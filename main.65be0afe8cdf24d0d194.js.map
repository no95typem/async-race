{"version":3,"sources":["webpack://async-race/./src/components/garage/garage.scss?dc9e","webpack://async-race/./src/components/garage/subcomps/car/car.scss?1a27","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/create-update.scss?4682","webpack://async-race/./src/components/garage/subcomps/main-controls/main-controls.scss?1eb1","webpack://async-race/./src/components/garage/subcomps/track/track.scss?9419","webpack://async-race/./src/components/header/header.scss?92c0","webpack://async-race/./src/components/winners/winners.scss?feec","webpack://async-race/./src/lib/components/popups/standalone/modal/popup-standalone-modal.scss?0629","webpack://async-race/./src/lib/components/popups/standalone/modal/progress/popup-progress.scss?22c3","webpack://async-race/./src/styles.scss?cfb3","webpack://async-race/./src/app/app.ts","webpack://async-race/./src/app/dbus-msgs/reboot-msg.def.ts","webpack://async-race/./src/components/garage/car-actions.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-action-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-created-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-remove-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-select-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-page-is-changed.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-request-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-status-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-reset-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-reset-req-msg.def.ts","webpack://async-race/./src/components/garage/garage-controller.ts","webpack://async-race/./src/components/garage/garage-driver.ts","webpack://async-race/./src/components/garage/garage-managers-team.ts","webpack://async-race/./src/components/garage/garage.ts","webpack://async-race/./src/components/garage/subcomps/car/car.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-create.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-proto.def.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-update.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/create-update.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/dbus-msgs/generate-cars-msg.def.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/main-controls.ts","webpack://async-race/./src/components/garage/subcomps/popup-winner/popup-winner.ts","webpack://async-race/./src/components/garage/subcomps/track/track.ts","webpack://async-race/./src/components/header/header.ts","webpack://async-race/./src/components/header/subcomps/nav-item/nav-item.ts","webpack://async-race/./src/components/winners/subcomps/winner-entry.ts","webpack://async-race/./src/components/winners/winners.ts","webpack://async-race/./src/definitions/car-random-data.def.ts","webpack://async-race/./src/lib/components/base-comp/base-comp.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/404/popup-404.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/popup-standalone-modal.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/progress/popup-progress.ts","webpack://async-race/./src/lib/components/popups/standalone/popup-standalone.ts","webpack://async-race/./src/lib/convertors/colors.ts","webpack://async-race/./src/lib/generators/generators.ts","webpack://async-race/./src/lib/gui/animation.ts","webpack://async-race/./src/lib/interfaces/notifiable.ts","webpack://async-race/./src/lib/processors/obj-processor.ts","webpack://async-race/./src/lib/services/dbus/dbus.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-common-responses.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-errors.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-hub-names.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-interface.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-rx/dbus-rx.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-topics.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-data-headers.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-data.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx.def.ts","webpack://async-race/./src/lib/services/dbus/defs/msgs/dbus-msg.def.ts","webpack://async-race/./src/lib/services/pager/pager.ts","webpack://async-race/./src/lib/services/simple-router/dbus-msgs-defs/dbus-msg-routing-msg.def.ts","webpack://async-race/./src/lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg.ts","webpack://async-race/./src/lib/services/simple-router/simple-router-agent.ts","webpack://async-race/./src/lib/services/simple-router/simple-router.ts","webpack://async-race/./src/services/rest-clients/client-engine/rest-client-engine.ts","webpack://async-race/./src/services/rest-clients/client-garage/rest-client-garage.ts","webpack://async-race/./src/services/rest-clients/client-winners/rest-client-winners.def.ts","webpack://async-race/./src/services/rest-clients/client-winners/rest-client-winners.ts","webpack://async-race/./src/services/rest-clients/rest-clients-errors.def.ts","webpack://async-race/./src/services/rest-clients/rest-clients-names.def.ts","webpack://async-race/webpack/bootstrap","webpack://async-race/webpack/runtime/define property getters","webpack://async-race/webpack/runtime/hasOwnProperty shorthand","webpack://async-race/webpack/runtime/make namespace object","webpack://async-race/./src/entry.ts"],"names":["rootElement","hubName","DBUS_HUB_NAMES","APP","loadedMainComponents","defaultRouterAgent","SimpleRouterAgent","this","loadMainComponent","router","SimpleRouter","mode","defaultRoot","defaultAgent","mainlineDBus","DBus","rebootMsg","DBusMsgRebootMsg","emergencyHandlerIsWorking","sendRebootMsg","tx","transmit","msg","prepMode","DBusTXPrepModes","freeze","waitMode","DBusTXWaitModes","allSetled","watchRouterMsgs","async","data","DBusMsgRouteIsChangedMsg","newRoute","DBUS_COMMON_RESPONSES","VOID","setupEmergencyHandler","classList","add","app","header","HeaderComponent","HEADER","append","attachHub","activateWantedAgents","window","addEventListener","e","preventDefault","promise","catch","error","message","REST_CLIENT_ERROR","CONNECTION_REFUSED","popup","PopupStandaloneModal404Comp","setText","show","retry","REST_CLIENT_GARAGE","getCars","console","log","hide","Promise","res","setTimeout","intrfce","routeRX","getNewRX","plugRX","DBusTopics","ROUTING","getNewTX","name","GarageComp","WinnersComp","location","hash","newComponent","currMainComponent","remove","isDBusHub","isNotifiable","notify","DBusMsg","signal","rxIds","prefResponseRxIds","super","APP_CTL","CarActions","DBusMsgCarActionMsg","action","CAR_ACTION","DBusMsgCarActionCreatedMsg","car","CREATED","DBusMsgCarActionRemovedMsg","nullifiedContract","REMOVED","DBusMsgCarActionSelectedMsg","notifyChanges","SELECTED","DBusMsgGarageMsg","GARAGE","DBusMsgGaragePageIsChangedMsg","DBusMsgGarageRaceMsg","DBusMsgRaceRequestMsg","DBusMsgGarageRaceStatusMsg","status","DBusMsgGarageResetMsg","DBusMsgGarageResetReqMsg","GarageCompCtlAkaDirector","tracksContainer","carCtlsBlock","GARAGE_CONTROLLER","txs","Set","entriesPerPage","pagerContainer","document","createElement","pagerCallback","dir","reloadData","appCtlRXFunc","resetState","generatorRXFunc","DBusMsgGenerateCarsMsg","garageManagersTeam","getContracts","size","racingRXFunc","pager","toogleLock","performRace","carActionsRXFunc","racePromise","tryChangePage","createCarCtlBlock","index","btns","btnSelect","btnStart","btnReset","btnRm","forEach","btn","numberSpan","textContent","toString","container","connectCtlAndTrack","ctlElem","track","illuminateSelf","GarageManagersTeam","Pager","setupPager","btnNextPage","getBtnNextPage","btnPrevPage","getBtnPrevPage","pagerInfo","getPagerSpan","redraw","int","autoConnect","carActionsMsgsRX","raceMsgsRX","generatorMsgsRX","GENERATE","appCtlMsgsRX","finally","undefined","rej","page","getCurrPageNumber","getEntriesPerPage","then","response","limit","cars","setEntriesCount","Number","parseInt","length","broadcastPaging","nullifyContracts","newContracts","TrackComp","carComp","CarComp","placeCar","push","addContracts","nowait","clearDOM","geometry","calcGeometry","setStylesForTracks","drawTracks","drawCarsCtls","firstChild","style","getComputedStyle","containerHeight","parseFloat","height","paddingBottom","paddingTop","firstAutoHeight","Math","min","innerWidth","CAR_WIDTH_RATIO","CAR_MAX_WIDTH","CAR_IMG_RATIO","heights","heightSum","contracts","contract","factor","SCALE_FACTOR","carTrackHeight","excessHeight","heightsReversed","sort","a","b","displacementBase","SKIPPED_PROGRESSION_MEMBERS_COUNT","displacements","midIndex","displacement","DISPLACEMENT_FIX","paddingBase","paddingShift","PADDING_SHIFT_BASE","PADDING_SHIFT_BASE_VW","trackHeights","setProperty","map","ctlBlocks","block","GarageDriverCommands","GarageDriver","emergencyAwaitServer","timeInMS","delayInMS","resPromise","PopupStandaloneModalProgressComp","setProgress","startTime","Date","now","interval","IamResolved","resFunc","clearInterval","setInterval","elapsedTime","progress","Error","flags","disableCtls","thisDriveId","genUniqId","currDriveId","ignitionPromise","TurnOnTheIgnition","driveParams","drivePromise","drive","REST_CLIENT_ENGINE","toggleEngine","currCar","id","stopCar","rollBack","msgBlock","updateProgress","playAwaitingAnim","clearTimeout","lastTimeInMs","lastStart","driveId","time","calculateDriveTime","start","enterDriveMode","success","rollForward","playbackRate","onlyAnim","rollover","broken","stop","params","distance","velocity","freeDrivers","busyDrivers","Map","winnerPopup","GaragePopupWinner","carCtlsClickListener","target","HTMLElement","elem","HTMLButtonElement","parentElement","disabled","currRaceId","handleRemoving","startDriving","handleRestoreState","handleSelection","handleWinner","isFinishVisible","duration","getTransitionDuration","awaitTime","isRoadMoves","winnerCar","setData","toFixed","REST_CLIENT_WINNERS","getWinner","winnerRecord","updatedWinnerData","wins","updateWinner","NOT_FOUND","newWinnerData","createWinner","tryFreeDrivers","delete","clear","—Åontracts","newContract","prepareForRace","rollbackCars","broadcastRaceStatus","driver","get","returnToStart","choosedDriver","find","isFree","set","putBehindTheWheel","performDrivingProtocol","deleteCar","deleteWinner","genSelectCallback","rollbacks","all","thisRaceId","raceData","raceId","arrivedByOrder","notArrived","participantsCount","roadElem","stratedCount","processRace","result","handleDriveResult","getOutOfTheCar","has","updateData","BaseComp","isControllerWorking","mainControlsComp","MainControlsComp","carsCtlsBlock","bgVideo","bgVideoProgressListener","buffered","end","bgVideoCanPlayListener","removeEventListener","reset","controller","startWorking","play","_rootElement","garage","selfCtlsBlock","bg","garage__bg","setupBgVideo","renderBgVideo","controls","loop","defaultMuted","muted","autoplay","src","attachSubHub","_currCar","canvas","tireBack","btnSelect$","btnRm$","_spanCarName","btnStart$","btnReset$","isReseted","movingClassName","clearAnimFromElem","anim","commitStyles","selectSpan","rmSpan","startSpan","resetSpan","drawCar","color","drawWheels","observer","MutationObserver","mutations","mutation","oldValue","includes","currOutOfSceneAnim","pause","disconnect","contains","outOfScene","rootElem","wheelImg","Image","CAR_WHEEL_IMG_SRC","onload","backwardWheelImg","OBJ_PROCESSOR","deepClone","carData","finishPromise","resolve","playOutAnim","cancel","currAnimation","finished","removeProperty","playInAnim","asyncFunc","animOut","animate","opacity","easing","fill","promiseToAwait","animIn","iterations","POSITIVE_INFINITY","transform","handleBtns","rootStyle","selfStyle","rootWidth","width","paddingLeft","paddingRight","selfWidth","coordinateInPercents","onfinish","oncancel","playState","roadIsMoving","observe","attributes","attributeOldValue","img","frameNumber","CAR_EXPLOSION_IMG_DATA","BASE_URL","EXTENSION","FRAME_TIME_MS","FRAMES_COUNT","hexColor","CAR_BODY_IMG_SRC","ctx","getContext","shadowColor","shadowBlur","drawImage","paintCarBody","imageData","getImageData","rgb","hexToRgb","j","i","red","green","blue","blueDiff","blueDiffThreshold","threshold","r","g","putImageData","TIMING_FUNCTION","CreateCompController","CreateUpdateCompControllerProto","elements","inputText","inputColor","setupBtnCreate","reportValidity","unregCar","value","createCar","clone","ctlsStateMap","ctls","setCustomValidity","pattern","removeAttribute","state","ctl","pushCtlsState","toogleCtlsDisabled","popCtlsState","UpdateCompController","garageMsgsListener","carActionsListener","choosedCar","notifyCb","setupBtnUpdate","rxCarActions","rxGarage","updateCar","CreateUpdateComponent","type","btnText","CREATE_UPDATE","textInput","colorInput","root","MAIN_CONTROLS","createComponent","updateComponent","btnRace","btnGenerate","generateClickListener","transmissions","transmission","allSettled","generate","genCb","resolveMsg","raceClickListener","resetClickListener","genRandomCarName","manufacturerNumber","getRandomInt","CAR_MODEL_LIST_KEYS","manufacturerName","models","CAR_MODEL_LIST","rxFuncForRaceMsgs","getController","enable","disable","btnsBlock","renderBtns","span","btnBlock","total","left","cb","genLeft","unregCarData","genRandomHexColor","rx","textTime","textName","textId","textNumber","timeStr","indexStr","topBlock","illuminate","track_illuminated","hasChildNodes","childNodes","child","spanCarName","buses","illuminateNavItem","anchors","anchor","getAttribute","logo","header__logo","firstSpan","secondSpan","navContainer","ul","li","svg","navItems","NavItem","item","illuminateRX","text","href","styles","iconSrc","_anchor","setAttribute","iconImage","WinnerRowComp","winnerData","indexElem","idElem","carPreviewBox","nameElem","winsElem","bestTimeElem","carPreview","genPreview","table","tableBody","tableHead","thId","thCar","thName","thWins","thBestTime","pagerBtnsContainer","currOrder","currSort","refillTable","tableHeadClickListener","REST_CLIENT_WINNERS_SORT_OPTIONS","refreshTableHeader","currSortedElem","winners","pagerSpan","renderPager","renderTable","renderTableHeader","tr","thIndex","getWinners","rows","Array","promises","indexInc","winner","getCar","totalIndex","row","getCarPreview","TEXT_CONTENT_ENG","deepFreeze","Lamborghini","Ferrari","Koenigsegg","Object","keys","tag","PopupStandaloneModalComp","dataset","PopupStandaloneComp","closeArea","body","barContainer","bar","setHeader","hex","c","test","split","slice","arr","Uint8Array","crypto","getRandomValues","join","max","floor","random","prop","transPropArr","getPropertyValue","replace","propIndex","lastIndexOf","transformAndAutoresolve","delay","val","forceAutoresolveIn","valToWait","eventHandler","propertyName","transformAndWaitEvent","object","obj","record","isFrozen","isArray","v","n","cloneNode","Blob","k","setPrototypeOf","getPrototypeOf","network","idCounter","rxs","createdRXs","createdTXs","attachedHubs","occupiedNames","callRXFunc","headers","clonedData","func","handleClone","freezedData","handleFreeze","DBUS_ERRORS","UNEXPECTED_PREP_MODE","busId","hub","suffix","createInterfaceForHub","prefix","HUB_IS_ALREADY_ATTACHED","HUB_NAME_NOT_AUTHORIZED","HUB_NAME_IS_OCCUPIED","dbusInterface","DBusInterface","desc","genNewRX","topic","unplugRX","subHub","subSuffix","connect","regNumber","DBusTX","opts","head","DBusTXDataHeaders","DBusTXData","freezedTX","DBusRX","freezedRX","XENO_RX","TOPIC_IS_NOT_EXIST","TOPIC_HAS_NO_RXS","choosedRXs","PREF_RXS_ARE_NOT_EXIST","manual","BAD_REQUEST","ROUTER","objAsRecord","arrowedGetNewTX","arrowedGetNewRX","arrowedPlugRX","arrowedUnplugRX","RXs","TXs","RXsPlugMap","txId","txRegNumber","txDesc","listCallback","firstPageNumber","currPageNumber","lastPageNumber","entriesCount","callbackIsCalled","btnNextSpan","btnPrevSpan","callCallback","lock","toggleBtnsDisabled","ceil","DBusMsgRoutingMsg","addInfo","path","callback","getStateCallback","setStateCallback","options","agents","restrictions","currRoute","wantedRoute","host","values","arrow","cancelRouteChange","activatedCount","errors","onlyDBus","agentsArr","agent","baseUrl","resUrl","fullUrl","url","fetch","method","json","UNEXPECTED_RESULT","UNKNOWN_ERROR","clientName","REST_CLIENT_NAMES","limitStr","limitResponse","JSON","stringify","regCar","order","winnerCarData","WINNERS","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","d","definition","key","o","defineProperty","enumerable","prototype","hasOwnProperty","Symbol","toStringTag","appDiv","App"],"mappings":"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","file":"main.65be0afe8cdf24d0d194.js","sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"garage\":\"_21SC4SGf5mTamWfNdNRR\",\"garage__bg\":\"_2VnbeeG4HKnZfSWUedizHh\",\"garage__track-container\":\"_1rsPT6UvHnbHI-FUFvPaSe\",\"hue-rotate\":\"_3MSD3skhU7RLqKdx6pBax7\",\"garage__track-container_finish\":\"_1khEfVJzcbQlBMhoHPdhzY\",\"garage__winner-popup\":\"_17InT8lGlAlk8k1JRcrTCM\",\"garage-bg\":\"-BA3r_cxZwAYkgGQVVZeo\",\"garage-bg__video\":\"_3byu86MCf3s6B7JQuetNAw\",\"garage-bg__car-ctl-btn\":\"_3upDU-ngLjybmFg4wiVvfl\",\"garage-bg__car-ctl-block-number\":\"_3dT19pzigDW1UKuPVLEguq\",\"garage-bg__car-ctl-block\":\"_2e0Ox8Joh0jw60ztR_rVt5\",\"garage-bg__cars-ctls-block\":\"wMVLCRcoluFnZleBHWXlm\",\"garage-bg__self-ctls-block\":\"_2VQVmkB2amN4PG9XCyFye9\",\"garage-bg__pager\":\"_2avafWgl8XDS2KLJswKq0H\",\"garage-bg__pager-span\":\"_3ktlpozBQghco3VMHLJBo1\",\"garage-bg__pager-btn\":\"_2QdjLaEnj3Balh89eZAya4\",\"synthwave-background\":\"_2pUKJme_w_0KTS_JoVNV5b\",\"synthwave-background_race-mode\":\"n1z9UH35nfilmkK2lmQvV\",\"race\":\"_375ItX4gjZY-ZT7KrEfBgG\",\"move-grid\":\"_1MqERRNbzZtvdd9iE43L04\"};","// extracted by mini-css-extract-plugin\nexport default {\"car-div\":\"_3pRKwGaRv59JcJqlApAnkk\",\"car-div__canvas\":\"rH6_OMXna8-zeemMHF11D\",\"car-div__wheel\":\"_3WNDl-LGGtViqzAfLLX4CB\",\"car-div__wheel_forward\":\"_3Rdh32fs7fi-95LcabV_Ed\",\"car-div__wheel_backward\":\"_3xptMXOOFn6YcMVYMigRMa\",\"car-div__explosion\":\"_3w8-mlW0m2zLABohqiDQ3e\",\"car-div_rollForward\":\"_3xWmq3Q2UpNiq2nICrGAIN\",\"car-div-anim\":\"_381V-1xCMVwSdGT0FxnQiO\",\"tire-anim\":\"_2Qs9DAZPIqZivw_0ON2Vot\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"_2uo9WXSTJyDD3jBlT_quev\",\"text-input\":\"_2YNdYEaErpy02Ske_bZONx\",\"color-input\":\"_3Ye7rbfoBnq4HZn4H-yDB8\"};","// extracted by mini-css-extract-plugin\nexport default {\"main-controls\":\"_2b_svto1O0DGSO3_579_Xj\",\"btn-block\":\"_262VSHreYXfZUHLGeCJEvZ\"};","// extracted by mini-css-extract-plugin\nexport default {\"track\":\"_2hDrLwwwZMiv2NrI-XZZqJ\",\"track_illuminated\":\"_3zXlLAoKpXJ_jlpauHLjHR\",\"track__controls-block\":\"_3pqcODoHFqX9rxmLKBnhD4\"};","// extracted by mini-css-extract-plugin\nexport default {\"header\":\"_3TTTWNe5aoHesw4iV0YUGU\",\"header__logo\":\"_2idUQTZia_1M_0xkhMkXf8\",\"header-nav\":\"_7vejZGT8OzUejTiWyGs1P\",\"header-nav__item\":\"_1NYwlHRXmh2YGu63soBsjx\",\"header-nav__anchor\":\"_2n39qEg5Iz5Tym2Z0Jrjz9\",\"header-nav__anchor_active\":\"_2bRvd3RlExbbSpyXLuxSdS\",\"header-nav__svg\":\"_2FCXcgNK7Jgl9f3ZK-O56I\",\"header-nav__span\":\"_1NVrpdaSQLvqho4VNqQqit\",\"header-nav__list\":\"_1vy8OijKt-Cy7SGXyM4ek9\",\"header-nav__list_disabled\":\"_25SilQm6mkAlbl-WpajKBY\"};","// extracted by mini-css-extract-plugin\nexport default {\"winners\":\"HVDfoBgyIQ4teF5EKFzcD\",\"table\":\"_3mJKnd573Tt4WspNl7gf1J\",\"table__car-preview-box\":\"_86kcZK8UgXIsvYD-wpDED\",\"table__can-be-sorted\":\"_3Xa74hpyx3g6XUuZ9fB9Cm\",\"table__sorted-elem\":\"rfPuVNCW0Sd4nzQGO8-R8\",\"table__sorted-elem_asc\":\"N6296gY2c5AFEX4KjE4I4\",\"table__sorted-elem_desc\":\"_37bMOUs2OF28ZqMubJCPnM\",\"pager\":\"_2q-noyJbwIpKOMhl7AWlq5\",\"pager-span\":\"_1O8erRuDz9RWa3C9tqnUm-\",\"pager-btn\":\"_3OktYstRgXgDE6zlpOM6LA\"};","// extracted by mini-css-extract-plugin\nexport default {\"popup-modal\":\"_3KlZOyoPt2P4FT1Ofdi1oz\",\"popup-bg\":\"_1QGzfQYEHvrYonFptRzkG6\",\"popup-body\":\"_3zDyJwNy615xogiYvCl4vt\",\"popup-body-header\":\"_2DglTs5KJlA1QJriRI6bVZ\",\"popup-body-text\":\"_2oMxBL_Jv1KW3bHu3sVdaA\",\"popup-body__btn-close\":\"HV1Imp7Np5N8O5nUXwQsS\"};","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"_1KBIW4BNGKHwQtRcKc6JIF\",\"hue-rotate\":\"_1t6lrd-wEBCB6ei-o9kDmk\",\"bar\":\"_2DWg3PnmWwM25SBd7sLJQK\",\"body\":\"_24wm1l_qZHsMTx2Oy-enF4\",\"text\":\"_1UFV3thankQQ1R2Ly1Zle2\"};","// extracted by mini-css-extract-plugin\nexport default {\"app\":\"_2ljk-3_Qk7EjDct5a15qZP\",\"main-component\":\"_394erWdWCWrQmkYlaBZ1L5\",\"btn\":\"_3cliA46UjEIGfEKGRnJzCZ\",\"btn-1\":\"_7q7sGuJSjnM-fV8DfMtl5\",\"btn-4\":\"KE9Fso9VtLV8xX_x8IAiF\",\"btn-6\":\"_35BryCkuNmCUsRxmBw_Y1\",\"btn-9\":\"_9jiLaDmXVuzxrmO3P-9mb\",\"btn-13\":\"_1872fOtVBrHuR0iXYtVhRT\",\"btn-15\":\"TNTO3dtfSfS40M6g8U274\",\"glitched-text\":\"xB_2phBrodgB6jPUYYf8V\",\"glitch-animation-1\":\"_2N8U2GaQpCAdpuVv32CY9B\",\"glitch-animation-2\":\"_1g8DjVAkpXimf-Ld9-LLk8\"};","import { BaseComp } from '../lib/components/base-comp/base-comp';\nimport { SimpleRouterAgent } from '../lib/services/simple-router/simple-router-agent';\nimport { SimpleRouter } from '../lib/services/simple-router/simple-router';\nimport { DBus } from '../lib/services/dbus/dbus';\nimport { DBusMsgRouteIsChangedMsg } from '../lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport { DBusTopics } from '../lib/services/dbus/defs/dbus-topics.def';\nimport { DBUS_COMMON_RESPONSES } from '../lib/services/dbus/defs/dbus-common-responses.def';\nimport { HeaderComponent } from '../components/header/header';\n\nimport sharedStyles from '../styles.scss';\nimport { DBusTXData } from '../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { GarageComp } from '../components/garage/garage';\nimport {\n  DBusHub,\n  isDBusHub,\n  DBusInterface,\n} from '../lib/services/dbus/defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from '../lib/services/dbus/defs/dbus-hub-names.def';\nimport { WinnersComp } from '../components/winners/winners';\nimport { REST_CLIENT_ERROR } from '../services/rest-clients/rest-clients-errors.def';\nimport { isNotifiable } from '../lib/interfaces/notifiable';\nimport { PopupStandaloneModal404Comp } from '../lib/components/popups/standalone/modal/404/popup-404';\nimport { REST_CLIENT_GARAGE } from '../services/rest-clients/client-garage/rest-client-garage';\nimport { AppFlags } from './app-flags';\nimport { DBusMsgRebootMsg } from './dbus-msgs/reboot-msg.def';\nimport { DBusTX } from '../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\n\nexport class App implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.APP;\n\n  protected loadedMainComponents: Record<string, BaseComp> = {};\n\n  protected currMainComponent: BaseComp | undefined;\n\n  protected defaultRouterAgent = new SimpleRouterAgent('hash', '', () =>\n    this.loadMainComponent('default'),\n  );\n\n  protected router = new SimpleRouter({\n    mode: '#',\n    defaultRoot: '',\n    defaultAgent: this.defaultRouterAgent,\n  });\n\n  protected mainlineDBus = new DBus();\n\n  protected tx: DBusTX | undefined;\n\n  protected rebootMsg = new DBusMsgRebootMsg('reboot');\n\n  protected emergencyHandlerIsWorking = false;\n\n  constructor(private readonly rootElement: HTMLElement) {\n    // window.addEventListener('error', e => console.log(e));\n    this.setupEmergencyHandler();\n\n    this.rootElement.classList.add(sharedStyles.app);\n\n    const header = new HeaderComponent(DBUS_HUB_NAMES.HEADER);\n    this.rootElement.append(header.rootElement);\n\n    this.mainlineDBus.attachHub(this);\n    this.mainlineDBus.attachHub(header);\n    this.mainlineDBus.attachHub(this.router);\n\n    this.router.activateWantedAgents();\n  }\n\n  private setupEmergencyHandler() {\n    window.addEventListener('unhandledrejection', e => {\n      e.preventDefault();\n      e.promise.catch((error: Error) => {\n        if (\n          !this.emergencyHandlerIsWorking &&\n          error.message in REST_CLIENT_ERROR &&\n          error.message === REST_CLIENT_ERROR.CONNECTION_REFUSED\n        ) {\n          this.emergencyHandlerIsWorking = true;\n          const popup = new PopupStandaloneModal404Comp();\n          popup\n            .setText(\n              `No connection! Check that the server is online\n          and nothing is blocking the connection!`,\n            )\n            .show();\n          const retry = async () => {\n            try {\n              await REST_CLIENT_GARAGE.getCars();\n              console.log('SEND MSG!');\n              await this.sendRebootMsg();\n              console.log('HIDDING');\n              popup.hide();\n              this.emergencyHandlerIsWorking = false;\n            } catch {\n              console.log('catched');\n              await new Promise(res => setTimeout(res, 1000));\n              retry();\n            }\n          };\n          retry();\n        }\n      });\n    });\n  }\n\n  private sendRebootMsg = () => {\n    return this.tx?.transmit({\n      msg: this.rebootMsg,\n      prepMode: DBusTXPrepModes.freeze,\n      waitMode: DBusTXWaitModes.allSetled,\n    });\n  };\n\n  connect(intrfce: DBusInterface) {\n    const routeRX = intrfce.getNewRX(this.watchRouterMsgs);\n    intrfce.plugRX(DBusTopics.ROUTING, routeRX);\n    this.tx = intrfce.getNewTX('APP SYSTEM MSGS TX');\n  }\n\n  private watchRouterMsgs = async (data: DBusTXData) => {\n    const { msg } = data;\n    if (msg instanceof DBusMsgRouteIsChangedMsg) {\n      // TODO: Rework with enum!?\n      this.loadMainComponent(msg.newRoute);\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private loadMainComponent(name: string): void {\n    if (!(name in this.loadedMainComponents)) {\n      switch (name) {\n        case '#garage':\n          this.loadedMainComponents[`${name}`] = new GarageComp();\n          break;\n        case '#winners':\n          this.loadedMainComponents[`${name}`] = new WinnersComp();\n          break;\n        default:\n          window.location.hash = '#garage';\n          break;\n      }\n    }\n    const newComponent = this.loadedMainComponents[`${name}`];\n\n    if (newComponent) {\n      if (this.currMainComponent) {\n        this.currMainComponent.rootElement.remove();\n      }\n\n      this.currMainComponent = newComponent;\n      newComponent.rootElement.classList.add(sharedStyles['main-component']);\n      this.rootElement.append(newComponent.rootElement);\n\n      if (isDBusHub(this.currMainComponent)) {\n        try {\n          this.mainlineDBus.attachHub(this.currMainComponent);\n        } catch {\n          // no need to catch\n        }\n      }\n      if (isNotifiable(this.currMainComponent)) {\n        console.log('notify');\n        this.currMainComponent.notify(null);\n      }\n    }\n  }\n}\n","import { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport class DBusMsgRebootMsg extends DBusMsg {\n  constructor(\n    readonly signal: 'reboot',\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.APP_CTL, rxIds, prefResponseRxIds);\n  }\n}\n","export enum CarActions {\n  CREATED,\n  SELECTED,\n  REMOVED,\n  UPDATED,\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\nimport { CarActions } from '../../../car-actions.def';\n\nexport class DBusMsgCarActionMsg extends DBusMsg {\n  constructor(\n    readonly action: CarActions,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.CAR_ACTION, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionCreatedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.CREATED, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { GarageServicemanContract } from '../../../garage-serviceman-contract.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionRemovedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly nullifiedContract: GarageServicemanContract,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.REMOVED, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionSelectedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly notifyChanges?: (car: RegCarData) => unknown,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.SELECTED, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgGarageMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GARAGE, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageMsg } from './garage-msg.def';\n\nexport class DBusMsgGaragePageIsChangedMsg extends DBusMsgGarageMsg {}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgGarageRaceMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GARAGE, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageRaceMsg } from './garage-race-msg.def';\n\nexport class DBusMsgRaceRequestMsg extends DBusMsgGarageRaceMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { RaceStatusesList } from '../../../race-statuses.def';\nimport { DBusMsgGarageRaceMsg } from './garage-race-msg.def';\n\nexport class DBusMsgGarageRaceStatusMsg extends DBusMsgGarageRaceMsg {\n  constructor(\n    readonly status: RaceStatusesList,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgGarageResetMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GARAGE, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageResetMsg } from './garage-reset-msg.def';\n\nexport class DBusMsgGarageResetReqMsg extends DBusMsgGarageResetMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBUS_COMMON_RESPONSES } from '../../lib/services/dbus/defs/dbus-common-responses.def';\nimport { DBUS_HUB_NAMES } from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBusTX } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionRemovedMsg } from './dbus-msgs/by-topic/car-action/garage-car-remove-msg.def';\nimport { GarageManagersTeam } from './garage-managers-team';\nimport { CarComp } from './subcomps/car/car';\nimport { TrackComp } from './subcomps/track/track';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\nimport { DBusMsgCarActionCreatedMsg } from './dbus-msgs/by-topic/car-action/garage-car-created-msg.def';\nimport { DBusMsgRaceRequestMsg } from './dbus-msgs/by-topic/garage/garage-race-request-msg.def';\nimport { DBusMsgGarageResetReqMsg } from './dbus-msgs/by-topic/garage/garage-reset-req-msg.def';\n\nimport styles from './garage.scss';\nimport sharedStyles from '../../styles.scss';\nimport { Pager } from '../../lib/services/pager/pager';\nimport { DBusMsgGenerateCarsMsg } from './subcomps/main-controls/dbus-msgs/generate-cars-msg.def';\nimport { DBusMsgRebootMsg } from '../../app/dbus-msgs/reboot-msg.def';\nimport { DBusMsgGaragePageIsChangedMsg } from './dbus-msgs/by-topic/garage/garage-page-is-changed.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\n\ntype TracksGeometry = {\n  trackHeights: number[];\n  displacements: number[];\n  paddingBase: number;\n  paddingShift: number;\n};\n\nexport class GarageCompCtlAkaDirector implements DBusHub {\n  static readonly DISPLACEMENT_FIX = -30;\n\n  static readonly CAR_WIDTH_RATIO = 0.2;\n\n  static readonly CAR_MAX_WIDTH =\n    1920 * GarageCompCtlAkaDirector.CAR_WIDTH_RATIO;\n\n  static readonly SKIPPED_PROGRESSION_MEMBERS_COUNT = 2;\n\n  static readonly PADDING_SHIFT_BASE = 20;\n\n  static readonly PADDING_SHIFT_BASE_VW = 1920;\n\n  static readonly CAR_IMG_RATIO = 3.78;\n\n  static readonly SCALE_FACTOR = 0.95;\n\n  readonly hubName = DBUS_HUB_NAMES.GARAGE_CONTROLLER;\n\n  protected txs = new Set<DBusTX>();\n\n  private garageManagersTeam: GarageManagersTeam;\n\n  private pager: Pager;\n\n  private entriesPerPage = 7;\n\n  private pagerContainer = document.createElement('div');\n\n  private racePromise: Promise<unknown> | undefined;\n\n  // * FINISHED < 40 LINES *\n  constructor(\n    private tracksContainer: HTMLElement,\n    private carCtlsBlock: HTMLElement,\n  ) {\n    this.garageManagersTeam = new GarageManagersTeam(\n      tracksContainer,\n      carCtlsBlock,\n    );\n\n    this.pager = new Pager(this.entriesPerPage, this.pagerCallback);\n    this.setupPager();\n  }\n\n  // * FINISHED < 40 LINES *\n  private setupPager() {\n    const btnNextPage = this.pager.getBtnNextPage();\n    btnNextPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['garage-bg__pager-btn'],\n    );\n\n    const btnPrevPage = this.pager.getBtnPrevPage();\n    btnPrevPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['garage-bg__pager-btn'],\n    );\n\n    const pagerInfo = this.pager.getPagerSpan();\n    pagerInfo.classList.add(styles['garage-bg__pager-span']);\n\n    this.pagerContainer.classList.add(styles['garage-bg__pager']);\n    this.pagerContainer.append(btnPrevPage, btnNextPage, pagerInfo);\n  }\n\n  // * FINISHED < 40 LINES *\n  private pagerCallback = async (dir: 'prev' | 'next'): Promise<boolean> => {\n    try {\n      await this.reloadData(dir);\n      return true;\n    } catch {\n      return false;\n    }\n  };\n\n  // * FINISHED < 40 LINES *\n  async startWorking(): Promise<boolean> {\n    try {\n      await this.reloadData('no');\n      window.addEventListener('resize', () => this.redraw());\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  // * FINISHED < 40 LINES *\n  async connect(int: DBusInterface): Promise<void> {\n    this.txs.add(int.getNewTX('send requests to REST Garage client'));\n    this.garageManagersTeam.autoConnect(int);\n\n    const carActionsMsgsRX = int.getNewRX(\n      this.carActionsRXFunc,\n      'monitor cars removes',\n    );\n    int.plugRX(DBusTopics.CAR_ACTION, carActionsMsgsRX);\n\n    const raceMsgsRX = int.getNewRX(this.racingRXFunc, 'handle race requsets');\n    int.plugRX(DBusTopics.GARAGE, raceMsgsRX);\n\n    const generatorMsgsRX = int.getNewRX(this.generatorRXFunc);\n    int.plugRX(DBusTopics.GENERATE, generatorMsgsRX);\n\n    const appCtlMsgsRX = int.getNewRX(\n      this.appCtlRXFunc,\n      'handle app reboot msgs',\n    );\n    int.plugRX(DBusTopics.APP_CTL, appCtlMsgsRX);\n  }\n\n  private appCtlRXFunc = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgRebootMsg && data.msg.signal === 'reboot') {\n      await this.resetState();\n      await this.reloadData('no');\n      return true;\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private generatorRXFunc = async (data: DBusTXData) => {\n    if (\n      data.msg instanceof DBusMsgGenerateCarsMsg &&\n      data.msg.status === 'end'\n    ) {\n      const contracts = this.garageManagersTeam.getContracts();\n\n      if (contracts.size < this.entriesPerPage) await this.reloadData('no');\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private racingRXFunc = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgRaceRequestMsg) {\n      this.pager.toogleLock(true);\n      await this.performRace();\n      this.pager.toogleLock(false);\n      return true;\n    }\n    if (data.msg instanceof DBusMsgGarageResetReqMsg) {\n      return this.resetState();\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private async resetState() {\n    const reseted = await this.garageManagersTeam.resetState();\n    return reseted;\n  }\n\n  // * FINISHED < 40 LINES *\n  // ! NOT TESTED PROMISE !\n  private async performRace() {\n    this.racePromise = this.garageManagersTeam.performRace().finally(() => {\n      this.racePromise = undefined;\n    });\n  }\n\n  // * FINISHED < 40 LINES *\n  // ! NOT TESTED AWAIT PROMISE !\n  private carActionsRXFunc = async (data: DBusTXData) => {\n    if (\n      data.msg instanceof DBusMsgCarActionRemovedMsg ||\n      data.msg instanceof DBusMsgCarActionCreatedMsg\n    ) {\n      if (this.racePromise) await this.racePromise;\n      try {\n        this.reloadData('no');\n      } catch {\n        this.pager.tryChangePage('prev');\n      }\n    }\n\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private reloadData(dir: 'prev' | 'next' | 'no') {\n    return new Promise<boolean>((res, rej) => {\n      const page = dir\n        ? dir === 'next'\n          ? this.pager.getCurrPageNumber() + 1\n          : dir === 'prev'\n          ? this.pager.getCurrPageNumber() - 1\n          : dir === 'no'\n          ? this.pager.getCurrPageNumber()\n          : 1\n        : 1;\n      REST_CLIENT_GARAGE.getCars(page, this.pager.getEntriesPerPage()).then(\n        async response => {\n          const { limit, cars } = response;\n          this.pager.setEntriesCount(Number.parseInt(limit, 10));\n          if (cars.length === 0 && dir !== 'no') {\n            rej();\n            return;\n          }\n          if (dir !== 'no') this.broadcastPaging();\n\n          await this.garageManagersTeam.nullifyContracts();\n          const newContracts: GarageServicemanContract[] = [];\n\n          cars.forEach((car, index) => {\n            const track = new TrackComp();\n            const carComp = new CarComp(car, index + 1);\n            track.placeCar(carComp);\n            newContracts.push({ track, car: carComp });\n          });\n\n          this.garageManagersTeam.addContracts(...newContracts);\n          this.garageManagersTeam.resetState();\n          this.redraw();\n          res(true);\n        },\n      );\n    });\n  }\n\n  private broadcastPaging() {\n    const msg = new DBusMsgGaragePageIsChangedMsg();\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  // * FINISHED < 40 LINES *\n  private redraw() {\n    this.clearDOM();\n\n    const geometry = this.calcGeometry();\n    this.setStylesForTracks(geometry);\n\n    this.drawTracks();\n    this.drawCarsCtls();\n  }\n\n  // * FINISHED < 40 LINES *\n  private clearDOM() {\n    while (this.tracksContainer.firstChild)\n      this.tracksContainer.firstChild.remove();\n    while (this.carCtlsBlock.firstChild) this.carCtlsBlock.firstChild.remove();\n  }\n\n  // ! MORE THAN 40 LINES ! BUT IT IS AN ONE-PIECE FUNCTION !\n  // ! BETTER TO SAVE IT AS IS\n  private calcGeometry(): TracksGeometry {\n    const style = window.getComputedStyle(this.tracksContainer);\n    const containerHeight =\n      Number.parseFloat(style.height) -\n      Number.parseFloat(style.paddingBottom) -\n      Number.parseFloat(style.paddingTop);\n    const firstAutoWidth = Math.min(\n      window.innerWidth * GarageCompCtlAkaDirector.CAR_WIDTH_RATIO,\n      GarageCompCtlAkaDirector.CAR_MAX_WIDTH,\n    );\n    const firstAutoHeight =\n      firstAutoWidth / GarageCompCtlAkaDirector.CAR_IMG_RATIO;\n    const heights: number[] = [];\n    let heightSum = 0;\n    const contracts = [...this.garageManagersTeam.getContracts()];\n\n    contracts.forEach((contract, index) => {\n      const factor = GarageCompCtlAkaDirector.SCALE_FACTOR ** index;\n      const carTrackHeight = firstAutoHeight * factor;\n      heightSum += carTrackHeight;\n      heights.push(carTrackHeight);\n    });\n\n    const excessHeight = heightSum - containerHeight;\n    const heightsReversed = heights.sort((a, b) => a - b);\n    const displacementBase =\n      excessHeight > 0\n        ? excessHeight / this.garageManagersTeam.getContracts().size -\n          GarageCompCtlAkaDirector.SKIPPED_PROGRESSION_MEMBERS_COUNT\n        : 0;\n\n    const displacements: number[] = [];\n    const midIndex = (contracts.length - 1) / 2;\n\n    contracts.forEach((contract, index) => {\n      const diff = index - midIndex;\n      const displacement =\n        displacementBase * -diff + GarageCompCtlAkaDirector.DISPLACEMENT_FIX;\n      displacements.push(displacement);\n    });\n\n    const paddingBase =\n      (heightsReversed[0] as number) * GarageCompCtlAkaDirector.CAR_IMG_RATIO;\n    const paddingShift =\n      (GarageCompCtlAkaDirector.PADDING_SHIFT_BASE * window.innerWidth) /\n      GarageCompCtlAkaDirector.PADDING_SHIFT_BASE_VW;\n\n    return {\n      trackHeights: heightsReversed,\n      displacements,\n      paddingBase,\n      paddingShift,\n    };\n  }\n\n  // * FINISHED < 40 LINES *\n  private setStylesForTracks(geometry: TracksGeometry) {\n    const contracts = [...this.garageManagersTeam.getContracts()];\n\n    contracts.forEach((contract, index) => {\n      contract.track.rootElement.style.setProperty(\n        'height',\n        `${geometry.trackHeights[index]}px`,\n      );\n\n      contract.track.rootElement.style.setProperty(\n        'top',\n        `${geometry.displacements[index]}px`,\n      );\n\n      contract.track.rootElement.style.setProperty('z-index', `${index + 1}`);\n\n      contract.track.rootElement.style.setProperty(\n        '--padding-w',\n        `${\n          (geometry.trackHeights[\n            geometry.trackHeights.length - 1 - index\n          ] as number) *\n            GarageCompCtlAkaDirector.CAR_IMG_RATIO -\n          geometry.paddingBase +\n          geometry.paddingShift * (contracts.length - 1 - index)\n        }px`,\n      );\n    });\n  }\n\n  // * FINISHED < 40 LINES *\n  private drawTracks() {\n    this.tracksContainer.append(\n      this.pagerContainer,\n      ...[...this.garageManagersTeam.getContracts()].map(\n        contract => contract.track.rootElement,\n      ),\n    );\n  }\n\n  // * FINISHED < 40 LINES *\n  private drawCarsCtls() {\n    const contracts = [...this.garageManagersTeam.getContracts()];\n    const ctlBlocks = contracts.map((contract, index) => {\n      const block = this.createCarCtlBlock(contract.car, index + 1);\n      this.connectCtlAndTrack(block, contract.track);\n      return block;\n    });\n    this.carCtlsBlock.append(...ctlBlocks);\n  }\n\n  // * FINISHED < 40 LINES *\n  private createCarCtlBlock = (car: CarComp, index: number): HTMLElement => {\n    const btns = [car.btnSelect, car.btnStart, car.btnReset, car.btnRm];\n\n    btns.forEach(btn => {\n      btn.classList.add(sharedStyles.btn, styles['garage-bg__car-ctl-btn']);\n    });\n\n    car.btnStart.classList.add(sharedStyles['btn-15']);\n    car.btnSelect.classList.add(sharedStyles['btn-13']);\n    car.btnReset.classList.add(sharedStyles['btn-9']);\n    car.btnRm.classList.add(sharedStyles['btn-4']);\n\n    const numberSpan = document.createElement('span');\n    numberSpan.classList.add(styles['garage-bg__car-ctl-block-number']);\n    numberSpan.textContent = index.toString();\n\n    const container = document.createElement('div');\n    container.classList.add(styles['garage-bg__car-ctl-block']);\n    container.append(numberSpan, ...btns);\n\n    return container;\n  };\n\n  // * FINISHED < 40 LINES *\n  // ? REFACTOR TO BE ABLE TO RM EVENT LISTENERS ?\n  private connectCtlAndTrack = (ctlElem: HTMLElement, track: TrackComp) => {\n    ctlElem.addEventListener(\n      'mouseover',\n      () => track.illuminateSelf(true),\n      true,\n    );\n    ctlElem.addEventListener(\n      'mouseout',\n      () => track.illuminateSelf(false),\n      true,\n    );\n  };\n}\n","import { PopupStandaloneModalProgressComp } from '../../lib/components/popups/standalone/modal/progress/popup-progress';\nimport { genUniqId } from '../../lib/generators/generators';\nimport {\n  EngineResponse,\n  REST_CLIENT_ENGINE,\n} from '../../services/rest-clients/client-engine/rest-client-engine';\nimport { REST_CLIENT_ERROR } from '../../services/rest-clients/rest-clients-errors.def';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\n\nexport enum GarageDriverCommands {\n  START_DRIVING,\n  STOP_DRIVING,\n}\n\nexport class GarageDriver {\n  private contract: GarageServicemanContract | undefined;\n\n  private currDriveId: string | undefined;\n\n  private drivePromise: Promise<unknown> | undefined;\n\n  private ignitionPromise: Promise<unknown> | undefined;\n\n  private lastStart: number | undefined;\n\n  private lastTimeInMs: number | undefined;\n\n  public isFree(): boolean {\n    if (!this.contract) return true;\n    return false;\n  }\n\n  putBehindTheWheel(contract: GarageServicemanContract): void {\n    if (this.contract) throw new Error('ALREADY IN CAR');\n    this.contract = contract;\n  }\n\n  async getOutOfTheCar() {\n    this.contract = undefined;\n  }\n\n  async performDrivingProtocol(flags?: Record<string, unknown>) {\n    const newPromise = new Promise<{\n      driveParams: EngineResponse;\n      drivePromise: Promise<number | false>;\n    }>((res, rej) => {\n      if (flags) this.contract?.car.disableCtls(); // race\n      const thisDriveId = genUniqId();\n      this.currDriveId = thisDriveId;\n      this.ignitionPromise = this.TurnOnTheIgnition()\n        .then(driveParams => {\n          if (thisDriveId !== this.currDriveId) rej(new Error('interrupted'));\n          // console.log(driveParams);\n          const drivePromise = this.drive(driveParams, thisDriveId, flags);\n          res({\n            driveParams,\n            drivePromise,\n          });\n        })\n        .catch((error: Error) => {\n          if (thisDriveId !== this.currDriveId) rej(new Error('interrupted'));\n          else rej(error);\n        });\n    });\n    return newPromise;\n  }\n\n  private async TurnOnTheIgnition() {\n    if (!this.contract) throw new Error('NOT_BEHIND_THE_WHEEL');\n    if (this.drivePromise) await this.drivePromise;\n    const params = await REST_CLIENT_ENGINE.toggleEngine(\n      this.contract.car.currCar.id,\n      'started',\n    );\n    // console.log('ENGINE STARTED');\n    return params;\n  }\n\n  // !!! If animation fails, this promise never resolves!\n  async returnToStart() {\n    this.currDriveId = undefined;\n    if (this.contract) {\n      if (this.ignitionPromise) await this.ignitionPromise;\n      if (this.drivePromise) {\n        await this.stopCar(true, false);\n        await this.contract.car.rollBack(this.drivePromise);\n        const msgBlock = document.createElement('div');\n        msgBlock.style.setProperty('height', '100%');\n        msgBlock.style.setProperty('width', '40%');\n        msgBlock.style.setProperty('position', 'absolute');\n        msgBlock.style.setProperty('right', '0px');\n        msgBlock.style.setProperty('top', '100%');\n        msgBlock.style.setProperty('transform', 'translate(-40%, -120%)');\n        this.contract.track.rootElement.append(msgBlock);\n        const popup = new PopupStandaloneModalProgressComp();\n\n        popup\n          .setText(\n            `I can't let the engine start again until\n          the server finishes its business, read the notes, please.`,\n          )\n          .show(msgBlock);\n        const interval = this.updateProgress(popup);\n        await this.contract.car.playAwaitingAnim(this.drivePromise);\n        if (interval) clearTimeout(interval);\n        popup.hide();\n        msgBlock.remove();\n      } else {\n        await this.stopCar(false, false);\n        await this.contract.car.rollBack();\n      }\n    }\n    return true;\n  }\n\n  private updateProgress(\n    popup: PopupStandaloneModalProgressComp,\n  ): NodeJS.Timeout {\n    const interval = setInterval(() => {\n      if (this.lastTimeInMs && this.lastStart) {\n        const progress =\n          ((Date.now() - this.lastStart) / this.lastTimeInMs) * 100;\n        popup.setProgress(progress);\n      } else clearInterval(interval);\n    }, 500);\n    return interval;\n  }\n\n  private async drive(\n    driveParams: EngineResponse,\n    driveId: string,\n    flags?: Record<string, unknown>,\n  ): Promise<false | number> {\n    return new Promise<false | number>((res, rej) => {\n      if (this.contract) {\n        const { contract } = this;\n        const time = GarageDriver.calculateDriveTime(driveParams);\n        this.lastStart = Date.now();\n        this.lastTimeInMs = time * 1000;\n        const start = Date.now();\n        this.drivePromise = REST_CLIENT_ENGINE.enterDriveMode(\n          contract.car.currCar.id,\n        ).then(success => {\n          if (\n            !(contract === this.contract) ||\n            !(driveId === this.currDriveId)\n          ) {\n            rej(new Error('interrupted'));\n          } else if (success) {\n            res(time);\n            console.log('stop car finish');\n            this.stopCar(true, true, false, flags);\n          } else {\n            console.log('stop car broken');\n            this.stopCar(true, false, true, flags);\n            res(false);\n          }\n          console.log(`time from start: ${Date.now() - start}`);\n        });\n        contract.car\n          .rollForward(time, !flags)\n          .catch(() => {\n            res(false);\n          })\n          .then(async playbackRate => {\n            if (playbackRate && playbackRate > 0) {\n              this.stopCar(true, true, false, flags);\n              const connectionRestored = await this.emergencyAwaitServer(\n                time * 1000,\n                1000,\n                this.drivePromise,\n              );\n              if (!connectionRestored) {\n                rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n              }\n            }\n          });\n      } else rej(new Error('No car'));\n    });\n  }\n\n  private emergencyAwaitServer = (\n    timeInMS: number,\n    delayInMS: number,\n    resPromise?: Promise<unknown>,\n  ) => {\n    const popup = new PopupStandaloneModalProgressComp();\n    popup\n      .setText(`Connection is lost... awaiting server`)\n      .setProgress(1)\n      .show();\n    return new Promise<boolean>(res => {\n      const startTime = Date.now();\n      let IamResolved = false;\n      let interval: NodeJS.Timeout;\n      const resFunc = () => {\n        IamResolved = true;\n        if (interval) clearInterval(interval);\n        popup.hide();\n        res(false);\n      };\n      const chargeInterval = () => {\n        interval = setInterval(() => {\n          console.log(resPromise, IamResolved);\n          if (IamResolved) {\n            clearInterval(interval);\n            return;\n          }\n          const currTime = Date.now();\n          const elapsedTime = currTime - startTime;\n          if (elapsedTime < timeInMS) {\n            const progress = (elapsedTime / timeInMS) * 100;\n            popup.setProgress(progress);\n          } else resFunc();\n        }, timeInMS / 20); // 5%\n      };\n\n      resPromise?.finally(() => {\n        resFunc();\n      });\n      setTimeout(() => chargeInterval(), delayInMS);\n    });\n  };\n\n  private async stopCar(\n    onlyAnim = false,\n    rollover = true,\n    broken = false,\n    flags?: Record<string, unknown>,\n  ) {\n    if (this.contract) {\n      if (!broken && !onlyAnim) {\n        const response = await REST_CLIENT_ENGINE.toggleEngine(\n          this.contract.car.currCar.id,\n          'stopped',\n        );\n        console.log('stopped by server', response);\n      }\n      await this.contract.car.stop(rollover, broken, flags);\n      return true;\n    }\n    throw new Error('No car');\n  }\n\n  private static calculateDriveTime(params: EngineResponse) {\n    const time = params.distance / 1000 / params.velocity; /// !!! distance units???\n    return time;\n  }\n}\n","import { RegCarData, WinnerCarData } from '../../definitions/car-data.def';\nimport { DBusInterface } from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../lib/services/dbus/defs/dbus-port.def';\nimport { DBusRX } from '../../lib/services/dbus/defs/dbus-rx/dbus-rx.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgCarActionSelectedMsg } from './dbus-msgs/by-topic/car-action/garage-car-select-msg.def';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionRemovedMsg } from './dbus-msgs/by-topic/car-action/garage-car-remove-msg.def';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\nimport { GarageDriver, GarageDriverCommands } from './garage-driver';\nimport { genUniqId } from '../../lib/generators/generators';\n\nimport styles from './garage.scss';\nimport { REST_CLIENT_WINNERS } from '../../services/rest-clients/client-winners/rest-client-winners';\nimport { REST_CLIENT_ERROR } from '../../services/rest-clients/rest-clients-errors.def';\nimport { DBusMsgGarageRaceStatusMsg } from './dbus-msgs/by-topic/garage/garage-race-status-msg.def';\nimport { RaceStatusesList } from './race-statuses.def';\nimport {\n  getTransitionDuration,\n  transitionPromise,\n} from '../../lib/gui/animation';\nimport { GaragePopupWinner } from './subcomps/popup-winner/popup-winner';\n\ntype RaceData = {\n  raceId: string;\n  arrivedByOrder: GarageServicemanContract[];\n  notArrived: GarageServicemanContract[];\n  participantsCount: number;\n  flags: Record<string, unknown>;\n  stratedCount: number;\n};\n\ntype RaceResults = {\n  arrivedByOrder: GarageServicemanContract[];\n  notArrived: GarageServicemanContract[];\n};\nexport class GarageManagersTeam implements DBusPort {\n  protected txs = new Set<DBusTX>();\n\n  protected contracts = new Set<GarageServicemanContract>();\n\n  protected freeDrivers = new Set<GarageDriver>();\n\n  protected busyDrivers = new Map<GarageServicemanContract, GarageDriver>();\n\n  protected currRaceId: string | undefined;\n\n  protected winnerPopup = new GaragePopupWinner();\n\n  constructor(\n    private readonly tracksContainer: HTMLElement,\n    private readonly carCtlsBlock: HTMLElement,\n  ) {\n    this.carCtlsBlock.addEventListener('click', this.carCtlsClickListener);\n    this.winnerPopup.rootElement.classList.add(styles['garage__winner-popup']);\n  }\n\n  autoConnect(int: DBusInterface) {\n    const tx = int.getNewTX('garage serviceman');\n    this.txs.add(tx);\n  }\n\n  public getContracts() {\n    return this.contracts;\n  }\n\n  async nullifyContracts(contracts?: GarageServicemanContract[]) {\n    if (contracts) {\n      this.tryFreeDrivers(...contracts);\n      contracts.forEach(contract => {\n        this.contracts.delete(contract);\n      });\n    } else {\n      this.tryFreeDrivers(...this.contracts);\n      this.contracts.clear();\n    }\n  }\n\n  addContracts(...—Åontracts: GarageServicemanContract[]) {\n    —Åontracts.forEach(newContract => this.contracts.add(newContract));\n  }\n\n  private carCtlsClickListener = (e: Event) => {\n    if (e.target instanceof HTMLElement) {\n      const elem = e.target;\n      let btn: HTMLButtonElement | undefined;\n\n      if (elem instanceof HTMLButtonElement) btn = elem;\n      else if (elem.parentElement instanceof HTMLButtonElement)\n        btn = elem.parentElement;\n\n      if (btn && btn.disabled !== true) {\n        this.contracts.forEach(contract => {\n          if (this.currRaceId) return;\n          if (btn === contract.car.btnSelect) {\n            this.handleSelection(contract);\n            return;\n          }\n          if (btn === contract.car.btnRm) {\n            contract.car.btnRm.disabled = true;\n            this.handleRemoving(contract);\n            return;\n          }\n          if (btn === contract.car.btnStart) {\n            contract.car.btnStart.disabled = true;\n            this.startDriving(contract);\n            return;\n          }\n          if (btn === contract.car.btnReset) {\n            contract.car.btnReset.disabled = true;\n            this.handleRestoreState(contract);\n          }\n        });\n      }\n    }\n  };\n\n  async resetState(prepareForRace?: boolean) {\n    if (!prepareForRace) this.currRaceId = undefined;\n    this.winnerPopup.rootElement.remove();\n    this.tracksContainer.classList.remove(\n      styles['synthwave-background_race-mode'],\n    );\n    await this.rollbackCars();\n\n    if (!prepareForRace) {\n      this.broadcastRaceStatus('READY_TO_GO');\n    }\n  }\n\n  private async handleRestoreState(contract: GarageServicemanContract) {\n    const driver = this.busyDrivers.get(contract);\n    if (driver) {\n      await driver.returnToStart();\n    }\n  }\n\n  private async startDriving(\n    contract: GarageServicemanContract,\n    flags?: Record<string, unknown>,\n  ) {\n    let choosedDriver = this.busyDrivers.get(contract);\n\n    if (!choosedDriver) {\n      // !!! excess check?\n      choosedDriver = [...this.freeDrivers].find(driver => driver.isFree());\n\n      if (choosedDriver) {\n        this.freeDrivers.delete(choosedDriver);\n      } else {\n        choosedDriver = new GarageDriver();\n      }\n\n      this.busyDrivers.set(contract, choosedDriver);\n\n      choosedDriver.putBehindTheWheel(contract);\n    }\n\n    return choosedDriver.performDrivingProtocol(flags);\n  }\n\n  private handleRemoving(contract: GarageServicemanContract) {\n    REST_CLIENT_GARAGE.deleteCar(contract.car.currCar.id).then(async () => {\n      await REST_CLIENT_WINNERS.deleteWinner(contract.car.currCar.id).catch(\n        () => {},\n      );\n      this.tryFreeDrivers(contract);\n      this.contracts.delete(contract);\n      const msg = new DBusMsgCarActionRemovedMsg(\n        contract.car.currCar,\n        contract,\n      );\n      this.txs.forEach(tx => {\n        tx.transmit({\n          msg,\n          prepMode: DBusTXPrepModes.freeze,\n          waitMode: DBusTXWaitModes.nowait,\n        });\n      });\n    });\n  }\n\n  private handleSelection(contract: GarageServicemanContract) {\n    const msg = new DBusMsgCarActionSelectedMsg(\n      contract.car.currCar,\n      this.genSelectCallback(contract),\n    );\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  private async rollbackCars() {\n    this.tracksContainer.classList.remove(\n      styles['garage__track-container_finish'],\n    );\n    this.tracksContainer.style.setProperty('--translate-x', '0px');\n    // rollback cars\n    const rollbacks: Promise<unknown>[] = [];\n    this.busyDrivers.forEach(driver => {\n      rollbacks.push(driver.returnToStart());\n    });\n    await Promise.all(rollbacks);\n  }\n\n  async performRace() {\n    // prepare\n    const thisRaceId = genUniqId();\n    this.currRaceId = thisRaceId;\n    await this.resetState(true);\n    // check if user cancell a race\n    if (thisRaceId !== this.currRaceId) return;\n\n    // process race\n    const raceData: RaceData = {\n      raceId: thisRaceId,\n      arrivedByOrder: [],\n      notArrived: [],\n      participantsCount: this.contracts.size,\n      flags: {\n        roadElem: this.tracksContainer,\n        isFinishVisible: false, // TODO: rm\n      },\n      stratedCount: 0,\n    };\n    this.broadcastRaceStatus('IN_PROCESS');\n    await this.processRace(raceData)\n      .catch((error: Error) => {\n        if (!(thisRaceId !== this.currRaceId)) throw error;\n      })\n      .finally(() => {\n        this.tracksContainer.classList.remove(\n          styles['synthwave-background_race-mode'],\n        );\n      });\n\n    // check if user cancell a race\n    if (thisRaceId !== this.currRaceId) return;\n\n    // console.log(raceData);\n\n    this.broadcastRaceStatus('NEED_RESET');\n    // TODO: Do something else?\n  }\n\n  private broadcastRaceStatus(status: RaceStatusesList) {\n    const msg = new DBusMsgGarageRaceStatusMsg(status);\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  // false if race was interrupted\n  private processRace(raceData: RaceData) {\n    return new Promise<RaceData | false>(res => {\n      this.contracts.forEach(contract => {\n        this.startDriving(contract, raceData.flags).then(response => {\n          if (raceData.raceId !== this.currRaceId) {\n            res(false);\n            return;\n          }\n\n          if (raceData.stratedCount === raceData.participantsCount - 1) {\n            this.tracksContainer.classList.add(\n              styles['synthwave-background_race-mode'],\n            );\n            raceData.flags.isRoadMoves = true;\n          } else raceData.stratedCount++;\n\n          if (!(response instanceof Error)) {\n            response.drivePromise\n              .then(result =>\n                this.handleDriveResult(raceData, contract, result),\n              )\n              .catch((error: Error) => {\n                if (error.message === 'interrupted') res(false);\n              })\n              .finally(() => {\n                console.log(raceData);\n                if (\n                  raceData.arrivedByOrder.length +\n                    raceData.notArrived.length ===\n                  raceData.participantsCount\n                ) {\n                  console.log(raceData);\n                  res(raceData);\n                }\n              });\n          } else {\n            throw response;\n          }\n        });\n      });\n    });\n  }\n\n  private handleDriveResult(\n    raceData: RaceData,\n    contract: GarageServicemanContract,\n    result: number | false,\n  ) {\n    if (raceData.raceId !== this.currRaceId) return;\n    if (result !== false) {\n      if (raceData.arrivedByOrder.length === 0) {\n        this.handleWinner(contract, result, raceData.flags);\n      }\n      raceData.arrivedByOrder.push(contract);\n    } else {\n      raceData.notArrived.push(contract);\n    }\n  }\n\n  private handleWinner = async (\n    contract: GarageServicemanContract,\n    time: number,\n    flags: Record<string, unknown>,\n  ) => {\n    flags.isFinishVisible = true;\n    this.tracksContainer.classList.add(\n      styles['garage__track-container_finish'],\n    );\n    const style = window.getComputedStyle(this.tracksContainer, '::after');\n    const duration = getTransitionDuration(style, 'right');\n    if (duration) {\n      const awaitTime = Number.parseFloat(duration);\n      if (awaitTime > 0)\n        await new Promise(res => setTimeout(res, awaitTime * 1000));\n    }\n    this.tracksContainer.classList.remove(\n      styles['synthwave-background_race-mode'],\n    );\n    flags.isRoadMoves = false;\n    const winnerCar = contract.car.currCar;\n    this.winnerPopup.setData(\n      winnerCar,\n      time.toFixed(2),\n      contract.car.index?.toString(),\n    );\n    this.tracksContainer.append(this.winnerPopup.rootElement);\n    REST_CLIENT_WINNERS.getWinner(winnerCar.id)\n      .then(winnerRecord => {\n        const updatedWinnerData: WinnerCarData = {\n          id: winnerRecord.id,\n          wins: winnerRecord.wins + 1,\n          time:\n            time < winnerRecord.time\n              ? Number.parseFloat(time.toFixed(2))\n              : winnerRecord.time,\n        };\n        REST_CLIENT_WINNERS.updateWinner(updatedWinnerData);\n      })\n      .catch((error: Error) => {\n        if (error.message === REST_CLIENT_ERROR.NOT_FOUND) {\n          const newWinnerData: WinnerCarData = {\n            id: winnerCar.id,\n            wins: 1,\n            time: Number.parseFloat(time.toFixed(2)),\n          };\n          REST_CLIENT_WINNERS.createWinner(newWinnerData);\n        }\n      });\n  };\n\n  private tryFreeDrivers(...contracts: GarageServicemanContract[]) {\n    contracts.forEach(contract => {\n      const driver = this.busyDrivers.get(contract);\n      if (driver) {\n        driver.getOutOfTheCar().then(() => {\n          this.busyDrivers.delete(contract);\n          this.freeDrivers.add(driver);\n        });\n      }\n    });\n  }\n\n  private genSelectCallback(contract: GarageServicemanContract) {\n    return (car: RegCarData) => {\n      if (!this.contracts.has(contract)) return;\n      contract.car.updateData(car);\n    };\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { DBUS_HUB_NAMES } from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { GarageCompCtlAkaDirector } from './garage-controller';\nimport { MainControlsComp } from './subcomps/main-controls/main-controls';\n\nimport styles from './garage.scss';\nimport { Notifiable } from '../../lib/interfaces/notifiable';\nimport { PopupStandaloneModalProgressComp } from '../../lib/components/popups/standalone/modal/progress/popup-progress';\n\nexport class GarageComp extends BaseComp implements DBusHub, Notifiable {\n  readonly hubName = DBUS_HUB_NAMES.GARAGE;\n\n  private controller: GarageCompCtlAkaDirector;\n\n  private isControllerWorking = false;\n\n  private mainControlsComp = new MainControlsComp();\n\n  private carsCtlsBlock = document.createElement('div');\n\n  private bgVideo = document.createElement('video');\n\n  private popup = new PopupStandaloneModalProgressComp();\n\n  constructor() {\n    super('section');\n    console.log('show');\n    this.popup.setText('Loading...').setProgress(1).show();\n    this._rootElement.classList.add(styles.garage);\n\n    const selfCtlsBlock = document.createElement('div');\n    selfCtlsBlock.classList.add(styles['garage-bg__self-ctls-block']);\n    selfCtlsBlock.append(this.mainControlsComp.rootElement);\n\n    const bg = document.createElement('div');\n    bg.classList.add(styles.garage__bg, styles['garage-bg']);\n    bg.append(this.bgVideo, selfCtlsBlock);\n\n    const tracksContainer = document.createElement('div');\n    tracksContainer.classList.add(\n      styles['garage__track-container'],\n      styles['synthwave-background'],\n    );\n\n    this.carsCtlsBlock.classList.add(styles['garage-bg__cars-ctls-block']);\n\n    this.controller = new GarageCompCtlAkaDirector(\n      tracksContainer,\n      this.carsCtlsBlock,\n    );\n\n    this.setupBgVideo();\n\n    this._rootElement.append(bg, tracksContainer, this.carsCtlsBlock);\n  }\n\n  private setupBgVideo() {\n    this.bgVideo.addEventListener('progress', this.bgVideoProgressListener);\n    this.bgVideo.addEventListener(\n      'canplaythrough',\n      this.bgVideoCanPlayListener,\n    );\n    this.renderBgVideo();\n  }\n\n  private renderBgVideo() {\n    this.bgVideo.classList.add(styles['garage-bg__video']);\n    this.bgVideo.controls = false;\n    this.bgVideo.loop = true;\n    this.bgVideo.defaultMuted = true;\n    this.bgVideo.muted = true;\n    this.bgVideo.autoplay = true;\n    this.bgVideo.src = './assets/videos/bg/cyberpunk2077-garage.mp4';\n  }\n\n  private bgVideoProgressListener = () => {\n    if (this.bgVideo.buffered.length > 0) {\n      const progress =\n        (this.bgVideo.buffered.end(0) / this.bgVideo.duration) * 100;\n      this.popup.setProgress(progress);\n    }\n  };\n\n  private bgVideoCanPlayListener = async () => {\n    this.bgVideo.removeEventListener(\n      'canplaythrough',\n      this.bgVideoCanPlayListener,\n    );\n    this.bgVideo.removeEventListener('progress', this.bgVideoProgressListener);\n    this.popup.setProgress(100).reset().hide();\n    this.isControllerWorking = await this.controller.startWorking();\n  };\n\n  connect(int: DBusInterface): void {\n    int.attachSubHub(this.controller);\n    int.attachSubHub(this.mainControlsComp);\n  }\n\n  notify = async (): Promise<void> => {\n    try {\n      this.bgVideo.play();\n    } catch {\n      // do nothing...\n    }\n    if (!this.isControllerWorking) {\n      this.isControllerWorking = await this.controller.startWorking();\n    }\n  };\n}\n","import { RegCarData, UnregCarData } from '../../../../definitions/car-data.def';\nimport { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { hexToRgb } from '../../../../lib/convertors/colors';\nimport { transitionPromise } from '../../../../lib/gui/animation';\nimport { OBJ_PROCESSOR } from '../../../../lib/processors/obj-processor';\nimport styles from './car.scss';\nimport garageStyles from '../../garage.scss';\n\nexport class CarComp extends BaseComp {\n  static readonly TIMING_FUNCTION = 'cubic-bezier(.72,.2,.54,.77)';\n\n  static readonly CAR_BODY_IMG_SRC = './assets/imgs/cars/body.gif';\n\n  static readonly CAR_WHEEL_IMG_SRC = './assets/imgs/cars/tire back.gif';\n\n  static readonly CAR_EXPLOSION_IMG_DATA = {\n    BASE_URL: './assets/imgs/cars/explosion/',\n    EXTENSION: '.png',\n    FRAMES_COUNT: 9,\n    FRAME_TIME_MS: 200,\n  };\n\n  protected canvas = document.createElement('canvas');\n\n  protected tireBack = document.createElement('img');\n\n  private btnSelect$ = document.createElement('button');\n\n  private btnRm$ = document.createElement('button');\n\n  private _spanCarName = document.createElement('span');\n\n  private btnStart$ = document.createElement('button');\n\n  private btnReset$ = document.createElement('button');\n\n  private currAnimation: Animation | undefined;\n\n  private currOutOfSceneAnim: Animation | undefined;\n\n  private isReseted = true;\n\n  private observer: MutationObserver;\n\n  private movingClassName = garageStyles['synthwave-background_race-mode'];\n\n  constructor(private _currCar: RegCarData, public index?: number) {\n    super('div');\n\n    this._rootElement.classList.add(styles['car-div']);\n    this.canvas.classList.add(styles['car-div__canvas']);\n    this._rootElement.append(this.canvas);\n\n    const selectSpan = document.createElement('span');\n    const rmSpan = document.createElement('span');\n    const startSpan = document.createElement('span');\n    const resetSpan = document.createElement('span');\n\n    selectSpan.textContent = 'select';\n    rmSpan.textContent = 'remove';\n    startSpan.textContent = 'start!';\n    resetSpan.textContent = 'reset';\n\n    this.btnSelect$.append(selectSpan);\n    this.btnRm$.append(rmSpan);\n    this.btnReset$.append(resetSpan);\n    this.btnStart$.append(startSpan);\n\n    this.btnReset$.disabled = true;\n\n    CarComp.drawCar(this.canvas, this._currCar.color);\n    this._spanCarName.textContent = `${index}: ${_currCar.name}`;\n    CarComp.drawWheels(this._rootElement);\n\n    this.observer = new MutationObserver(mutations => {\n      mutations.forEach(mutation => {\n        if (mutation.oldValue?.includes(this.movingClassName)) {\n          this.currOutOfSceneAnim?.pause();\n          this.observer.disconnect();\n        } else {\n          const elem = mutation.target as HTMLElement;\n          if (elem.classList.contains(this.movingClassName)) {\n            this.outOfScene();\n          }\n        }\n      });\n    });\n  }\n\n  static drawWheels(rootElem: HTMLElement) {\n    const wheelImg = new Image();\n    wheelImg.src = CarComp.CAR_WHEEL_IMG_SRC;\n    wheelImg.onload = () => {\n      wheelImg.classList.add(styles['car-div__wheel']);\n      const backwardWheelImg = OBJ_PROCESSOR.deepClone(wheelImg);\n      wheelImg.classList.add(styles['car-div__wheel_forward']);\n      backwardWheelImg.classList.add(styles['car-div__wheel_backward']);\n\n      rootElem.append(wheelImg);\n      rootElem.append(backwardWheelImg);\n    };\n  }\n\n  updateData(carData: RegCarData) {\n    this._currCar = carData;\n    CarComp.drawCar(this.canvas, this._currCar.color);\n    this._spanCarName.textContent = `${this.index}: ${carData.name}`;\n    // this._rootElement.style.setProperty('background-color', carData.color);\n  }\n\n  public async rollBack(finishPromise: Promise<unknown> = Promise.resolve()) {\n    return new Promise(res => {\n      const asyncFunc = async () => {\n        if (!this.isReseted) {\n          this.observer.disconnect();\n          await this.playOutAnim();\n          if (this.currOutOfSceneAnim) {\n            this.currOutOfSceneAnim.cancel();\n            // await this.currOutOfSceneAnim.finished;\n            this.clearAnimFromElem(this.currOutOfSceneAnim);\n            this.currOutOfSceneAnim = undefined;\n          }\n          if (this.currAnimation) {\n            await this.stop();\n            this.currAnimation.playbackRate = -10;\n            this.currAnimation.play();\n            console.log(`wait curr anim ${this.index}`);\n            await this.currAnimation.finished;\n            this.clearAnimFromElem(this.currAnimation);\n            this.currAnimation = undefined;\n            this._rootElement.classList.remove(styles['car-div_rollForward']);\n          }\n          this._rootElement.style.removeProperty('transition');\n          this._rootElement.style.removeProperty('transform');\n          await this.playInAnim();\n          this._rootElement.style.removeProperty('opacity');\n          finishPromise.finally(() => {\n            this.btnStart$.disabled = false;\n            this.btnReset$.disabled = true;\n            this.btnRm$.disabled = false;\n            this.btnSelect$.disabled = false;\n          });\n        }\n        console.log(`reseted ${this.index}`);\n        this.isReseted = true;\n        res(true);\n      };\n      asyncFunc();\n    });\n  }\n\n  async playOutAnim() {\n    const animOut = this._rootElement.animate(\n      [\n        { opacity: `0.5` },\n        { opacity: `0.9` },\n        { opacity: `0.3` },\n        { opacity: `0.7` },\n        { opacity: `0.1` },\n        { opacity: `0.4` },\n        { opacity: `0` },\n      ],\n      {\n        duration: 300,\n        easing: 'linear',\n        fill: 'forwards',\n      },\n    );\n    await animOut.finished;\n    this.clearAnimFromElem(animOut);\n  }\n\n  async playAwaitingAnim(promiseToAwait: Promise<unknown>) {\n    return new Promise<void>(res => {\n      const animIn = this._rootElement.animate(\n        [\n          { opacity: `0` },\n          { opacity: `0.6` },\n          { opacity: `0.3` },\n          { opacity: `0.8` },\n          { opacity: `0.3` },\n          { opacity: `0.6` },\n          { opacity: `0` },\n        ],\n        {\n          duration: 400,\n          easing: 'linear',\n          fill: 'forwards',\n          iterations: Number.POSITIVE_INFINITY,\n        },\n      );\n      promiseToAwait.finally(() => {\n        animIn.cancel();\n        this.clearAnimFromElem(animIn);\n        res();\n      });\n    });\n  }\n\n  async playInAnim() {\n    const animIn = this._rootElement.animate(\n      [\n        { opacity: `0` },\n        { opacity: `0.6` },\n        { opacity: `0.3` },\n        { opacity: `0.8` },\n        { opacity: `0.5` },\n        { opacity: `1` },\n      ],\n      {\n        duration: 300,\n        easing: 'linear',\n        fill: 'forwards',\n      },\n    );\n    await animIn.finished;\n    this.clearAnimFromElem(animIn);\n  }\n\n  private clearAnimFromElem = (a: Animation) => {\n    const anim = a as unknown as Record<string, unknown>;\n    if ('commitStyles' in anim && typeof anim.commitStyles === 'function')\n      anim.commitStyles();\n  };\n\n  private outOfScene() {\n    // console.log(`OUT OF SCENE ${this.index}`);\n    this.isReseted = false;\n    this.currOutOfSceneAnim = this._rootElement.animate(\n      [{ transform: `translateX(${-1000}%)` }],\n      {\n        duration: 3600,\n        easing: 'ease-in',\n        fill: 'forwards',\n      },\n    );\n  }\n\n  public disableCtls() {\n    this.btnStart$.disabled = true;\n    this.btnRm$.disabled = true;\n    this.btnSelect$.disabled = true;\n    this.btnReset$.disabled = true;\n  }\n\n  public async rollForward(time: number, handleBtns = true) {\n    this.isReseted = false;\n    // console.log(`anim time: ${time} ${this.index}`);\n    return new Promise<number | undefined>((res, rej) => {\n      const start = Date.now();\n      if (handleBtns) {\n        this.btnStart$.disabled = true;\n        this.btnRm$.disabled = true;\n        this.btnSelect$.disabled = true;\n        this.btnReset$.disabled = false;\n      }\n      const rootStyle = window.getComputedStyle(\n        this._rootElement.parentElement as HTMLElement,\n      );\n      const selfStyle = window.getComputedStyle(this.rootElement);\n\n      const rootWidth =\n        Number.parseFloat(rootStyle.width) -\n        Number.parseFloat(rootStyle.paddingLeft) -\n        Number.parseFloat(rootStyle.paddingRight);\n      const selfWidth = Number.parseFloat(selfStyle.width);\n\n      const coordinateInPercents = ((rootWidth - selfWidth) / selfWidth) * 100;\n\n      this._rootElement.classList.add(styles['car-div_rollForward']);\n\n      this.currAnimation = this._rootElement.animate(\n        [{ transform: `translateX(${coordinateInPercents}%)` }],\n        {\n          duration: time * 1000 + 1000,\n          easing: 'ease-in-out',\n          fill: 'forwards',\n        },\n      );\n\n      this.currAnimation.onfinish = (e: Event) => {\n        // console.log(`time from anim start: ${Date.now() - start}`);\n        // console.log('stop animation by roll forward finish');\n        // this._rootElement.classList.remove(styles['car-div_rollForward']);\n        // this.stop();\n        // console.log('TRUE', e);\n        res(this.currAnimation?.playbackRate);\n      };\n\n      this.currAnimation.oncancel = () => {\n        // console.log(`curr Anim cancel ${this.index}`);\n        this._rootElement.classList.remove(styles['car-div_rollForward']);\n        rej();\n      };\n    });\n  }\n\n  public async stop(\n    rollover = true,\n    broken = false,\n    flags?: Record<string, unknown>,\n  ) {\n    // console.log(`STOP, broken: ${broken}, ${this.index}`);\n    // this.rootElement.style.setProperty('transition', '');\n    if (rollover) {\n      await new Promise(res => {\n        if (this.currAnimation?.playState === 'running') {\n          // console.log(\n          //   this.currAnimation,\n          //   `awaiting for animation ${this.index}`,\n          // );\n          this.currAnimation.addEventListener('finish', () => res(true));\n          this.currAnimation.addEventListener('cancel', () => res(true));\n        } else res(true);\n      });\n    }\n    this._rootElement.classList.remove(styles['car-div_rollForward']);\n    this.currAnimation?.pause();\n    if (broken) {\n      if (flags) {\n        const roadElem = flags.roadElem as HTMLElement;\n        const roadIsMoving = roadElem.classList.contains(this.movingClassName);\n        console.log(`CHECK IF ROAD IS MOVING ${this.index}`);\n        if (roadIsMoving) this.outOfScene();\n        this.observer.observe(roadElem, {\n          attributes: true,\n          attributeOldValue: true,\n        });\n      }\n      console.log(`exp anim ${this.index}`);\n      const img = new Image();\n      let frameNumber = 0;\n      img.classList.add(styles['car-div__explosion']);\n      img.src = `${CarComp.CAR_EXPLOSION_IMG_DATA.BASE_URL}${frameNumber}${CarComp.CAR_EXPLOSION_IMG_DATA.EXTENSION}`;\n      img.onload = async () => {\n        this._rootElement.append(img);\n        await new Promise(res =>\n          setTimeout(res, CarComp.CAR_EXPLOSION_IMG_DATA.FRAME_TIME_MS),\n        );\n        frameNumber++;\n        if (frameNumber < CarComp.CAR_EXPLOSION_IMG_DATA.FRAMES_COUNT) {\n          img.src = `${CarComp.CAR_EXPLOSION_IMG_DATA.BASE_URL}${frameNumber}${CarComp.CAR_EXPLOSION_IMG_DATA.EXTENSION}`;\n        } else {\n          img.remove();\n        }\n      };\n    }\n  }\n\n  public get currCar(): RegCarData {\n    return this._currCar;\n  }\n\n  public get btnSelect() {\n    return this.btnSelect$;\n  }\n\n  public get btnRm() {\n    return this.btnRm$;\n  }\n\n  public get btnStart() {\n    return this.btnStart$;\n  }\n\n  public get btnReset() {\n    return this.btnReset$;\n  }\n\n  public get spanCarName() {\n    return this._spanCarName;\n  }\n\n  static drawCar(canvas: HTMLCanvasElement, hexColor: string) {\n    const img = new Image();\n    img.src = CarComp.CAR_BODY_IMG_SRC;\n    img.onload = () => {\n      canvas.height = img.height / 3;\n      canvas.width = img.width / 3;\n      const ctx = canvas.getContext('2d');\n\n      if (ctx) {\n        ctx.shadowColor = hexColor;\n        ctx.shadowBlur = 25;\n        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n      }\n\n      CarComp.paintCarBody(canvas, hexColor);\n    };\n  }\n\n  static paintCarBody(canvas: HTMLCanvasElement, hexColor: string) {\n    const imageData = canvas\n      .getContext('2d')\n      ?.getImageData(0, 0, canvas.width, canvas.height);\n    if (imageData) {\n      const rgb = hexToRgb(hexColor);\n      for (let j = 0; j < imageData.width; j++) {\n        for (let i = 0; i < imageData.height; i++) {\n          // index: red, green, blue, alpha, red, green, blue, alpha..etc.\n          const index = i * 4 * imageData.width + j * 4;\n          const red = imageData.data[index] as number;\n          const green = imageData.data[index + 1] as number;\n          const blue = imageData.data[index + 2] as number;\n          // const alpha = imageData.data[index + 3] as number;\n\n          const blueDiff = 2 * blue - red - green;\n          const blueDiffThreshold = 10;\n          const threshold = 70;\n          if (\n            red > threshold &&\n            green > threshold &&\n            blue > threshold &&\n            blueDiff < blueDiffThreshold\n          ) {\n            imageData.data[index] = (red / 255) * rgb.r;\n            imageData.data[index + 1] = (green / 255) * rgb.g;\n            imageData.data[index + 2] = (blue / 255) * rgb.b;\n            // imageData.data[index + 3] = 225; /// !!! TEST !!!\n          }\n        }\n      }\n      canvas\n        .getContext('2d')\n        ?.putImageData(imageData, 0, 0, 0, 0, canvas.width, canvas.height);\n    }\n  }\n\n  static genPreview(car: UnregCarData): HTMLElement {\n    const container = document.createElement('div');\n    const canvas = document.createElement('canvas');\n    canvas.classList.add(styles['car-div__canvas']);\n    container.append(canvas);\n    CarComp.drawWheels(container);\n    CarComp.drawCar(canvas, car.color);\n    return container;\n  }\n}\n","import { UnregCarData } from '../../../../../definitions/car-data.def';\nimport { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { REST_CLIENT_GARAGE } from '../../../../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionCreatedMsg } from '../../../dbus-msgs/by-topic/car-action/garage-car-created-msg.def';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\n\nexport class CreateCompController extends CreateUpdateCompControllerProto {\n  private txs = new Set<DBusTX>();\n\n  constructor(elements: CreateUpdateCompControllerReqElems) {\n    super(elements.inputText, elements.inputColor, elements.btn);\n\n    this.setupBtnCreate();\n  }\n\n  private setupBtnCreate() {\n    this.btn.addEventListener('click', () => {\n      if (!this.reportValidity()) return;\n      this.btn.disabled = true;\n      const unregCar: UnregCarData = {\n        name: this.inputText.value,\n        color: this.inputColor.value,\n      };\n      REST_CLIENT_GARAGE.createCar(unregCar)\n        .then(car => {\n          // TODO: Notify with DBus\n          const msg = new DBusMsgCarActionCreatedMsg(car);\n          this.txs.forEach(tx => {\n            tx.transmit({\n              msg,\n              prepMode: DBusTXPrepModes.clone,\n              waitMode: DBusTXWaitModes.nowait,\n            });\n          });\n        })\n        .finally(() => {\n          this.btn.disabled = false;\n        });\n    });\n  }\n\n  autoConnect(int: DBusInterface) {\n    const tx = int.getNewTX('send created car msgs');\n    this.txs.add(tx);\n  }\n}\n","import { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../../../../lib/services/dbus/defs/dbus-port.def';\n\nexport interface CreateUpdateCompControllerReqElems {\n  inputText: HTMLInputElement;\n  inputColor: HTMLInputElement;\n  btn: HTMLButtonElement;\n}\n\nexport abstract class CreateUpdateCompControllerProto implements DBusPort {\n  protected ctlsStateMap = new Map<HTMLElement, boolean>();\n\n  protected ctls = [this.inputText, this.inputColor, this.btn];\n\n  constructor(\n    protected inputText: HTMLInputElement,\n    protected inputColor: HTMLInputElement,\n    protected btn: HTMLButtonElement,\n  ) {}\n\n  abstract autoConnect(int: DBusInterface): void | Promise<void>;\n\n  protected reportValidity() {\n    if (this.inputText.value.length === 0) {\n      this.inputText.setCustomValidity('Please, enter a name');\n      this.inputText.pattern = '';\n      this.inputText.reportValidity();\n      this.inputText.removeAttribute('pattern');\n      return false;\n    }\n    return true;\n  }\n\n  protected toogleCtlsDisabled(state: boolean) {\n    this.inputText.disabled = state;\n    this.inputColor.disabled = state;\n    this.btn.disabled = state;\n  }\n\n  protected pushCtlsState() {\n    this.ctls.forEach(ctl => {\n      this.ctlsStateMap.set(ctl, ctl.disabled);\n    });\n  }\n\n  protected popCtlsState() {\n    this.ctls.forEach(ctl => {\n      const state = this.ctlsStateMap.get(ctl);\n      if (state !== undefined) ctl.disabled = state;\n    });\n    this.ctlsStateMap.clear();\n  }\n\n  disable() {\n    this.pushCtlsState();\n    this.toogleCtlsDisabled(true);\n  }\n\n  enable() {\n    this.popCtlsState();\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../../../lib/processors/obj-processor';\nimport { DBUS_COMMON_RESPONSES } from '../../../../../lib/services/dbus/defs/dbus-common-responses.def';\nimport { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../../../../lib/services/dbus/defs/dbus-port.def';\nimport { DBusRX } from '../../../../../lib/services/dbus/defs/dbus-rx/dbus-rx.def';\nimport { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { REST_CLIENT_GARAGE } from '../../../../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionRemovedMsg } from '../../../dbus-msgs/by-topic/car-action/garage-car-remove-msg.def';\nimport { DBusMsgCarActionSelectedMsg } from '../../../dbus-msgs/by-topic/car-action/garage-car-select-msg.def';\nimport { DBusMsgGaragePageIsChangedMsg } from '../../../dbus-msgs/by-topic/garage/garage-page-is-changed.def';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\n\nexport class UpdateCompController\n  extends CreateUpdateCompControllerProto\n  implements DBusPort\n{\n  private choosedCar: RegCarData | undefined;\n\n  private notifyCb: ((car: RegCarData) => unknown) | undefined;\n\n  constructor(elements: CreateUpdateCompControllerReqElems) {\n    super(elements.inputText, elements.inputColor, elements.btn);\n\n    this.setupBtnUpdate();\n  }\n\n  autoConnect(int: DBusInterface) {\n    const rxCarActions = int.getNewRX(\n      this.carActionsListener,\n      'listen car choosing',\n    );\n    int.plugRX(DBusTopics.CAR_ACTION, rxCarActions);\n\n    const rxGarage = int.getNewRX(\n      this.garageMsgsListener,\n      'listen garage paging',\n    );\n    int.plugRX(DBusTopics.GARAGE, rxGarage);\n  }\n\n  private garageMsgsListener = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgGaragePageIsChangedMsg) {\n      this.reset();\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private reset() {\n    this.notifyCb = undefined;\n    this.choosedCar = undefined;\n    this.inputText.value = '';\n    this.inputColor.value = '#000000';\n    this.toogleCtlsDisabled(true);\n  }\n\n  private carActionsListener = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgCarActionSelectedMsg) {\n      this.choosedCar = OBJ_PROCESSOR.deepClone(data.msg.car);\n      this.notifyCb = data.msg.notifyChanges;\n      this.inputColor.value = data.msg.car.color;\n      this.inputText.value = data.msg.car.name;\n      this.toogleCtlsDisabled(false);\n    }\n    if (\n      data.msg instanceof DBusMsgCarActionRemovedMsg &&\n      data.msg.car.id === this.choosedCar?.id\n    ) {\n      this.reset();\n    }\n\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private setupBtnUpdate() {\n    this.toogleCtlsDisabled(true);\n    this.btn.addEventListener('click', () => {\n      if (!this.reportValidity()) return;\n      this.toogleCtlsDisabled(true);\n      if (!this.choosedCar) return;\n      this.choosedCar.color = this.inputColor.value;\n      this.choosedCar.name = this.inputText.value;\n      REST_CLIENT_GARAGE.updateCar(this.choosedCar)\n        .then(car => {\n          if (this.notifyCb) this.notifyCb(car);\n        })\n        .finally(() => {\n          this.toogleCtlsDisabled(false);\n        });\n    });\n  }\n}\n","import { BaseComp } from '../../../../../lib/components/base-comp/base-comp';\nimport { DBUS_HUB_NAMES } from '../../../../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { CreateCompController } from './controller-create';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\nimport { UpdateCompController } from './controller-update';\n\nimport styles from './create-update.scss';\nimport sharedStyles from '../../../../../styles.scss';\n\nexport class CreateUpdateComponent extends BaseComp implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.CREATE_UPDATE;\n\n  protected textInput = document.createElement('input');\n\n  protected colorInput = document.createElement('input');\n\n  protected btn = document.createElement('button');\n\n  protected controller: CreateUpdateCompControllerProto;\n\n  constructor(type: 'CREATE' | 'UPDATE', btnText: string) {\n    super('div');\n    this._rootElement.classList.add(styles.root);\n    this.textInput.type = 'text';\n    this.textInput.classList.add(styles['text-input']);\n    this.colorInput.type = 'color';\n    this.colorInput.classList.add(styles['color-input']);\n    this.btn.textContent = btnText;\n    this.btn.classList.add(sharedStyles.btn);\n    this._rootElement.append(this.textInput, this.colorInput, this.btn);\n\n    const elements: CreateUpdateCompControllerReqElems = {\n      inputText: this.textInput,\n      inputColor: this.colorInput,\n      btn: this.btn,\n    };\n\n    switch (type) {\n      case 'UPDATE':\n        this.controller = new UpdateCompController(elements);\n        this.btn.classList.add(sharedStyles['btn-13']);\n        break;\n      case 'CREATE':\n      default:\n        this.controller = new CreateCompController(elements);\n        this.btn.classList.add(sharedStyles['btn-13']); // TODO: maybe change?\n        break;\n    }\n  }\n\n  getController() {\n    return this.controller;\n  }\n\n  connect(int: DBusInterface) {\n    this.controller.autoConnect(int);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport class DBusMsgGenerateCarsMsg extends DBusMsg {\n  constructor(\n    readonly status: 'start' | 'end',\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GENERATE, rxIds, prefResponseRxIds);\n  }\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { CreateUpdateComponent } from './create-update/create-update';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from '../../../../lib/services/dbus/defs/dbus-hub-names.def';\nimport { DBusMsgRaceRequestMsg } from '../../dbus-msgs/by-topic/garage/garage-race-request-msg.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusMsgGarageResetReqMsg } from '../../dbus-msgs/by-topic/garage/garage-reset-req-msg.def';\n\nimport styles from './main-controls.scss';\nimport sharedStyles from '../../../../styles.scss';\nimport { REST_CLIENT_GARAGE } from '../../../../services/rest-clients/client-garage/rest-client-garage';\nimport {\n  CAR_MODEL_LIST,\n  CAR_MODEL_LIST_KEYS,\n} from '../../../../definitions/car-random-data.def';\nimport {\n  genRandomHexColor,\n  getRandomArbitraryInt,\n  getRandomInt,\n} from '../../../../lib/generators/generators';\nimport {\n  UnregCarData,\n  WinnerCarData,\n} from '../../../../definitions/car-data.def';\nimport { REST_CLIENT_WINNERS } from '../../../../services/rest-clients/client-winners/rest-client-winners';\nimport { DBusTXData } from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBusMsgGarageRaceMsg } from '../../dbus-msgs/by-topic/garage/garage-race-msg.def';\nimport { DBUS_COMMON_RESPONSES } from '../../../../lib/services/dbus/defs/dbus-common-responses.def';\nimport { DBusMsgGarageRaceStatusMsg } from '../../dbus-msgs/by-topic/garage/garage-race-status-msg.def';\nimport { DBusTopics } from '../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTX } from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgGenerateCarsMsg } from './dbus-msgs/generate-cars-msg.def';\nimport { PopupStandaloneModalProgressComp } from '../../../../lib/components/popups/standalone/modal/progress/popup-progress';\n\nexport class MainControlsComp extends BaseComp implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.MAIN_CONTROLS;\n\n  private txs = new Set<DBusTX>();\n\n  private createComponent = new CreateUpdateComponent('CREATE', 'create');\n\n  private updateComponent = new CreateUpdateComponent('UPDATE', 'update');\n\n  private btnRace = document.createElement('button');\n\n  private btnReset = document.createElement('button');\n\n  private btnGenerate = document.createElement('button');\n\n  private popup = new PopupStandaloneModalProgressComp();\n\n  constructor() {\n    super('div');\n    this._rootElement.classList.add(styles['main-controls']);\n\n    const btnsBlock = this.renderBtns();\n    this.btnRace.addEventListener('click', this.raceClickListener);\n    this.btnReset.addEventListener('click', this.resetClickListener);\n    this.btnGenerate.addEventListener('click', this.generateClickListener);\n\n    this.btnReset.disabled = true;\n    this.btnRace.disabled = true;\n\n    this._rootElement.append(\n      this.createComponent.rootElement,\n      this.updateComponent.rootElement,\n      btnsBlock,\n    );\n  }\n\n  private generateClickListener = async () => {\n    this.btnGenerate.disabled = true;\n    const msg = new DBusMsgGenerateCarsMsg('start');\n    const transmissions: Promise<unknown>[] = [];\n    this.txs.forEach(tx => {\n      const transmission = tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n      transmissions.push(transmission);\n    });\n    await Promise.allSettled(transmissions);\n    this.popup\n      .reset()\n      .setText('please wait while the entries are generated')\n      .show();\n    await this.generate(100, undefined, this.genCb);\n    this.popup.reset().hide();\n    const resolveMsg = new DBusMsgGenerateCarsMsg('end');\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg: resolveMsg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n    this.btnGenerate.disabled = false;\n  };\n\n  private genCb = (progress: number) => {\n    this.popup.setProgress(progress);\n  };\n\n  private raceClickListener = async () => {\n    if (this.txs.size === 0) return;\n    this.btnRace.disabled = true;\n    this.btnGenerate.disabled = true;\n    const msg = new DBusMsgRaceRequestMsg();\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n    });\n  };\n\n  private resetClickListener = async () => {\n    if (this.txs.size === 0) return;\n    const msg = new DBusMsgGarageResetReqMsg();\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n    });\n  };\n\n  private renderBtns(): HTMLElement {\n    // setip btns\n    const span = document.createElement('span');\n    span.textContent = 'race';\n    this.btnRace.append(span);\n    this.btnRace.classList.add(sharedStyles.btn, sharedStyles['btn-15']);\n    this.btnReset.textContent = 'reset';\n    this.btnReset.classList.add(sharedStyles.btn, sharedStyles['btn-9']);\n    this.btnGenerate.textContent = 'generate cars';\n    this.btnGenerate.classList.add(sharedStyles.btn, sharedStyles['btn-1']);\n\n    const btnBlock = document.createElement('div');\n    btnBlock.classList.add(styles['btn-block']);\n    btnBlock.append(this.btnRace, this.btnReset, this.btnGenerate);\n    return btnBlock;\n  }\n\n  private async generate(\n    total: number,\n    left?: number,\n    cb?: (progress: number) => unknown,\n  ): Promise<boolean> {\n    let genLeft = left || total;\n    const randomName = this.genRandomCarName();\n    const color = genRandomHexColor();\n    const unregCarData: UnregCarData = {\n      name: randomName,\n      color,\n    };\n    const car = await REST_CLIENT_GARAGE.createCar(unregCarData);\n    // const winner: WinnerCarData = {\n    //   id: car.id,\n    //   wins: getRandomArbitraryInt(1, 3),\n    //   time: Number.parseFloat((getRandomArbitraryInt(40, 50) / 3).toFixed(2)),\n    // };\n    // await REST_CLIENT_WINNERS.createWinner(winner);\n    genLeft--;\n\n    if (cb) {\n      const progress = (1 - genLeft / total) * 100;\n      cb(progress);\n    }\n\n    if (genLeft > 0) return this.generate(total, genLeft, cb);\n\n    return true;\n  }\n\n  private genRandomCarName = (): string => {\n    const manufacturerNumber = getRandomInt(CAR_MODEL_LIST_KEYS.length - 1);\n    const manufacturerName = CAR_MODEL_LIST_KEYS[\n      manufacturerNumber\n    ] as keyof typeof CAR_MODEL_LIST;\n    const models = CAR_MODEL_LIST[manufacturerName];\n    const modelNumber = getRandomInt(models.length - 1);\n    const modelName = models[modelNumber] as string;\n    return `${manufacturerName} ${modelName}`;\n  };\n\n  private rxFuncForRaceMsgs = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgGarageRaceStatusMsg) {\n      const { status } = data.msg;\n      switch (status) {\n        case 'READY_TO_GO':\n          this.btnRace.disabled = false;\n          this.btnReset.disabled = true;\n          this.btnGenerate.disabled = false;\n          this.createComponent.getController().enable();\n          this.updateComponent.getController().enable();\n          break;\n        case 'IN_PROCESS':\n          this.btnRace.disabled = true;\n          this.btnReset.disabled = false;\n          this.btnGenerate.disabled = true;\n          this.createComponent.getController().disable();\n          this.updateComponent.getController().disable();\n          break;\n        case 'NEED_RESET':\n          this.btnRace.disabled = true;\n          this.btnReset.disabled = false;\n          this.btnGenerate.disabled = false;\n          this.createComponent.getController().enable();\n          this.updateComponent.getController().enable();\n          break;\n        default:\n          break;\n      }\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  connect(int: DBusInterface) {\n    int.attachSubHub(this.createComponent, 'cu_create');\n    int.attachSubHub(this.updateComponent, 'cu_delete');\n\n    const rx = int.getNewRX(\n      this.rxFuncForRaceMsgs,\n      'toggle btns in main-ctls-block',\n    );\n    int.plugRX(DBusTopics.GARAGE, rx);\n\n    const tx = int.getNewTX('start race | broadcast generate');\n    this.txs.add(tx);\n  }\n}\n","import { RegCarData } from '../../../../definitions/car-data.def';\nimport { BaseComp } from '../../../../lib/components/base-comp/base-comp';\n\nexport class GaragePopupWinner extends BaseComp {\n  private header = document.createElement('h3');\n\n  private textTime = document.createElement('span');\n\n  private textName = document.createElement('span');\n\n  private textId = document.createElement('span');\n\n  private textNumber = document.createElement('span');\n\n  constructor() {\n    super('div');\n    this.header.textContent = 'WE HAVE A WINNER!';\n    this._rootElement.append(\n      this.header,\n      this.textTime,\n      this.textName,\n      this.textId,\n      this.textNumber,\n    );\n  }\n\n  setData(car: RegCarData, timeStr: string, indexStr?: string) {\n    this.textTime.textContent = `Time: ${timeStr}s`;\n    this.textName.textContent = `Name of the car: \\n ${car.name}`;\n    this.textId.textContent = `ID of the car: ${car.id}`;\n    this.textNumber.textContent = indexStr\n      ? `Position on the track: ${indexStr}`\n      : ``;\n  }\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { CarComp } from '../car/car';\n\nimport styles from './track.scss';\n\nexport class TrackComp extends BaseComp {\n  private topBlock = document.createElement('div');\n\n  constructor() {\n    super('div');\n    this._rootElement.classList.add(styles.track);\n    this._rootElement.append();\n    this.topBlock.classList.add(styles['track__controls-block']);\n  }\n\n  illuminateSelf = (illuminate: boolean) => {\n    if (illuminate) this._rootElement.classList.add(styles.track_illuminated);\n    else this._rootElement.classList.remove(styles.track_illuminated);\n  };\n\n  placeCar(carComp: CarComp) {\n    if (this._rootElement.hasChildNodes()) {\n      this._rootElement.childNodes.forEach(child => child.remove());\n    }\n    this.topBlock.append(carComp.spanCarName);\n    this._rootElement.append(this.topBlock, carComp.rootElement);\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { DBus } from '../../lib/services/dbus/dbus';\nimport { DBUS_COMMON_RESPONSES } from '../../lib/services/dbus/defs/dbus-common-responses.def';\nimport {\n  DBusHubNamesList,\n  DBUS_HUB_NAMES,\n} from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBusMsgRouteIsChangedMsg } from '../../lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport styles from './header.scss';\nimport { NavItem } from './subcomps/nav-item/nav-item';\n\nexport class HeaderComponent extends BaseComp implements DBusHub {\n  private navContainer: HTMLElement;\n\n  private logo: HTMLElement;\n\n  protected anchors: HTMLAnchorElement[];\n\n  protected buses: DBus[] = [];\n\n  constructor(readonly hubName: DBusHubNamesList = DBUS_HUB_NAMES.HEADER) {\n    super('header');\n    this.rootElement.classList.add(styles.header);\n\n    // logo\n    this.logo = document.createElement('h1');\n    this.logo.classList.add(styles.header__logo);\n    const firstSpan = document.createElement('span');\n    firstSpan.textContent = 'async';\n    const secondSpan = document.createElement('span');\n    secondSpan.textContent = 'race';\n    this.logo.append(firstSpan, secondSpan);\n    this.rootElement.append(this.logo);\n\n    // nav\n    this.navContainer = document.createElement('nav');\n    this.navContainer.classList.add(styles['header-nav']);\n    this.rootElement.append(this.navContainer);\n\n    // ul\n    const ul = document.createElement('ul');\n    ul.classList.add(styles['header-nav__list']);\n    this.navContainer.append(ul);\n\n    // ul items\n    const classList = {\n      li: styles['header-nav__item'],\n      a: styles['header-nav__anchor'],\n      svg: styles['header-nav__svg'],\n      span: styles['header-nav__span'],\n    };\n\n    const garageNavItem = new NavItem('garage', '#garage', classList);\n    const winnersNavItem = new NavItem('winners', '#winners', classList);\n\n    const navItems = [garageNavItem, winnersNavItem];\n    this.anchors = navItems.map(item => item.anchor);\n\n    ul.append(...navItems.map(item => item.rootElement));\n  }\n\n  connect(int: DBusInterface) {\n    const illuminateRX = int.getNewRX(\n      this.illuminateNavItem,\n      'illuminate nav items',\n    );\n    int.plugRX(DBusTopics.ROUTING, illuminateRX);\n  }\n\n  private illuminateNavItem = async (data: DBusTXData) => {\n    const { msg } = data;\n    if (msg instanceof DBusMsgRouteIsChangedMsg) {\n      this.anchors.forEach(anchor => {\n        if (anchor.getAttribute('href') === msg.newRoute) {\n          anchor.classList.add(styles['header-nav__anchor_active']);\n        } else {\n          anchor.classList.remove(styles['header-nav__anchor_active']);\n        }\n      });\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\n\nexport interface NavItemStyles {\n  li?: string;\n  a?: string;\n  svg?: string;\n  span?: string;\n}\n\nexport class NavItem extends BaseComp {\n  private _anchor: HTMLAnchorElement;\n\n  protected iconImage: HTMLImageElement | undefined;\n\n  protected span: HTMLSpanElement;\n\n  constructor(\n    text: string,\n    href: string,\n    styles?: NavItemStyles,\n    iconSrc?: string,\n  ) {\n    super('li');\n\n    if (styles?.li) this._rootElement.classList.add(styles.li);\n    this._anchor = document.createElement('a');\n    this._anchor.setAttribute('href', href);\n\n    if (styles?.a) this._anchor.classList.add(styles.a);\n\n    if (iconSrc) {\n      this.iconImage = document.createElement('img');\n      this.iconImage.src = iconSrc;\n\n      if (styles?.svg) this.iconImage.classList.add(styles.svg);\n      this._anchor.append(this.iconImage);\n    }\n    this.span = document.createElement('span');\n    this.span.textContent = text;\n\n    if (styles?.span) this.span.classList.add(styles.span);\n    this._anchor.append(this.span);\n\n    this.rootElement.append(this._anchor);\n  }\n\n  get anchor(): HTMLAnchorElement {\n    return this._anchor;\n  }\n}\n","import { UnregCarData, WinnerCarData } from '../../../definitions/car-data.def';\nimport { BaseComp } from '../../../lib/components/base-comp/base-comp';\nimport { CarComp } from '../../garage/subcomps/car/car';\n\nexport class WinnerRowComp extends BaseComp {\n  private indexElem = document.createElement('td');\n\n  private idElem = document.createElement('td');\n\n  private carPreviewBox = document.createElement('td');\n\n  private nameElem = document.createElement('td');\n\n  private winsElem = document.createElement('td');\n\n  private bestTimeElem = document.createElement('td');\n\n  private carPreview: HTMLElement;\n\n  constructor(index: number, winnerData: WinnerCarData, carData: UnregCarData) {\n    super('tr');\n\n    this.indexElem.textContent = index.toString();\n    this.idElem.textContent = winnerData.id.toString();\n    this.carPreview = CarComp.genPreview(carData);\n    this.carPreviewBox.append(this.carPreview);\n    this.nameElem.textContent = carData.name;\n    this.winsElem.textContent = winnerData.wins.toString();\n    this.bestTimeElem.textContent = winnerData.time.toString();\n\n    this._rootElement.append(\n      this.indexElem,\n      this.idElem,\n      this.carPreviewBox,\n      this.nameElem,\n      this.winsElem,\n      this.bestTimeElem,\n    );\n  }\n\n  public getCarPreview() {\n    return this.carPreview;\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { REST_CLIENT_WINNERS } from '../../services/rest-clients/client-winners/rest-client-winners';\nimport {\n  RestClientWinnersSortOptionsList,\n  REST_CLIENT_WINNERS_SORT_OPTIONS,\n} from '../../services/rest-clients/client-winners/rest-client-winners.def';\nimport { WinnerRowComp } from './subcomps/winner-entry';\nimport { Pager } from '../../lib/services/pager/pager';\n\nimport styles from './winners.scss';\nimport sharedStyles from '../../styles.scss';\nimport { Notifiable } from '../../lib/interfaces/notifiable';\n\nexport class WinnersComp extends BaseComp implements Notifiable {\n  static readonly TEXT_CONTENT_ENG = {};\n\n  private table = document.createElement('table');\n\n  private tableBody = document.createElement('tbody');\n\n  private tableHead = document.createElement('thead');\n\n  private thId = document.createElement('th');\n\n  private thCar = document.createElement('th');\n\n  private thName = document.createElement('th');\n\n  private thWins = document.createElement('th');\n\n  private thBestTime = document.createElement('th');\n\n  private pager: Pager;\n\n  private pagerBtnsContainer = document.createElement('div');\n\n  private pagerSpan: HTMLSpanElement;\n\n  private currSortedElem: HTMLElement | undefined;\n\n  private currOrder: 'ASC' | 'DESC' = 'ASC';\n\n  private currSort: RestClientWinnersSortOptionsList = 'time';\n\n  private entriesPerPage = 10;\n\n  constructor() {\n    super('section');\n    this._rootElement.classList.add(styles.winners);\n    this._rootElement.style.setProperty(\n      'background-image',\n      `url('./assets/imgs/backgrounds/winners/anime-girl-cyberpunk-ride-4k-lx-2880x1800.jpg')`,\n    );\n\n    this.pager = new Pager(this.entriesPerPage, this.pagerCallback);\n    this.pagerSpan = this.pager.getPagerSpan();\n\n    this.renderPager();\n\n    this.renderTable();\n\n    this._rootElement.append(this.table);\n  }\n\n  private renderTable() {\n    this.renderTableHeader();\n    this.table.classList.add(styles.table);\n    this.table.append(\n      this.tableHead,\n      this.tableBody,\n      this.pagerBtnsContainer,\n      this.pagerSpan,\n    );\n  }\n\n  private renderTableHeader() {\n    const tr = document.createElement('tr');\n\n    const thIndex = document.createElement('th');\n    thIndex.textContent = '‚Ññ';\n    this.thId.textContent = 'ID';\n    this.thId.classList.add(styles['table__can-be-sorted']);\n    this.thCar.textContent = 'CAR';\n    this.thName.textContent = 'NAME';\n    this.thWins.textContent = 'WINS';\n    this.thWins.classList.add(styles['table__can-be-sorted']);\n    this.thBestTime.textContent = 'BEST TIME';\n    this.thBestTime.classList.add(styles['table__can-be-sorted']);\n\n    tr.append(\n      thIndex,\n      this.thId,\n      this.thCar,\n      this.thName,\n      this.thWins,\n      this.thBestTime,\n    );\n    this.tableHead.append(tr);\n    this.tableHead.addEventListener('click', this.tableHeadClickListener);\n  }\n\n  private renderPager() {\n    const btnPrevPage = this.pager.getBtnPrevPage();\n\n    btnPrevPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['pager-btn'],\n    );\n\n    const btnNextPage = this.pager.getBtnNextPage();\n\n    btnNextPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['pager-btn'],\n    );\n\n    this.pagerBtnsContainer.classList.add(styles.pager);\n    this.pagerBtnsContainer.append(btnPrevPage, btnNextPage);\n\n    this.pagerSpan.classList.add(styles['pager-span']);\n  }\n\n  notify(): void {\n    this.refillTable().then(() =>\n      this.refreshTableHeader(this.currSortedElem || this.thBestTime),\n    );\n  }\n\n  private pagerCallback = async (dir: 'prev' | 'next'): Promise<boolean> => {\n    try {\n      await this.refillTable(dir);\n      return true;\n    } catch {\n      return false;\n    }\n  };\n\n  private async refillTable(dir?: 'prev' | 'next'): Promise<void> {\n    return new Promise((res, rej) => {\n      const page = dir\n        ? dir === 'next'\n          ? this.pager.getCurrPageNumber() + 1\n          : this.pager.getCurrPageNumber() - 1\n        : this.pager.getCurrPageNumber();\n\n      console.log(page, this.currSort, this.currOrder);\n      REST_CLIENT_WINNERS.getWinners(\n        page,\n        10,\n        this.currSort,\n        this.currOrder,\n      ).then(async response => {\n        this.pager.setEntriesCount(Number.parseInt(response.limit, 10));\n        if (response.cars.length === 0) {\n          if (dir) {\n            rej();\n            return;\n          }\n\n          if (page > 1) {\n            await this.pager.tryChangePage('prev');\n            res();\n            return;\n          }\n        }\n        const rows = new Array<WinnerRowComp>(response.cars.length);\n        const promises: Promise<unknown>[] = [];\n        const indexInc = (page - 1) * 10;\n        response.cars.forEach((winner, index) => {\n          const promise = REST_CLIENT_GARAGE.getCar(winner.id).then(car => {\n            const totalIndex = index + indexInc + 1;\n            const row = new WinnerRowComp(totalIndex, winner, car);\n            console.log(totalIndex, winner.time);\n            rows[index] = row;\n          });\n          promises.push(promise);\n        });\n        await Promise.allSettled(promises);\n        while (this.tableBody.firstChild) this.tableBody.firstChild.remove();\n        this.tableBody.append(\n          ...rows.map(row => {\n            row.getCarPreview().classList.add(styles['table__car-preview-box']);\n            return row.rootElement;\n          }),\n        );\n        res();\n      });\n    });\n  }\n\n  private tableHeadClickListener = async (e: Event) => {\n    let sort: RestClientWinnersSortOptionsList | undefined;\n    switch (e.target) {\n      case this.thId:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.id;\n        break;\n      case this.thWins:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.wins;\n        break;\n      case this.thBestTime:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.time;\n        break;\n      default:\n        break;\n    }\n    if (sort) {\n      this.pager.toogleLock(true);\n      const elem = e.target as HTMLElement;\n      this.currOrder = elem.classList.contains(\n        styles['table__sorted-elem_desc'],\n      )\n        ? 'ASC'\n        : 'DESC';\n      this.currSort = sort;\n      await this.refillTable();\n      this.refreshTableHeader(elem);\n      this.pager.toogleLock(false);\n    }\n  };\n\n  private refreshTableHeader = (elem: HTMLElement) => {\n    if (this.currSortedElem)\n      this.currSortedElem.classList.remove(styles['table__sorted-elem']);\n\n    elem.classList.add(styles['table__sorted-elem']);\n    this.currSortedElem = elem;\n\n    if (this.currOrder === 'ASC') {\n      elem.classList.remove(styles['table__sorted-elem_desc']);\n      elem.classList.add(styles['table__sorted-elem_asc']);\n    } else {\n      elem.classList.remove(styles['table__sorted-elem_asc']);\n      elem.classList.add(styles['table__sorted-elem_desc']);\n    }\n  };\n}\n","import { OBJ_PROCESSOR } from '../lib/processors/obj-processor';\n\nconst models = {\n  Lamborghini: [\n    'Murci√©lago',\n    '350 GT',\n    '400 GT',\n    'Si√°n FKP 37',\n    'Essenza SCV12',\n    'Urus',\n    'Centenario',\n    'Hurac√°n',\n    'Veneno',\n    'Sesto Element–æ',\n    'Aventador',\n    'Revent√≥n',\n    'Gallardo',\n    'Diablo',\n    'LM002',\n    'Jalpa',\n    'Silhouette',\n    'Countach',\n    'Urraco',\n    'Jarama',\n    'Islero',\n    'Espada',\n    'Miura',\n  ],\n  'Aston Martin': [\n    'Project 003',\n    'Valkyrie',\n    'DBS',\n    'Vanquish Zagato',\n    'Vanquish',\n    'Virage/Virage Volante',\n    'V12 Zagato',\n    'One-77',\n    'V8 Coupe/V8 Volante',\n    'V8 Zagato',\n  ],\n  Ferrari: [\n    'Roma',\n    'Portfolio',\n    '488 GTB',\n    'California T',\n    '360 Spider',\n    '355 F1 Berlinetta',\n    'F355 GTS',\n    '456 GT',\n    'Testarossa',\n    'SF1000',\n  ],\n  Koenigsegg: [\n    'Jesko Absolut',\n    'Jesko',\n    'Agera Final',\n    'Agera XS',\n    'Agera X',\n    'Agera S',\n    'Regera',\n    'Agera RS',\n    'One:1',\n    'CCGT',\n  ],\n};\n\nconst CAR_MODEL_LIST = OBJ_PROCESSOR.deepFreeze(models);\n\nexport { CAR_MODEL_LIST };\n\nconst CAR_MODEL_LIST_KEYS = OBJ_PROCESSOR.deepFreeze(\n  Object.keys(CAR_MODEL_LIST),\n);\n\nexport { CAR_MODEL_LIST_KEYS };\n","export class BaseComp {\n  protected _rootElement: HTMLElement;\n\n  constructor(tag: keyof HTMLElementTagNameMap = 'div') {\n    this._rootElement = document.createElement(tag);\n  }\n\n  public get rootElement(): HTMLElement {\n    return this._rootElement;\n  }\n}\n","import { PopupStandaloneModalComp } from '../popup-standalone-modal';\n\nimport sharedStyles from '../../../../../../styles.scss';\n\nexport class PopupStandaloneModal404Comp extends PopupStandaloneModalComp {\n  constructor() {\n    super();\n    this.header.textContent = 'ERROR: 404';\n    this.header.dataset.textContent = this.header.textContent;\n    this.header.classList.add(sharedStyles['glitched-text']);\n    this.text.classList.add(sharedStyles['glitched-text']);\n  }\n}\n","import { PopupStandaloneComp } from '../popup-standalone';\n\nimport styles from './popup-standalone-modal.scss';\n\nexport abstract class PopupStandaloneModalComp extends PopupStandaloneComp {\n  constructor() {\n    super();\n    this._rootElement.classList.add(styles['popup-modal']);\n    const closeArea = document.createElement('div');\n    closeArea.classList.add(styles['popup-bg']);\n    this._rootElement.append(closeArea);\n    this.body.classList.add(styles['popup-body']);\n    closeArea.append(this.body);\n    this.header.classList.add(styles['popup-body-header']);\n    this.text.classList.add(styles['popup-body-text']);\n  }\n\n  setHeader(text: string): PopupStandaloneModalComp {\n    this.header.textContent = text;\n    this.header.dataset.textContent = text;\n    return this;\n  }\n\n  setText(text: string): PopupStandaloneModalComp {\n    this.text.textContent = text;\n    this.text.dataset.textContent = text;\n    return this;\n  }\n\n  show(rootElem?: HTMLElement): PopupStandaloneModalComp {\n    const root = rootElem || document.body;\n    root.append(this._rootElement);\n    return this;\n  }\n\n  hide(): PopupStandaloneModalComp {\n    this._rootElement.remove();\n    return this;\n  }\n}\n","import { PopupStandaloneModalComp } from '../popup-standalone-modal';\n\nimport styles from './popup-progress.scss';\nimport sharedStyles from '../../../../../../styles.scss';\n\nexport class PopupStandaloneModalProgressComp extends PopupStandaloneModalComp {\n  private barContainer = document.createElement('div');\n\n  private bar = document.createElement('div');\n\n  constructor() {\n    super();\n    this.barContainer.classList.add(styles.container);\n    this.bar.classList.add(styles.bar);\n    this.barContainer.append(this.bar);\n    this.text.classList.add(styles.text, sharedStyles['glitched-text']);\n    this.body.classList.add(styles.body);\n    this.body.append(this.barContainer);\n  }\n\n  setHeader(text: string): PopupStandaloneModalProgressComp {\n    super.setHeader(text);\n    return this;\n  }\n\n  setText(text: string): PopupStandaloneModalProgressComp {\n    super.setText(text);\n    return this;\n  }\n\n  reset(): PopupStandaloneModalProgressComp {\n    this.bar.style.removeProperty('--progress');\n    this.text.textContent = '';\n    this.text.dataset.textContent = '';\n    return this;\n  }\n\n  setProgress(progress: number): PopupStandaloneModalProgressComp {\n    this.bar.style.setProperty('--progress', `${progress}%`);\n    return this;\n  }\n}\n","import { BaseComp } from '../../base-comp/base-comp';\n\nexport interface BasePopupAttrs {\n  configurable: boolean;\n}\n\nexport abstract class PopupStandaloneComp extends BaseComp {\n  protected body: HTMLElement;\n\n  protected header: HTMLHeadingElement;\n\n  protected text: HTMLParagraphElement;\n\n  constructor() {\n    super('div');\n\n    this.body = document.createElement('div');\n    this.header = document.createElement('h3');\n    this.text = document.createElement('p');\n\n    this.body.append(this.header, this.text);\n    this._rootElement.append(this.body);\n  }\n}\n","export function hexToRgb(hex: string): { r: number; g: number; b: number } {\n  let c: string[];\n  if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\n    // c = hex.substring(1).split('');\n    c = hex.split('');\n    if (c.length === 4) {\n      c = [c[1], c[1], c[2], c[2], c[3], c[3]] as string[];\n    }\n    const r = Number.parseInt(hex.slice(1, 3), 16);\n    const g = Number.parseInt(hex.slice(3, 5), 16);\n    const b = Number.parseInt(hex.slice(5, 7), 16);\n    // return `rgb(${r}, ${g}, ${b})`;\n    return { r, g, b };\n  }\n  throw new Error('Bad Hex');\n}\n","export function genUniqId(): string {\n  const arr = new Uint8Array(4);\n  return window.crypto.getRandomValues(arr).join('');\n}\n\nexport function getRandomInt(max: number): number {\n  return Math.floor(Math.random() * max);\n}\n\nexport function getRandomArbitraryInt(min: number, max: number): number {\n  return Math.floor(Math.random() * (max - min) + min);\n}\n\nexport function genRandomHexColor(): string {\n  const color = `#${Math.floor(Math.random() * 16_777_215).toString(16)}`;\n  if (color.length === 7) return color;\n  return genRandomHexColor();\n}\n","export interface TransitionPromiseInterface {\n  elem: HTMLElement;\n  prop: string;\n  val?: string;\n  valToWait?: string;\n  forceAutoresolveIn?: number;\n}\n\nexport function getTransitionDuration(\n  style: CSSStyleDeclaration,\n  prop: string,\n) {\n  const transPropArr = style\n    .getPropertyValue('transition-property')\n    .replace(',', '')\n    .split(' ');\n  let propIndex = transPropArr.lastIndexOf(prop);\n\n  if (propIndex === -1) propIndex = transPropArr.lastIndexOf('all');\n\n  if (propIndex !== -1) {\n    const transDurationsArr = style\n      .getPropertyValue('transition-duration')\n      .replace(',', '')\n      .split(' ');\n    return transDurationsArr[propIndex];\n  }\n\n  return undefined;\n}\n\nexport function transitionPromise(\n  params: TransitionPromiseInterface,\n): Promise<boolean> {\n  return new Promise(resolve => {\n    const transformAndAutoresolve = (delay?: number): void => {\n      if (params.val) params.elem.style.setProperty(params.prop, params.val);\n      const time = delay || 20;\n      setTimeout(() => {\n        resolve(true);\n        // doesn't work - for cause look forward\n        // window.getComputedStyle(elem)[prop] == val ? resolve(true) : resolve(false);\n      }, time);\n    };\n\n    const transformAndWaitEvent = () => {\n      const eventHandler = (e: TransitionEvent): void => {\n        if (e.target !== params.elem) return;\n\n        if (e.propertyName !== params.prop) return;\n\n        if (\n          params.valToWait &&\n          window.getComputedStyle(params.elem).getPropertyValue(params.prop) !==\n            params.valToWait\n        ) {\n          return;\n        }\n\n        params.elem.removeEventListener('transitionend', eventHandler);\n        params.elem.removeEventListener('transitionend', eventHandler);\n\n        // val should be equal to style ! For example translate != matrix...\n        // if(val) window.getComputedStyle(elem)[prop] == val ? resolve(true) : reject(false);\n        // else\n        resolve(true);\n      };\n\n      params.elem.addEventListener('transitionend', eventHandler);\n      params.elem.addEventListener('transitioncancel', eventHandler);\n\n      if (params.val) params.elem.style.setProperty(params.prop, params.val);\n    };\n\n    if (params.forceAutoresolveIn)\n      transformAndAutoresolve(params.forceAutoresolveIn);\n    else if (\n      params.valToWait &&\n      window.getComputedStyle(params.elem).getPropertyValue(params.prop) ===\n        params.valToWait\n    )\n      transformAndAutoresolve();\n    else {\n      const style = window.getComputedStyle(params.elem);\n      const duration = getTransitionDuration(style, params.prop);\n\n      if (!duration || duration === '0s') {\n        transformAndAutoresolve();\n      } else {\n        transformAndWaitEvent();\n      }\n    }\n  });\n}\n","export interface Notifiable {\n  notify: <T>(params: T) => void | Promise<void>;\n}\n\nexport function isNotifiable(object: unknown): object is Notifiable {\n  const objAsRecord = object as Record<string, unknown>;\n  return 'notify' in objAsRecord && typeof objAsRecord.notify === 'function';\n}\n","class ObjProcessor {\n  readonly deepFreeze = <T>(obj: T): T => {\n    if (typeof obj === 'object' && obj !== null) {\n      const record = obj as Record<string, unknown>;\n      Object.keys(record).forEach(prop => {\n        if (\n          typeof record[prop] === 'object' &&\n          !Object.isFrozen(record[prop])\n        ) {\n          this.deepFreeze(record[prop]);\n        }\n      });\n      return Object.freeze(obj);\n    }\n    throw new Error('not object');\n  };\n\n  readonly deepClone = <T>(target: T): T => {\n    if (Array.isArray(target)) {\n      const clone = [] as unknown[];\n      (target as unknown[]).forEach(v => {\n        clone.push(v);\n      });\n      return clone.map((n: unknown) => this.deepClone(n)) as unknown as T;\n    }\n\n    if (typeof target === 'object' && target !== null) {\n      if (target instanceof HTMLElement)\n        return target.cloneNode(true) as unknown as T;\n      if (target instanceof Blob) return target.slice() as unknown as T;\n      const clone = {\n        ...(target as unknown as { [key: string]: unknown }),\n      } as {\n        [key: string]: unknown;\n      };\n      Object.keys(clone).forEach(k => {\n        clone[k] = this.deepClone(clone[k]);\n      });\n      Object.setPrototypeOf(clone, Object.getPrototypeOf(target));\n      return clone as unknown as T;\n    }\n    return target;\n  };\n}\n\nconst OBJ_PROCESSOR = new ObjProcessor();\nOBJ_PROCESSOR.deepFreeze(OBJ_PROCESSOR);\nexport { OBJ_PROCESSOR };\n","import { DBusTopics } from './defs/dbus-topics.def';\nimport { genUniqId } from '../../generators/generators';\nimport { OBJ_PROCESSOR } from '../../processors/obj-processor';\nimport { DBUS_ERRORS } from './defs/dbus-errors.def';\nimport { DBusRX, DBusRXFunc } from './defs/dbus-rx/dbus-rx.def';\nimport { DBusTX } from './defs/dbus-tx/dbus-tx.def';\nimport { DBusTXOptions } from './defs/dbus-tx/dbus-tx-options.def';\nimport { DBusTXData } from './defs/dbus-tx/dbus-tx-data.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from './defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTXDataHeaders } from './defs/dbus-tx/dbus-tx-data-headers.def';\nimport { DBusHub, DBusInterface } from './defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from './defs/dbus-hub-names.def';\n\nexport class DBus {\n  private network: Map<DBusTopics, Set<DBusRX>> = new Map();\n\n  private idCounter = {\n    txs: 0,\n    rxs: 0,\n  };\n\n  private createdRXs = new Set<DBusRX>();\n\n  private createdTXs = new Set<DBusTX>();\n\n  private attachedHubs = new Map<DBusHub, DBusInterface>();\n\n  private occupiedNames = new Set<string>();\n\n  readonly busId: string;\n\n  constructor() {\n    this.busId = genUniqId();\n    return Object.freeze(this) as unknown as DBus;\n  }\n\n  public attachHub(hub: DBusHub, suffix?: string): void | Promise<void> {\n    return this.createInterfaceForHub(hub, undefined, suffix);\n  }\n\n  private createInterfaceForHub(\n    hub: DBusHub,\n    prefix?: string,\n    suffix?: string,\n  ): void | Promise<void> {\n    if (this.attachedHubs.has(hub))\n      throw new Error(DBUS_ERRORS.HUB_IS_ALREADY_ATTACHED);\n\n    if (!(hub.hubName in DBUS_HUB_NAMES))\n      throw new Error(DBUS_ERRORS.HUB_NAME_NOT_AUTHORIZED);\n\n    let hubName = prefix ? `${prefix}_${hub.hubName}` : hub.hubName;\n    if (suffix) hubName += `_${suffix}`;\n\n    if (this.occupiedNames.has(hubName))\n      throw new Error(DBUS_ERRORS.HUB_NAME_IS_OCCUPIED);\n\n    const arrowedGetNewTX = (desc?: string) => this.getNewTX(hubName, desc);\n    const arrowedGetNewRX = (func: DBusRXFunc, desc?: string) =>\n      this.genNewRX(func, desc);\n    const arrowedPlugRX = (topic: DBusTopics, rx: DBusRX) =>\n      this.plugRX(topic, rx);\n    const arrowedUnplugRX = (topic: DBusTopics, rx: DBusRX) =>\n      this.unplugRX(topic, rx);\n    const decoratedAttachHub = (subHub: DBusHub, subSuffix?: string) =>\n      this.createInterfaceForHub(subHub, hubName, subSuffix);\n\n    const dbusInterface = new DBusInterface(\n      arrowedGetNewTX,\n      arrowedGetNewRX,\n      arrowedPlugRX,\n      arrowedUnplugRX,\n      decoratedAttachHub,\n    );\n\n    this.occupiedNames.add(hubName);\n    this.attachedHubs.set(hub, dbusInterface);\n\n    OBJ_PROCESSOR.deepFreeze(dbusInterface);\n\n    return hub.connect(dbusInterface);\n  }\n\n  private getNewTX(hubName: string, desc?: string): DBusTX {\n    const id = genUniqId();\n    const regNumber = this.idCounter.txs++;\n\n    const arrowedTransmit = async (opts: DBusTXOptions) => {\n      const head = new DBusTXDataHeaders(\n        hubName,\n        id,\n        regNumber,\n        opts.waitMode,\n        opts.prepMode,\n        desc,\n      );\n      const data = new DBusTXData(head, opts.msg);\n      const result = await this.transmit(data);\n      return result;\n    };\n\n    const tx = new DBusTX(regNumber, id, this.busId, arrowedTransmit);\n\n    const freezedTX = OBJ_PROCESSOR.deepFreeze(tx);\n\n    this.createdTXs.add(freezedTX);\n\n    return freezedTX;\n  }\n\n  private genNewRX(func: DBusRXFunc, desc?: string): DBusRX {\n    const id = genUniqId();\n    const regNumber = this.idCounter.rxs++;\n    const rx = new DBusRX(regNumber, id, this.busId, func, desc);\n    const freezedRX = OBJ_PROCESSOR.deepFreeze(rx);\n    this.createdRXs.add(freezedRX);\n    return freezedRX;\n  }\n\n  private plugRX(topic: DBusTopics, rx: DBusRX): void {\n    if (!this.createdRXs.has(rx)) throw new Error(DBUS_ERRORS.XENO_RX);\n    if (!this.network.has(topic)) this.network.set(topic, new Set());\n    this.network.get(topic)?.add(rx);\n  }\n\n  private unplugRX(topic: DBusTopics, rx: DBusRX): void {\n    this.network.get(topic)?.delete(rx);\n  }\n\n  private async transmit(data: DBusTXData): Promise<unknown> {\n    if (!this.network.has(data.msg.topic)) {\n      throw new Error(DBUS_ERRORS.TOPIC_IS_NOT_EXIST);\n    }\n\n    const rxs = this.network.get(data.msg.topic);\n\n    if (rxs === undefined || rxs.size === 0)\n      throw new Error(DBUS_ERRORS.TOPIC_HAS_NO_RXS);\n\n    let choosedRXs: DBusRX[] = [];\n\n    if (data.msg.prefResponseRxIds) {\n      rxs.forEach(rx => {\n        if (data.msg.prefResponseRxIds?.includes(rx.id)) choosedRXs.push(rx);\n      });\n      if (choosedRXs.length === 0)\n        throw new Error(DBUS_ERRORS.PREF_RXS_ARE_NOT_EXIST);\n    } else choosedRXs = [...rxs];\n\n    let result;\n    switch (data.headers.waitMode) {\n      case DBusTXWaitModes.all:\n        result = await Promise.all(\n          choosedRXs.map(rx => this.callRXFunc(data, rx)),\n        );\n        break;\n      case DBusTXWaitModes.allSetled:\n        result = await Promise.allSettled(\n          choosedRXs.map(rx => this.callRXFunc(data, rx)),\n        );\n        break;\n      case DBusTXWaitModes.manual:\n        result = choosedRXs;\n        break;\n      case DBusTXWaitModes.nowait:\n      default:\n        choosedRXs.map(rx => this.callRXFunc(data, rx));\n        result = true;\n        break;\n    }\n    return result;\n  }\n\n  private callRXFunc = (data: DBusTXData, rx: DBusRX) => {\n    const handleClone = () => {\n      const clonedData = OBJ_PROCESSOR.deepClone(data);\n      return rx.func(clonedData);\n    };\n\n    const handleFreeze = () => {\n      const freezedData = OBJ_PROCESSOR.deepFreeze(data);\n      return rx.func(freezedData);\n    };\n\n    switch (data.headers.prepMode) {\n      case DBusTXPrepModes.clone:\n        return handleClone();\n      case DBusTXPrepModes.freeze:\n        return handleFreeze();\n      default:\n        throw new Error(DBUS_ERRORS.UNEXPECTED_PREP_MODE);\n    }\n  };\n}\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nconst dbusCommonResponses = {\n  VOID: 'VOID',\n  BAD_REQUEST: 'BAD_REQUEST',\n};\n\nconst DBUS_COMMON_RESPONSES = OBJ_PROCESSOR.deepFreeze(dbusCommonResponses);\n\nexport { DBUS_COMMON_RESPONSES };\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nconst dbusErrors = {\n  HUB_NAME_IS_OCCUPIED: 'HUB_NAME_IS_OCCUPIED',\n  HUB_IS_ALREADY_ATTACHED: 'HUB_IS_ALREADY_ATTACHED',\n  HUB_NAME_NOT_AUTHORIZED: 'HUB_NAME_NOT_AUTHORIZED',\n  XENO_RX: 'XENO_RX',\n  TOPIC_IS_NOT_EXIST: 'TOPIC_IS_NOT_EXIST',\n  TOPIC_HAS_NO_RXS: 'TOPIC_HAS_NO_RXS',\n  PREF_RXS_ARE_NOT_EXIST: 'PREF_RXS_ARE_NOT_EXIST',\n  UNEXPECTED_PREP_MODE: 'UNEXPECTED_PREP_MODE',\n};\n\nconst DBUS_ERRORS = OBJ_PROCESSOR.deepFreeze(dbusErrors);\n\nexport { DBUS_ERRORS };\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nclass DBusHubNames {\n  readonly APP = 'APP';\n\n  readonly ROUTER = 'ROUTER';\n\n  readonly GARAGE = 'GARAGE';\n\n  readonly HEADER = 'HEADER';\n\n  readonly MAIN_CONTROLS = 'MAIN_CONTROLS';\n\n  readonly CREATE_UPDATE = 'CREATE_UPDATE';\n\n  readonly GARAGE_CONTROLLER = 'GARAGE_CONTROLLER';\n}\n\nconst obj = new DBusHubNames();\n\nconst DBUS_HUB_NAMES = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { DBUS_HUB_NAMES };\n\nexport type DBusHubNamesList = keyof DBusHubNames;\n","import { DBusHubNamesList, DBUS_HUB_NAMES } from './dbus-hub-names.def';\nimport { DBusRX, DBusRXFunc } from './dbus-rx/dbus-rx.def';\nimport { DBusTopics } from './dbus-topics.def';\nimport { DBusTX } from './dbus-tx/dbus-tx.def';\n\nexport interface DBusHub {\n  readonly hubName: DBusHubNamesList;\n  connect: (dbusInterface: DBusInterface) => void | Promise<void>;\n  // TODO: handleSystemRequset: (request: unknown) => unknown | Promise<unknown>;\n}\n\nexport function isDBusHub(object: unknown): object is DBusHub {\n  const objAsRecord = object as Record<string, unknown>;\n  return (\n    'connect' in objAsRecord &&\n    'hubName' in objAsRecord &&\n    typeof objAsRecord.hubName === 'string' &&\n    objAsRecord.hubName in DBUS_HUB_NAMES\n  );\n}\n\nexport class DBusInterface {\n  private RXs = new Set<DBusRX>();\n\n  private TXs = new Set<DBusTX>();\n\n  private RXsPlugMap = new Map<DBusTopics, Set<DBusRX>>();\n\n  constructor(\n    private readonly arrowedGetNewTX: (desc?: string) => DBusTX,\n    private readonly arrowedGetNewRX: (\n      func: DBusRXFunc,\n      desc?: string,\n    ) => DBusRX,\n    private readonly arrowedPlugRX: (topic: DBusTopics, rx: DBusRX) => void,\n    private readonly arrowedUnplugRX: (topic: DBusTopics, rx: DBusRX) => void,\n    public readonly attachSubHub: (\n      subHub: DBusHub,\n      subSuffix?: string,\n    ) => void | Promise<void>,\n  ) {}\n\n  getNewRX(func: DBusRXFunc, desc?: string) {\n    const rx = this.arrowedGetNewRX(func, desc);\n    this.RXs.add(rx);\n    return rx;\n  }\n\n  getNewTX(desc?: string) {\n    const tx = this.arrowedGetNewTX(desc);\n    this.TXs.add(tx);\n    return tx;\n  }\n\n  plugRX(topic: DBusTopics, rx: DBusRX): void {\n    if (!this.RXsPlugMap.has(topic)) this.RXsPlugMap.set(topic, new Set());\n    this.RXsPlugMap.get(topic)?.add(rx);\n    this.arrowedPlugRX(topic, rx);\n  }\n\n  unplugRX(topic: DBusTopics, rx: DBusRX): void {\n    this.RXsPlugMap.get(topic)?.delete(rx);\n    this.arrowedUnplugRX(topic, rx);\n  }\n}\n","import { DBusTXData } from '../dbus-tx/dbus-tx-data.def';\n\nexport type DBusRXFunc = (data: DBusTXData) => Promise<unknown>;\n\nexport class DBusRX {\n  constructor(\n    readonly regNumber: number,\n    readonly id: string,\n    readonly busId: string,\n    readonly func: DBusRXFunc,\n    readonly desc?: string,\n  ) {}\n}\n","export enum DBusTopics {\n  APP_CTL,\n  ROUTING,\n  CAR_ACTION,\n  GARAGE,\n  REST_CLIENT_REQUESTS,\n  GENERATE,\n}\n","import { DBusTXPrepModes, DBusTXWaitModes } from './dbus-tx-modes.def';\n\nexport class DBusTXDataHeaders {\n  constructor(\n    readonly hubName: string,\n    readonly txId: string,\n    readonly txRegNumber: number,\n    readonly waitMode: DBusTXWaitModes,\n    readonly prepMode: DBusTXPrepModes,\n    readonly txDesc?: string,\n  ) {}\n}\n","import { DBusMsg } from '../msgs/dbus-msg.def';\nimport { DBusTXDataHeaders } from './dbus-tx-data-headers.def';\n\nexport class DBusTXData {\n  constructor(readonly headers: DBusTXDataHeaders, readonly msg: DBusMsg) {}\n}\n","export enum DBusTXWaitModes {\n  nowait,\n  all,\n  allSetled,\n  manual,\n}\n\nexport enum DBusTXPrepModes {\n  clone,\n  freeze,\n}\n","import { DBusTXOptions } from './dbus-tx-options.def';\n\nexport class DBusTX {\n  constructor(\n    readonly regNumber: number,\n    readonly id: string,\n    readonly busId: string,\n    readonly transmit: (options: DBusTXOptions) => Promise<unknown>,\n  ) {}\n}\n","import { DBusTopics } from '../dbus-topics.def';\n\nexport abstract class DBusMsg {\n  constructor(\n    readonly topic: DBusTopics,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {}\n}\n","export class Pager {\n  private firstPageNumber = 1;\n\n  private currPageNumber = this.firstPageNumber;\n\n  private lastPageNumber = 0;\n\n  private pagerSpan = document.createElement('span');\n\n  private entriesCount = 0;\n\n  private callbackIsCalled = false;\n\n  constructor(\n    private entriesPerPage: number,\n    protected readonly listCallback: (dir: 'prev' | 'next') => Promise<boolean>,\n    private btnPrevPage = document.createElement('button'),\n    private btnNextPage = document.createElement('button'),\n  ) {\n    const btnNextSpan = document.createElement('span');\n    btnNextSpan.textContent = 'Next page';\n    this.btnNextPage.append(btnNextSpan);\n\n    const btnPrevSpan = document.createElement('span');\n    btnPrevSpan.textContent = 'Prev page';\n    this.btnPrevPage.append(btnPrevSpan);\n\n    this.btnNextPage.addEventListener('click', () => this.callCallback('next'));\n    this.btnPrevPage.addEventListener('click', () => this.callCallback('prev'));\n  }\n\n  public toogleLock(lock: boolean) {\n    this.toggleBtnsDisabled(lock);\n  }\n\n  public getEntriesPerPage(): number {\n    return this.entriesPerPage;\n  }\n\n  public setLastPageNumber(n: number) {\n    this.lastPageNumber = n;\n    if (!this.callbackIsCalled) this.toggleBtnsDisabled(false);\n  }\n\n  public setEntriesCount(n: number) {\n    this.entriesCount = n;\n    this.lastPageNumber = Math.ceil(this.entriesCount / this.entriesPerPage);\n    this.pagerSpan.textContent = `Entries: ${n}, Page: ${this.currPageNumber}/${this.lastPageNumber}`;\n    if (!this.callbackIsCalled) this.toggleBtnsDisabled(false);\n  }\n\n  public getCurrPageNumber() {\n    return this.currPageNumber;\n  }\n\n  public getBtnPrevPage(): HTMLSpanElement {\n    return this.btnPrevPage;\n  }\n\n  public getBtnNextPage(): HTMLSpanElement {\n    return this.btnNextPage;\n  }\n\n  public getPagerSpan(): HTMLSpanElement {\n    return this.pagerSpan;\n  }\n\n  tryChangePage(dir: 'prev' | 'next') {\n    return this.callCallback(dir);\n  }\n\n  private async callCallback(dir: 'prev' | 'next') {\n    this.callbackIsCalled = true;\n    this.toggleBtnsDisabled(true);\n    const pageIsChanged = await this.listCallback(dir);\n    if (pageIsChanged) {\n      switch (dir) {\n        case 'next':\n          this.currPageNumber++;\n          break;\n        case 'prev':\n          this.currPageNumber--;\n          break;\n        default:\n          break;\n      }\n    }\n    this.toggleBtnsDisabled(false);\n    this.callbackIsCalled = false;\n  }\n\n  private toggleBtnsDisabled(state: boolean) {\n    if (state === true) {\n      this.btnPrevPage.disabled = true;\n      this.btnNextPage.disabled = true;\n      return;\n    }\n\n    if (this.currPageNumber > this.firstPageNumber)\n      this.btnPrevPage.disabled = false;\n    else this.btnPrevPage.disabled = true;\n\n    if (this.currPageNumber < this.lastPageNumber)\n      this.btnNextPage.disabled = false;\n    else this.btnNextPage.disabled = true;\n  }\n}\n","import { DBusTopics } from '../../dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgRoutingMsg extends DBusMsg {\n  constructor(rxIds?: string[], prefResponseRxIds?: string[]) {\n    super(DBusTopics.ROUTING, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgRoutingMsg } from '../dbus-msg-routing-msg.def';\nimport { ROUTES } from '../../routes.def';\n\nexport class DBusMsgRouteIsChangedMsg extends DBusMsgRoutingMsg {\n  constructor(\n    readonly newRoute: keyof typeof ROUTES | string,\n    readonly addInfo?: unknown,\n    rxIds?: string[],\n    prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","export class SimpleRouterAgent {\n  constructor(\n    readonly type: string,\n    readonly path: string,\n    readonly callback: CallableFunction,\n    readonly getStateCallback?: CallableFunction,\n    readonly setStateCallback?: CallableFunction,\n  ) {}\n}\n","import { OBJ_PROCESSOR } from '../../processors/obj-processor';\nimport { DBUS_HUB_NAMES } from '../dbus/defs/dbus-hub-names.def';\nimport { DBusHub, DBusInterface } from '../dbus/defs/dbus-interface.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgRouteIsChangedMsg } from './dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport { SimpleRouterAgent } from './simple-router-agent';\n\nexport interface RouterOptions {\n  mode: string;\n  onlyDBus?: true;\n  defaultRoot?: string;\n  defaultAgent?: SimpleRouterAgent;\n}\n\nexport class SimpleRouter implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.ROUTER;\n\n  private agents: Set<SimpleRouterAgent> = new Set();\n\n  private options: RouterOptions;\n\n  private currRoute: string | undefined;\n\n  private txs: Set<DBusTX> = new Set();\n\n  private defaultAgent: SimpleRouterAgent | undefined;\n\n  private restrictions: Set<() => Promise<boolean>> = new Set();\n\n  constructor(options: RouterOptions) {\n    switch (options.mode) {\n      case '#':\n        // just filter that # mode\n        break;\n      case '?':\n        throw new Error(`${options.mode} is not supported yet!`);\n      default:\n        throw new Error(`${options.mode} is not supported!`);\n    }\n    this.options = OBJ_PROCESSOR.deepFreeze(options);\n\n    window.addEventListener('popstate', async () => {\n      if (window.location.href === this.currRoute) return;\n\n      if (this.restrictions.size > 0) {\n        const wantedRoute = window.location.href;\n\n        if (this.currRoute) {\n          window.location.href = this.currRoute;\n        } else if (this.options.defaultRoot) {\n          window.location.href = `${window.location.host}/${this.options.defaultRoot}`;\n        }\n        const arr = [...this.restrictions.values()];\n        const promises = arr.map(arrow => arrow());\n        const result = await Promise.all(promises);\n        let cancelRouteChange = false;\n\n        if (Array.isArray(result)) {\n          for (let i = 0; i < result.length; i++) {\n            if (typeof result[i] !== 'boolean')\n              throw new Error('restrict func returned not boolean value!');\n\n            if (!result[i]) cancelRouteChange = true;\n            else {\n              const func = arr[i];\n\n              if (func) this.restrictions.delete(func);\n            }\n          }\n        }\n\n        if (!cancelRouteChange) window.location.href = wantedRoute;\n      } else {\n        this.activateWantedAgents();\n      }\n    });\n  }\n\n  activateWantedAgents(addInfo?: unknown): boolean | Error[] {\n    this.currRoute = window.location.href;\n    let activatedCount = 0;\n    const errors = [];\n\n    if (!this.options.onlyDBus && this.options.mode === '#') {\n      const agentsArr = [...this.agents];\n      for (let i = 0; i < this.agents.size; i++) {\n        if (agentsArr[i]?.path === window.location.hash) {\n          try {\n            agentsArr[i]?.callback(addInfo);\n          } catch (error) {\n            error.push(error);\n          }\n          activatedCount++;\n          break;\n        }\n      }\n\n      if (activatedCount === 0) {\n        if (\n          this.defaultAgent &&\n          this.options.defaultRoot === window.location.hash\n        ) {\n          this.defaultAgent.callback(addInfo);\n        } else {\n          errors.push(new Error('Agent is not finded'));\n        }\n      }\n    }\n\n    if (this.txs.size > 0) {\n      this.txs.forEach(tx => {\n        const msg = new DBusMsgRouteIsChangedMsg(window.location.hash, addInfo);\n        tx.transmit({\n          msg,\n          waitMode: DBusTXWaitModes.nowait,\n          prepMode: DBusTXPrepModes.freeze,\n        });\n      });\n    }\n\n    if (errors.length > 0) return errors;\n    return activatedCount > 0;\n  }\n\n  addRouterAgent(agent: SimpleRouterAgent): void {\n    this.agents.add(agent);\n  }\n\n  removeRouterAgent(agent: SimpleRouterAgent): void {\n    this.agents.delete(agent);\n  }\n\n  flushRouterAgents(): void {\n    this.agents.clear();\n  }\n\n  /* not refactored yet\n  private watchRestrictions = async (msg: DataBusRoutingMsg) => {\n    if (msg instanceof DataBusMsgRoutingRoutingRestrictMode) {\n      const func = msg.data.callbackPromiseGenerator as () => Promise<boolean>;\n\n      if (msg.data.mode) {\n        this.restrictions.add(func);\n      } else {\n        this.restrictions.delete(func);\n      }\n    }\n  };\n  */\n\n  connect(int: DBusInterface): void {\n    const tx = int.getNewTX('broadcasting route changes');\n    this.txs.add(tx);\n    // watch restriction\n    // not refactored yet\n    // const rx = bus.getNewRX();\n    // bus.registerReceiver(DataBusMsgTopics.ROUTING, msgReceiver);\n  }\n}\n","import { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\n\nexport type EngineResponse = {\n  velocity: number;\n  distance: number;\n};\n\nclass RestClientEngine {\n  private resUrl = '/engine';\n\n  private fullUrl: string;\n\n  constructor(private baseUrl: string) {\n    this.fullUrl = baseUrl + this.resUrl;\n  }\n\n  toggleEngine(\n    id: number,\n    status: 'started' | 'stopped',\n  ): Promise<EngineResponse> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}?id=${id}&status=${status}`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as EngineResponse))\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  enterDriveMode(id: number): Promise<true | false | 404> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}?id=${id}&status=drive`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          else if (response.status === 500) res(false);\n          else rej(new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT));\n        })\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n}\n\nconst obj = new RestClientEngine('http://127.0.0.1:3000');\n\nconst REST_CLIENT_ENGINE = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_ENGINE };\n","import { RegCarData, UnregCarData } from '../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\nimport { REST_CLIENT_NAMES } from '../rest-clients-names.def';\n\nclass RestClientGarage {\n  protected clientName = REST_CLIENT_NAMES.GARAGE;\n\n  private resUrl = '/garage';\n\n  private fullUrl: string;\n\n  constructor(private baseUrl: string) {\n    this.fullUrl = baseUrl + this.resUrl;\n  }\n\n  getCars(\n    page?: number,\n    limit?: number,\n  ): Promise<{ limit: string; cars: RegCarData[] }> {\n    return new Promise((res, rej) => {\n      const limitStr = limit || '';\n      const url = `${this.fullUrl}?_page=${page}&_limit=${limitStr}`;\n      let limitResponse = '';\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) {\n            limitResponse = response.headers.get('X-Total-Count') as string;\n            return response.json();\n          }\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res({ limit: limitResponse, cars: json as RegCarData[] }))\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  getCar(id: number): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as RegCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  createCar(unregCar: UnregCarData): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      fetch(this.fullUrl, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(unregCar),\n      })\n        .then(response => {\n          if (response.status === 201) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as RegCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  deleteCar(id: number): Promise<true> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'DELETE',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  updateCar(regCar: RegCarData): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${regCar.id}`;\n      const data: UnregCarData = regCar;\n      fetch(url, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data),\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n}\n\nconst obj = new RestClientGarage('http://127.0.0.1:3000');\n\nconst REST_CLIENT_GARAGE = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_GARAGE };\n","import { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\n\nclass RestClientWinnersSortOptions {\n  readonly id = 'id';\n\n  readonly wins = 'wins';\n\n  readonly time = 'time';\n}\n\nconst obj = new RestClientWinnersSortOptions();\n\nconst REST_CLIENT_WINNERS_SORT_OPTIONS = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_WINNERS_SORT_OPTIONS };\n\nexport type RestClientWinnersSortOptionsList =\n  keyof RestClientWinnersSortOptions;\n","import { WinnerCarData } from '../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\nimport { RestClientWinnersSortOptionsList } from './rest-client-winners.def';\n\nclass RestClientWinners {\n  private resUrl = '/winners';\n\n  private fullUrl: string;\n\n  constructor(private baseUrl: string) {\n    this.fullUrl = baseUrl + this.resUrl;\n  }\n\n  getWinners(\n    page = 0,\n    limit?: number,\n    sort?: RestClientWinnersSortOptionsList,\n    order?: 'ASC' | 'DESC',\n  ): Promise<{ limit: string; cars: WinnerCarData[] }> {\n    return new Promise((res, rej) => {\n      const limitStr = limit || '';\n      let url = `${this.fullUrl}?_page=${page}&_limit=${limitStr}`;\n      if (sort) url += `&_sort=${sort}`;\n      if (order) url += `&_order=${order}`;\n      let limitResponse = '';\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) {\n            limitResponse = response.headers.get('X-Total-Count') as string;\n            return response.json();\n          }\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json =>\n          res({ limit: limitResponse, cars: json as WinnerCarData[] }),\n        )\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  getWinner(id: number): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  createWinner(winnerCarData: WinnerCarData): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      fetch(this.fullUrl, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(winnerCarData),\n      })\n        .then(response => {\n          if (response.status === 201) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  deleteWinner(id: number): Promise<true> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'DELETE',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  updateWinner(winnerData: WinnerCarData): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${winnerData.id}`;\n      const data: WinnerCarData = winnerData;\n      fetch(url, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data),\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n}\n\nconst obj = new RestClientWinners('http://127.0.0.1:3000');\n\nconst REST_CLIENT_WINNERS = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_WINNERS };\n","import { OBJ_PROCESSOR } from '../../lib/processors/obj-processor';\n\nconst restClientError = {\n  UNEXPECTED_RESULT: 'UNEXPECTED_RESULT',\n  UNKNOWN_ERROR: 'UNKNOWN_ERROR',\n  NOT_FOUND: 'NOT_FOUND',\n  CONNECTION_REFUSED: 'CONNECTION_REFUSED',\n};\n\nconst REST_CLIENT_ERROR = OBJ_PROCESSOR.deepFreeze(\n  restClientError,\n) as typeof restClientError;\n\nexport { REST_CLIENT_ERROR };\n","import { OBJ_PROCESSOR } from '../../lib/processors/obj-processor';\n\nclass RestClientNames {\n  readonly GARAGE = 'GARAGE';\n\n  readonly WINNERS = 'WINNERS';\n}\n\nconst REST_CLIENT_NAMES = new RestClientNames();\n\nOBJ_PROCESSOR.deepFreeze(REST_CLIENT_NAMES);\n\nexport { REST_CLIENT_NAMES };\n\nexport type RestClientNamesList = keyof RestClientNames;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { App } from './app/app';\n\nwindow.addEventListener('load', () => {\n  const appDiv = document.createElement('div');\n  document.body.append(appDiv);\n  const app = new App(appDiv);\n});\n"],"sourceRoot":""}