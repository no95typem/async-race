{"version":3,"sources":["webpack://async-race/./src/components/garage/garage.scss?dc9e","webpack://async-race/./src/components/garage/subcomps/car/car.scss?1a27","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/create-update.scss?4682","webpack://async-race/./src/components/garage/subcomps/main-controls/main-controls.scss?1eb1","webpack://async-race/./src/components/garage/subcomps/track/track.scss?9419","webpack://async-race/./src/components/header/header.scss?92c0","webpack://async-race/./src/components/popups/fitrst-open/popup-choice-first-open.scss?c499","webpack://async-race/./src/components/popups/popup-list/popup-list.scss?b474","webpack://async-race/./src/components/winners/winners.scss?feec","webpack://async-race/./src/lib/components/popups/standalone/modal/popup-standalone-modal.scss?0629","webpack://async-race/./src/lib/components/popups/standalone/modal/progress/popup-progress.scss?22c3","webpack://async-race/./src/styles/styles.scss?0948","webpack://async-race/./src/lib/components/btn-close/btn-close.svg","webpack://async-race/./src/app/app.ts","webpack://async-race/./src/app/dbus-msgs/reboot-msg.def.ts","webpack://async-race/./src/app/dbus-msgs/reconfigure-req.def.ts","webpack://async-race/./src/components/garage/car-actions.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-action-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-created-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-remove-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-select-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-page-is-changed.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-request-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-status-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-reset-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-reset-req-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-status-msg.def.ts","webpack://async-race/./src/components/garage/garage-controller.ts","webpack://async-race/./src/components/garage/garage-driver.ts","webpack://async-race/./src/components/garage/garage-managers-team.ts","webpack://async-race/./src/components/garage/garage.ts","webpack://async-race/./src/components/garage/race-statuses.def.ts","webpack://async-race/./src/components/garage/subcomps/car/car.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-create.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-proto.def.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-update.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/create-update.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/dbus-msgs/generate-cars-msg.def.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/main-controls.ts","webpack://async-race/./src/components/garage/subcomps/popup-winner/popup-winner.ts","webpack://async-race/./src/components/garage/subcomps/track/track.ts","webpack://async-race/./src/components/header/header.ts","webpack://async-race/./src/components/header/subcomps/nav-item/nav-item.ts","webpack://async-race/./src/components/popups/fitrst-open/popup-choice-first-open.ts","webpack://async-race/./src/components/popups/popup-list/inhereitors/popup-credits/popup-credits.ts","webpack://async-race/./src/components/popups/popup-list/inhereitors/popup-notes/popup-notes.ts","webpack://async-race/./src/components/popups/popup-list/popup-list.ts","webpack://async-race/./src/components/winners/subcomps/winner-entry.ts","webpack://async-race/./src/components/winners/winners.ts","webpack://async-race/./src/definitions/car-random-data.def.ts","webpack://async-race/./src/lib/components/base-comp/base-comp.ts","webpack://async-race/./src/lib/components/btn-close/btn-close.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/404/popup-404.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/choice/popup-choice.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/popup-standalone-modal.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/progress/popup-progress.ts","webpack://async-race/./src/lib/components/popups/standalone/popup-standalone.ts","webpack://async-race/./src/lib/convertors/colors.ts","webpack://async-race/./src/lib/generators/generators.ts","webpack://async-race/./src/lib/gui/animation.ts","webpack://async-race/./src/lib/interfaces/notifiable.ts","webpack://async-race/./src/lib/processors/obj-processor.ts","webpack://async-race/./src/lib/services/dbus/dbus.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-common-responses.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-errors.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-hub-names.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-interface.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-rx/dbus-rx.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-topics.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-data-headers.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-data.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx.def.ts","webpack://async-race/./src/lib/services/dbus/defs/msgs/dbus-msg.def.ts","webpack://async-race/./src/lib/services/pager/pager.ts","webpack://async-race/./src/lib/services/simple-router/dbus-msgs-defs/dbus-msg-routing-msg.def.ts","webpack://async-race/./src/lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg.ts","webpack://async-race/./src/lib/services/simple-router/dbus-msgs-defs/types/router-status-msg.def.ts","webpack://async-race/./src/lib/services/simple-router/dbus-msgs-defs/types/routing-restrict-msg.def.ts","webpack://async-race/./src/lib/services/simple-router/simple-router-agent.ts","webpack://async-race/./src/lib/services/simple-router/simple-router.ts","webpack://async-race/./src/services/rest-clients/client-engine/rest-client-engine.ts","webpack://async-race/./src/services/rest-clients/client-garage/rest-client-garage.ts","webpack://async-race/./src/services/rest-clients/client-winners/rest-client-winners.def.ts","webpack://async-race/./src/services/rest-clients/client-winners/rest-client-winners.ts","webpack://async-race/./src/services/rest-clients/rest-client.ts","webpack://async-race/./src/services/rest-clients/rest-clients-errors.def.ts","webpack://async-race/webpack/bootstrap","webpack://async-race/webpack/runtime/define property getters","webpack://async-race/webpack/runtime/hasOwnProperty shorthand","webpack://async-race/webpack/runtime/make namespace object","webpack://async-race/./src/entry.ts"],"names":["module","exports","App","rootElement","hubName","DBUS_HUB_NAMES","APP","TEXT_CONTENT","TEXT_CONTENT_ENG","loadedMainComponents","defaultRouterAgent","SimpleRouterAgent","this","loadMainComponent","router","SimpleRouter","mode","defaultRoot","defaultAgent","mainlineDBus","DBus","rebootMsg","DBusMsgRebootMsg","emergencyHandlerIsWorking","popup404","PopupStandaloneModal404Comp","welcomePopup","PopupStandaloneModalChoiceFirstOpenComp","toggleGlitch","document","cookie","includes","GLITCH_COOKIE","ENABLED","body","classList","remove","add","sendRebootMsg","tx","transmit","msg","prepMode","DBusTXPrepModes","freeze","waitMode","DBusTXWaitModes","allSetled","rxFuncForAppCtl","async","data","DBusMsgAppCtlReconfureReqMsg","checkFirstOpen","DBUS_COMMON_RESPONSES","VOID","watchRouterMsgs","DBusMsgRouteIsChangedMsg","newRoute","setupEmergencyHandler","app","setTextContent","setText","POPUPS","POPUP404","TEXT","header","HeaderComponent","HEADER","append","attachHub","activateWantedAgents","force","OPENED_COOKIE","recharge","awaitDesicion","DISABLED","hide","window","addEventListener","e","preventDefault","promise","catch","error","message","REST_CLIENT_ERROR","CONNECTION_REFUSED","show","retry","REST_CLIENT_GARAGE","getCars","Promise","res","setTimeout","int","rxRouting","getNewRX","plugRX","DBusTopics","ROUTING","rxAppCtl","APP_CTL","getNewTX","name","GarageComp","WinnersComp","location","hash","newComponent","currMainComponent","isDBusHub","isNotifiable","notify","DBusMsg","signal","rxIds","prefResponseRxIds","super","CarActions","DBusMsgCarActionMsg","action","CAR_ACTION","DBusMsgCarActionCreatedMsg","car","CREATED","DBusMsgCarActionRemovedMsg","nullifiedContract","REMOVED","DBusMsgCarActionSelectedMsg","notifyChanges","SELECTED","DBusMsgGarageMsg","GARAGE","DBusMsgGaragePageIsChangedMsg","DBusMsgGarageRaceMsg","DBusMsgRaceRequestMsg","DBusMsgGarageRaceStatusMsg","status","DBusMsgGarageResetMsg","DBusMsgGarageResetReqMsg","DBusMsgGarageStatusMsg","GarageCompCtlAkaDirector","tracksContainer","carCtlsBlock","GARAGE_CONTROLLER","txs","Set","entriesPerPage","pagerContainer","createElement","ctlBlocks","pagerCallback","dir","resetState","reloadData","appCtlRXFunc","generatorRXFunc","DBusMsgGenerateCarsMsg","racingRXFunc","pager","toogleLock","result","performRace","carCtlsBlockBlockListener","stopPropagation","routingRestrainFunc","carActionsRXFunc","racePromise","garageManagersTeam","handleCarRm","finally","tryChangePage","createCarCtlBlock","index","btns","btnSelect","btnStart","btnReset","btnRm","forEach","btn","numberSpan","textContent","toString","container","connectCtlAndTrack","ctlElem","track","illuminateSelf","GarageManagersTeam","lockCallback","Pager","setupPager","btnNextPage","getBtnNextPage","btnPrevPage","getBtnPrevPage","pagerInfo","getPagerSpan","redraw","autoConnect","carActionsMsgsRX","raceMsgsRX","generatorMsgsRX","GENERATE","appCtlMsgsRX","restrainFunc","toggleRoutingRestrains","rej","toggleCtlsBlockDisabled","then","state","capture","block","style","setProperty","length","removeEventListener","removeProperty","DBusMsgRoutingRestrainMsg","transmissions","x","push","allSettled","undefined","page","getCurrPageNumber","getEntriesPerPage","response","limit","cars","setEntriesCount","Number","parseInt","broadcastPaging","nullifyContracts","newContracts","TrackComp","carComp","CarComp","placeCar","addContracts","nowait","clearDOM","geometry","calcGeometry","setStylesForTracks","drawTracks","drawCarsCtls","firstChild","getComputedStyle","containerHeight","parseFloat","height","paddingBottom","paddingTop","firstAutoHeight","Math","min","innerWidth","CAR_WIDTH_RATIO","CAR_MAX_WIDTH","CAR_IMG_RATIO","heights","heightSum","contracts","getContracts","contract","factor","SCALE_FACTOR","carTrackHeight","excessHeight","heightsReversed","sort","a","b","displacementBase","size","SKIPPED_PROGRESSION_MEMBERS_COUNT","displacements","midIndex","displacement","DISPLACEMENT_FIX","paddingBase","paddingShift","PADDING_SHIFT_BASE","PADDING_SHIFT_BASE_VW","trackHeights","map","playFirstIntroAnim","GarageDriverCommands","GarageDriver","emergencyAwaitServer","timeInMS","delayInMS","resPromise","popup","PopupStandaloneModalProgressComp","setProgress","startTime","Date","now","interval","IamResolved","resFunc","clearInterval","setInterval","elapsedTime","progress","Error","flags","disableCtls","thisDriveId","genUniqId","currDriveId","ignitionPromise","TurnOnTheIgnition","driveParams","drivePromise","drive","toggleIgniteAnim","REST_CLIENT_ENGINE","toggleEngine","currCar","id","stopCar","rollBack","msgBlock","createMsgBlock","updateProgress","playAwaitingAnim","clearTimeout","lastTimeInMs","lastStart","driveId","time","calculateDriveTime","enterDriveMode","success","processSuccessfullDriveReslut","controlCarAnim","rollForward","playbackRate","onlyAnim","rollover","broken","stop","params","distance","velocity","directorLockCb","freeDrivers","busyDrivers","Map","movingDrivers","winnerPopup","GaragePopupWinner","carCtlsClickListener","target","HTMLElement","elem","HTMLButtonElement","parentElement","disabled","currRaceId","handleRemoving","startDriving","handleRestoreState","handleSelection","handleWinner","raceData","isFinishVisible","duration","getTransitionDuration","awaitTime","isRoadMoves","raceId","winnerCar","saveWinner","setData","toFixed","get","getOutOfTheCar","tryFreeDrivers","delete","clear","—Åontracts","newContract","prepareForRace","rollbackCars","broadcastGarageStatus","broadcastRaceStatus","driver","returnToStart","broadcastIfAllInStart","every","isInStartPosition","choosedDriver","find","isFree","set","putBehindTheWheel","performDrivingProtocol","deleteCar","REST_CLIENT_WINNERS","deleteWinner","genSelectCallback","rollbackPromise","rollbacks","all","RACE_STATUSES","RACE_REJECTED","thisRaceId","RACE_INTERRUPTED","arrivedByOrder","notArrived","participantsCount","roadElem","stratedCount","processRace","NEED_RESET","handleDriveResult","getWinner","winnerRecord","updatedWinnerData","wins","updateWinner","NOT_FOUND","newWinnerData","createWinner","has","updateData","BaseComp","isControllerWorking","mainControlsComp","MainControlsComp","carsCtlsBlock","bgVideo","bgVideoProgressListener","buffered","end","bgVideoCanPlayListener","reset","controller","startWorking","play","_rootElement","garage","selfCtlsBlock","bg","garage__bg","setupBgVideo","renderBgVideo","controls","loop","defaultMuted","muted","autoplay","src","attachSubHub","obj","READY_TO_GO","IN_PROCESS","OBJ_PROCESSOR","deepFreeze","_currCar","canvas","tireBack","btnSelect$","btnRm$","spanCarName$","btnStart$","btnReset$","isReseted","movingClassName","observerFunc","mutations","mutation","oldValue","currOutOfSceneAnim","pause","observer","disconnect","contains","outOfScene","calcDestinationInPercents","computedStyles","rootWidth","parentStyle","width","paddingLeft","paddingRight","selfWidth","selfStyle","renderBtns","renderCar","MutationObserver","drawCar","color","drawWheels","selectSpan","rmSpan","startSpan","resetSpan","rootElem","wheelImg","Image","CAR_WHEEL_IMG_SRC","onload","backwardWheelImg","deepClone","carData","finishPromise","resolve","playOutAnim","cancel","commitStyles","currAnimation","finished","playInAnim","asyncFunc","animOut","animate","opacity","easing","fill","promiseToAwait","animIn","iterations","POSITIVE_INFINITY","filter","transform","handleBtns","getStyles","coordinateInPercents","onfinish","oncancel","playState","observe","attributes","attributeOldValue","playExplosionAnim","img","frameNumber","CAR_EXPLOSION_IMG_DATA","BASE_URL","EXTENSION","FRAME_TIME_MS","FRAMES_COUNT","hexColor","CAR_BODY_IMG_SRC","ctx","getContext","shadowColor","shadowBlur","drawImage","paintCarBody","imageData","getImageData","rgb","hexToRgb","j","i","red","green","blue","blueDiff","blueDiffThreshold","threshold","r","g","putImageData","TIMING_FUNCTION","CreateCompController","CreateUpdateCompControllerProto","elements","inputText","inputColor","setupBtnCreate","reportValidity","unregCar","value","createCar","clone","ctlsStateMap","ctls","valid","setCustomValidity","pattern","removeAttribute","ctl","pushCtlsState","toogleCtlsDisabled","popCtlsState","UpdateCompController","garageMsgsListener","carActionsListener","choosedCar","notifyCb","setupBtnUpdate","rxCarActions","rxGarage","updateCar","CreateUpdateComponent","type","btnText","CREATE_UPDATE","textInput","colorInput","root","MAIN_CONTROLS","createComponent","updateComponent","btnRace","btnGenerate","generateClickListener","transmission","generate","genCb","resolveMsg","btnRaceClickListener","btnResetClickListener","genRandomCarName","manufacturerNumber","getRandomInt","CAR_MODEL_LIST_KEYS","manufacturerName","models","CAR_MODEL_LIST","rxFuncForRaceMsgs","getController","enable","disable","rxFuncForGarageMsgs","btnsBlock","span","btnBlock","total","left","cb","genLeft","unregCarData","genRandomHexColor","rx","rx2","textTime","textName","textId","textNumber","timeStr","indexStr","topBlock","illuminate","track_illuminated","hasChildNodes","childNodes","child","spanCarName","buses","illuminateNavItem","anchors","anchor","getAttribute","DBusMsgRoutingStatusMsg","navContainer","logo","renderLogo","ul","li","svg","navItems","NavItem","item","header__logo","firstSpan","dataset","secondSpan","illuminateRX","text","href","styles","iconSrc","_anchor","setAttribute","iconImage","PopupStandaloneModalChoiceComp","renderText","enableBtn","outerSpan","innerSpan","glitch","disableBtn","mapBtnsAndChoices","desicion","PopupStandaloneModalListCredits","PopupStandaloneModalList","P1","OL","LI1","LI2","LI3","LI4","LI5","LI6","LI7","CAPTION","PopupStandaloneModalListNotes","PopupStandaloneModalComp","list","btnOk","btnCloseContainer","caption","renderList","renderCloseBtns","setupCloseActions","renderOtherThings","btnCloseComp","BtnClose","btnOkOuterSpan","btnOkInnerSpan","liArray","Object","values","liItem","anchorElem","ol","hideSmoothly","key","WinnerRowComp","winnerData","indexElem","idElem","carPreviewBox","nameElem","winsElem","bestTimeElem","carPreview","genPreview","WINNERS","table","tableBody","tableHead","thId","thCar","thName","thWins","thBestTime","pagerBtnsContainer","currOrder","currSort","bottomBtnsContainer","btnReconfigureGlitch","btnNotes","btnCredits","popupNotes","popupCredits","getNewImgReadResponse","Response","ReadableStream","headers","close","reader","getReader","totalBytes","loadedBytes","readMore","read","val","byteLength","enqueue","done","createBtnWithTwoSpans","btnOuterSpan","btnInnerSpan","tableHeadClickListener","REST_CLIENT_WINNERS_SORT_OPTIONS","refreshTableHeader","currSortedElem","pagerSpan","start","loadBg","renderPager","renderTable","renderBottomBtnsContainer","setupBottomBtnsActions","winners","currBGInfo","randomIndex","BG_SRCS","bgInfo","getRandomBGInfo","fetch","blob","showSmoothly","btnReconfigureGlitchObj","renderTableHeader","tr","thIndex","getWinners","redrawWinners","pageNumber","rows","Array","promises","indexInc","winner","getCar","totalIndex","row","getCarPreview","Lamborghini","Ferrari","Koenigsegg","Porsche","Jaguar","Maserati","McLaren","Spyker","keys","tag","image","choicePromise","resolveFunc","control","PopupStandaloneComp","closeArea","anim","barContainer","bar","setHeader","hex","c","test","split","slice","arr","Uint8Array","crypto","getRandomValues","join","max","floor","random","prop","transPropArr","getPropertyValue","replace","propIndex","lastIndexOf","transformAndAutoresolve","delay","forceAutoresolveIn","valToWait","eventHandler","propertyName","transformAndWaitEvent","object","record","isFrozen","isArray","v","n","cloneNode","Blob","k","setPrototypeOf","getPrototypeOf","network","idCounter","rxs","createdRXs","createdTXs","attachedHubs","occupiedNames","callRXFunc","clonedData","func","handleClone","freezedData","handleFreeze","DBUS_ERRORS","UNEXPECTED_PREP_MODE","busId","hub","suffix","createInterfaceForHub","prefix","HUB_IS_ALREADY_ATTACHED","HUB_NAME_NOT_AUTHORIZED","HUB_NAME_IS_OCCUPIED","dbusInterface","DBusInterface","desc","genNewRX","topic","unplugRX","subHub","subSuffix","connect","regNumber","DBusTX","opts","head","DBusTXDataHeaders","DBusTXData","freezedTX","DBusRX","freezedRX","XENO_RX","TOPIC_IS_NOT_EXIST","TOPIC_HAS_NO_RXS","choosedRXs","PREF_RXS_ARE_NOT_EXIST","manual","BAD_REQUEST","ROUTER","objAsRecord","arrowedGetNewTX","arrowedGetNewRX","arrowedPlugRX","arrowedUnplugRX","RXs","TXs","RXsPlugMap","txId","txRegNumber","txDesc","listCallback","firstPageNumber","currPageNumber","lastPageNumber","entriesCount","callbackIsCalled","btnNextSpan","btnPrevSpan","callCallback","lock","toggleBtnsDisabled","ceil","updateSpanText","pageIsChanged","DBusMsgRoutingMsg","addInfo","callback","path","getStateCallback","setStateCallback","options","agents","restrains","watchRestrictions","broadcastRoutingStatus","currRoute","wantedRoute","host","arrow","cancelRouteChange","activatedCount","errors","onlyDBus","agentsArr","agent","RestClientEngine","RestClient","baseUrl","url","fullUrl","method","json","UNEXPECTED_RESULT","handleError","RestClientGarage","limitStr","limitResponse","JSON","stringify","regCar","RestClientWinners","order","winnerCarData","resUrl","rejFunc","UNKNOWN_ERROR","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call","d","definition","o","defineProperty","enumerable","prototype","hasOwnProperty","Symbol","toStringTag","appDiv"],"mappings":"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BA0IMpD,EAAiB,EAAArK,cAAcC,WAxItB,CACb0V,YAAa,CACX,aACA,SACA,SACA,cACA,gBACA,OACA,aACA,UACA,SACA,iBACA,YACA,WACA,WACA,SACA,QACA,QACA,aACA,WACA,SACA,SACA,SACA,SACA,SAEF,eAAgB,CACd,cACA,WACA,MACA,kBACA,WACA,wBACA,aACA,SACA,sBACA,aAEFC,QAAS,CACP,OACA,YACA,UACA,eACA,aACA,oBACA,WACA,SACA,aACA,UAEFC,WAAY,CACV,gBACA,QACA,cACA,WACA,UACA,UACA,SACA,WACA,QACA,QAEFC,QAAS,CACP,aACA,cACA,QACA,SACA,WACA,aACA,UACA,MACA,MACA,cAEFC,OAAQ,CACN,SACA,kBACA,kBACA,KACA,KACA,KACA,KACA,KACA,SACA,UAEFC,SAAU,CACR,UACA,UACA,OACA,SACA,QACA,OACA,SACA,YACA,gBACA,WAEF,gBAAiB,CACf,SACA,UACA,cACA,OACA,OACA,OACA,OACA,OACA,OACA,QAEFC,QAAS,CACP,SACA,OACA,YACA,KACA,QACA,OACA,OACA,QACA,OACA,MAEFC,OAAQ,CACN,gBACA,YACA,sBACA,wBACA,oBACA,MACA,aACA,aACA,sBACA,mBAMK,EAAA7L,iBAET,MAAMH,EAAsB,EAAAlK,cAAcC,WACxCiQ,OAAOiG,KAAK9L,IAGL,EAAAH,uB,6FClJT,iBAGE,YAAYkM,EAAmC,OAC7CvyB,KAAKkb,aAAeja,SAASwH,cAAc8pB,GAG7C,kBACE,OAAOvyB,KAAKkb,gB,yLCRhB,gBACA,aAEA,MAAa+Q,UAAiB,EAAA7R,SAC5B,cACE3T,MAAM,OACN,MAAM+rB,EAAQ,IAAI1T,MAClB0T,EAAM1W,IAAM,UACZ9b,KAAKkb,aAAa1X,OAAOgvB,IAL7B,c,4MCHA,gBAEA,aAEA,MAAa3xB,UAAoC,EAAA0qB,yBAC/C,cACE9kB,QACAzG,KAAKqD,OAAOqH,YAAc,aAC1B1K,KAAKqD,OAAOkmB,QAAQ7e,YAAc1K,KAAKqD,OAAOqH,YAC9C1K,KAAKqD,OAAO9B,UAAUE,IAA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","file":"main.bccb1aab0c8338aabe6a.js","sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"garage\":\"_21SC4SGf5mTamWfNdNRR\",\"intro\":\"_1_6B8epjerqfM9sjWaJS0B\",\"garage__bg\":\"_2VnbeeG4HKnZfSWUedizHh\",\"garage__track-container\":\"_1rsPT6UvHnbHI-FUFvPaSe\",\"hue-rotate\":\"_3MSD3skhU7RLqKdx6pBax7\",\"garage__track-container_finish\":\"_1khEfVJzcbQlBMhoHPdhzY\",\"garage__winner-popup\":\"_17InT8lGlAlk8k1JRcrTCM\",\"garage-bg\":\"-BA3r_cxZwAYkgGQVVZeo\",\"garage-bg__video\":\"_3byu86MCf3s6B7JQuetNAw\",\"garage-bg__car-ctl-btn\":\"_3upDU-ngLjybmFg4wiVvfl\",\"garage-bg__car-ctl-block-number\":\"_3dT19pzigDW1UKuPVLEguq\",\"garage-bg__car-ctl-block\":\"_2e0Ox8Joh0jw60ztR_rVt5\",\"garage-bg__cars-ctls-block\":\"wMVLCRcoluFnZleBHWXlm\",\"garage-bg__self-ctls-block\":\"_2VQVmkB2amN4PG9XCyFye9\",\"garage-bg__pager\":\"_2avafWgl8XDS2KLJswKq0H\",\"garage-bg__pager-span\":\"_3ktlpozBQghco3VMHLJBo1\",\"garage-bg__pager-btn\":\"_2QdjLaEnj3Balh89eZAya4\",\"synthwave-background\":\"_2pUKJme_w_0KTS_JoVNV5b\",\"synthwave-background_race-mode\":\"n1z9UH35nfilmkK2lmQvV\",\"race\":\"_375ItX4gjZY-ZT7KrEfBgG\",\"move-grid\":\"_1MqERRNbzZtvdd9iE43L04\"};","// extracted by mini-css-extract-plugin\nexport default {\"car-div\":\"_3pRKwGaRv59JcJqlApAnkk\",\"car-div__canvas\":\"rH6_OMXna8-zeemMHF11D\",\"car-div__wheel\":\"_3WNDl-LGGtViqzAfLLX4CB\",\"car-div__wheel_forward\":\"_3Rdh32fs7fi-95LcabV_Ed\",\"car-div__wheel_backward\":\"_3xptMXOOFn6YcMVYMigRMa\",\"car-div__explosion\":\"_3w8-mlW0m2zLABohqiDQ3e\",\"car-div_ignite\":\"_3gEkh_UHPsV03BNqNGmyBe\",\"car-div_borken\":\"UxI1dTvw1TMcYTYZRUsCf\",\"car-div_rollForward\":\"_3xWmq3Q2UpNiq2nICrGAIN\",\"car-div-anim\":\"_381V-1xCMVwSdGT0FxnQiO\",\"hue-rotate-360\":\"_2xfuDYbUjW8QtSLtmjzC7b\",\"tire-anim\":\"_2Qs9DAZPIqZivw_0ON2Vot\",\"glitch-animation-1\":\"_18DmdiFkNll__X_lkGV0vb\",\"glitch-animation-2\":\"_3dfetHNRAa7hXqdHw76Uur\",\"glitch-animation-3-xy\":\"qr9kE_7wWzjw836QOZH4l\",\"glitch-animation-4-xy\":\"bBFhOAPzr7ZHO1gMz8m2a\",\"hue-rotate-90\":\"_3V692dxTWP4I0NCS1rUiMn\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"_2uo9WXSTJyDD3jBlT_quev\",\"text-input\":\"_2YNdYEaErpy02Ske_bZONx\",\"color-input\":\"_3Ye7rbfoBnq4HZn4H-yDB8\"};","// extracted by mini-css-extract-plugin\nexport default {\"main-controls\":\"_2b_svto1O0DGSO3_579_Xj\",\"btn-block\":\"_262VSHreYXfZUHLGeCJEvZ\"};","// extracted by mini-css-extract-plugin\nexport default {\"track\":\"_2hDrLwwwZMiv2NrI-XZZqJ\",\"track_illuminated\":\"_3zXlLAoKpXJ_jlpauHLjHR\",\"track__controls-block\":\"_3pqcODoHFqX9rxmLKBnhD4\"};","// extracted by mini-css-extract-plugin\nexport default {\"header\":\"_3TTTWNe5aoHesw4iV0YUGU\",\"header__logo\":\"_2idUQTZia_1M_0xkhMkXf8\",\"glitch-animation-1\":\"_15gesIXTXGxm1uBGCwmmqp\",\"glitch-animation-2\":\"s3dyJTG8fG5lknNowsTqO\",\"header-nav\":\"_7vejZGT8OzUejTiWyGs1P\",\"header-nav__item\":\"_1NYwlHRXmh2YGu63soBsjx\",\"header-nav__anchor\":\"_2n39qEg5Iz5Tym2Z0Jrjz9\",\"header-nav__anchor_active\":\"_2bRvd3RlExbbSpyXLuxSdS\",\"header-nav_not-active\":\"_3gNs_UBLjSUG-Bq-Vf2T67\",\"glitch-animation-3-xy\":\"_3uLEqFHW9zkb7hCp_s1nFC\",\"header-nav__svg\":\"_2FCXcgNK7Jgl9f3ZK-O56I\",\"header-nav__span\":\"_1NVrpdaSQLvqho4VNqQqit\",\"header-nav__list\":\"_1vy8OijKt-Cy7SGXyM4ek9\",\"header-nav__list_disabled\":\"_25SilQm6mkAlbl-WpajKBY\",\"glitch-animation-4-xy\":\"_1oG3arGYS7T4HAPVRP9NtY\",\"hue-rotate-90\":\"_3ejf9WYQ_keT8RXiF6nTIR\",\"hue-rotate-360\":\"_7lIM2sgFifv2jKmceFM04\"};","// extracted by mini-css-extract-plugin\nexport default {\"body\":\"_3tVLnvk3q7kf60N7EfAsgP\",\"btn-block\":\"_1jkUqwfJwBTeZA_PwMXeCg\",\"btn\":\"_2bwmpgTrhG5WrJx-0mrkhx\",\"glitch-parent\":\"_2smmCfANEjhtt4BzpG_sLO\",\"glitch\":\"_3ekpIOxutzsrjgHi6vaoRD\",\"glitch-animation-3-xy\":\"VB0xzvIXCf2IHNQxhbOz8\",\"glitch-animation-1\":\"_9Kfwb6iucSGuo9YCmWXdk\",\"glitch-animation-2\":\"_3dHLnmaxXP_FHzxB_NlAdr\",\"glitch-animation-4-xy\":\"_2DypaqsNhdjJQN1C2baR7W\",\"hue-rotate-90\":\"_2rKbfZQT8JgPGaWisOZtuc\",\"hue-rotate-360\":\"_3pGjJdHvp_pWzeUh0WTbEO\"};","// extracted by mini-css-extract-plugin\nexport default {\"body\":\"_1HdHF-02knc5SKDPjQ6D2-\",\"ol\":\"eAvfZ_Z8yQCULeXIjq3-G\",\"btn-close\":\"GNY0R7d-Ad5AS2UOZ7yps\",\"rotate360\":\"_3gtxvh81CAFXLzkaUGlfKh\",\"btn-close-container\":\"jItdRkRWCFtbNhv5xpdUC\",\"hue-rotate-360\":\"_2hz6JNRu4bvDfPbTnBQ5V2\",\"btn-ok\":\"_14IPB-YWgyQRP3qstS_Ade\",\"btn-ok__innerSpan\":\"_1_FQyYyG2Fwqho6LSJWbZ-\",\"glitch-animation-1\":\"_1j1k5OCsoD8-WtIGxQqUln\",\"glitch-animation-2\":\"J-GZe1o1bK_Q2fKIxIW9s\",\"glitch-animation-3-xy\":\"_3FKHYtzhv7_wotaeIY_jom\",\"glitch-animation-4-xy\":\"_3Gvn6xqDi0qGQHXbItP29f\",\"hue-rotate-90\":\"_1oo2FQqnFJI_g2nEdnhjC0\"};","// extracted by mini-css-extract-plugin\nexport default {\"winners\":\"HVDfoBgyIQ4teF5EKFzcD\",\"intro\":\"yZnUjHL-jkdakQQFCkqyq\",\"table\":\"_3mJKnd573Tt4WspNl7gf1J\",\"table__car-preview-box\":\"_86kcZK8UgXIsvYD-wpDED\",\"table__can-be-sorted\":\"_3Xa74hpyx3g6XUuZ9fB9Cm\",\"table__sorted-elem\":\"rfPuVNCW0Sd4nzQGO8-R8\",\"table__sorted-elem_asc\":\"N6296gY2c5AFEX4KjE4I4\",\"table__sorted-elem_desc\":\"_37bMOUs2OF28ZqMubJCPnM\",\"pager\":\"_2q-noyJbwIpKOMhl7AWlq5\",\"pager-span\":\"_1O8erRuDz9RWa3C9tqnUm-\",\"pager-btn\":\"_3OktYstRgXgDE6zlpOM6LA\",\"bottom-btns-container\":\"_3W15tscjdKQtes2IFf9GuC\",\"btn-glitch\":\"XFsunLW_IkuzOAT8jcND0\",\"btn-glitch__innerSpan\":\"_3MAkYSGRBaTwkvxCSVha72\",\"glitch-animation-1\":\"d3lBrA2HIOudPajPuC6Qc\",\"glitch-animation-2\":\"_268kxyhSlSSFPnx4Ajj8N3\",\"glitch-animation-3-xy\":\"_1WbYKA4KBGh4V1OT5dXIsS\",\"glitch-animation-4-xy\":\"Bqga7NnAzaDXnFYuV6T8R\",\"hue-rotate-90\":\"vj-f94Y0-qyHt_tBW9aAH\",\"hue-rotate-360\":\"_345l5rRWgIZ1hnilXXB-Pz\"};","// extracted by mini-css-extract-plugin\nexport default {\"popup-modal\":\"_3KlZOyoPt2P4FT1Ofdi1oz\",\"popup-bg\":\"_1QGzfQYEHvrYonFptRzkG6\",\"popup-body\":\"_3zDyJwNy615xogiYvCl4vt\",\"popup-body-header\":\"_2DglTs5KJlA1QJriRI6bVZ\",\"popup-body-text\":\"_2oMxBL_Jv1KW3bHu3sVdaA\",\"popup-body__btn-close\":\"HV1Imp7Np5N8O5nUXwQsS\"};","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"_1KBIW4BNGKHwQtRcKc6JIF\",\"hue-rotate\":\"_1t6lrd-wEBCB6ei-o9kDmk\",\"bar\":\"_2DWg3PnmWwM25SBd7sLJQK\",\"body\":\"_24wm1l_qZHsMTx2Oy-enF4\",\"text\":\"_1UFV3thankQQ1R2Ly1Zle2\"};","// extracted by mini-css-extract-plugin\nexport default {\"no-glitch\":\"_3jhfNB0kF108EhynXnwXt4\",\"app\":\"_2GlW9kbzGCCom4UEGnZpRF\",\"main-component\":\"GLMZ5rIXl-xoQfoZneWIs\",\"btn\":\"a_2w3d8M_c1utyjkPDogH\",\"btn-1\":\"_27iqs8X5NFef8-ZpiL_u3n\",\"btn-4\":\"_3exd3hkMJO4xoKflZ4jI0K\",\"btn-6\":\"vg6GhvI_oAd82g2nOcNB6\",\"btn-9\":\"_3mEdzCA2cTh_gbEuZrEqkT\",\"btn-13\":\"_1CI8MrNcZ0Zzun_fhIJH2p\",\"btn-15\":\"_1c4rHdMAWRFc5xA3fFj1Kh\",\"glitched-text\":\"_2WhQAYnvrw5r57jsvwHEcW\",\"glitch-animation-1\":\"_3SsWJY5j_rpKm4wbE1jggd\",\"glitch-animation-2\":\"_2T9jhQKkqS5XqoaN2hOjdC\",\"glitched-item\":\"_3ehw9TJADVx0W9b4WfYGWs\",\"glitch-animation-3-xy\":\"_3cq3m6zsAObFT1W9drsRbr\",\"glitch-animation-4-xy\":\"_2az41XGPhMc3_U4DsjhHiR\",\"hue-rotate-90\":\"_2KOyboeT9ymliFqM8Het0d\",\"hue-rotate-360\":\"_1eInkycuomIYicyYM2UGnf\"};","module.exports = \"data:image/svg+xml,%3csvg viewBox='0 0 30 30' xmlns='http://www.w3.org/2000/svg'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M29.5599 2.56066C30.1457 1.97487 30.1457 1.02512 29.5599 0.439337C28.9741 -0.146448 28.0243 -0.146445 27.4386 0.439343L14.9997 12.8783L2.56112 0.439648C1.97534 -0.14614 1.02559 -0.146143 0.4398 0.439642C-0.145987 1.02543 -0.14599 1.97517 0.439795 2.56096L12.8784 14.9996L0.439337 27.4387C-0.146448 28.0245 -0.146445 28.9743 0.439343 29.56C1.02513 30.1458 1.97488 30.1458 2.56066 29.56L14.9997 17.1209L27.439 29.5603C28.0248 30.1461 28.9745 30.1461 29.5603 29.5604C30.1461 28.9746 30.1461 28.0248 29.5603 27.439L17.121 14.9996L29.5599 2.56066Z'/%3e %3c/svg%3e\"","import { BaseComp } from '../lib/components/base-comp/base-comp';\nimport { SimpleRouterAgent } from '../lib/services/simple-router/simple-router-agent';\nimport { SimpleRouter } from '../lib/services/simple-router/simple-router';\nimport { DBus } from '../lib/services/dbus/dbus';\nimport { DBusMsgRouteIsChangedMsg } from '../lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport { DBusTopics } from '../lib/services/dbus/defs/dbus-topics.def';\nimport { DBUS_COMMON_RESPONSES } from '../lib/services/dbus/defs/dbus-common-responses.def';\nimport { HeaderComponent } from '../components/header/header';\n\nimport { DBusTXData } from '../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { GarageComp } from '../components/garage/garage';\nimport {\n  DBusHub,\n  isDBusHub,\n  DBusInterface,\n} from '../lib/services/dbus/defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from '../lib/services/dbus/defs/dbus-hub-names.def';\nimport { WinnersComp } from '../components/winners/winners';\nimport { REST_CLIENT_ERROR } from '../services/rest-clients/rest-clients-errors.def';\nimport { isNotifiable } from '../lib/interfaces/notifiable';\nimport { PopupStandaloneModal404Comp } from '../lib/components/popups/standalone/modal/404/popup-404';\nimport { REST_CLIENT_GARAGE } from '../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgRebootMsg } from './dbus-msgs/reboot-msg.def';\nimport { DBusTX } from '../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusMsgAppCtlReconfureReqMsg } from './dbus-msgs/reconfigure-req.def';\nimport {\n  FirstOpenDesicions,\n  PopupStandaloneModalChoiceFirstOpenComp,\n} from '../components/popups/fitrst-open/popup-choice-first-open';\n\nimport styles from '../styles/styles.scss';\n\nexport class App implements DBusHub {\n  static readonly TEXT_CONTENT_ENG = {\n    POPUPS: {\n      POPUP404: {\n        TEXT: `No connection! Check that the server is online\n        and nothing is blocking the connection!`,\n      },\n    },\n  };\n\n  static readonly OPENED_COOKIE = 'no95typem-async-race=opened';\n\n  static readonly GLITCH_COOKIE = {\n    ENABLED: 'no95typem-async-race-glitch=enabled',\n    DISABLED: 'no95typem-async-race-glitch=disabled',\n  };\n\n  readonly hubName = DBUS_HUB_NAMES.APP;\n\n  protected TEXT_CONTENT = App.TEXT_CONTENT_ENG;\n\n  protected loadedMainComponents: Record<string, BaseComp> = {};\n\n  protected currMainComponent: BaseComp | undefined;\n\n  protected defaultRouterAgent = new SimpleRouterAgent('hash', '', () =>\n    this.loadMainComponent('default'),\n  );\n\n  protected router = new SimpleRouter({\n    mode: '#',\n    defaultRoot: '',\n    defaultAgent: this.defaultRouterAgent,\n  });\n\n  protected mainlineDBus = new DBus();\n\n  protected tx: DBusTX | undefined;\n\n  protected rebootMsg = new DBusMsgRebootMsg('reboot');\n\n  protected emergencyHandlerIsWorking = false;\n\n  protected popup404 = new PopupStandaloneModal404Comp();\n\n  protected welcomePopup = new PopupStandaloneModalChoiceFirstOpenComp();\n\n  // * good\n  constructor(private readonly rootElement: HTMLElement) {\n    this.setupEmergencyHandler();\n\n    this.rootElement.classList.add(styles.app);\n\n    this.setTextContent();\n  }\n\n  // * good\n  // !!! MAKE IT BASECOMP PROP IN NEXT PROJECT\n  setTextContent(): void {\n    this.popup404.setText(this.TEXT_CONTENT.POPUPS.POPUP404.TEXT);\n  }\n\n  // * good\n  async start(): Promise<void> {\n    await this.checkFirstOpen();\n\n    const header = new HeaderComponent(DBUS_HUB_NAMES.HEADER);\n    this.rootElement.append(header.rootElement);\n\n    this.mainlineDBus.attachHub(this);\n    this.mainlineDBus.attachHub(header);\n    this.mainlineDBus.attachHub(this.router);\n    this.router.activateWantedAgents();\n  }\n\n  // !!! IN NEXT PROJ MAKE APP A POPUP HANDLER VIA DBUS AND ATTACH POPUPS TO APP\n  // !!! OR RETURN A POPUP HANDLER...\n  // * good\n  private async checkFirstOpen(force?: true) {\n    if (!document.cookie.includes(App.OPENED_COOKIE) || force) {\n      this.rootElement.append(this.welcomePopup.rootElement);\n      const desicion = (await this.welcomePopup\n        .recharge()\n        .awaitDesicion()) as FirstOpenDesicions;\n      switch (desicion) {\n        case 'enable glitch':\n          document.cookie = App.GLITCH_COOKIE.ENABLED;\n          break;\n        default:\n          document.cookie = App.GLITCH_COOKIE.DISABLED;\n          break;\n      }\n      document.cookie = App.OPENED_COOKIE;\n      this.welcomePopup.hide();\n    }\n    this.toggleGlitch();\n  }\n\n  // * good\n  private toggleGlitch = () => {\n    if (document.cookie.includes(App.GLITCH_COOKIE.ENABLED)) {\n      document.body.classList.remove(styles['no-glitch']);\n    } else {\n      document.body.classList.add(styles['no-glitch']);\n    }\n  };\n\n  // * it may be better\n  private setupEmergencyHandler() {\n    window.addEventListener('unhandledrejection', e => {\n      e.preventDefault();\n      e.promise.catch((error: Error) => {\n        if (\n          !this.emergencyHandlerIsWorking &&\n          error.message === REST_CLIENT_ERROR.CONNECTION_REFUSED\n        ) {\n          this.emergencyHandlerIsWorking = true;\n\n          this.popup404.show();\n          const retry = async () => {\n            try {\n              await REST_CLIENT_GARAGE.getCars();\n              await this.sendRebootMsg();\n              this.popup404.hide();\n              this.emergencyHandlerIsWorking = false;\n            } catch {\n              await new Promise(res => setTimeout(res, 1000));\n              retry();\n            }\n          };\n          retry();\n        }\n      });\n    });\n  }\n\n  // * good\n  private sendRebootMsg = () => {\n    return this.tx?.transmit({\n      msg: this.rebootMsg,\n      prepMode: DBusTXPrepModes.freeze,\n      waitMode: DBusTXWaitModes.allSetled,\n    });\n  };\n\n  //* This is the first appearance of TX RX Dbus\n  //* So if you wonder why, You can read this:\n  //* https://www.avrfreaks.net/forum/why-txrx\n  // * good\n  connect(int: DBusInterface): void {\n    const rxRouting = int.getNewRX(this.watchRouterMsgs);\n    int.plugRX(DBusTopics.ROUTING, rxRouting);\n\n    const rxAppCtl = int.getNewRX(this.rxFuncForAppCtl);\n    int.plugRX(DBusTopics.APP_CTL, rxAppCtl);\n\n    this.tx = int.getNewTX('APP SYSTEM MSGS TX');\n  }\n\n  // * now from dbus i can get data with typed msg and headers\n  // * in headers i can get TX name\n  // * this is useful for debugging and could be useful in match match,\n  // * but I did not find any use in this porject\n  // * good\n  private rxFuncForAppCtl = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgAppCtlReconfureReqMsg) {\n      return this.checkFirstOpen(true);\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * good\n  private watchRouterMsgs = async (data: DBusTXData) => {\n    const { msg } = data;\n    if (msg instanceof DBusMsgRouteIsChangedMsg) {\n      // TODO: Rework with enum!?\n      this.loadMainComponent(msg.newRoute);\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // ! I do not like this.loadedMainComponents as Record<string, unknown> change this in next proj to map\n  // * mid tier\n  private loadMainComponent(name: string): void {\n    if (!(name in this.loadedMainComponents)) {\n      switch (name) {\n        case '#garage':\n          this.loadedMainComponents[`${name}`] = new GarageComp();\n          break;\n        case '#winners':\n          this.loadedMainComponents[`${name}`] = new WinnersComp();\n          break;\n        default:\n          window.location.hash = '#garage';\n          break;\n      }\n    }\n    const newComponent = this.loadedMainComponents[`${name}`];\n\n    if (newComponent) {\n      if (this.currMainComponent) {\n        this.currMainComponent.rootElement.remove();\n      }\n\n      this.currMainComponent = newComponent;\n      newComponent.rootElement.classList.add(styles['main-component']);\n      this.rootElement.append(newComponent.rootElement);\n\n      if (isDBusHub(this.currMainComponent)) {\n        try {\n          this.mainlineDBus.attachHub(this.currMainComponent);\n        } catch {\n          // no need to do something\n        }\n      }\n      if (isNotifiable(this.currMainComponent))\n        this.currMainComponent.notify(null);\n    }\n  }\n}\n","import { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport class DBusMsgRebootMsg extends DBusMsg {\n  constructor(\n    readonly signal: 'reboot',\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.APP_CTL, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport class DBusMsgAppCtlReconfureReqMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.APP_CTL, rxIds, prefResponseRxIds);\n  }\n}\n","export enum CarActions {\n  CREATED,\n  SELECTED,\n  REMOVED,\n  UPDATED,\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\nimport { CarActions } from '../../../car-actions.def';\n\nexport class DBusMsgCarActionMsg extends DBusMsg {\n  constructor(\n    readonly action: CarActions,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.CAR_ACTION, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionCreatedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.CREATED, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { GarageServicemanContract } from '../../../garage-serviceman-contract.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionRemovedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly nullifiedContract: GarageServicemanContract,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.REMOVED, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionSelectedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly notifyChanges?: (car: RegCarData) => unknown,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.SELECTED, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgGarageMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GARAGE, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageMsg } from './garage-msg.def';\n\nexport class DBusMsgGaragePageIsChangedMsg extends DBusMsgGarageMsg {}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgGarageRaceMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GARAGE, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageRaceMsg } from './garage-race-msg.def';\n\nexport class DBusMsgRaceRequestMsg extends DBusMsgGarageRaceMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { RaceStatusesList } from '../../../race-statuses.def';\nimport { DBusMsgGarageRaceMsg } from './garage-race-msg.def';\n\nexport class DBusMsgGarageRaceStatusMsg extends DBusMsgGarageRaceMsg {\n  constructor(\n    readonly status: RaceStatusesList,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgGarageResetMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GARAGE, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageResetMsg } from './garage-reset-msg.def';\n\nexport class DBusMsgGarageResetReqMsg extends DBusMsgGarageResetMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageMsg } from './garage-msg.def';\n\nexport type GarageStatus =\n  | 'need reset'\n  | 'car moves'\n  | 'all cars stopped'\n  | 'reset is not needed';\n\nexport class DBusMsgGarageStatusMsg extends DBusMsgGarageMsg {\n  constructor(\n    readonly status: GarageStatus,\n    rxIds?: string[],\n    prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBUS_COMMON_RESPONSES } from '../../lib/services/dbus/defs/dbus-common-responses.def';\nimport { DBUS_HUB_NAMES } from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBusTX } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionRemovedMsg } from './dbus-msgs/by-topic/car-action/garage-car-remove-msg.def';\nimport { GarageManagersTeam } from './garage-managers-team';\nimport { CarComp } from './subcomps/car/car';\nimport { TrackComp } from './subcomps/track/track';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\nimport { DBusMsgCarActionCreatedMsg } from './dbus-msgs/by-topic/car-action/garage-car-created-msg.def';\nimport { DBusMsgRaceRequestMsg } from './dbus-msgs/by-topic/garage/garage-race-request-msg.def';\nimport { DBusMsgGarageResetReqMsg } from './dbus-msgs/by-topic/garage/garage-reset-req-msg.def';\n\nimport styles from './garage.scss';\nimport sharedStyles from '../../styles/styles.scss';\nimport { Pager } from '../../lib/services/pager/pager';\nimport { DBusMsgGenerateCarsMsg } from './subcomps/main-controls/dbus-msgs/generate-cars-msg.def';\nimport { DBusMsgRebootMsg } from '../../app/dbus-msgs/reboot-msg.def';\nimport { DBusMsgGaragePageIsChangedMsg } from './dbus-msgs/by-topic/garage/garage-page-is-changed.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport {\n  DBusMsgRoutingRestrainMsg,\n  RoutingRestrainActions,\n} from '../../lib/services/simple-router/dbus-msgs-defs/types/routing-restrict-msg.def';\n\ntype TracksGeometry = {\n  trackHeights: number[];\n  displacements: number[];\n  paddingBase: number;\n  paddingShift: number;\n};\n\nexport class GarageCompCtlAkaDirector implements DBusHub {\n  static readonly DISPLACEMENT_FIX = -24;\n\n  static readonly CAR_WIDTH_RATIO = 0.2;\n\n  static readonly CAR_MAX_WIDTH =\n    1920 * GarageCompCtlAkaDirector.CAR_WIDTH_RATIO;\n\n  static readonly SKIPPED_PROGRESSION_MEMBERS_COUNT = 2;\n\n  static readonly PADDING_SHIFT_BASE = 35;\n\n  static readonly PADDING_SHIFT_BASE_VW = 1920;\n\n  static readonly CAR_IMG_RATIO = 3.78;\n\n  static readonly SCALE_FACTOR = 0.95;\n\n  readonly hubName = DBUS_HUB_NAMES.GARAGE_CONTROLLER;\n\n  protected txs = new Set<DBusTX>();\n\n  private garageManagersTeam: GarageManagersTeam;\n\n  private pager: Pager;\n\n  private entriesPerPage = 7;\n\n  private pagerContainer = document.createElement('div');\n\n  private racePromise: Promise<unknown> | undefined;\n\n  private ctlBlocks: HTMLElement[] = [];\n\n  // * FINISHED < 40 LINES *\n  constructor(\n    private tracksContainer: HTMLElement,\n    private carCtlsBlock: HTMLElement,\n  ) {\n    this.garageManagersTeam = new GarageManagersTeam(\n      tracksContainer,\n      carCtlsBlock,\n      this.lockCallback,\n    );\n\n    this.pager = new Pager(this.entriesPerPage, this.pagerCallback);\n    this.setupPager();\n  }\n\n  // * FINISHED < 40 LINES *\n  private setupPager() {\n    const btnNextPage = this.pager.getBtnNextPage();\n    btnNextPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['garage-bg__pager-btn'],\n    );\n\n    const btnPrevPage = this.pager.getBtnPrevPage();\n    btnPrevPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['garage-bg__pager-btn'],\n    );\n\n    const pagerInfo = this.pager.getPagerSpan();\n    pagerInfo.classList.add(styles['garage-bg__pager-span']);\n\n    this.pagerContainer.classList.add(styles['garage-bg__pager']);\n    this.pagerContainer.append(btnPrevPage, btnNextPage, pagerInfo);\n  }\n\n  // * FINISHED < 40 LINES *\n  private pagerCallback = async (dir: 'prev' | 'next'): Promise<boolean> => {\n    try {\n      await this.resetState();\n      await this.reloadData(dir);\n      return true;\n    } catch {\n      return false;\n    }\n  };\n\n  // * FINISHED < 40 LINES *\n  async startWorking(): Promise<boolean> {\n    try {\n      await this.reloadData();\n      window.addEventListener('resize', () => this.redraw());\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  // * FINISHED < 40 LINES *\n  async connect(int: DBusInterface): Promise<void> {\n    this.txs.add(int.getNewTX('broadcast paging'));\n    this.garageManagersTeam.autoConnect(int);\n\n    const carActionsMsgsRX = int.getNewRX(\n      this.carActionsRXFunc,\n      'monitor cars removes',\n    );\n    int.plugRX(DBusTopics.CAR_ACTION, carActionsMsgsRX);\n\n    const raceMsgsRX = int.getNewRX(this.racingRXFunc, 'handle race requsets');\n    int.plugRX(DBusTopics.GARAGE, raceMsgsRX);\n\n    const generatorMsgsRX = int.getNewRX(this.generatorRXFunc);\n    int.plugRX(DBusTopics.GENERATE, generatorMsgsRX);\n\n    const appCtlMsgsRX = int.getNewRX(\n      this.appCtlRXFunc,\n      'handle app reboot msgs',\n    );\n    int.plugRX(DBusTopics.APP_CTL, appCtlMsgsRX);\n  }\n\n  private appCtlRXFunc = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgRebootMsg && data.msg.signal === 'reboot') {\n      await this.resetState();\n      await this.reloadData();\n      return true;\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private generatorRXFunc = async (data: DBusTXData) => {\n    if (\n      data.msg instanceof DBusMsgGenerateCarsMsg &&\n      data.msg.status === 'end'\n    ) {\n      await this.resetState();\n      await this.reloadData();\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private racingRXFunc = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgRaceRequestMsg) {\n      this.pager.toogleLock(true);\n      const result = await this.performRace();\n      this.pager.toogleLock(false);\n      return result;\n    }\n    if (data.msg instanceof DBusMsgGarageResetReqMsg) {\n      return this.resetState();\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private async resetState() {\n    // ! this function should be here to be a unique lock!\n    // eslint-disable-next-line unicorn/consistent-function-scoping\n    const restrainFunc = async () => false;\n    await this.toggleRoutingRestrains('restrain', restrainFunc);\n    return new Promise((res, rej) => {\n      this.toggleCtlsBlockDisabled(true);\n      this.pager.toogleLock(true);\n      this.garageManagersTeam\n        .resetState()\n        .then(() => res(true))\n        .catch((error: Error) => {\n          rej(error);\n        })\n        .finally(() => {\n          this.pager.toogleLock(false);\n          this.toggleCtlsBlockDisabled(false);\n        });\n    }).finally(() => {\n      this.toggleRoutingRestrains('unleash', restrainFunc);\n    });\n  }\n\n  private async lockCallback(state: boolean) {\n    this.pager.toogleLock(state);\n    return true;\n  }\n\n  private toggleCtlsBlockDisabled(state: boolean) {\n    if (state === true) {\n      this.carCtlsBlock.addEventListener(\n        'click',\n        this.carCtlsBlockBlockListener,\n        {\n          capture: true,\n        },\n      );\n      this.ctlBlocks.forEach((block, index) => {\n        block.style.setProperty(\n          '--glitch-delay',\n          `${index / this.ctlBlocks.length}s`,\n        );\n        block.classList.add(sharedStyles['glitched-item']);\n      });\n    } else {\n      this.carCtlsBlock.removeEventListener(\n        'click',\n        this.carCtlsBlockBlockListener,\n        {\n          capture: true,\n        },\n      );\n      this.ctlBlocks.forEach(block => {\n        block.classList.remove(sharedStyles['glitched-item']);\n        block.style.removeProperty('--glitch-delay');\n      });\n    }\n  }\n\n  private carCtlsBlockBlockListener = (e: Event) => {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  toggleRoutingRestrains(\n    action: RoutingRestrainActions,\n    restrainFunc?: () => Promise<boolean>,\n  ): Promise<unknown> {\n    const msg = new DBusMsgRoutingRestrainMsg(\n      action,\n      restrainFunc || this.routingRestrainFunc,\n    );\n    const transmissions: Promise<unknown>[] = [];\n    this.txs.forEach(tx => {\n      const x = tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n      transmissions.push(x);\n    });\n    return Promise.allSettled(transmissions);\n  }\n\n  private routingRestrainFunc = async () => {\n    return false;\n  };\n\n  // * FINISHED < 40 LINES *\n  // ! NOT TESTED PROMISE !\n  private async performRace() {\n    this.racePromise = this.garageManagersTeam.performRace().finally(() => {\n      this.racePromise = undefined;\n    });\n    return this.racePromise;\n  }\n\n  // * FINISHED < 40 LINES *\n  private carActionsRXFunc = async (data: DBusTXData) => {\n    if (\n      data.msg instanceof DBusMsgCarActionRemovedMsg ||\n      data.msg instanceof DBusMsgCarActionCreatedMsg\n    ) {\n      if (this.racePromise) await this.racePromise;\n      try {\n        if (data.msg instanceof DBusMsgCarActionRemovedMsg) {\n          this.garageManagersTeam.handleCarRm(data.msg.car);\n        }\n        this.resetState().finally(() => this.reloadData());\n      } catch {\n        this.pager.tryChangePage('prev');\n      }\n    }\n\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private reloadData(dir?: 'prev' | 'next') {\n    return new Promise<boolean>((res, rej) => {\n      const page = dir\n        ? dir === 'next'\n          ? this.pager.getCurrPageNumber() + 1\n          : this.pager.getCurrPageNumber() - 1\n        : this.pager.getCurrPageNumber();\n      REST_CLIENT_GARAGE.getCars(page, this.pager.getEntriesPerPage()).then(\n        async response => {\n          const { limit, cars } = response;\n          this.pager.setEntriesCount(Number.parseInt(limit, 10));\n          if (cars.length === 0) {\n            if (dir) {\n              rej();\n              return;\n            }\n\n            if (page > 1) {\n              await this.pager.tryChangePage('prev');\n              res(true);\n              return;\n            }\n          }\n          this.broadcastPaging();\n\n          await this.garageManagersTeam.nullifyContracts();\n          const newContracts: GarageServicemanContract[] = [];\n\n          cars.forEach((car, index) => {\n            const track = new TrackComp();\n            const carComp = new CarComp(car, index + 1);\n            track.placeCar(carComp);\n            newContracts.push({ track, car: carComp });\n          });\n\n          this.garageManagersTeam.addContracts(...newContracts);\n          this.garageManagersTeam.resetState();\n          this.redraw();\n          res(true);\n        },\n      );\n    });\n  }\n\n  private broadcastPaging() {\n    const msg = new DBusMsgGaragePageIsChangedMsg();\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  // * FINISHED < 40 LINES *\n  private async redraw() {\n    this.clearDOM();\n\n    const geometry = this.calcGeometry();\n    this.setStylesForTracks(geometry);\n\n    this.drawTracks();\n    this.drawCarsCtls();\n  }\n\n  // * FINISHED < 40 LINES *\n  private clearDOM() {\n    while (this.tracksContainer.firstChild)\n      this.tracksContainer.firstChild.remove();\n    while (this.carCtlsBlock.firstChild) this.carCtlsBlock.firstChild.remove();\n  }\n\n  // ! MORE THAN 40 LINES ! BUT IT IS AN ONE-PIECE FUNCTION !\n  // ! BETTER TO SAVE IT AS IS\n  private calcGeometry(): TracksGeometry {\n    const style = window.getComputedStyle(this.tracksContainer);\n    const containerHeight =\n      Number.parseFloat(style.height) -\n      Number.parseFloat(style.paddingBottom) -\n      Number.parseFloat(style.paddingTop);\n    const firstAutoWidth = Math.min(\n      window.innerWidth * GarageCompCtlAkaDirector.CAR_WIDTH_RATIO,\n      GarageCompCtlAkaDirector.CAR_MAX_WIDTH,\n    );\n    const firstAutoHeight =\n      firstAutoWidth / GarageCompCtlAkaDirector.CAR_IMG_RATIO;\n    const heights: number[] = [];\n    let heightSum = 0;\n    const contracts = [...this.garageManagersTeam.getContracts()];\n\n    contracts.forEach((contract, index) => {\n      const factor = GarageCompCtlAkaDirector.SCALE_FACTOR ** index;\n      const carTrackHeight = firstAutoHeight * factor;\n      heightSum += carTrackHeight;\n      heights.push(carTrackHeight);\n    });\n\n    const excessHeight = heightSum - containerHeight;\n    const heightsReversed = heights.sort((a, b) => a - b);\n    const displacementBase =\n      excessHeight > 0\n        ? excessHeight / this.garageManagersTeam.getContracts().size -\n          GarageCompCtlAkaDirector.SKIPPED_PROGRESSION_MEMBERS_COUNT\n        : 0;\n\n    const displacements: number[] = [];\n    const midIndex = (contracts.length - 1) / 2;\n\n    contracts.forEach((contract, index) => {\n      const diff = index - midIndex;\n      const displacement =\n        displacementBase * -diff + GarageCompCtlAkaDirector.DISPLACEMENT_FIX;\n      displacements.push(displacement);\n    });\n\n    const paddingBase =\n      (heightsReversed[0] as number) * GarageCompCtlAkaDirector.CAR_IMG_RATIO;\n    const paddingShift =\n      (GarageCompCtlAkaDirector.PADDING_SHIFT_BASE * window.innerWidth) /\n      GarageCompCtlAkaDirector.PADDING_SHIFT_BASE_VW;\n\n    return {\n      trackHeights: heightsReversed,\n      displacements,\n      paddingBase,\n      paddingShift,\n    };\n  }\n\n  // * FINISHED < 40 LINES *\n  private setStylesForTracks(geometry: TracksGeometry) {\n    const contracts = [...this.garageManagersTeam.getContracts()];\n\n    contracts.forEach((contract, index) => {\n      contract.track.rootElement.style.setProperty(\n        'height',\n        `${geometry.trackHeights[index]}px`,\n      );\n\n      contract.track.rootElement.style.setProperty(\n        'top',\n        `${geometry.displacements[index]}px`,\n      );\n\n      contract.track.rootElement.style.setProperty('z-index', `${index + 1}`);\n\n      contract.track.rootElement.style.setProperty(\n        '--padding-w',\n        `${\n          (geometry.trackHeights[\n            geometry.trackHeights.length - 1 - index\n          ] as number) *\n            GarageCompCtlAkaDirector.CAR_IMG_RATIO -\n          geometry.paddingBase +\n          geometry.paddingShift * (contracts.length - 1 - index)\n        }px`,\n      );\n    });\n  }\n\n  // * FINISHED < 40 LINES *\n  private drawTracks() {\n    this.tracksContainer.append(\n      this.pagerContainer,\n      ...[...this.garageManagersTeam.getContracts()].map(contract => {\n        contract.car.playFirstIntroAnim();\n        return contract.track.rootElement;\n      }),\n    );\n  }\n\n  // * FINISHED < 40 LINES *\n  private drawCarsCtls() {\n    const contracts = [...this.garageManagersTeam.getContracts()];\n    this.ctlBlocks = contracts.map((contract, index) => {\n      const block = this.createCarCtlBlock(contract.car, index + 1);\n      this.connectCtlAndTrack(block, contract.track);\n      return block;\n    });\n    this.carCtlsBlock.append(...this.ctlBlocks);\n  }\n\n  // * FINISHED < 40 LINES *\n  private createCarCtlBlock = (car: CarComp, index: number): HTMLElement => {\n    const btns = [car.btnSelect, car.btnStart, car.btnReset, car.btnRm];\n\n    btns.forEach(btn => {\n      btn.classList.add(sharedStyles.btn, styles['garage-bg__car-ctl-btn']);\n    });\n\n    car.btnStart.classList.add(sharedStyles['btn-15']);\n    car.btnSelect.classList.add(sharedStyles['btn-13']);\n    car.btnReset.classList.add(sharedStyles['btn-9']);\n    car.btnRm.classList.add(sharedStyles['btn-4']);\n\n    const numberSpan = document.createElement('span');\n    numberSpan.classList.add(styles['garage-bg__car-ctl-block-number']);\n    numberSpan.textContent = index.toString();\n\n    const container = document.createElement('div');\n    container.classList.add(styles['garage-bg__car-ctl-block']);\n    container.append(numberSpan, ...btns);\n\n    return container;\n  };\n\n  // * FINISHED < 40 LINES *\n  // ? REFACTOR TO BE ABLE TO RM EVENT LISTENERS ?\n  private connectCtlAndTrack = (ctlElem: HTMLElement, track: TrackComp) => {\n    ctlElem.addEventListener(\n      'mouseover',\n      () => track.illuminateSelf(true),\n      true,\n    );\n    ctlElem.addEventListener(\n      'mouseout',\n      () => track.illuminateSelf(false),\n      true,\n    );\n  };\n}\n","import { PopupStandaloneModalProgressComp } from '../../lib/components/popups/standalone/modal/progress/popup-progress';\nimport { genUniqId } from '../../lib/generators/generators';\nimport {\n  EngineResponse,\n  REST_CLIENT_ENGINE,\n} from '../../services/rest-clients/client-engine/rest-client-engine';\nimport { REST_CLIENT_ERROR } from '../../services/rest-clients/rest-clients-errors.def';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\n\nexport enum GarageDriverCommands {\n  START_DRIVING,\n  STOP_DRIVING,\n}\n\nexport class GarageDriver {\n  private contract: GarageServicemanContract | undefined;\n\n  private currDriveId: string | undefined;\n\n  private drivePromise: Promise<unknown> | undefined;\n\n  private ignitionPromise: Promise<unknown> | undefined;\n\n  private lastStart: number | undefined;\n\n  private lastTimeInMs: number | undefined;\n\n  public isFree(): boolean {\n    if (!this.contract) return true;\n    return false;\n  }\n\n  putBehindTheWheel(contract: GarageServicemanContract): void {\n    if (this.contract) throw new Error('ALREADY IN CAR');\n    this.contract = contract;\n  }\n\n  async getOutOfTheCar(): Promise<void> {\n    this.contract = undefined;\n  }\n\n  performDrivingProtocol(flags?: Record<string, unknown>): Promise<{\n    driveParams: EngineResponse;\n    drivePromise: Promise<number | false>;\n  }> {\n    const newPromise = new Promise<{\n      driveParams: EngineResponse;\n      drivePromise: Promise<number | false>;\n    }>((res, rej) => {\n      if (flags) this.contract?.car.disableCtls(); // race\n      const thisDriveId = genUniqId();\n      this.currDriveId = thisDriveId;\n      this.ignitionPromise = this.TurnOnTheIgnition()\n        .then(driveParams => {\n          if (thisDriveId !== this.currDriveId) rej(new Error('interrupted'));\n          const drivePromise = this.drive(driveParams, thisDriveId, flags);\n          res({\n            driveParams,\n            drivePromise,\n          });\n        })\n        .catch((error: Error) => {\n          if (thisDriveId !== this.currDriveId) rej(new Error('interrupted'));\n          else rej(error);\n        });\n    });\n    return newPromise;\n  }\n\n  private async TurnOnTheIgnition() {\n    if (!this.contract) throw new Error('NOT_BEHIND_THE_WHEEL');\n    if (this.drivePromise) await Promise.allSettled([this.drivePromise]);\n    const { car } = this.contract;\n    car.toggleIgniteAnim(true);\n    const params = await REST_CLIENT_ENGINE.toggleEngine(\n      car.currCar.id,\n      'started',\n    ).finally(() => {\n      car.toggleIgniteAnim(false);\n    });\n    return params;\n  }\n\n  public isInStartPosition(): boolean {\n    return !this.currDriveId;\n  }\n\n  // !!! If animation fails, this promise never resolves!\n  async returnToStart(): Promise<boolean> {\n    this.currDriveId = undefined;\n    if (this.contract) {\n      if (this.ignitionPromise) await this.ignitionPromise;\n      if (this.drivePromise) {\n        await this.stopCar(true, false);\n        await this.contract.car.rollBack(this.drivePromise);\n\n        const msgBlock = GarageDriver.createMsgBlock();\n        this.contract.track.rootElement.append(msgBlock);\n        const popup = new PopupStandaloneModalProgressComp();\n\n        popup\n          .setText(\n            `I can't let the engine start again until\n          the server finishes its business, read the notes, please.`,\n          )\n          .show(msgBlock);\n        const interval = this.updateProgress(popup);\n        await this.contract.car.playAwaitingAnim(this.drivePromise);\n        if (interval) clearTimeout(interval);\n        popup.hide();\n        msgBlock.remove();\n      } else {\n        await this.stopCar(false, false);\n        await this.contract.car.rollBack();\n      }\n    }\n    return true;\n  }\n\n  private updateProgress(\n    popup: PopupStandaloneModalProgressComp,\n  ): NodeJS.Timeout {\n    const interval = setInterval(() => {\n      if (this.lastTimeInMs && this.lastStart) {\n        const progress =\n          ((Date.now() - this.lastStart) / this.lastTimeInMs) * 100;\n        popup.setProgress(progress);\n      } else clearInterval(interval);\n    }, 500);\n    return interval;\n  }\n\n  static createMsgBlock(): HTMLElement {\n    const msgBlock = document.createElement('div');\n    msgBlock.style.setProperty('height', '100%');\n    msgBlock.style.setProperty('width', '40%');\n    msgBlock.style.setProperty('position', 'absolute');\n    msgBlock.style.setProperty('right', '0px');\n    msgBlock.style.setProperty('top', '100%');\n    msgBlock.style.setProperty('transform', 'translate(-40%, -120%)');\n    return msgBlock;\n  }\n\n  // ! The following 3 functions must be in one!\n  // ! This is not a very smart 40 lines per function limit I think!\n  // ! Now, after splitting into functions, it is much worse readable than before.\n  private async drive(\n    driveParams: EngineResponse,\n    driveId: string,\n    flags?: Record<string, unknown>,\n  ): Promise<false | number> {\n    return new Promise<false | number>((res, rej) => {\n      if (this.contract) {\n        const { contract } = this;\n        const time = GarageDriver.calculateDriveTime(driveParams);\n        this.lastStart = Date.now();\n        this.lastTimeInMs = time * 1000;\n        this.drivePromise = REST_CLIENT_ENGINE.enterDriveMode(\n          contract.car.currCar.id,\n        ).then(success =>\n          this.processSuccessfullDriveReslut(\n            success,\n            res,\n            rej,\n            contract,\n            driveId,\n            time,\n            flags,\n          ),\n        );\n        this.controlCarAnim(contract, res, rej, time, flags);\n      } else rej(new Error('No car'));\n    });\n  }\n\n  private controlCarAnim(\n    contract: GarageServicemanContract,\n    res: (a: number | false) => void,\n    rej: (e: unknown) => void,\n    time: number,\n    flags?: Record<string, unknown>,\n  ) {\n    contract.car\n      .rollForward(time, !flags)\n      .catch(() => {\n        res(false);\n      })\n      .then(async playbackRate => {\n        if (playbackRate && playbackRate > 0) {\n          this.stopCar(true, true, false, flags);\n          const connectionRestored = await this.emergencyAwaitServer(\n            time * 1000,\n            1000,\n            // ! wtf unicorn?\n            // eslint-disable-next-line unicorn/consistent-destructuring\n            this.drivePromise,\n          );\n          if (!connectionRestored) {\n            rej(new Error(REST_CLIENT_ERROR['Failed to fetch']));\n          }\n        }\n      });\n  }\n\n  private processSuccessfullDriveReslut(\n    success: boolean,\n    res: (a: number | false) => void,\n    rej: (e: unknown) => void,\n    contract: GarageServicemanContract,\n    driveId: string,\n    time: number,\n    flags?: Record<string, unknown>,\n  ) {\n    if (\n      // ! IT IS NECESSARY TO CHECK REMEMBERED CONTRACT WITH CURR CONTRACT AND DRIVE ID\n      // ! UNICORN DON'T UNDERSTAND THIS !\n      // eslint-disable-next-line unicorn/consistent-destructuring\n      !(contract === this.contract) ||\n      // eslint-disable-next-line unicorn/consistent-destructuring\n      !(driveId === this.currDriveId)\n    ) {\n      rej(new Error('interrupted'));\n    } else if (success) {\n      res(time);\n      this.stopCar(true, true, false, flags);\n    } else {\n      this.stopCar(true, false, true, flags);\n      res(false);\n    }\n  }\n\n  // ! 40 lines\n  private emergencyAwaitServer = (\n    timeInMS: number,\n    delayInMS: number,\n    resPromise?: Promise<unknown>,\n  ) => {\n    const popup = new PopupStandaloneModalProgressComp();\n    popup.setText(`Connection is lost... awaiting server`).setProgress(1);\n    return new Promise<boolean>(res => {\n      const startTime = Date.now();\n      let IamResolved = false;\n      let interval: NodeJS.Timeout;\n      const resFunc = () => {\n        IamResolved = true;\n        if (interval) clearInterval(interval);\n        popup.hide();\n        res(false);\n      };\n      const chargeInterval = () => {\n        interval = setInterval(() => {\n          if (IamResolved) {\n            clearInterval(interval);\n            return;\n          }\n          popup.show();\n          const currTime = Date.now();\n          const elapsedTime = currTime - startTime;\n          if (elapsedTime < timeInMS) {\n            const progress = (elapsedTime / timeInMS) * 100;\n            popup.setProgress(progress);\n          } else resFunc();\n        }, timeInMS / 20); // 5%\n      };\n\n      resPromise?.finally(() => {\n        resFunc();\n      });\n      setTimeout(() => {\n        chargeInterval();\n      }, delayInMS);\n    });\n  };\n\n  private async stopCar(\n    onlyAnim = false,\n    rollover = true,\n    broken = false,\n    flags?: Record<string, unknown>,\n  ) {\n    if (this.contract) {\n      if (!broken && !onlyAnim) {\n        await REST_CLIENT_ENGINE.toggleEngine(\n          this.contract.car.currCar.id,\n          'stopped',\n        );\n      }\n      await this.contract.car.stop(rollover, broken, flags);\n      return true;\n    }\n    throw new Error('No car');\n  }\n\n  private static calculateDriveTime(params: EngineResponse): number {\n    const time = params.distance / 1000 / params.velocity; /// !!! distance units???\n    return time;\n  }\n}\n","import { RegCarData, WinnerCarData } from '../../definitions/car-data.def';\nimport { DBusInterface } from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../lib/services/dbus/defs/dbus-port.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgCarActionSelectedMsg } from './dbus-msgs/by-topic/car-action/garage-car-select-msg.def';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionRemovedMsg } from './dbus-msgs/by-topic/car-action/garage-car-remove-msg.def';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\nimport { GarageDriver } from './garage-driver';\nimport { genUniqId } from '../../lib/generators/generators';\n\nimport styles from './garage.scss';\nimport { REST_CLIENT_WINNERS } from '../../services/rest-clients/client-winners/rest-client-winners';\nimport { REST_CLIENT_ERROR } from '../../services/rest-clients/rest-clients-errors.def';\nimport { DBusMsgGarageRaceStatusMsg } from './dbus-msgs/by-topic/garage/garage-race-status-msg.def';\nimport { RaceStatusesList, RACE_STATUSES } from './race-statuses.def';\nimport { getTransitionDuration } from '../../lib/gui/animation';\nimport { GaragePopupWinner } from './subcomps/popup-winner/popup-winner';\nimport {\n  DBusMsgRoutingRestrainMsg,\n  RoutingRestrainActions,\n} from '../../lib/services/simple-router/dbus-msgs-defs/types/routing-restrict-msg.def';\nimport {\n  DBusMsgGarageStatusMsg,\n  GarageStatus,\n} from './dbus-msgs/by-topic/garage/garage-status-msg.def';\n\ntype RaceData = {\n  raceId: string;\n  arrivedByOrder: GarageServicemanContract[];\n  notArrived: GarageServicemanContract[];\n  participantsCount: number;\n  flags: Record<string, unknown>;\n  stratedCount: number;\n};\n\nexport class GarageManagersTeam implements DBusPort {\n  protected txs = new Set<DBusTX>();\n\n  protected contracts = new Set<GarageServicemanContract>();\n\n  protected freeDrivers = new Set<GarageDriver>();\n\n  protected busyDrivers = new Map<GarageServicemanContract, GarageDriver>();\n\n  protected movingDrivers = new Map<GarageServicemanContract, GarageDriver>();\n\n  protected currRaceId: string | undefined;\n\n  protected winnerPopup = new GaragePopupWinner();\n\n  protected rollbackPromise: Promise<unknown> | undefined;\n\n  constructor(\n    private readonly tracksContainer: HTMLElement,\n    private readonly carCtlsBlock: HTMLElement,\n    private readonly directorLockCb: (state: boolean) => Promise<boolean>,\n  ) {\n    this.carCtlsBlock.addEventListener('click', this.carCtlsClickListener);\n    this.winnerPopup.rootElement.classList.add(styles['garage__winner-popup']);\n  }\n\n  autoConnect(int: DBusInterface): void {\n    const tx = int.getNewTX('garage serviceman');\n    this.txs.add(tx);\n  }\n\n  public getContracts(): Set<GarageServicemanContract> {\n    return this.contracts;\n  }\n\n  public handleCarRm(car: RegCarData): void {\n    this.contracts.forEach(contract => {\n      if (contract.car.currCar.id === car.id)\n        this.busyDrivers.get(contract)?.getOutOfTheCar();\n    });\n  }\n\n  async nullifyContracts(\n    contracts?: GarageServicemanContract[],\n  ): Promise<void> {\n    if (contracts) {\n      this.tryFreeDrivers(...contracts);\n      contracts.forEach(contract => {\n        this.contracts.delete(contract);\n      });\n    } else {\n      this.tryFreeDrivers(...this.contracts);\n      this.contracts.clear();\n    }\n  }\n\n  addContracts(...—Åontracts: GarageServicemanContract[]): void {\n    —Åontracts.forEach(newContract => this.contracts.add(newContract));\n  }\n\n  private carCtlsClickListener = (e: Event) => {\n    if (e.target instanceof HTMLElement) {\n      const elem = e.target;\n      let btn: HTMLButtonElement | undefined;\n\n      if (elem instanceof HTMLButtonElement) btn = elem;\n      else if (elem.parentElement instanceof HTMLButtonElement)\n        btn = elem.parentElement;\n\n      if (btn && btn.disabled !== true) {\n        this.contracts.forEach(contract => {\n          if (this.currRaceId) return;\n          if (btn === contract.car.btnSelect) {\n            this.handleSelection(contract);\n            return;\n          }\n          if (btn === contract.car.btnRm) {\n            contract.car.btnRm.disabled = true;\n            this.handleRemoving(contract);\n            return;\n          }\n          if (btn === contract.car.btnStart) {\n            contract.car.btnStart.disabled = true;\n            this.startDriving(contract);\n            return;\n          }\n          if (btn === contract.car.btnReset) {\n            contract.car.btnReset.disabled = true;\n            this.handleRestoreState(contract);\n          }\n        });\n      }\n    }\n  };\n\n  async resetState(prepareForRace?: boolean): Promise<void> {\n    if (!prepareForRace) this.currRaceId = undefined;\n    this.winnerPopup.rootElement.remove();\n    this.tracksContainer.classList.remove(\n      styles['synthwave-background_race-mode'],\n    );\n    await this.rollbackCars();\n    this.broadcastGarageStatus('reset is not needed');\n\n    if (!prepareForRace) {\n      this.broadcastRaceStatus('READY_TO_GO');\n    }\n  }\n\n  private async handleRestoreState(\n    contract: GarageServicemanContract,\n  ): Promise<void> {\n    const driver = this.busyDrivers.get(contract);\n    if (driver) {\n      await driver.returnToStart();\n      await this.broadcastIfAllInStart();\n    }\n  }\n\n  private async broadcastIfAllInStart(): Promise<void> {\n    const allInStart = [...this.busyDrivers].every(contract =>\n      contract[1].isInStartPosition(),\n    );\n    if (allInStart) {\n      this.broadcastGarageStatus('reset is not needed');\n    }\n  }\n\n  private async startDriving(\n    contract: GarageServicemanContract,\n    flags?: Record<string, unknown>,\n  ) {\n    let choosedDriver = this.busyDrivers.get(contract);\n\n    if (!choosedDriver) {\n      // !!! excess check?\n      choosedDriver = [...this.freeDrivers].find(driver => driver.isFree());\n\n      if (choosedDriver) {\n        this.freeDrivers.delete(choosedDriver);\n      } else {\n        choosedDriver = new GarageDriver();\n      }\n\n      this.busyDrivers.set(contract, choosedDriver);\n\n      choosedDriver.putBehindTheWheel(contract);\n    }\n\n    this.movingDrivers.set(contract, choosedDriver);\n    if (this.movingDrivers.size === 1) {\n      await this.broadcastGarageStatus('need reset');\n      await this.toggleRoutingRestrains('restrain');\n      await this.broadcastGarageStatus('car moves');\n    }\n\n    return choosedDriver\n      .performDrivingProtocol(flags)\n      .then(response => {\n        response.drivePromise.finally(() => {\n          this.movingDrivers.delete(contract);\n\n          if (this.movingDrivers.size === 0) {\n            this.toggleRoutingRestrains('unleash');\n            this.broadcastGarageStatus('all cars stopped');\n          }\n        });\n        return response;\n      })\n      .catch(error => {\n        this.movingDrivers.delete(contract);\n\n        if (this.movingDrivers.size === 0) {\n          this.toggleRoutingRestrains('unleash');\n          this.broadcastGarageStatus('all cars stopped');\n        }\n\n        throw error;\n      });\n  }\n\n  private async broadcastGarageStatus(status: GarageStatus) {\n    const msg = new DBusMsgGarageStatusMsg(status);\n    const transmissions: Promise<unknown>[] = [];\n    this.txs.forEach(tx => {\n      const x = tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n      transmissions.push(x);\n    });\n    return Promise.allSettled(transmissions);\n  }\n\n  toggleRoutingRestrains(action: RoutingRestrainActions): Promise<unknown> {\n    const msg = new DBusMsgRoutingRestrainMsg(action, this.routingRestrainFunc);\n    const transmissions: Promise<unknown>[] = [];\n    this.txs.forEach(tx => {\n      const x = tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n      transmissions.push(x);\n    });\n    return Promise.allSettled(transmissions);\n  }\n\n  private routingRestrainFunc = async () => {\n    return false;\n  };\n\n  private handleRemoving(contract: GarageServicemanContract) {\n    REST_CLIENT_GARAGE.deleteCar(contract.car.currCar.id).then(async () => {\n      await REST_CLIENT_WINNERS.deleteWinner(contract.car.currCar.id).catch(\n        () => {},\n      );\n      this.tryFreeDrivers(contract);\n      this.contracts.delete(contract);\n      const msg = new DBusMsgCarActionRemovedMsg(\n        contract.car.currCar,\n        contract,\n      );\n      this.txs.forEach(tx => {\n        tx.transmit({\n          msg,\n          prepMode: DBusTXPrepModes.freeze,\n          waitMode: DBusTXWaitModes.nowait,\n        });\n      });\n    });\n  }\n\n  private handleSelection(contract: GarageServicemanContract) {\n    const msg = new DBusMsgCarActionSelectedMsg(\n      contract.car.currCar,\n      this.genSelectCallback(contract),\n    );\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  private async rollbackCars() {\n    if (this.rollbackPromise) {\n      await this.rollbackPromise;\n      return;\n    }\n    this.tracksContainer.classList.remove(\n      styles['garage__track-container_finish'],\n    );\n    this.tracksContainer.style.setProperty('--translate-x', '0px');\n    // rollback cars\n    const rollbacks: Promise<unknown>[] = [];\n    this.busyDrivers.forEach(driver => {\n      rollbacks.push(driver.returnToStart());\n    });\n    this.rollbackPromise = Promise.all(rollbacks).finally(() => {\n      this.rollbackPromise = undefined;\n    });\n    await this.rollbackPromise;\n  }\n\n  async performRace(): Promise<RaceStatusesList> {\n    if (this.contracts.size === 0) return RACE_STATUSES.RACE_REJECTED;\n\n    // prepare\n    const thisRaceId = genUniqId();\n    this.currRaceId = thisRaceId;\n    await this.resetState(true);\n    // check if user cancell a race\n    if (thisRaceId !== this.currRaceId) return RACE_STATUSES.RACE_INTERRUPTED;\n\n    // process race\n    const raceData: RaceData = {\n      raceId: thisRaceId,\n      arrivedByOrder: [],\n      notArrived: [],\n      participantsCount: this.contracts.size,\n      flags: {\n        roadElem: this.tracksContainer,\n        isFinishVisible: false, // TODO: rm\n      },\n      stratedCount: 0,\n    };\n    this.broadcastRaceStatus('IN_PROCESS');\n    await this.processRace(raceData)\n      .catch((error: Error) => {\n        if (!(thisRaceId !== this.currRaceId)) throw error;\n      })\n      .finally(() => {\n        this.tracksContainer.classList.remove(\n          styles['synthwave-background_race-mode'],\n        );\n      });\n\n    // check if user cancell a race\n    if (thisRaceId !== this.currRaceId) return RACE_STATUSES.RACE_INTERRUPTED;\n\n    // console.log(raceData);\n\n    this.broadcastRaceStatus('NEED_RESET');\n    // TODO: Do something else?\n    return RACE_STATUSES.NEED_RESET;\n  }\n\n  private broadcastRaceStatus(status: RaceStatusesList) {\n    const msg = new DBusMsgGarageRaceStatusMsg(status);\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  // false if race was interrupted\n  private processRace(raceData: RaceData) {\n    return new Promise<RaceData | false>(res => {\n      this.contracts.forEach(contract => {\n        this.startDriving(contract, raceData.flags).then(response => {\n          if (raceData.raceId !== this.currRaceId) {\n            res(false);\n            return;\n          }\n\n          if (raceData.stratedCount === raceData.participantsCount - 1) {\n            this.tracksContainer.classList.add(\n              styles['synthwave-background_race-mode'],\n            );\n            raceData.flags.isRoadMoves = true;\n          } else raceData.stratedCount++;\n\n          if (!(response instanceof Error)) {\n            response.drivePromise\n              .then(result =>\n                this.handleDriveResult(raceData, contract, result),\n              )\n              .catch((error: Error) => {\n                if (error.message === 'interrupted') res(false);\n              })\n              .finally(() => {\n                if (\n                  raceData.arrivedByOrder.length +\n                    raceData.notArrived.length ===\n                  raceData.participantsCount\n                ) {\n                  res(raceData);\n                }\n              });\n          } else {\n            throw response;\n          }\n        });\n      });\n    });\n  }\n\n  private handleDriveResult(\n    raceData: RaceData,\n    contract: GarageServicemanContract,\n    result: number | false,\n  ) {\n    if (raceData.raceId !== this.currRaceId) return;\n    if (result !== false) {\n      if (raceData.arrivedByOrder.length === 0) {\n        this.handleWinner(contract, result, raceData);\n      }\n      raceData.arrivedByOrder.push(contract);\n    } else {\n      raceData.notArrived.push(contract);\n    }\n  }\n\n  private handleWinner = async (\n    contract: GarageServicemanContract,\n    time: number,\n    raceData: RaceData,\n  ) => {\n    raceData.flags.isFinishVisible = true;\n    this.tracksContainer.classList.add(\n      styles['garage__track-container_finish'],\n    );\n    const style = window.getComputedStyle(this.tracksContainer, '::after');\n    const duration = getTransitionDuration(style, 'right');\n    if (duration) {\n      const awaitTime = Number.parseFloat(duration);\n      if (awaitTime > 0)\n        await new Promise(res => setTimeout(res, awaitTime * 1000));\n    }\n    this.tracksContainer.classList.remove(\n      styles['synthwave-background_race-mode'],\n    );\n    raceData.flags.isRoadMoves = false;\n\n    if (this.currRaceId !== raceData.raceId) return;\n\n    const winnerCar = contract.car.currCar;\n    GarageManagersTeam.saveWinner(winnerCar, time);\n    this.winnerPopup.setData(\n      winnerCar,\n      time.toFixed(2),\n      contract.car.index?.toString(),\n    );\n    this.tracksContainer.append(this.winnerPopup.rootElement);\n  };\n\n  static saveWinner(winnerCar: RegCarData, time: number): void {\n    REST_CLIENT_WINNERS.getWinner(winnerCar.id)\n      .then(winnerRecord => {\n        const updatedWinnerData: WinnerCarData = {\n          id: winnerRecord.id,\n          wins: winnerRecord.wins + 1,\n          time:\n            time < winnerRecord.time\n              ? Number.parseFloat(time.toFixed(2))\n              : winnerRecord.time,\n        };\n        REST_CLIENT_WINNERS.updateWinner(updatedWinnerData);\n      })\n      .catch((error: Error) => {\n        if (error.message === REST_CLIENT_ERROR.NOT_FOUND) {\n          const newWinnerData: WinnerCarData = {\n            id: winnerCar.id,\n            wins: 1,\n            time: Number.parseFloat(time.toFixed(2)),\n          };\n          REST_CLIENT_WINNERS.createWinner(newWinnerData);\n        }\n      });\n  }\n\n  private tryFreeDrivers(...contracts: GarageServicemanContract[]) {\n    contracts.forEach(contract => {\n      const driver = this.busyDrivers.get(contract);\n      if (driver) {\n        driver.getOutOfTheCar().then(() => {\n          this.busyDrivers.delete(contract);\n          this.freeDrivers.add(driver);\n        });\n      }\n    });\n  }\n\n  private genSelectCallback(contract: GarageServicemanContract) {\n    return (car: RegCarData) => {\n      if (!this.contracts.has(contract)) return;\n      contract.car.updateData(car);\n    };\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { DBUS_HUB_NAMES } from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { GarageCompCtlAkaDirector } from './garage-controller';\nimport { MainControlsComp } from './subcomps/main-controls/main-controls';\n\nimport styles from './garage.scss';\nimport { Notifiable } from '../../lib/interfaces/notifiable';\nimport { PopupStandaloneModalProgressComp } from '../../lib/components/popups/standalone/modal/progress/popup-progress';\n\nexport class GarageComp extends BaseComp implements DBusHub, Notifiable {\n  readonly hubName = DBUS_HUB_NAMES.GARAGE;\n\n  private controller: GarageCompCtlAkaDirector;\n\n  private isControllerWorking = false;\n\n  private mainControlsComp = new MainControlsComp();\n\n  private carsCtlsBlock = document.createElement('div');\n\n  private bgVideo = document.createElement('video');\n\n  private popup = new PopupStandaloneModalProgressComp();\n\n  constructor() {\n    super('section');\n    this.popup.setText('Loading...').setProgress(1).show();\n    this._rootElement.classList.add(styles.garage);\n\n    const selfCtlsBlock = document.createElement('div');\n    selfCtlsBlock.classList.add(styles['garage-bg__self-ctls-block']);\n    selfCtlsBlock.append(this.mainControlsComp.rootElement);\n\n    const bg = document.createElement('div');\n    bg.classList.add(styles.garage__bg, styles['garage-bg']);\n    bg.append(this.bgVideo, selfCtlsBlock);\n\n    const tracksContainer = document.createElement('div');\n    tracksContainer.classList.add(\n      styles['garage__track-container'],\n      styles['synthwave-background'],\n    );\n\n    this.carsCtlsBlock.classList.add(styles['garage-bg__cars-ctls-block']);\n\n    this.controller = new GarageCompCtlAkaDirector(\n      tracksContainer,\n      this.carsCtlsBlock,\n    );\n\n    this.setupBgVideo();\n\n    this._rootElement.append(bg, tracksContainer, this.carsCtlsBlock);\n  }\n\n  private setupBgVideo() {\n    this.bgVideo.addEventListener('progress', this.bgVideoProgressListener);\n    this.bgVideo.addEventListener(\n      'canplaythrough',\n      this.bgVideoCanPlayListener,\n    );\n    this.renderBgVideo();\n  }\n\n  private renderBgVideo() {\n    this.bgVideo.classList.add(styles['garage-bg__video']);\n    this.bgVideo.controls = false;\n    this.bgVideo.loop = true;\n    this.bgVideo.defaultMuted = true;\n    this.bgVideo.muted = true;\n    this.bgVideo.autoplay = true;\n    this.bgVideo.src = './assets/videos/bg/cyberpunk2077-garage.mp4';\n  }\n\n  private bgVideoProgressListener = () => {\n    if (this.bgVideo.buffered.length > 0) {\n      const progress =\n        (this.bgVideo.buffered.end(0) / this.bgVideo.duration) * 100;\n      this.popup.setProgress(progress);\n    }\n  };\n\n  private bgVideoCanPlayListener = async () => {\n    this.bgVideo.removeEventListener(\n      'canplaythrough',\n      this.bgVideoCanPlayListener,\n    );\n    this.bgVideo.removeEventListener('progress', this.bgVideoProgressListener);\n    this.popup.setProgress(100).reset().hide();\n    this.isControllerWorking = await this.controller.startWorking();\n  };\n\n  connect(int: DBusInterface): void {\n    int.attachSubHub(this.controller);\n    int.attachSubHub(this.mainControlsComp);\n  }\n\n  notify = async (): Promise<void> => {\n    try {\n      this.bgVideo.play();\n    } catch {\n      // do nothing...\n    }\n    if (!this.isControllerWorking) {\n      this.isControllerWorking = await this.controller.startWorking();\n    }\n  };\n}\n","import { OBJ_PROCESSOR } from '../../lib/processors/obj-processor';\n\nclass RaceStatuses {\n  readonly READY_TO_GO = 'READY_TO_GO';\n\n  readonly IN_PROCESS = 'IN_PROCESS';\n\n  readonly NEED_RESET = 'NEED_RESET';\n\n  readonly RACE_REJECTED = 'RACE_REJECTED';\n\n  readonly RACE_INTERRUPTED = 'RACE_INTERRUPTED';\n}\n\nconst obj = new RaceStatuses();\n\nconst RACE_STATUSES = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { RACE_STATUSES };\n\nexport type RaceStatusesList = keyof RaceStatuses;\n","import { RegCarData, UnregCarData } from '../../../../definitions/car-data.def';\nimport { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { hexToRgb } from '../../../../lib/convertors/colors';\nimport { OBJ_PROCESSOR } from '../../../../lib/processors/obj-processor';\n\nimport styles from './car.scss';\nimport garageStyles from '../../garage.scss';\nimport sharedStyles from '../../../../styles/styles.scss';\nimport { commitStyles } from '../../../../lib/gui/animation';\n\nexport class CarComp extends BaseComp {\n  static readonly TIMING_FUNCTION = 'cubic-bezier(.72,.2,.54,.77)';\n\n  static readonly CAR_BODY_IMG_SRC = './assets/imgs/cars/body.gif';\n\n  static readonly CAR_WHEEL_IMG_SRC = './assets/imgs/cars/tire back.gif';\n\n  static readonly CAR_EXPLOSION_IMG_DATA = {\n    BASE_URL: './assets/imgs/cars/explosion/',\n    EXTENSION: '.png',\n    FRAMES_COUNT: 9,\n    FRAME_TIME_MS: 200,\n  };\n\n  protected canvas = document.createElement('canvas');\n\n  protected tireBack = document.createElement('img');\n\n  private btnSelect$ = document.createElement('button');\n\n  private btnRm$ = document.createElement('button');\n\n  private spanCarName$ = document.createElement('span');\n\n  private btnStart$ = document.createElement('button');\n\n  private btnReset$ = document.createElement('button');\n\n  private currAnimation: Animation | undefined;\n\n  private currOutOfSceneAnim: Animation | undefined;\n\n  private isReseted = true;\n\n  private observer: MutationObserver;\n\n  private movingClassName = garageStyles['synthwave-background_race-mode'];\n\n  // ? mid tier\n  constructor(private _currCar: RegCarData, public index?: number) {\n    super('div');\n    this._rootElement.classList.add(styles['car-div']);\n\n    this.canvas.classList.add(styles['car-div__canvas']);\n    this._rootElement.append(this.canvas);\n\n    this.renderBtns();\n\n    this.renderCar();\n\n    this.btnReset$.disabled = true;\n\n    this.observer = new MutationObserver(this.observerFunc);\n  }\n\n  // ? mid tier\n  private renderCar() {\n    CarComp.drawCar(this.canvas, this._currCar.color);\n    CarComp.drawWheels(this._rootElement);\n    this.spanCarName$.textContent = `${this.index}: ${this._currCar.name}`;\n  }\n\n  // ? mid tier textContent may be moved to static prop but it's so small\n  private renderBtns() {\n    const selectSpan = document.createElement('span');\n    const rmSpan = document.createElement('span');\n    const startSpan = document.createElement('span');\n    const resetSpan = document.createElement('span');\n\n    selectSpan.textContent = 'select';\n    rmSpan.textContent = 'remove';\n    startSpan.textContent = 'start!';\n    resetSpan.textContent = 'reset';\n\n    this.btnSelect$.append(selectSpan);\n    this.btnRm$.append(rmSpan);\n    this.btnReset$.append(resetSpan);\n    this.btnStart$.append(startSpan);\n  }\n\n  // * good\n  private observerFunc = (mutations: MutationRecord[]) => {\n    mutations.forEach(mutation => {\n      if (mutation.oldValue?.includes(this.movingClassName)) {\n        this.currOutOfSceneAnim?.pause();\n        this.observer.disconnect();\n      } else {\n        const elem = mutation.target as HTMLElement;\n        if (elem.classList.contains(this.movingClassName)) {\n          this.outOfScene();\n        }\n      }\n    });\n  };\n\n  // * good\n  static drawWheels(rootElem: HTMLElement): void {\n    const wheelImg = new Image();\n    wheelImg.src = CarComp.CAR_WHEEL_IMG_SRC;\n    wheelImg.onload = () => {\n      wheelImg.classList.add(styles['car-div__wheel']);\n      const backwardWheelImg = OBJ_PROCESSOR.deepClone(wheelImg);\n      wheelImg.classList.add(styles['car-div__wheel_forward']);\n      backwardWheelImg.classList.add(styles['car-div__wheel_backward']);\n\n      rootElem.append(wheelImg);\n      rootElem.append(backwardWheelImg);\n    };\n  }\n\n  // * good\n  updateData(carData: RegCarData): void {\n    this._currCar = carData;\n    CarComp.drawCar(this.canvas, this._currCar.color);\n    this.spanCarName$.textContent = `${this.index}: ${carData.name}`;\n  }\n\n  // * good\n  public toggleIgniteAnim(state: boolean): void {\n    if (state) this._rootElement.classList.add(styles['car-div_ignite']);\n    else this._rootElement.classList.remove(styles['car-div_ignite']);\n  }\n\n  // * good\n  public async rollBack(\n    finishPromise: Promise<unknown> = Promise.resolve(),\n  ): Promise<boolean> {\n    return new Promise(res => {\n      const asyncFunc = async () => {\n        if (!this.isReseted) {\n          this.observer.disconnect();\n          this._rootElement.classList.remove(styles['car-div_borken']);\n          await this.playOutAnim();\n          if (this.currOutOfSceneAnim) {\n            this.currOutOfSceneAnim.cancel();\n            commitStyles(this.currOutOfSceneAnim);\n            this.currOutOfSceneAnim = undefined;\n          }\n          if (this.currAnimation) {\n            await this.stop();\n            this.currAnimation.playbackRate = -10;\n            this.currAnimation.play();\n            await this.currAnimation.finished;\n            commitStyles(this.currAnimation);\n            this.currAnimation = undefined;\n            this._rootElement.classList.remove(styles['car-div_rollForward']);\n          }\n          this._rootElement.style.removeProperty('transition');\n          this._rootElement.style.removeProperty('transform');\n          await this.playInAnim();\n          this._rootElement.style.removeProperty('opacity');\n          finishPromise.finally(() => {\n            this.btnStart$.disabled = false;\n            this.btnReset$.disabled = true;\n            this.btnRm$.disabled = false;\n            this.btnSelect$.disabled = false;\n          });\n        }\n        this.isReseted = true;\n        res(true);\n      };\n      asyncFunc();\n    });\n  }\n\n  // ? keyframes and animation props can be moved to static! But for what?\n  // TODO: Function may be a lib func! this is not necessary!\n  async playOutAnim(): Promise<void> {\n    if (document.body.classList.contains(sharedStyles['no-glitch'])) return;\n    const animOut = this._rootElement.animate(\n      [\n        { opacity: `0.5` },\n        { opacity: `0.9` },\n        { opacity: `0.3` },\n        { opacity: `0.7` },\n        { opacity: `0.1` },\n        { opacity: `0.4` },\n        { opacity: `0` },\n      ],\n      {\n        duration: 300,\n        easing: 'linear',\n        fill: 'forwards',\n      },\n    );\n    await animOut.finished;\n    commitStyles(animOut);\n  }\n\n  // ? keyframes and animation props can be moved to static! But for what?\n  // TODO: Function may be a lib func! this is not necessary!\n  async playAwaitingAnim(promiseToAwait: Promise<unknown>): Promise<void> {\n    return new Promise<void>(res => {\n      let animIn: Animation | undefined;\n      if (!document.body.classList.contains(sharedStyles['no-glitch'])) {\n        animIn = this._rootElement.animate(\n          [\n            { opacity: `0` },\n            { opacity: `0.6` },\n            { opacity: `0.3` },\n            { opacity: `0.8` },\n            { opacity: `0.3` },\n            { opacity: `0.6` },\n            { opacity: `0` },\n          ],\n          {\n            duration: 400,\n            easing: 'linear',\n            fill: 'forwards',\n            iterations: Number.POSITIVE_INFINITY,\n          },\n        );\n      }\n      promiseToAwait.finally(() => {\n        if (animIn) {\n          animIn.cancel();\n          commitStyles(animIn);\n        }\n        res();\n      });\n    });\n  }\n\n  // ? keyframes and animation props can be moved to static! But for what?\n  // TODO: Function may be a lib func! this is not necessary!\n  async playFirstIntroAnim(timeInMS = 500): Promise<void> {\n    const animIn = this._rootElement.animate(\n      [\n        { opacity: `0`, filter: 'blur(30px)' },\n        { opacity: `1`, filter: 'none' },\n      ],\n      {\n        duration: timeInMS,\n        easing: 'ease-in-out',\n        fill: 'forwards',\n      },\n    );\n    await animIn.finished;\n    commitStyles(animIn);\n  }\n\n  // ? keyframes and animation props can be moved to static! But for what?\n  // TODO: Function may be a lib func! this is not necessary!\n  async playInAnim(timeInMS = 300): Promise<void> {\n    if (document.body.classList.contains(sharedStyles['no-glitch'])) return;\n    const animIn = this._rootElement.animate(\n      [\n        { opacity: `0` },\n        { opacity: `0.6` },\n        { opacity: `0.3` },\n        { opacity: `0.8` },\n        { opacity: `0.5` },\n        { opacity: `1` },\n      ],\n      {\n        duration: timeInMS,\n        easing: 'linear',\n        fill: 'forwards',\n      },\n    );\n    await animIn.finished;\n    commitStyles(animIn);\n  }\n\n  // ? keyframes and animation props can be moved to static! But for what?\n  private outOfScene(): void {\n    this.isReseted = false;\n    this.currOutOfSceneAnim = this._rootElement.animate(\n      [{ transform: `translateX(${-1000}%)` }],\n      {\n        duration: 3600,\n        easing: 'ease-in',\n        fill: 'forwards',\n      },\n    );\n  }\n\n  // * good\n  public disableCtls(): void {\n    this.btnStart$.disabled = true;\n    this.btnRm$.disabled = true;\n    this.btnSelect$.disabled = true;\n    this.btnReset$.disabled = true;\n  }\n\n  // * good\n  public async rollForward(\n    time: number,\n    handleBtns = true,\n  ): Promise<number | undefined> {\n    this.isReseted = false;\n    return new Promise<number | undefined>((res, rej) => {\n      if (handleBtns) {\n        this.btnStart$.disabled = true;\n        this.btnRm$.disabled = true;\n        this.btnSelect$.disabled = true;\n        this.btnReset$.disabled = false;\n      }\n\n      const computedStyles = this.getStyles();\n      const coordinateInPercents =\n        this.calcDestinationInPercents(computedStyles);\n\n      this._rootElement.classList.add(styles['car-div_rollForward']);\n\n      this.currAnimation = this._rootElement.animate(\n        [{ transform: `translateX(${coordinateInPercents}%)` }],\n        {\n          duration: time * 1000 + 1000,\n          easing: 'ease-in-out',\n          fill: 'forwards',\n        },\n      );\n      this.currAnimation.onfinish = () => {\n        res(this.currAnimation?.playbackRate);\n      };\n      this.currAnimation.oncancel = () => {\n        this._rootElement.classList.remove(styles['car-div_rollForward']);\n        rej();\n      };\n    });\n  }\n\n  // ? may be lib func, but for what?\n  private getStyles(): {\n    parentStyle: CSSStyleDeclaration;\n    selfStyle: CSSStyleDeclaration;\n  } {\n    const parentStyle = window.getComputedStyle(\n      this._rootElement.parentElement as HTMLElement,\n    );\n    const selfStyle = window.getComputedStyle(this.rootElement);\n\n    return {\n      parentStyle,\n      selfStyle,\n    };\n  }\n\n  // ? may be lib func, but for what?\n  // ! magic number\n  private calcDestinationInPercents = (computedStyles: {\n    parentStyle: CSSStyleDeclaration;\n    selfStyle: CSSStyleDeclaration;\n  }): number => {\n    const rootWidth =\n      Number.parseFloat(computedStyles.parentStyle.width) -\n      Number.parseFloat(computedStyles.parentStyle.paddingLeft) -\n      Number.parseFloat(computedStyles.parentStyle.paddingRight);\n    const selfWidth = Number.parseFloat(computedStyles.selfStyle.width);\n\n    return ((rootWidth - selfWidth) / selfWidth) * 100;\n  };\n\n  // * mid tier\n  public async stop(\n    rollover = true,\n    broken = false,\n    flags?: Record<string, unknown>,\n  ): Promise<void> {\n    if (rollover) {\n      await new Promise(res => {\n        if (this.currAnimation?.playState === 'running') {\n          this.currAnimation.addEventListener('finish', () => res(true));\n          this.currAnimation.addEventListener('cancel', () => res(true));\n        } else res(true);\n      });\n    }\n    this._rootElement.classList.remove(styles['car-div_rollForward']);\n    this.currAnimation?.pause();\n    if (broken) {\n      if (flags) {\n        const roadElem = flags.roadElem as HTMLElement;\n        const roadIsMoving = roadElem.classList.contains(this.movingClassName);\n        if (roadIsMoving) this.outOfScene();\n        this.observer.observe(roadElem, {\n          attributes: true,\n          attributeOldValue: true,\n        });\n      }\n      this.playExplosionAnim();\n      this._rootElement.classList.add(styles['car-div_borken']);\n    }\n  }\n\n  // * explosion may be a gif, but... it's working now\n  playExplosionAnim(): void {\n    const img = new Image();\n    let frameNumber = 0;\n    img.classList.add(styles['car-div__explosion']);\n    img.src = `${CarComp.CAR_EXPLOSION_IMG_DATA.BASE_URL}${frameNumber}${CarComp.CAR_EXPLOSION_IMG_DATA.EXTENSION}`;\n    img.onload = async () => {\n      this._rootElement.append(img);\n      await new Promise(res =>\n        setTimeout(res, CarComp.CAR_EXPLOSION_IMG_DATA.FRAME_TIME_MS),\n      );\n      frameNumber++;\n      if (frameNumber < CarComp.CAR_EXPLOSION_IMG_DATA.FRAMES_COUNT) {\n        img.src = `${CarComp.CAR_EXPLOSION_IMG_DATA.BASE_URL}${frameNumber}${CarComp.CAR_EXPLOSION_IMG_DATA.EXTENSION}`;\n      } else {\n        img.remove();\n      }\n    };\n  }\n\n  // * good\n  public get currCar(): RegCarData {\n    return this._currCar;\n  }\n\n  // * good\n  public get btnSelect(): HTMLButtonElement {\n    return this.btnSelect$;\n  }\n\n  // * good\n  public get btnRm(): HTMLButtonElement {\n    return this.btnRm$;\n  }\n\n  // * good\n  public get btnStart(): HTMLButtonElement {\n    return this.btnStart$;\n  }\n\n  // * good\n  public get btnReset(): HTMLButtonElement {\n    return this.btnReset$;\n  }\n\n  // * good\n  public get spanCarName(): HTMLElement {\n    return this.spanCarName$;\n  }\n\n  // ! magic number\n  static drawCar(canvas: HTMLCanvasElement, hexColor: string): void {\n    const img = new Image();\n    img.src = CarComp.CAR_BODY_IMG_SRC;\n    img.onload = () => {\n      canvas.height = img.height / 3;\n      canvas.width = img.width / 3;\n      const ctx = canvas.getContext('2d');\n\n      if (ctx) {\n        ctx.shadowColor = hexColor;\n        ctx.shadowBlur = 25;\n        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n      }\n\n      CarComp.paintCarBody(canvas, hexColor);\n    };\n  }\n\n  // * good\n  static paintCarBody(canvas: HTMLCanvasElement, hexColor: string): void {\n    const imageData = canvas\n      .getContext('2d')\n      ?.getImageData(0, 0, canvas.width, canvas.height);\n    if (imageData) {\n      const rgb = hexToRgb(hexColor);\n      for (let j = 0; j < imageData.width; j++) {\n        for (let i = 0; i < imageData.height; i++) {\n          // index: red, green, blue, alpha, red, green, blue, alpha..etc.\n          const index = i * 4 * imageData.width + j * 4;\n          const red = imageData.data[index] as number;\n          const green = imageData.data[index + 1] as number;\n          const blue = imageData.data[index + 2] as number;\n          // const alpha = imageData.data[index + 3] as number;\n\n          const blueDiff = 2 * blue - red - green;\n          const blueDiffThreshold = 10;\n          const threshold = 70;\n          if (\n            red > threshold &&\n            green > threshold &&\n            blue > threshold &&\n            blueDiff < blueDiffThreshold\n          ) {\n            imageData.data[index] = (red / 255) * rgb.r;\n            imageData.data[index + 1] = (green / 255) * rgb.g;\n            imageData.data[index + 2] = (blue / 255) * rgb.b;\n            // imageData.data[index + 3] = 225; /// !!! TEST !!!\n          }\n        }\n      }\n      canvas\n        .getContext('2d')\n        ?.putImageData(imageData, 0, 0, 0, 0, canvas.width, canvas.height);\n    }\n  }\n\n  // * good\n  static genPreview(car: UnregCarData): HTMLElement {\n    const container = document.createElement('div');\n    const canvas = document.createElement('canvas');\n    canvas.classList.add(styles['car-div__canvas']);\n    container.append(canvas);\n    CarComp.drawWheels(container);\n    CarComp.drawCar(canvas, car.color);\n    return container;\n  }\n}\n","import { UnregCarData } from '../../../../../definitions/car-data.def';\nimport { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { REST_CLIENT_GARAGE } from '../../../../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionCreatedMsg } from '../../../dbus-msgs/by-topic/car-action/garage-car-created-msg.def';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\n\nexport class CreateCompController extends CreateUpdateCompControllerProto {\n  private txs = new Set<DBusTX>();\n\n  constructor(elements: CreateUpdateCompControllerReqElems) {\n    super(elements.inputText, elements.inputColor, elements.btn);\n\n    this.setupBtnCreate();\n  }\n\n  private setupBtnCreate() {\n    this.btn.addEventListener('click', () => {\n      if (!this.reportValidity()) return;\n      this.btn.disabled = true;\n      const unregCar: UnregCarData = {\n        name: this.inputText.value,\n        color: this.inputColor.value,\n      };\n      REST_CLIENT_GARAGE.createCar(unregCar)\n        .then(car => {\n          // TODO: Notify with DBus\n          const msg = new DBusMsgCarActionCreatedMsg(car);\n          this.txs.forEach(tx => {\n            tx.transmit({\n              msg,\n              prepMode: DBusTXPrepModes.clone,\n              waitMode: DBusTXWaitModes.nowait,\n            });\n          });\n        })\n        .finally(() => {\n          this.btn.disabled = false;\n        });\n    });\n  }\n\n  autoConnect(int: DBusInterface): void {\n    const tx = int.getNewTX('send created car msgs');\n    this.txs.add(tx);\n  }\n}\n","import { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../../../../lib/services/dbus/defs/dbus-port.def';\n\nexport interface CreateUpdateCompControllerReqElems {\n  inputText: HTMLInputElement;\n  inputColor: HTMLInputElement;\n  btn: HTMLButtonElement;\n}\n\nexport abstract class CreateUpdateCompControllerProto implements DBusPort {\n  protected ctlsStateMap = new Map<HTMLElement, boolean>();\n\n  protected ctls = [this.inputText, this.inputColor, this.btn];\n\n  protected disabled = false;\n\n  constructor(\n    protected inputText: HTMLInputElement,\n    protected inputColor: HTMLInputElement,\n    protected btn: HTMLButtonElement,\n  ) {}\n\n  abstract autoConnect(int: DBusInterface): void | Promise<void>;\n\n  protected reportValidity(): boolean {\n    const { length } = this.inputText.value;\n    let valid = true;\n\n    if (length === 0) {\n      this.inputText.setCustomValidity('Please, enter a name');\n      valid = false;\n    }\n\n    if (length > 30) {\n      this.inputText.setCustomValidity('Name is too long!');\n      valid = false;\n    }\n\n    if (!valid) {\n      this.inputText.pattern = '';\n      this.inputText.reportValidity();\n      this.inputText.removeAttribute('pattern');\n      return false;\n    }\n\n    return true;\n  }\n\n  protected toogleCtlsDisabled(state: boolean): void {\n    this.inputText.disabled = state;\n    this.inputColor.disabled = state;\n    this.btn.disabled = state;\n  }\n\n  protected pushCtlsState(): void {\n    this.ctls.forEach(ctl => {\n      this.ctlsStateMap.set(ctl, ctl.disabled);\n    });\n  }\n\n  protected popCtlsState(): void {\n    this.ctls.forEach(ctl => {\n      const state = this.ctlsStateMap.get(ctl);\n      if (state !== undefined) ctl.disabled = state;\n    });\n    this.ctlsStateMap.clear();\n  }\n\n  disable(): void {\n    if (this.disabled) return;\n    this.disabled = true;\n    this.pushCtlsState();\n    this.toogleCtlsDisabled(true);\n  }\n\n  enable(): void {\n    if (!this.disabled) return;\n    this.disabled = false;\n    this.popCtlsState();\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../../../lib/processors/obj-processor';\nimport { DBUS_COMMON_RESPONSES } from '../../../../../lib/services/dbus/defs/dbus-common-responses.def';\nimport { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../../../../lib/services/dbus/defs/dbus-port.def';\nimport { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { REST_CLIENT_GARAGE } from '../../../../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionRemovedMsg } from '../../../dbus-msgs/by-topic/car-action/garage-car-remove-msg.def';\nimport { DBusMsgCarActionSelectedMsg } from '../../../dbus-msgs/by-topic/car-action/garage-car-select-msg.def';\nimport { DBusMsgGaragePageIsChangedMsg } from '../../../dbus-msgs/by-topic/garage/garage-page-is-changed.def';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\n\nexport class UpdateCompController\n  extends CreateUpdateCompControllerProto\n  implements DBusPort\n{\n  private choosedCar: RegCarData | undefined;\n\n  private notifyCb: ((car: RegCarData) => unknown) | undefined;\n\n  constructor(elements: CreateUpdateCompControllerReqElems) {\n    super(elements.inputText, elements.inputColor, elements.btn);\n\n    this.setupBtnUpdate();\n  }\n\n  autoConnect(int: DBusInterface): void {\n    const rxCarActions = int.getNewRX(\n      this.carActionsListener,\n      'listen car choosing',\n    );\n    int.plugRX(DBusTopics.CAR_ACTION, rxCarActions);\n\n    const rxGarage = int.getNewRX(\n      this.garageMsgsListener,\n      'listen garage paging',\n    );\n    int.plugRX(DBusTopics.GARAGE, rxGarage);\n  }\n\n  private garageMsgsListener = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgGaragePageIsChangedMsg) {\n      this.reset();\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private reset() {\n    this.notifyCb = undefined;\n    this.choosedCar = undefined;\n    this.inputText.value = '';\n    this.inputColor.value = '#000000';\n    this.toogleCtlsDisabled(true);\n  }\n\n  private carActionsListener = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgCarActionSelectedMsg) {\n      this.choosedCar = OBJ_PROCESSOR.deepClone(data.msg.car);\n      this.notifyCb = data.msg.notifyChanges;\n      this.inputColor.value = data.msg.car.color;\n      this.inputText.value = data.msg.car.name;\n      this.toogleCtlsDisabled(false);\n    }\n    if (\n      data.msg instanceof DBusMsgCarActionRemovedMsg &&\n      data.msg.car.id === this.choosedCar?.id\n    ) {\n      this.reset();\n    }\n\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private setupBtnUpdate() {\n    this.toogleCtlsDisabled(true);\n    this.btn.addEventListener('click', () => {\n      if (!this.reportValidity()) return;\n      this.toogleCtlsDisabled(true);\n      if (!this.choosedCar) return;\n      this.choosedCar.color = this.inputColor.value;\n      this.choosedCar.name = this.inputText.value;\n      REST_CLIENT_GARAGE.updateCar(this.choosedCar)\n        .then(car => {\n          if (this.notifyCb) this.notifyCb(car);\n        })\n        .finally(() => {\n          this.toogleCtlsDisabled(false);\n        });\n    });\n  }\n}\n","import { BaseComp } from '../../../../../lib/components/base-comp/base-comp';\nimport { DBUS_HUB_NAMES } from '../../../../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { CreateCompController } from './controller-create';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\nimport { UpdateCompController } from './controller-update';\n\nimport styles from './create-update.scss';\nimport sharedStyles from '../../../../../styles/styles.scss';\n\nexport class CreateUpdateComponent extends BaseComp implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.CREATE_UPDATE;\n\n  protected textInput = document.createElement('input');\n\n  protected colorInput = document.createElement('input');\n\n  protected btn = document.createElement('button');\n\n  protected controller: CreateUpdateCompControllerProto;\n\n  constructor(type: 'CREATE' | 'UPDATE', btnText: string) {\n    super('div');\n    this._rootElement.classList.add(styles.root);\n    this.textInput.type = 'text';\n    this.textInput.classList.add(styles['text-input']);\n    this.colorInput.type = 'color';\n    this.colorInput.classList.add(styles['color-input']);\n    this.btn.textContent = btnText;\n    this.btn.classList.add(sharedStyles.btn);\n    this._rootElement.append(this.textInput, this.colorInput, this.btn);\n\n    const elements: CreateUpdateCompControllerReqElems = {\n      inputText: this.textInput,\n      inputColor: this.colorInput,\n      btn: this.btn,\n    };\n\n    switch (type) {\n      case 'UPDATE':\n        this.controller = new UpdateCompController(elements);\n        this.btn.classList.add(sharedStyles['btn-13']);\n        break;\n      case 'CREATE':\n      default:\n        this.controller = new CreateCompController(elements);\n        this.btn.classList.add(sharedStyles['btn-13']); // TODO: maybe change?\n        break;\n    }\n  }\n\n  getController(): CreateUpdateCompControllerProto {\n    return this.controller;\n  }\n\n  connect(int: DBusInterface): void {\n    this.controller.autoConnect(int);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport class DBusMsgGenerateCarsMsg extends DBusMsg {\n  constructor(\n    readonly status: 'start' | 'end',\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GENERATE, rxIds, prefResponseRxIds);\n  }\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { CreateUpdateComponent } from './create-update/create-update';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from '../../../../lib/services/dbus/defs/dbus-hub-names.def';\nimport { DBusMsgRaceRequestMsg } from '../../dbus-msgs/by-topic/garage/garage-race-request-msg.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusMsgGarageResetReqMsg } from '../../dbus-msgs/by-topic/garage/garage-reset-req-msg.def';\n\nimport styles from './main-controls.scss';\nimport sharedStyles from '../../../../styles/styles.scss';\nimport { REST_CLIENT_GARAGE } from '../../../../services/rest-clients/client-garage/rest-client-garage';\nimport {\n  CAR_MODEL_LIST,\n  CAR_MODEL_LIST_KEYS,\n} from '../../../../definitions/car-random-data.def';\nimport {\n  genRandomHexColor,\n  getRandomInt,\n} from '../../../../lib/generators/generators';\nimport { UnregCarData } from '../../../../definitions/car-data.def';\nimport { DBusTXData } from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBUS_COMMON_RESPONSES } from '../../../../lib/services/dbus/defs/dbus-common-responses.def';\nimport { DBusMsgGarageRaceStatusMsg } from '../../dbus-msgs/by-topic/garage/garage-race-status-msg.def';\nimport { DBusTopics } from '../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTX } from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgGenerateCarsMsg } from './dbus-msgs/generate-cars-msg.def';\nimport { PopupStandaloneModalProgressComp } from '../../../../lib/components/popups/standalone/modal/progress/popup-progress';\nimport { DBusMsgGarageStatusMsg } from '../../dbus-msgs/by-topic/garage/garage-status-msg.def';\nimport { RACE_STATUSES } from '../../race-statuses.def';\n\nexport class MainControlsComp extends BaseComp implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.MAIN_CONTROLS;\n\n  private txs = new Set<DBusTX>();\n\n  private createComponent = new CreateUpdateComponent('CREATE', 'create');\n\n  private updateComponent = new CreateUpdateComponent('UPDATE', 'update');\n\n  private btnRace = document.createElement('button');\n\n  private btnReset = document.createElement('button');\n\n  private btnGenerate = document.createElement('button');\n\n  private popup = new PopupStandaloneModalProgressComp();\n\n  constructor() {\n    super('div');\n    this._rootElement.classList.add(styles['main-controls']);\n\n    const btnsBlock = this.renderBtns();\n    this.btnRace.addEventListener('click', this.btnRaceClickListener);\n    this.btnReset.addEventListener('click', this.btnResetClickListener);\n    this.btnGenerate.addEventListener('click', this.generateClickListener);\n\n    this.btnReset.disabled = true;\n    this.btnRace.disabled = true;\n\n    this._rootElement.append(\n      this.createComponent.rootElement,\n      this.updateComponent.rootElement,\n      btnsBlock,\n    );\n  }\n\n  private generateClickListener = async () => {\n    this.btnGenerate.disabled = true;\n    const msg = new DBusMsgGenerateCarsMsg('start');\n    const transmissions: Promise<unknown>[] = [];\n    this.txs.forEach(tx => {\n      const transmission = tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n      transmissions.push(transmission);\n    });\n    await Promise.allSettled(transmissions);\n    this.popup\n      .reset()\n      .setText('please wait while the entries are generated')\n      .show();\n    this.generate(100, undefined, this.genCb).finally(() => {\n      this.popup.reset().hide();\n      const resolveMsg = new DBusMsgGenerateCarsMsg('end');\n      this.txs.forEach(tx => {\n        tx.transmit({\n          msg: resolveMsg,\n          prepMode: DBusTXPrepModes.freeze,\n          waitMode: DBusTXWaitModes.nowait,\n        });\n      });\n      this.btnGenerate.disabled = false;\n    });\n  };\n\n  private genCb = (progress: number) => {\n    this.popup.setProgress(progress);\n  };\n\n  private btnRaceClickListener = async () => {\n    this.btnRace.disabled = true;\n    this.btnGenerate.disabled = true;\n    const msg = new DBusMsgRaceRequestMsg();\n    const transmissions: Promise<unknown>[] = [];\n    this.txs.forEach(tx => {\n      const x = tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n      transmissions.push(x);\n    });\n    (await Promise.all(transmissions)).forEach(response => {\n      const results = response as PromiseSettledResult<unknown>[];\n      results.forEach(result => {\n        if (\n          result.status === 'fulfilled' &&\n          result.value === RACE_STATUSES.RACE_REJECTED\n        ) {\n          this.btnRace.disabled = false;\n          this.btnGenerate.disabled = false;\n        }\n      });\n    });\n  };\n\n  private btnResetClickListener = async () => {\n    this.btnReset.disabled = true;\n    this.btnGenerate.disabled = true;\n    const msg = new DBusMsgGarageResetReqMsg();\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n    });\n  };\n\n  private renderBtns(): HTMLElement {\n    const span = document.createElement('span');\n    span.textContent = 'race';\n    this.btnRace.append(span);\n    this.btnRace.classList.add(sharedStyles.btn, sharedStyles['btn-15']);\n    this.btnReset.textContent = 'reset';\n    this.btnReset.classList.add(sharedStyles.btn, sharedStyles['btn-9']);\n    this.btnGenerate.textContent = 'generate cars';\n    this.btnGenerate.classList.add(sharedStyles.btn, sharedStyles['btn-1']);\n\n    const btnBlock = document.createElement('div');\n    btnBlock.classList.add(styles['btn-block']);\n    btnBlock.append(this.btnRace, this.btnReset, this.btnGenerate);\n    return btnBlock;\n  }\n\n  private async generate(\n    total: number,\n    left?: number,\n    cb?: (progress: number) => unknown,\n  ): Promise<boolean> {\n    let genLeft = left || total;\n    const randomName = this.genRandomCarName();\n    const color = genRandomHexColor();\n    const unregCarData: UnregCarData = {\n      name: randomName,\n      color,\n    };\n    await REST_CLIENT_GARAGE.createCar(unregCarData);\n    genLeft--;\n\n    if (cb) {\n      const progress = (1 - genLeft / total) * 100;\n      cb(progress);\n    }\n\n    if (genLeft > 0) return this.generate(total, genLeft, cb);\n\n    return true;\n  }\n\n  private genRandomCarName = (): string => {\n    const manufacturerNumber = getRandomInt(CAR_MODEL_LIST_KEYS.length - 1);\n    const manufacturerName = CAR_MODEL_LIST_KEYS[\n      manufacturerNumber\n    ] as keyof typeof CAR_MODEL_LIST;\n    const models = CAR_MODEL_LIST[manufacturerName];\n    const modelNumber = getRandomInt(models.length - 1);\n    const modelName = models[modelNumber] as string;\n    return `${manufacturerName} ${modelName}`;\n  };\n\n  private rxFuncForRaceMsgs = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgGarageRaceStatusMsg) {\n      const { status } = data.msg;\n      switch (status) {\n        case 'READY_TO_GO':\n          this.btnRace.disabled = false;\n          this.btnReset.disabled = true;\n          this.btnGenerate.disabled = false;\n          this.createComponent.getController().enable();\n          this.updateComponent.getController().enable();\n          break;\n        case 'IN_PROCESS':\n          this.btnRace.disabled = true;\n          this.btnReset.disabled = false;\n          this.btnGenerate.disabled = true;\n          this.createComponent.getController().disable();\n          this.updateComponent.getController().disable();\n          break;\n        case 'NEED_RESET':\n          this.btnRace.disabled = true;\n          this.btnReset.disabled = false;\n          this.btnGenerate.disabled = false;\n          this.createComponent.getController().enable();\n          this.updateComponent.getController().enable();\n          break;\n        default:\n          break;\n      }\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private rxFuncForGarageMsgs = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgGarageStatusMsg) {\n      switch (data.msg.status) {\n        case 'car moves':\n          this.btnGenerate.disabled = true;\n          this.createComponent.getController().disable();\n          this.updateComponent.getController().disable();\n          break;\n        case 'all cars stopped':\n          this.btnGenerate.disabled = false;\n          this.createComponent.getController().enable();\n          this.updateComponent.getController().enable();\n          break;\n        case 'need reset':\n          this.btnReset.disabled = false;\n          break;\n        case 'reset is not needed':\n          this.btnReset.disabled = true;\n          break;\n        default:\n          break;\n      }\n    }\n  };\n\n  connect(int: DBusInterface): void {\n    int.attachSubHub(this.createComponent, 'cu_create');\n    int.attachSubHub(this.updateComponent, 'cu_delete');\n\n    const rx = int.getNewRX(\n      this.rxFuncForRaceMsgs,\n      'toggle btns in main-ctls-block',\n    );\n    int.plugRX(DBusTopics.GARAGE, rx);\n\n    const rx2 = int.getNewRX(\n      this.rxFuncForGarageMsgs,\n      'toggle btns in main-ctls-block',\n    );\n    int.plugRX(DBusTopics.GARAGE, rx2);\n\n    const tx = int.getNewTX('start race | broadcast generate');\n    this.txs.add(tx);\n  }\n}\n","import { RegCarData } from '../../../../definitions/car-data.def';\nimport { BaseComp } from '../../../../lib/components/base-comp/base-comp';\n\nexport class GaragePopupWinner extends BaseComp {\n  private header = document.createElement('h3');\n\n  private textTime = document.createElement('span');\n\n  private textName = document.createElement('span');\n\n  private textId = document.createElement('span');\n\n  private textNumber = document.createElement('span');\n\n  constructor() {\n    super('div');\n    this.header.textContent = 'WE HAVE A WINNER!';\n    this._rootElement.append(\n      this.header,\n      this.textTime,\n      this.textName,\n      this.textId,\n      this.textNumber,\n    );\n  }\n\n  setData(car: RegCarData, timeStr: string, indexStr?: string): void {\n    this.textTime.textContent = `Time: ${timeStr}s`;\n    this.textName.textContent = `Name of the car: \\n ${car.name}`;\n    this.textId.textContent = `ID of the car: ${car.id}`;\n    this.textNumber.textContent = indexStr\n      ? `Position on the track: ${indexStr}`\n      : ``;\n  }\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { CarComp } from '../car/car';\n\nimport styles from './track.scss';\n\nexport class TrackComp extends BaseComp {\n  private topBlock = document.createElement('div');\n\n  constructor() {\n    super('div');\n    this._rootElement.classList.add(styles.track);\n    this._rootElement.append();\n    this.topBlock.classList.add(styles['track__controls-block']);\n  }\n\n  illuminateSelf = (illuminate: boolean): void => {\n    if (illuminate) this._rootElement.classList.add(styles.track_illuminated);\n    else this._rootElement.classList.remove(styles.track_illuminated);\n  };\n\n  placeCar(carComp: CarComp): void {\n    if (this._rootElement.hasChildNodes()) {\n      this._rootElement.childNodes.forEach(child => child.remove());\n    }\n    this.topBlock.append(carComp.spanCarName);\n    this._rootElement.append(this.topBlock, carComp.rootElement);\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { DBus } from '../../lib/services/dbus/dbus';\nimport { DBUS_COMMON_RESPONSES } from '../../lib/services/dbus/defs/dbus-common-responses.def';\nimport {\n  DBusHubNamesList,\n  DBUS_HUB_NAMES,\n} from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBusMsgRouteIsChangedMsg } from '../../lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport { DBusMsgRoutingStatusMsg } from '../../lib/services/simple-router/dbus-msgs-defs/types/router-status-msg.def';\n\nimport styles from './header.scss';\nimport { NavItem } from './subcomps/nav-item/nav-item';\n\nexport class HeaderComponent extends BaseComp implements DBusHub {\n  private navContainer: HTMLElement;\n\n  private logo: HTMLElement;\n\n  protected anchors: HTMLAnchorElement[];\n\n  protected buses: DBus[] = [];\n\n  constructor(readonly hubName: DBusHubNamesList = DBUS_HUB_NAMES.HEADER) {\n    super('header');\n    this.rootElement.classList.add(styles.header);\n\n    // logo\n    this.logo = HeaderComponent.renderLogo();\n    this.rootElement.append(this.logo);\n\n    // nav\n    this.navContainer = document.createElement('nav');\n    this.navContainer.classList.add(styles['header-nav']);\n    this.rootElement.append(this.navContainer);\n\n    // ul\n    const ul = document.createElement('ul');\n    ul.classList.add(styles['header-nav__list']);\n    this.navContainer.append(ul);\n\n    // ul items\n    const classList = {\n      li: styles['header-nav__item'],\n      a: styles['header-nav__anchor'],\n      svg: styles['header-nav__svg'],\n      span: styles['header-nav__span'],\n    };\n\n    const garageNavItem = new NavItem('garage', '#garage', classList);\n    const winnersNavItem = new NavItem('winners', '#winners', classList);\n\n    const navItems = [garageNavItem, winnersNavItem];\n    this.anchors = navItems.map(item => item.anchor);\n\n    ul.append(...navItems.map(item => item.rootElement));\n  }\n\n  static renderLogo(): HTMLElement {\n    const logo = document.createElement('h1');\n    logo.classList.add(styles.header__logo);\n    const firstSpan = document.createElement('span');\n    firstSpan.textContent = 'async';\n    firstSpan.dataset.textContent = 'async';\n    const secondSpan = document.createElement('span');\n    secondSpan.textContent = 'race';\n    secondSpan.dataset.textContent = 'race';\n    logo.append(firstSpan, secondSpan);\n    return logo;\n  }\n\n  connect(int: DBusInterface): void {\n    const illuminateRX = int.getNewRX(\n      this.illuminateNavItem,\n      'illuminate nav items',\n    );\n    int.plugRX(DBusTopics.ROUTING, illuminateRX);\n  }\n\n  private illuminateNavItem = async (data: DBusTXData) => {\n    const { msg } = data;\n    if (msg instanceof DBusMsgRouteIsChangedMsg) {\n      this.anchors.forEach(anchor => {\n        if (anchor.getAttribute('href') === msg.newRoute) {\n          anchor.classList.add(styles['header-nav__anchor_active']);\n        } else {\n          anchor.classList.remove(styles['header-nav__anchor_active']);\n        }\n      });\n    }\n    if (msg instanceof DBusMsgRoutingStatusMsg) {\n      if (msg.status === 'restrained')\n        this.navContainer.classList.add(styles['header-nav_not-active']);\n      else if (msg.status === 'free')\n        this.navContainer.classList.remove(styles['header-nav_not-active']);\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\n\nexport interface NavItemStyles {\n  li?: string;\n  a?: string;\n  svg?: string;\n  span?: string;\n}\n\nexport class NavItem extends BaseComp {\n  private _anchor: HTMLAnchorElement;\n\n  protected iconImage: HTMLImageElement | undefined;\n\n  protected span: HTMLSpanElement;\n\n  constructor(\n    text: string,\n    href: string,\n    styles?: NavItemStyles,\n    iconSrc?: string,\n  ) {\n    super('li');\n\n    if (styles?.li) this._rootElement.classList.add(styles.li);\n    this._anchor = document.createElement('a');\n    this._anchor.setAttribute('href', href);\n\n    if (styles?.a) this._anchor.classList.add(styles.a);\n\n    if (iconSrc) {\n      this.iconImage = document.createElement('img');\n      this.iconImage.src = iconSrc;\n\n      if (styles?.svg) this.iconImage.classList.add(styles.svg);\n      this._anchor.append(this.iconImage);\n    }\n    this.span = document.createElement('span');\n    this.span.textContent = text;\n    this.span.dataset.textContent = text;\n\n    if (styles?.span) this.span.classList.add(styles.span);\n    this._anchor.append(this.span);\n\n    this.rootElement.append(this._anchor);\n  }\n\n  get anchor(): HTMLAnchorElement {\n    return this._anchor;\n  }\n}\n","import { PopupStandaloneModalChoiceComp } from '../../../lib/components/popups/standalone/modal/choice/popup-choice';\n\nimport styles from './popup-choice-first-open.scss';\nimport sharedStyles from '../../../styles/styles.scss';\n\nexport type FirstOpenDesicions = 'disable glitch' | 'enable glitch';\n\nexport class PopupStandaloneModalChoiceFirstOpenComp extends PopupStandaloneModalChoiceComp {\n  static readonly TEXT_CONTENT_ENG = {\n    HEADER: 'Welcome to ASYNC RACE by no95typem',\n    TEXT: `Hey! Before starting,\n      I ask you to restart the server\n      because I cannot predict what was done with it before me!\n      In addition, the application seems to be overloaded with effects,\n      some of which can be dangerous for people with epilepsy.\n      So choose whether to disable them or not.\n      And please read the notes on the \"Winners\" page.`,\n  };\n\n  private TEXT_CONTENT =\n    PopupStandaloneModalChoiceFirstOpenComp.TEXT_CONTENT_ENG;\n\n  constructor() {\n    super();\n    this.body.classList.add(styles.body);\n    this.renderText();\n\n    const enableBtn = document.createElement('button');\n    const outerSpan = document.createElement('span');\n    const innerSpan = document.createElement('span');\n    innerSpan.textContent = 'enable glitch';\n    innerSpan.dataset.textContent = 'enable glitch';\n    outerSpan.append(innerSpan);\n    enableBtn.append(outerSpan);\n    innerSpan.classList.add(styles.glitch);\n    enableBtn.classList.add(styles['glitch-parent']);\n\n    const disableBtn = document.createElement('button');\n    const span = document.createElement('span');\n    span.textContent = 'disable glitch';\n    disableBtn.append(span);\n\n    this.btns.push(enableBtn, disableBtn);\n    this.mapBtnsAndChoices(\n      { btn: enableBtn, desicion: 'enable glitch' },\n      { btn: disableBtn, desicion: 'disable glitch' },\n    );\n\n    this.btns.forEach(btn => {\n      btn.classList.add(sharedStyles.btn, sharedStyles['btn-6'], styles.btn);\n    });\n\n    this.btnBlock.append(...this.btns);\n\n    this.btnBlock.classList.add(styles['btn-block']);\n  }\n\n  private renderText() {\n    this.header.textContent = this.TEXT_CONTENT.HEADER;\n    this.text.textContent = this.TEXT_CONTENT.TEXT;\n  }\n}\n","import {\n  PopupStandaloneModalList,\n  PopupStandaloneModalListTextContent,\n} from '../../popup-list';\n\nexport class PopupStandaloneModalListCredits extends PopupStandaloneModalList {\n  static readonly TEXT_CONTENT_ENG: PopupStandaloneModalListTextContent = {\n    HEADER: `CREDITS`,\n    P1: `All assets were taken from open sources,\n      used for non-commercial purposes,\n      so I believe no one's rights were violated.\n      But nevertheless, I want to give links to the works used.`,\n    OL: {\n      LI1: {\n        text: `The video and background images are taken from materials\n        for the video game 'Cyberpunk 2077'. `,\n        anchors: [\n          {\n            text: `Thanks to CD Red Project and their designers!`,\n            href: 'https://magazine.artstation.com/2021/01/cd-projekt-red-cyberpunk-2077art-blast/`',\n            target: '_blank',\n          },\n        ],\n      },\n      LI2: {\n        text: `Beautiful car template created `,\n        anchors: [\n          {\n            text: 'by \"overcrafted\"',\n            href: `https://overcrafted.itch.io/free-paid-vehicle-car-sprites-`,\n            target: '_blank',\n          },\n        ],\n      },\n      LI3: {\n        text: `Explosion animation `,\n        anchors: [\n          {\n            text: 'by NYKNCK',\n            href: `https://kvsr.itch.io/explosion`,\n            target: '_blank',\n          },\n        ],\n      },\n      LI4: {\n        text: `Fire and exhause animations `,\n        anchors: [\n          {\n            text: 'by XYEzawr',\n            href: `https://xyezawr.itch.io/free`,\n            target: '_blank',\n          },\n        ],\n      },\n      LI5: {\n        text: `Font is Audiowide Mono `,\n        anchors: [\n          {\n            text: 'by gilescope ',\n            href: `https://github.com/gilescope/cyberpunkfonts`,\n            target: '_blank',\n          },\n          {\n            text: '[is licensed under SIL Open Font License 1.1]',\n            href: `./licenses/audiowide-regular.txt`,\n            target: '_blank',\n          },\n        ],\n      },\n      LI6: {\n        text: `Beautiful animations is a fork of \"Neon Buttons Animation\" pen `,\n        anchors: [\n          {\n            text: 'by Yuhomyan ',\n            href: `https://codepen.io/yuhomyan/pen/GRobbXB`,\n            target: '_blank',\n          },\n          {\n            text: '[license].',\n            href: `./licenses/neon-buttons-animations.txt`,\n            target: '_blank',\n          },\n        ],\n      },\n      LI7: {\n        text: `The track background is a fork of \"Synthwave background gradient\" pen `,\n        anchors: [\n          {\n            text: 'by Adam Hollister ',\n            href: `https://codepen.io/aaahollister/pen/daMMPg`,\n            target: '_blank',\n          },\n          {\n            text: '[license].',\n            href: `./licenses/synthwave-background-animation.txt`,\n            target: '_blank',\n          },\n        ],\n      },\n    },\n    CAPTION: `Thanks for reading!`,\n  };\n\n  constructor() {\n    super(PopupStandaloneModalListCredits.TEXT_CONTENT_ENG);\n  }\n}\n","import {\n  PopupStandaloneModalList,\n  PopupStandaloneModalListTextContent,\n} from '../../popup-list';\n\nexport class PopupStandaloneModalListNotes extends PopupStandaloneModalList {\n  static readonly TEXT_CONTENT_ENG: PopupStandaloneModalListTextContent = {\n    HEADER: `Dear visitor!`,\n    P1: `Please pay attention to the following points:`,\n    OL: {\n      LI1: {\n        text: `The server must be restarted before testing -\n        a previous FE that you may have tested before could,\n        for example, save colors in non-hex format,\n        create machines with incredibly long names,\n        leave engines enabled, etc.`,\n      },\n      LI2: {\n        text: `Unfortunately, the server works in such a way\n        that I have to take control of the machines\n        before the setTimeout happens on the server.\n        The fact is that the server turns off the engine in any case,\n        it does not look whether the engine was turned off manually earlier\n        and turned on again. As a result,\n        depending on your luck, you can run into different mistakes.`,\n      },\n      LI3: {\n        text: `The application has been tested in various scenarios in Chromium and Firefox.\n        You can even try shutting down the server after starting the race.\n        But if you suddenly find a bug, please write to me in discord (no95typem @ 9889).`,\n      },\n      LI4: {\n        text: `For a nicer look, turn on glitch if you can.`,\n      },\n      LI5: {\n        text: `I hope your hardware is not weak!\n        I have a little slowdown on chromium,\n        but on FF with webrender enabled, everything is fine!`,\n      },\n      LI6: {\n        text: `By the way, if we are talking about browsers,\n        please enable autoplay video permission (and reload the page)\n        if you have blocked this feature for pages (as I do).\n        The background on the garage page should be a playing video.`,\n      },\n      LI7: {\n        text: `For cross checkers - if you find flaws,\n        write at least in detail and do not do it anonymously, please!`,\n      },\n    },\n    CAPTION: `Thanks for reading!`,\n  };\n\n  constructor() {\n    super(PopupStandaloneModalListNotes.TEXT_CONTENT_ENG);\n  }\n}\n","import { BtnClose } from '../../../lib/components/btn-close/btn-close';\nimport { PopupStandaloneModalComp } from '../../../lib/components/popups/standalone/modal/popup-standalone-modal';\n\nimport styles from './popup-list.scss';\nimport sharedStyles from '../../../styles/styles.scss';\n\nexport type PopupStandaloneModalListTextContent = {\n  HEADER: string;\n  P1: string;\n  OL: Record<string, LiItem>;\n  CAPTION: string;\n};\n\nexport type LiItem = {\n  text?: string;\n  anchors?: LiItemAnchor[];\n};\n\nexport type LiItemAnchor = {\n  href: string;\n  text: string;\n  target: '_blank';\n};\n\nexport abstract class PopupStandaloneModalList extends PopupStandaloneModalComp {\n  protected TEXT_CONTENT: PopupStandaloneModalListTextContent;\n\n  protected list = document.createElement('ol');\n\n  protected btnOk = document.createElement('button');\n\n  protected btnCloseContainer = document.createElement('div');\n\n  protected caption = document.createElement('p');\n\n  constructor(TEXT_CONTENT: PopupStandaloneModalListTextContent) {\n    super();\n    this.TEXT_CONTENT = TEXT_CONTENT;\n    this.header.textContent = this.TEXT_CONTENT.HEADER;\n\n    this.renderList();\n\n    this.renderCloseBtns();\n    this.setupCloseActions();\n\n    this.renderOtherThings();\n\n    this.body.classList.add(styles.body);\n    this.body.append(\n      this.list,\n      this.btnCloseContainer,\n      this.caption,\n      this.btnOk,\n    );\n  }\n\n  private renderCloseBtns() {\n    const btnCloseComp = new BtnClose();\n    this.btnCloseContainer.classList.add(styles['btn-close-container']);\n    btnCloseComp.rootElement.classList.add(styles['btn-close']);\n    this.btnCloseContainer.append(btnCloseComp.rootElement);\n\n    this.btnOk.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['btn-ok'],\n    );\n\n    const btnOkOuterSpan = document.createElement('span');\n    const btnOkInnerSpan = document.createElement('span');\n    btnOkInnerSpan.textContent = 'OK';\n    btnOkInnerSpan.dataset.textContent = 'OK';\n    btnOkInnerSpan.classList.add(styles['btn-ok__innerSpan']);\n    btnOkOuterSpan.append(btnOkInnerSpan);\n    this.btnOk.append(btnOkOuterSpan);\n  }\n\n  private renderList() {\n    const liItemsArray = Object.values(this.TEXT_CONTENT.OL);\n    const liArray = liItemsArray.map(liItem => {\n      const li = document.createElement('li');\n\n      if (liItem.text) {\n        const span = document.createElement('span');\n        span.textContent = liItem.text;\n        li.append(span);\n      }\n\n      const anchors = liItem.anchors?.map(anchor => {\n        const anchorElem = document.createElement('a');\n        anchorElem.textContent = anchor.text;\n        anchorElem.href = anchor.href;\n        anchorElem.target = anchor.target;\n        return anchorElem;\n      });\n\n      if (anchors) li.append(...anchors);\n\n      return li;\n    });\n    this.list.append(...liArray);\n    this.list.classList.add(styles.ol);\n  }\n\n  private renderOtherThings() {\n    this.caption.textContent = this.TEXT_CONTENT.CAPTION;\n  }\n\n  private setupCloseActions() {\n    this.btnCloseContainer.addEventListener('click', () => this.hideSmoothly());\n    this.btnOk.addEventListener('click', () => this.hideSmoothly());\n    document.body.addEventListener('keydown', e => {\n      if (e.key === 'Escape') this.hideSmoothly();\n    });\n  }\n}\n","import { UnregCarData, WinnerCarData } from '../../../definitions/car-data.def';\nimport { BaseComp } from '../../../lib/components/base-comp/base-comp';\nimport { CarComp } from '../../garage/subcomps/car/car';\n\nexport class WinnerRowComp extends BaseComp {\n  private indexElem = document.createElement('td');\n\n  private idElem = document.createElement('td');\n\n  private carPreviewBox = document.createElement('td');\n\n  private nameElem = document.createElement('td');\n\n  private winsElem = document.createElement('td');\n\n  private bestTimeElem = document.createElement('td');\n\n  private carPreview: HTMLElement;\n\n  constructor(index: number, winnerData: WinnerCarData, carData: UnregCarData) {\n    super('tr');\n\n    this.indexElem.textContent = index.toString();\n    this.idElem.textContent = winnerData.id.toString();\n    this.carPreview = CarComp.genPreview(carData);\n    this.carPreviewBox.append(this.carPreview);\n    this.nameElem.textContent = carData.name;\n    this.winsElem.textContent = winnerData.wins.toString();\n    this.bestTimeElem.textContent = winnerData.time.toString();\n\n    this._rootElement.append(\n      this.indexElem,\n      this.idElem,\n      this.carPreviewBox,\n      this.nameElem,\n      this.winsElem,\n      this.bestTimeElem,\n    );\n  }\n\n  public getCarPreview(): HTMLElement {\n    return this.carPreview;\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { REST_CLIENT_WINNERS } from '../../services/rest-clients/client-winners/rest-client-winners';\nimport {\n  RestClientWinnersSortOptionsList,\n  REST_CLIENT_WINNERS_SORT_OPTIONS,\n} from '../../services/rest-clients/client-winners/rest-client-winners.def';\nimport { WinnerRowComp } from './subcomps/winner-entry';\nimport { Pager } from '../../lib/services/pager/pager';\n\nimport styles from './winners.scss';\nimport sharedStyles from '../../styles/styles.scss';\nimport { Notifiable } from '../../lib/interfaces/notifiable';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport { DBusTX } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgAppCtlReconfureReqMsg } from '../../app/dbus-msgs/reconfigure-req.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { PopupStandaloneModalProgressComp } from '../../lib/components/popups/standalone/modal/progress/popup-progress';\nimport { getRandomInt } from '../../lib/generators/generators';\nimport { PopupStandaloneModalListNotes } from '../popups/popup-list/inhereitors/popup-notes/popup-notes';\nimport { PopupStandaloneModalListCredits } from '../popups/popup-list/inhereitors/popup-credits/popup-credits';\nimport { WinnerCarData } from '../../definitions/car-data.def';\n\ntype BGInfo = {\n  src: string;\n  styles: string;\n};\n\nexport class WinnersComp extends BaseComp implements DBusHub, Notifiable {\n  static readonly TEXT_CONTENT_ENG = {};\n\n  static readonly BG_SRCS: BGInfo[] = [\n    {\n      src: './assets/imgs/backgrounds/winners/alessandro-aramino-artboard-1.jpg',\n      styles: 'no-repeat left 50% top 0% / cover',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/alexander-dudar-q000-chase7-06.jpg',\n      styles: 'no-repeat right 0% top 0% / cover',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/alexander-dudar-q000-chase8.jpg',\n      styles: 'no-repeat right 0% top 0% / cover',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/andrzej-bury-1-9.jpg',\n      styles: '',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/andrzej-bury-1-12.jpg',\n      styles: '',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/charlotte-hughes-18.jpg',\n      styles: '',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/lukasz-sprada-18.jpg',\n      styles: 'no-repeat right 0% top 0% / cover',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/masahiro-sawada-arasaka-warehouse.jpg',\n      styles: '',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/ward-lindhout-charter-hill-highway2.jpg',\n      styles: 'no-repeat right 0% bottom 0% / cover',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/wiktoria-stachowska-ow-05.jpg',\n      styles: '',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/witold-justyniak-04-v19a.jpg',\n      styles: '',\n    },\n  ];\n\n  readonly hubName = DBUS_HUB_NAMES.WINNERS;\n\n  private table = document.createElement('table');\n\n  private tableBody = document.createElement('tbody');\n\n  private tableHead = document.createElement('thead');\n\n  private thId = document.createElement('th');\n\n  private thCar = document.createElement('th');\n\n  private thName = document.createElement('th');\n\n  private thWins = document.createElement('th');\n\n  private thBestTime = document.createElement('th');\n\n  private pager: Pager;\n\n  private pagerBtnsContainer = document.createElement('div');\n\n  private pagerSpan: HTMLSpanElement;\n\n  private currSortedElem: HTMLElement | undefined;\n\n  private currOrder: 'ASC' | 'DESC' = 'ASC';\n\n  private currSort: RestClientWinnersSortOptionsList = 'time';\n\n  private entriesPerPage = 10;\n\n  protected txs = new Set<DBusTX>();\n\n  protected bottomBtnsContainer = document.createElement('div');\n\n  protected btnReconfigureGlitch = document.createElement('button');\n\n  protected btnNotes = document.createElement('button');\n\n  protected btnCredits = document.createElement('button');\n\n  protected popupNotes = new PopupStandaloneModalListNotes();\n\n  protected popupCredits = new PopupStandaloneModalListCredits();\n\n  protected currBGInfo: BGInfo | undefined;\n\n  protected popup = new PopupStandaloneModalProgressComp();\n\n  // * good\n  constructor() {\n    super('section');\n\n    this.pager = new Pager(this.entriesPerPage, this.pagerCallback);\n    this.pagerSpan = this.pager.getPagerSpan();\n\n    this.start();\n  }\n\n  // * good\n  private async start() {\n    await this.loadBg();\n\n    this.renderPager();\n\n    this.renderTable();\n\n    this.renderBottomBtnsContainer();\n\n    this.setupBottomBtnsActions();\n\n    this._rootElement.classList.add(styles.winners);\n    this._rootElement.append(this.table, this.bottomBtnsContainer);\n  }\n\n  // * good\n  static getRandomBGInfo(currBGInfo?: BGInfo): BGInfo {\n    const randomIndex = getRandomInt(WinnersComp.BG_SRCS.length);\n    const bgInfo = WinnersComp.BG_SRCS[randomIndex] as BGInfo;\n\n    if (currBGInfo === bgInfo) return this.getRandomBGInfo(currBGInfo);\n\n    return bgInfo;\n  }\n\n  // * good\n  loadBg(): Promise<boolean> {\n    return new Promise<boolean>(res => {\n      const bgInfo = WinnersComp.getRandomBGInfo(this.currBGInfo);\n      this.currBGInfo = bgInfo;\n      const { src } = bgInfo;\n\n      this.rootElement.style.setProperty(\n        'background',\n        `url('${src}') ${bgInfo.styles}`,\n      );\n\n      this.popup.reset().setText('Loading').setProgress(1).show();\n\n      const resolve = () => {\n        this.popup.setProgress(100).hide();\n        res(true);\n      };\n\n      fetch(src)\n        .then(async response => {\n          const imgReadResponse = this.getNewImgReadResponse(\n            response,\n            this.popup,\n          );\n          imgReadResponse.blob().finally(() => {\n            resolve();\n          });\n        })\n        .catch(() => resolve());\n    });\n  }\n\n  // ? NEED TO UNDERSTAND THIS IN MORE DEPTH\n  // * good\n  private getNewImgReadResponse = (\n    response: Response,\n    popup?: PopupStandaloneModalProgressComp,\n  ): Response => {\n    return new Response(\n      new ReadableStream({\n        async start(controller) {\n          const length = response.headers.get('content-length');\n          if (!response.body || !length) {\n            controller.close();\n            return;\n          }\n          const reader = response.body.getReader();\n          const totalBytes = Number.parseInt(length, 10);\n          let loadedBytes = 0;\n\n          const readMore = async () => {\n            const read = await reader.read();\n            const val = read.value;\n\n            if (val) {\n              loadedBytes += val.byteLength;\n              popup?.setProgress((loadedBytes / totalBytes) * 100);\n              controller.enqueue(val);\n            }\n\n            if (!read.done) readMore();\n            else controller.close();\n          };\n\n          readMore();\n        },\n      }),\n    );\n  };\n\n  // * good\n  private setupBottomBtnsActions() {\n    this.btnNotes.addEventListener('click', () =>\n      this.popupNotes.showSmoothly(),\n    );\n    this.btnCredits.addEventListener('click', () =>\n      this.popupCredits.showSmoothly(),\n    );\n    this.btnReconfigureGlitch.addEventListener('click', () => {\n      const msg = new DBusMsgAppCtlReconfureReqMsg();\n      this.txs.forEach(tx => {\n        tx.transmit({\n          msg,\n          prepMode: DBusTXPrepModes.freeze,\n          waitMode: DBusTXWaitModes.nowait,\n        });\n      });\n    });\n  }\n\n  // * good\n  private renderBottomBtnsContainer() {\n    const btnReconfigureGlitchObj = this.createBtnWithTwoSpans(\n      this.btnReconfigureGlitch,\n      'reconfigure glitch',\n    );\n    const btnNotesObj = this.createBtnWithTwoSpans(this.btnNotes, 'notes');\n    const btnCreditsObj = this.createBtnWithTwoSpans(\n      this.btnCredits,\n      'credits',\n    );\n\n    [btnNotesObj, btnCreditsObj, btnReconfigureGlitchObj].forEach(obj => {\n      obj.btn.classList.add(\n        sharedStyles.btn,\n        sharedStyles['btn-6'],\n        styles['btn-glitch'],\n      );\n      obj.btnInnerSpan.classList.add(styles['btn-glitch__innerSpan']);\n    });\n\n    this.bottomBtnsContainer.classList.add(styles['bottom-btns-container']);\n    this.bottomBtnsContainer.append(\n      this.btnNotes,\n      this.btnCredits,\n      this.btnReconfigureGlitch,\n    );\n  }\n\n  // * good\n  private createBtnWithTwoSpans = (btn: HTMLElement, textContent: string) => {\n    const btnOuterSpan = document.createElement('span');\n    const btnInnerSpan = document.createElement('span');\n    btnInnerSpan.textContent = textContent;\n    btnInnerSpan.dataset.textContent = textContent;\n    btnOuterSpan.append(btnInnerSpan);\n    btn.append(btnOuterSpan);\n    return {\n      btn,\n      btnOuterSpan,\n      btnInnerSpan,\n    };\n  };\n\n  // * good\n  private renderTable() {\n    this.renderTableHeader();\n    this.table.classList.add(styles.table);\n    this.table.append(\n      this.tableHead,\n      this.tableBody,\n      this.pagerBtnsContainer,\n      this.pagerSpan,\n    );\n  }\n\n  // ? TEXT CONTENT MAY BE MOVED TO STATIC BUT IT'S SO SMALL...\n  private renderTableHeader() {\n    const tr = document.createElement('tr');\n\n    const thIndex = document.createElement('th');\n    thIndex.textContent = '‚Ññ';\n    this.thId.textContent = 'ID';\n    this.thId.classList.add(styles['table__can-be-sorted']);\n    this.thCar.textContent = 'CAR';\n    this.thName.textContent = 'NAME';\n    this.thWins.textContent = 'WINS';\n    this.thWins.classList.add(styles['table__can-be-sorted']);\n    this.thBestTime.textContent = 'BEST TIME';\n    this.thBestTime.classList.add(styles['table__can-be-sorted']);\n\n    tr.append(\n      thIndex,\n      this.thId,\n      this.thCar,\n      this.thName,\n      this.thWins,\n      this.thBestTime,\n    );\n    this.tableHead.append(tr);\n    this.tableHead.addEventListener('click', this.tableHeadClickListener);\n  }\n\n  // * good\n  private renderPager() {\n    const btnPrevPage = this.pager.getBtnPrevPage();\n\n    btnPrevPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['pager-btn'],\n    );\n\n    const btnNextPage = this.pager.getBtnNextPage();\n\n    btnNextPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['pager-btn'],\n    );\n\n    this.pagerBtnsContainer.classList.add(styles.pager);\n    this.pagerBtnsContainer.append(btnPrevPage, btnNextPage);\n\n    this.pagerSpan.classList.add(styles['pager-span']);\n  }\n\n  // * good\n  async notify(): Promise<void> {\n    this.reloadData().then(() =>\n      this.refreshTableHeader(this.currSortedElem || this.thBestTime),\n    );\n    await this.loadBg();\n  }\n\n  // * good\n  private pagerCallback = async (dir: 'prev' | 'next'): Promise<boolean> => {\n    try {\n      await this.reloadData(dir);\n      return true;\n    } catch {\n      return false;\n    }\n  };\n\n  // * good\n  private async reloadData(dir?: 'prev' | 'next'): Promise<void> {\n    return new Promise((res, rej) => {\n      const page = dir\n        ? dir === 'next'\n          ? this.pager.getCurrPageNumber() + 1\n          : this.pager.getCurrPageNumber() - 1\n        : this.pager.getCurrPageNumber();\n\n      REST_CLIENT_WINNERS.getWinners(\n        page,\n        this.entriesPerPage,\n        this.currSort,\n        this.currOrder,\n      ).then(async response => {\n        this.pager.setEntriesCount(Number.parseInt(response.limit, 10));\n\n        if (response.cars.length === 0) {\n          if (dir) {\n            rej();\n            return;\n          }\n\n          if (page > 1) {\n            await this.pager.tryChangePage('prev');\n            res();\n            return;\n          }\n        }\n\n        await this.redrawWinners(response.cars, page);\n        res();\n      });\n    });\n  }\n\n  // * good\n  private async redrawWinners(cars: WinnerCarData[], pageNumber: number) {\n    const rows = new Array<WinnerRowComp>(cars.length);\n    const promises: Promise<unknown>[] = [];\n    const indexInc = (pageNumber - 1) * 10;\n    cars.forEach((winner, index) => {\n      const promise = REST_CLIENT_GARAGE.getCar(winner.id).then(car => {\n        const totalIndex = index + indexInc + 1;\n        const row = new WinnerRowComp(totalIndex, winner, car);\n        rows[index] = row;\n      });\n      promises.push(promise);\n    });\n    await Promise.allSettled(promises);\n    while (this.tableBody.firstChild) this.tableBody.firstChild.remove();\n    this.tableBody.append(\n      ...rows.map(row => {\n        row.getCarPreview().classList.add(styles['table__car-preview-box']);\n        return row.rootElement;\n      }),\n    );\n  }\n\n  // * good\n  private tableHeadClickListener = async (e: Event) => {\n    let sort: RestClientWinnersSortOptionsList | undefined;\n    switch (e.target) {\n      case this.thId:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.id;\n        break;\n      case this.thWins:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.wins;\n        break;\n      case this.thBestTime:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.time;\n        break;\n      default:\n        break;\n    }\n    if (sort) {\n      this.pager.toogleLock(true);\n      const elem = e.target as HTMLElement;\n      this.currOrder = elem.classList.contains(\n        styles['table__sorted-elem_desc'],\n      )\n        ? 'ASC'\n        : 'DESC';\n      this.currSort = sort;\n      await this.reloadData();\n      this.refreshTableHeader(elem);\n      this.pager.toogleLock(false);\n    }\n  };\n\n  // * good\n  private refreshTableHeader = (elem: HTMLElement) => {\n    if (this.currSortedElem)\n      this.currSortedElem.classList.remove(styles['table__sorted-elem']);\n\n    elem.classList.add(styles['table__sorted-elem']);\n    this.currSortedElem = elem;\n\n    if (this.currOrder === 'ASC') {\n      elem.classList.remove(styles['table__sorted-elem_desc']);\n      elem.classList.add(styles['table__sorted-elem_asc']);\n    } else {\n      elem.classList.remove(styles['table__sorted-elem_asc']);\n      elem.classList.add(styles['table__sorted-elem_desc']);\n    }\n  };\n\n  // * good\n  connect(int: DBusInterface): void {\n    const tx = int.getNewTX('winners tx');\n    this.txs.add(tx);\n  }\n}\n","import { OBJ_PROCESSOR } from '../lib/processors/obj-processor';\n\nconst models = {\n  Lamborghini: [\n    'Murci√©lago',\n    '350 GT',\n    '400 GT',\n    'Si√°n FKP 37',\n    'Essenza SCV12',\n    'Urus',\n    'Centenario',\n    'Hurac√°n',\n    'Veneno',\n    'Sesto Element–æ',\n    'Aventador',\n    'Revent√≥n',\n    'Gallardo',\n    'Diablo',\n    'LM002',\n    'Jalpa',\n    'Silhouette',\n    'Countach',\n    'Urraco',\n    'Jarama',\n    'Islero',\n    'Espada',\n    'Miura',\n  ],\n  'Aston Martin': [\n    'Project 003',\n    'Valkyrie',\n    'DBS',\n    'Vanquish Zagato',\n    'Vanquish',\n    'Virage/Virage Volante',\n    'V12 Zagato',\n    'One-77',\n    'V8 Coupe/V8 Volante',\n    'V8 Zagato',\n  ],\n  Ferrari: [\n    'Roma',\n    'Portfolio',\n    '488 GTB',\n    'California T',\n    '360 Spider',\n    '355 F1 Berlinetta',\n    'F355 GTS',\n    '456 GT',\n    'Testarossa',\n    'SF1000',\n  ],\n  Koenigsegg: [\n    'Jesko Absolut',\n    'Jesko',\n    'Agera Final',\n    'Agera XS',\n    'Agera X',\n    'Agera S',\n    'Regera',\n    'Agera RS',\n    'One:1',\n    'CCGT',\n  ],\n  Porsche: [\n    '918 Spyder',\n    'Boxster 982',\n    'Macan',\n    'Taycan',\n    'Panamera',\n    'Carrera GT',\n    'Cayenne',\n    '968',\n    '928',\n    '919 Hybrid',\n  ],\n  Jaguar: [\n    'F-Type',\n    'Jaguar XKR X100',\n    'Jaguar XKR X150',\n    'R5',\n    'R4',\n    'R3',\n    'R2',\n    'R1',\n    'F-Pace',\n    'E-Pace',\n  ],\n  Maserati: [\n    'Kyalami',\n    'Khamsin',\n    'Indy',\n    'Mexico',\n    'Merak',\n    'MC12',\n    'Spyder',\n    'Gransport',\n    '4300 GT Coupe',\n    '3200 GT',\n  ],\n  'Mercedes-Benz': [\n    'AMG GT',\n    'SLS AMG',\n    'SLR-McLaren',\n    'R170',\n    'R171',\n    'W220',\n    'W221',\n    'W222',\n    'W223',\n    'W163',\n  ],\n  McLaren: [\n    'Artura',\n    'Elva',\n    'Speedtail',\n    'GT',\n    'Senna',\n    '720S',\n    '570S',\n    '675LT',\n    '650S',\n    'P1',\n  ],\n  Spyker: [\n    'C8 Laviolette',\n    'C8 Spyder',\n    'C8 Spyder T (Turbo)',\n    'Spyker C8 Double 12 S',\n    'Spyker C8 Aileron',\n    'C12',\n    'B6 Venator',\n    'C12 Zagato',\n    'D12 Peking-to-Paris',\n    'C12 La Turbie',\n  ],\n};\n\nconst CAR_MODEL_LIST = OBJ_PROCESSOR.deepFreeze(models);\n\nexport { CAR_MODEL_LIST };\n\nconst CAR_MODEL_LIST_KEYS = OBJ_PROCESSOR.deepFreeze(\n  Object.keys(CAR_MODEL_LIST),\n);\n\nexport { CAR_MODEL_LIST_KEYS };\n","export class BaseComp {\n  protected _rootElement: HTMLElement;\n\n  constructor(tag: keyof HTMLElementTagNameMap = 'div') {\n    this._rootElement = document.createElement(tag);\n  }\n\n  public get rootElement(): HTMLElement {\n    return this._rootElement;\n  }\n}\n","import { BaseComp } from '../base-comp/base-comp';\nimport svg from './btn-close.svg';\n\nexport class BtnClose extends BaseComp {\n  constructor() {\n    super('div');\n    const image = new Image();\n    image.src = svg;\n    this._rootElement.append(image);\n  }\n}\n","import { PopupStandaloneModalComp } from '../popup-standalone-modal';\n\nimport sharedStyles from '../../../../../../styles/styles.scss';\n\nexport class PopupStandaloneModal404Comp extends PopupStandaloneModalComp {\n  constructor() {\n    super();\n    this.header.textContent = 'ERROR: 404';\n    this.header.dataset.textContent = this.header.textContent;\n    this.header.classList.add(sharedStyles['glitched-text']);\n    this.text.classList.add(sharedStyles['glitched-text']);\n  }\n}\n","import { PopupStandaloneModalComp } from '../popup-standalone-modal';\n\nexport type PopupChoiceCtl = {\n  btn: HTMLButtonElement;\n  desicion: string;\n};\n\nexport class PopupStandaloneModalChoiceComp extends PopupStandaloneModalComp {\n  protected btnBlock = document.createElement('div');\n\n  protected resolveFunc:\n    | ((value: string | PromiseLike<string>) => void)\n    | undefined;\n\n  protected choicePromise: Promise<string>;\n\n  protected btns: HTMLButtonElement[] = [];\n\n  constructor() {\n    super();\n    this.choicePromise = new Promise<string>(res => {\n      this.resolveFunc = res;\n    });\n    this.body.append(this.btnBlock);\n  }\n\n  recharge(): PopupStandaloneModalChoiceComp {\n    this.choicePromise = new Promise<string>(res => {\n      this.resolveFunc = res;\n    });\n    return this;\n  }\n\n  async awaitDesicion(): Promise<string> {\n    return this.choicePromise;\n  }\n\n  mapBtnsAndChoices(...ctls: PopupChoiceCtl[]): void {\n    ctls.forEach(control => {\n      control.btn.addEventListener('click', () =>\n        this.resolveFunc?.(control.desicion),\n      );\n    });\n  }\n}\n","import { commitStyles } from '../../../../gui/animation';\nimport { PopupStandaloneComp } from '../popup-standalone';\n\nimport styles from './popup-standalone-modal.scss';\n\nexport abstract class PopupStandaloneModalComp extends PopupStandaloneComp {\n  constructor() {\n    super();\n    this._rootElement.classList.add(styles['popup-modal']);\n    const closeArea = document.createElement('div');\n    closeArea.classList.add(styles['popup-bg']);\n    this._rootElement.append(closeArea);\n    this.body.classList.add(styles['popup-body']);\n    closeArea.append(this.body);\n    this.header.classList.add(styles['popup-body-header']);\n    this.text.classList.add(styles['popup-body-text']);\n  }\n\n  setHeader(text: string): PopupStandaloneModalComp {\n    this.header.textContent = text;\n    this.header.dataset.textContent = text;\n    return this;\n  }\n\n  setText(text: string): PopupStandaloneModalComp {\n    this.text.textContent = text;\n    this.text.dataset.textContent = text;\n    return this;\n  }\n\n  show(rootElem?: HTMLElement): PopupStandaloneModalComp {\n    const root = rootElem || document.body;\n    root.append(this._rootElement);\n    return this;\n  }\n\n  showSmoothly(rootElem?: HTMLElement): PopupStandaloneModalComp {\n    this.show(rootElem);\n    const anim = this._rootElement.animate(\n      [{ opacity: `0` }, { opacity: `1` }],\n      {\n        duration: 500,\n        easing: 'ease-in-out',\n        fill: 'forwards',\n      },\n    );\n    anim.oncancel = () => commitStyles(anim);\n    anim.onfinish = () => commitStyles(anim);\n    return this;\n  }\n\n  hide(): PopupStandaloneModalComp {\n    this._rootElement.remove();\n    return this;\n  }\n\n  async hideSmoothly(): Promise<PopupStandaloneModalComp> {\n    const anim = this._rootElement.animate(\n      [{ opacity: `1` }, { opacity: `0` }],\n      {\n        duration: 500,\n        easing: 'ease-in-out',\n        fill: 'forwards',\n      },\n    );\n    await anim.finished;\n    this.hide();\n    commitStyles(anim);\n    this._rootElement.style.removeProperty('opacity');\n    return this;\n  }\n}\n","import { PopupStandaloneModalComp } from '../popup-standalone-modal';\n\nimport styles from './popup-progress.scss';\nimport sharedStyles from '../../../../../../styles/styles.scss';\n\nexport class PopupStandaloneModalProgressComp extends PopupStandaloneModalComp {\n  private barContainer = document.createElement('div');\n\n  private bar = document.createElement('div');\n\n  constructor() {\n    super();\n    this.barContainer.classList.add(styles.container);\n    this.bar.classList.add(styles.bar);\n    this.barContainer.append(this.bar);\n    this.text.classList.add(styles.text, sharedStyles['glitched-text']);\n    this.body.classList.add(styles.body);\n    this.body.append(this.barContainer);\n  }\n\n  setHeader(text: string): PopupStandaloneModalProgressComp {\n    super.setHeader(text);\n    return this;\n  }\n\n  setText(text: string): PopupStandaloneModalProgressComp {\n    super.setText(text);\n    return this;\n  }\n\n  reset(): PopupStandaloneModalProgressComp {\n    this.bar.style.removeProperty('--progress');\n    this.text.textContent = '';\n    this.text.dataset.textContent = '';\n    return this;\n  }\n\n  setProgress(progress: number): PopupStandaloneModalProgressComp {\n    this.bar.style.setProperty('--progress', `${progress}%`);\n    return this;\n  }\n}\n","import { BaseComp } from '../../base-comp/base-comp';\n\nexport interface BasePopupAttrs {\n  configurable: boolean;\n}\n\nexport abstract class PopupStandaloneComp extends BaseComp {\n  protected body: HTMLElement;\n\n  protected header: HTMLHeadingElement;\n\n  protected text: HTMLParagraphElement;\n\n  constructor() {\n    super('div');\n\n    this.body = document.createElement('div');\n    this.header = document.createElement('h3');\n    this.text = document.createElement('p');\n\n    this.body.append(this.header, this.text);\n    this._rootElement.append(this.body);\n  }\n}\n","export function hexToRgb(hex: string): { r: number; g: number; b: number } {\n  let c: string[];\n  if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\n    // c = hex.substring(1).split('');\n    c = hex.split('');\n    if (c.length === 4) {\n      c = [c[1], c[1], c[2], c[2], c[3], c[3]] as string[];\n    }\n    const r = Number.parseInt(hex.slice(1, 3), 16);\n    const g = Number.parseInt(hex.slice(3, 5), 16);\n    const b = Number.parseInt(hex.slice(5, 7), 16);\n    // return `rgb(${r}, ${g}, ${b})`;\n    return { r, g, b };\n  }\n  throw new Error('Bad Hex');\n}\n","export function genUniqId(): string {\n  const arr = new Uint8Array(4);\n  return window.crypto.getRandomValues(arr).join('');\n}\n\nexport function getRandomInt(max: number): number {\n  return Math.floor(Math.random() * max);\n}\n\nexport function getRandomArbitraryInt(min: number, max: number): number {\n  return Math.floor(Math.random() * (max - min) + min);\n}\n\nexport function genRandomHexColor(): string {\n  const color = `#${Math.floor(Math.random() * 16_777_215).toString(16)}`;\n  if (color.length === 7) return color;\n  return genRandomHexColor();\n}\n","export interface TransitionPromiseInterface {\n  elem: HTMLElement;\n  prop: string;\n  val?: string;\n  valToWait?: string;\n  forceAutoresolveIn?: number;\n}\n\nexport function getTransitionDuration(\n  style: CSSStyleDeclaration,\n  prop: string,\n): string | undefined {\n  const transPropArr = style\n    .getPropertyValue('transition-property')\n    .replace(',', '')\n    .split(' ');\n  let propIndex = transPropArr.lastIndexOf(prop);\n\n  if (propIndex === -1) propIndex = transPropArr.lastIndexOf('all');\n\n  if (propIndex !== -1) {\n    const transDurationsArr = style\n      .getPropertyValue('transition-duration')\n      .replace(',', '')\n      .split(' ');\n    return transDurationsArr[propIndex];\n  }\n\n  return undefined;\n}\n\nexport function transitionPromise(\n  params: TransitionPromiseInterface,\n): Promise<boolean> {\n  return new Promise(resolve => {\n    const transformAndAutoresolve = (delay?: number): void => {\n      if (params.val) params.elem.style.setProperty(params.prop, params.val);\n      const time = delay || 20;\n      setTimeout(() => {\n        resolve(true);\n        // doesn't work - for cause look forward\n        // window.getComputedStyle(elem)[prop] == val ? resolve(true) : resolve(false);\n      }, time);\n    };\n\n    const transformAndWaitEvent = () => {\n      const eventHandler = (e: TransitionEvent): void => {\n        if (e.target !== params.elem) return;\n\n        if (e.propertyName !== params.prop) return;\n\n        if (\n          params.valToWait &&\n          window.getComputedStyle(params.elem).getPropertyValue(params.prop) !==\n            params.valToWait\n        ) {\n          return;\n        }\n\n        params.elem.removeEventListener('transitionend', eventHandler);\n        params.elem.removeEventListener('transitionend', eventHandler);\n\n        // val should be equal to style ! For example translate != matrix...\n        // if(val) window.getComputedStyle(elem)[prop] == val ? resolve(true) : reject(false);\n        // else\n        resolve(true);\n      };\n\n      params.elem.addEventListener('transitionend', eventHandler);\n      params.elem.addEventListener('transitioncancel', eventHandler);\n\n      if (params.val) params.elem.style.setProperty(params.prop, params.val);\n    };\n\n    if (params.forceAutoresolveIn)\n      transformAndAutoresolve(params.forceAutoresolveIn);\n    else if (\n      params.valToWait &&\n      window.getComputedStyle(params.elem).getPropertyValue(params.prop) ===\n        params.valToWait\n    )\n      transformAndAutoresolve();\n    else {\n      const style = window.getComputedStyle(params.elem);\n      const duration = getTransitionDuration(style, params.prop);\n\n      if (!duration || duration === '0s') {\n        transformAndAutoresolve();\n      } else {\n        transformAndWaitEvent();\n      }\n    }\n  });\n}\n\nexport function commitStyles(a: Animation): void {\n  const anim = a as unknown as Record<string, unknown>;\n  if ('commitStyles' in anim && typeof anim.commitStyles === 'function')\n    anim.commitStyles();\n}\n","export interface Notifiable {\n  notify: <T>(params: T) => void | Promise<void>;\n}\n\nexport function isNotifiable(object: unknown): object is Notifiable {\n  const objAsRecord = object as Record<string, unknown>;\n  return 'notify' in objAsRecord && typeof objAsRecord.notify === 'function';\n}\n","class ObjProcessor {\n  readonly deepFreeze = <T>(obj: T): T => {\n    if (typeof obj === 'object' && obj !== null) {\n      const record = obj as Record<string, unknown>;\n      Object.keys(record).forEach(prop => {\n        if (\n          typeof record[prop] === 'object' &&\n          !Object.isFrozen(record[prop])\n        ) {\n          this.deepFreeze(record[prop]);\n        }\n      });\n      return Object.freeze(obj);\n    }\n    throw new Error('not object');\n  };\n\n  readonly deepClone = <T>(target: T): T => {\n    if (Array.isArray(target)) {\n      const clone = [] as unknown[];\n      (target as unknown[]).forEach(v => {\n        clone.push(v);\n      });\n      return clone.map((n: unknown) => this.deepClone(n)) as unknown as T;\n    }\n\n    if (typeof target === 'object' && target !== null) {\n      if (target instanceof HTMLElement)\n        return target.cloneNode(true) as unknown as T;\n      // eslint-disable-next-line unicorn/prefer-spread\n      if (target instanceof Blob) return target.slice() as unknown as T;\n      const clone = {\n        ...(target as unknown as { [key: string]: unknown }),\n      } as {\n        [key: string]: unknown;\n      };\n      Object.keys(clone).forEach(k => {\n        clone[k] = this.deepClone(clone[k]);\n      });\n      Object.setPrototypeOf(clone, Object.getPrototypeOf(target));\n      return clone as unknown as T;\n    }\n    return target;\n  };\n}\n\nconst OBJ_PROCESSOR = new ObjProcessor();\nOBJ_PROCESSOR.deepFreeze(OBJ_PROCESSOR);\nexport { OBJ_PROCESSOR };\n","import { DBusTopics } from './defs/dbus-topics.def';\nimport { genUniqId } from '../../generators/generators';\nimport { OBJ_PROCESSOR } from '../../processors/obj-processor';\nimport { DBUS_ERRORS } from './defs/dbus-errors.def';\nimport { DBusRX, DBusRXFunc } from './defs/dbus-rx/dbus-rx.def';\nimport { DBusTX } from './defs/dbus-tx/dbus-tx.def';\nimport { DBusTXOptions } from './defs/dbus-tx/dbus-tx-options.def';\nimport { DBusTXData } from './defs/dbus-tx/dbus-tx-data.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from './defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTXDataHeaders } from './defs/dbus-tx/dbus-tx-data-headers.def';\nimport { DBusHub, DBusInterface } from './defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from './defs/dbus-hub-names.def';\n\nexport class DBus {\n  private network: Map<DBusTopics, Set<DBusRX>> = new Map();\n\n  private idCounter = {\n    txs: 0,\n    rxs: 0,\n  };\n\n  private createdRXs = new Set<DBusRX>();\n\n  private createdTXs = new Set<DBusTX>();\n\n  private attachedHubs = new Map<DBusHub, DBusInterface>();\n\n  private occupiedNames = new Set<string>();\n\n  readonly busId: string;\n\n  constructor() {\n    this.busId = genUniqId();\n    return Object.freeze(this) as unknown as DBus;\n  }\n\n  public attachHub(hub: DBusHub, suffix?: string): void | Promise<void> {\n    return this.createInterfaceForHub(hub, undefined, suffix);\n  }\n\n  private createInterfaceForHub(\n    hub: DBusHub,\n    prefix?: string,\n    suffix?: string,\n  ): void | Promise<void> {\n    if (this.attachedHubs.has(hub))\n      throw new Error(DBUS_ERRORS.HUB_IS_ALREADY_ATTACHED);\n\n    if (!(hub.hubName in DBUS_HUB_NAMES))\n      throw new Error(DBUS_ERRORS.HUB_NAME_NOT_AUTHORIZED);\n\n    let hubName = prefix ? `${prefix}_${hub.hubName}` : hub.hubName;\n    if (suffix) hubName += `_${suffix}`;\n\n    if (this.occupiedNames.has(hubName))\n      throw new Error(DBUS_ERRORS.HUB_NAME_IS_OCCUPIED);\n\n    // ! unicorn fails to detect that this functions must be here!\n    // eslint-disable-next-line unicorn/consistent-function-scoping\n    const arrowedGetNewTX = (desc?: string) => this.getNewTX(hubName, desc);\n    // eslint-disable-next-line unicorn/consistent-function-scoping\n    const arrowedGetNewRX = (func: DBusRXFunc, desc?: string) =>\n      this.genNewRX(func, desc);\n    // eslint-disable-next-line unicorn/consistent-function-scoping\n    const arrowedPlugRX = (topic: DBusTopics, rx: DBusRX) =>\n      this.plugRX(topic, rx);\n    // eslint-disable-next-line unicorn/consistent-function-scoping\n    const arrowedUnplugRX = (topic: DBusTopics, rx: DBusRX) =>\n      this.unplugRX(topic, rx);\n    // eslint-disable-next-line unicorn/consistent-function-scoping\n    const decoratedAttachHub = (subHub: DBusHub, subSuffix?: string) =>\n      this.createInterfaceForHub(subHub, hubName, subSuffix);\n\n    const dbusInterface = new DBusInterface(\n      arrowedGetNewTX,\n      arrowedGetNewRX,\n      arrowedPlugRX,\n      arrowedUnplugRX,\n      decoratedAttachHub,\n    );\n\n    this.occupiedNames.add(hubName);\n    this.attachedHubs.set(hub, dbusInterface);\n\n    OBJ_PROCESSOR.deepFreeze(dbusInterface);\n\n    return hub.connect(dbusInterface);\n  }\n\n  private getNewTX(hubName: string, desc?: string): DBusTX {\n    const id = genUniqId();\n    const regNumber = this.idCounter.txs++;\n\n    const arrowedTransmit = async (opts: DBusTXOptions) => {\n      const head = new DBusTXDataHeaders(\n        hubName,\n        id,\n        regNumber,\n        opts.waitMode,\n        opts.prepMode,\n        desc,\n      );\n      const data = new DBusTXData(head, opts.msg);\n      const result = await this.transmit(data);\n      return result;\n    };\n\n    const tx = new DBusTX(regNumber, id, this.busId, arrowedTransmit);\n\n    const freezedTX = OBJ_PROCESSOR.deepFreeze(tx);\n\n    this.createdTXs.add(freezedTX);\n\n    return freezedTX;\n  }\n\n  private genNewRX(func: DBusRXFunc, desc?: string): DBusRX {\n    const id = genUniqId();\n    const regNumber = this.idCounter.rxs++;\n    const rx = new DBusRX(regNumber, id, this.busId, func, desc);\n    const freezedRX = OBJ_PROCESSOR.deepFreeze(rx);\n    this.createdRXs.add(freezedRX);\n    return freezedRX;\n  }\n\n  private plugRX(topic: DBusTopics, rx: DBusRX): void {\n    if (!this.createdRXs.has(rx)) throw new Error(DBUS_ERRORS.XENO_RX);\n    if (!this.network.has(topic)) this.network.set(topic, new Set());\n    this.network.get(topic)?.add(rx);\n  }\n\n  private unplugRX(topic: DBusTopics, rx: DBusRX): void {\n    this.network.get(topic)?.delete(rx);\n  }\n\n  private async transmit(data: DBusTXData): Promise<unknown> {\n    if (!this.network.has(data.msg.topic)) {\n      throw new Error(DBUS_ERRORS.TOPIC_IS_NOT_EXIST);\n    }\n\n    const rxs = this.network.get(data.msg.topic);\n\n    if (rxs === undefined || rxs.size === 0)\n      throw new Error(DBUS_ERRORS.TOPIC_HAS_NO_RXS);\n\n    let choosedRXs: DBusRX[] = [];\n\n    if (data.msg.prefResponseRxIds) {\n      rxs.forEach(rx => {\n        if (data.msg.prefResponseRxIds?.includes(rx.id)) choosedRXs.push(rx);\n      });\n      if (choosedRXs.length === 0)\n        throw new Error(DBUS_ERRORS.PREF_RXS_ARE_NOT_EXIST);\n    } else choosedRXs = [...rxs];\n\n    let result;\n    switch (data.headers.waitMode) {\n      case DBusTXWaitModes.all:\n        result = await Promise.all(\n          choosedRXs.map(rx => this.callRXFunc(data, rx)),\n        );\n        break;\n      case DBusTXWaitModes.allSetled:\n        result = await Promise.allSettled(\n          choosedRXs.map(rx => this.callRXFunc(data, rx)),\n        );\n        break;\n      case DBusTXWaitModes.manual:\n        result = choosedRXs;\n        break;\n      case DBusTXWaitModes.nowait:\n      default:\n        choosedRXs.map(rx => this.callRXFunc(data, rx));\n        result = true;\n        break;\n    }\n    return result;\n  }\n\n  private callRXFunc = (data: DBusTXData, rx: DBusRX) => {\n    const handleClone = () => {\n      const clonedData = OBJ_PROCESSOR.deepClone(data);\n      return rx.func(clonedData);\n    };\n\n    const handleFreeze = () => {\n      const freezedData = OBJ_PROCESSOR.deepFreeze(data);\n      return rx.func(freezedData);\n    };\n\n    switch (data.headers.prepMode) {\n      case DBusTXPrepModes.clone:\n        return handleClone();\n      case DBusTXPrepModes.freeze:\n        return handleFreeze();\n      default:\n        throw new Error(DBUS_ERRORS.UNEXPECTED_PREP_MODE);\n    }\n  };\n}\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nconst dbusCommonResponses = {\n  VOID: 'VOID',\n  BAD_REQUEST: 'BAD_REQUEST',\n};\n\nconst DBUS_COMMON_RESPONSES = OBJ_PROCESSOR.deepFreeze(dbusCommonResponses);\n\nexport { DBUS_COMMON_RESPONSES };\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nconst dbusErrors = {\n  HUB_NAME_IS_OCCUPIED: 'HUB_NAME_IS_OCCUPIED',\n  HUB_IS_ALREADY_ATTACHED: 'HUB_IS_ALREADY_ATTACHED',\n  HUB_NAME_NOT_AUTHORIZED: 'HUB_NAME_NOT_AUTHORIZED',\n  XENO_RX: 'XENO_RX',\n  TOPIC_IS_NOT_EXIST: 'TOPIC_IS_NOT_EXIST',\n  TOPIC_HAS_NO_RXS: 'TOPIC_HAS_NO_RXS',\n  PREF_RXS_ARE_NOT_EXIST: 'PREF_RXS_ARE_NOT_EXIST',\n  UNEXPECTED_PREP_MODE: 'UNEXPECTED_PREP_MODE',\n};\n\nconst DBUS_ERRORS = OBJ_PROCESSOR.deepFreeze(dbusErrors);\n\nexport { DBUS_ERRORS };\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nclass DBusHubNames {\n  readonly APP = 'APP';\n\n  readonly ROUTER = 'ROUTER';\n\n  readonly GARAGE = 'GARAGE';\n\n  readonly HEADER = 'HEADER';\n\n  readonly MAIN_CONTROLS = 'MAIN_CONTROLS';\n\n  readonly CREATE_UPDATE = 'CREATE_UPDATE';\n\n  readonly GARAGE_CONTROLLER = 'GARAGE_CONTROLLER';\n\n  readonly WINNERS = 'WINNERS';\n}\n\nconst obj = new DBusHubNames();\n\nconst DBUS_HUB_NAMES = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { DBUS_HUB_NAMES };\n\nexport type DBusHubNamesList = keyof DBusHubNames;\n","import { DBusHubNamesList, DBUS_HUB_NAMES } from './dbus-hub-names.def';\nimport { DBusRX, DBusRXFunc } from './dbus-rx/dbus-rx.def';\nimport { DBusTopics } from './dbus-topics.def';\nimport { DBusTX } from './dbus-tx/dbus-tx.def';\n\nexport interface DBusHub {\n  readonly hubName: DBusHubNamesList;\n  connect: (dbusInterface: DBusInterface) => void | Promise<void>;\n  // TODO: handleSystemRequset: (request: unknown) => unknown | Promise<unknown>;\n}\n\nexport function isDBusHub(object: unknown): object is DBusHub {\n  const objAsRecord = object as Record<string, unknown>;\n  return (\n    'connect' in objAsRecord &&\n    'hubName' in objAsRecord &&\n    typeof objAsRecord.hubName === 'string' &&\n    objAsRecord.hubName in DBUS_HUB_NAMES\n  );\n}\n\nexport class DBusInterface {\n  private RXs = new Set<DBusRX>();\n\n  private TXs = new Set<DBusTX>();\n\n  private RXsPlugMap = new Map<DBusTopics, Set<DBusRX>>();\n\n  constructor(\n    private readonly arrowedGetNewTX: (desc?: string) => DBusTX,\n    private readonly arrowedGetNewRX: (\n      func: DBusRXFunc,\n      desc?: string,\n    ) => DBusRX,\n    private readonly arrowedPlugRX: (topic: DBusTopics, rx: DBusRX) => void,\n    private readonly arrowedUnplugRX: (topic: DBusTopics, rx: DBusRX) => void,\n    public readonly attachSubHub: (\n      subHub: DBusHub,\n      subSuffix?: string,\n    ) => void | Promise<void>,\n  ) {}\n\n  getNewRX(func: DBusRXFunc, desc?: string): DBusRX {\n    const rx = this.arrowedGetNewRX(func, desc);\n    this.RXs.add(rx);\n    return rx;\n  }\n\n  getNewTX(desc?: string): DBusTX {\n    const tx = this.arrowedGetNewTX(desc);\n    this.TXs.add(tx);\n    return tx;\n  }\n\n  plugRX(topic: DBusTopics, rx: DBusRX): void {\n    if (!this.RXsPlugMap.has(topic)) this.RXsPlugMap.set(topic, new Set());\n    this.RXsPlugMap.get(topic)?.add(rx);\n    this.arrowedPlugRX(topic, rx);\n  }\n\n  unplugRX(topic: DBusTopics, rx: DBusRX): void {\n    this.RXsPlugMap.get(topic)?.delete(rx);\n    this.arrowedUnplugRX(topic, rx);\n  }\n}\n","import { DBusTXData } from '../dbus-tx/dbus-tx-data.def';\n\nexport type DBusRXFunc = (data: DBusTXData) => Promise<unknown>;\n\nexport class DBusRX {\n  constructor(\n    readonly regNumber: number,\n    readonly id: string,\n    readonly busId: string,\n    readonly func: DBusRXFunc,\n    readonly desc?: string,\n  ) {}\n}\n","export enum DBusTopics {\n  APP_CTL,\n  ROUTING,\n  CAR_ACTION,\n  GARAGE,\n  REST_CLIENT_REQUESTS,\n  GENERATE,\n}\n","import { DBusTXPrepModes, DBusTXWaitModes } from './dbus-tx-modes.def';\n\nexport class DBusTXDataHeaders {\n  constructor(\n    readonly hubName: string,\n    readonly txId: string,\n    readonly txRegNumber: number,\n    readonly waitMode: DBusTXWaitModes,\n    readonly prepMode: DBusTXPrepModes,\n    readonly txDesc?: string,\n  ) {}\n}\n","import { DBusMsg } from '../msgs/dbus-msg.def';\nimport { DBusTXDataHeaders } from './dbus-tx-data-headers.def';\n\nexport class DBusTXData {\n  constructor(readonly headers: DBusTXDataHeaders, readonly msg: DBusMsg) {}\n}\n","export enum DBusTXWaitModes {\n  nowait,\n  all,\n  allSetled,\n  manual,\n}\n\nexport enum DBusTXPrepModes {\n  clone,\n  freeze,\n}\n","import { DBusTXOptions } from './dbus-tx-options.def';\n\nexport class DBusTX {\n  constructor(\n    readonly regNumber: number,\n    readonly id: string,\n    readonly busId: string,\n    readonly transmit: (options: DBusTXOptions) => Promise<unknown>,\n  ) {}\n}\n","import { DBusTopics } from '../dbus-topics.def';\n\nexport abstract class DBusMsg {\n  constructor(\n    readonly topic: DBusTopics,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {}\n}\n","export class Pager {\n  private firstPageNumber = 1;\n\n  private currPageNumber = this.firstPageNumber;\n\n  private lastPageNumber = 0;\n\n  private pagerSpan = document.createElement('span');\n\n  private entriesCount = 0;\n\n  private callbackIsCalled = false;\n\n  constructor(\n    private entriesPerPage: number,\n    protected readonly listCallback: (dir: 'prev' | 'next') => Promise<boolean>,\n    private btnPrevPage = document.createElement('button'),\n    private btnNextPage = document.createElement('button'),\n  ) {\n    const btnNextSpan = document.createElement('span');\n    btnNextSpan.textContent = 'Next page';\n    this.btnNextPage.append(btnNextSpan);\n\n    const btnPrevSpan = document.createElement('span');\n    btnPrevSpan.textContent = 'Prev page';\n    this.btnPrevPage.append(btnPrevSpan);\n\n    this.btnNextPage.addEventListener('click', () => this.callCallback('next'));\n    this.btnPrevPage.addEventListener('click', () => this.callCallback('prev'));\n  }\n\n  public toogleLock(lock: boolean): void {\n    this.toggleBtnsDisabled(lock);\n  }\n\n  public getEntriesPerPage(): number {\n    return this.entriesPerPage;\n  }\n\n  public setLastPageNumber(n: number): void {\n    this.lastPageNumber = n;\n    if (!this.callbackIsCalled) this.toggleBtnsDisabled(false);\n  }\n\n  public setEntriesCount(n: number): void {\n    this.entriesCount = n;\n    this.lastPageNumber = Math.ceil(this.entriesCount / this.entriesPerPage);\n    this.updateSpanText();\n    if (!this.callbackIsCalled) this.toggleBtnsDisabled(false);\n  }\n\n  public getCurrPageNumber(): number {\n    return this.currPageNumber;\n  }\n\n  public getBtnPrevPage(): HTMLSpanElement {\n    return this.btnPrevPage;\n  }\n\n  public getBtnNextPage(): HTMLSpanElement {\n    return this.btnNextPage;\n  }\n\n  public getPagerSpan(): HTMLSpanElement {\n    return this.pagerSpan;\n  }\n\n  tryChangePage(dir: 'prev' | 'next'): Promise<void> {\n    return this.callCallback(dir);\n  }\n\n  private updateSpanText() {\n    const pageNumber = this.entriesCount > 0 ? this.currPageNumber : 0;\n    this.pagerSpan.textContent = `Entries: ${this.entriesCount}, Page: ${pageNumber}/${this.lastPageNumber}`;\n  }\n\n  private async callCallback(dir: 'prev' | 'next') {\n    if (this.callbackIsCalled) return;\n    this.callbackIsCalled = true;\n    this.toggleBtnsDisabled(true);\n    this.listCallback(dir)\n      .then(pageIsChanged => {\n        if (pageIsChanged) {\n          switch (dir) {\n            case 'next':\n              this.currPageNumber++;\n              break;\n            case 'prev':\n              this.currPageNumber--;\n              break;\n            default:\n              break;\n          }\n          this.updateSpanText();\n        }\n      })\n      .finally(() => {\n        this.toggleBtnsDisabled(false);\n        this.callbackIsCalled = false;\n      });\n  }\n\n  private toggleBtnsDisabled(state: boolean) {\n    if (state === true) {\n      this.btnPrevPage.disabled = true;\n      this.btnNextPage.disabled = true;\n      return;\n    }\n\n    if (this.currPageNumber > this.firstPageNumber)\n      this.btnPrevPage.disabled = false;\n    else this.btnPrevPage.disabled = true;\n\n    if (this.currPageNumber < this.lastPageNumber)\n      this.btnNextPage.disabled = false;\n    else this.btnNextPage.disabled = true;\n  }\n}\n","import { DBusTopics } from '../../dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgRoutingMsg extends DBusMsg {\n  constructor(rxIds?: string[], prefResponseRxIds?: string[]) {\n    super(DBusTopics.ROUTING, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgRoutingMsg } from '../dbus-msg-routing-msg.def';\nimport { ROUTES } from '../../routes.def';\n\nexport class DBusMsgRouteIsChangedMsg extends DBusMsgRoutingMsg {\n  constructor(\n    readonly newRoute: keyof typeof ROUTES | string,\n    readonly addInfo?: unknown,\n    rxIds?: string[],\n    prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgRoutingMsg } from '../dbus-msg-routing-msg.def';\n\nexport type RouterStatus = 'restrained' | 'free';\n\nexport class DBusMsgRoutingStatusMsg extends DBusMsgRoutingMsg {\n  constructor(\n    readonly status: RouterStatus,\n    rxIds?: string[],\n    prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgRoutingMsg } from '../dbus-msg-routing-msg.def';\n\nexport type RoutingRestrainActions = 'restrain' | 'unleash';\n\nexport class DBusMsgRoutingRestrainMsg extends DBusMsgRoutingMsg {\n  constructor(\n    readonly action: RoutingRestrainActions,\n    readonly callback: () => Promise<boolean>,\n    rxIds?: string[],\n    prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","export class SimpleRouterAgent {\n  constructor(\n    readonly type: string,\n    readonly path: string,\n    readonly callback: CallableFunction,\n    readonly getStateCallback?: CallableFunction,\n    readonly setStateCallback?: CallableFunction,\n  ) {}\n}\n","import { OBJ_PROCESSOR } from '../../processors/obj-processor';\nimport { DBUS_HUB_NAMES } from '../dbus/defs/dbus-hub-names.def';\nimport { DBusHub, DBusInterface } from '../dbus/defs/dbus-interface.def';\nimport { DBusTopics } from '../dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../dbus/defs/dbus-tx/dbus-tx-data.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgRouteIsChangedMsg } from './dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport {\n  DBusMsgRoutingStatusMsg,\n  RouterStatus,\n} from './dbus-msgs-defs/types/router-status-msg.def';\nimport { DBusMsgRoutingRestrainMsg } from './dbus-msgs-defs/types/routing-restrict-msg.def';\nimport { SimpleRouterAgent } from './simple-router-agent';\n\nexport interface RouterOptions {\n  mode: string;\n  onlyDBus?: true;\n  defaultRoot?: string;\n  defaultAgent?: SimpleRouterAgent;\n}\n\nexport class SimpleRouter implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.ROUTER;\n\n  private agents: Set<SimpleRouterAgent> = new Set();\n\n  private options: RouterOptions;\n\n  private currRoute: string | undefined;\n\n  private txs: Set<DBusTX> = new Set();\n\n  private defaultAgent: SimpleRouterAgent | undefined;\n\n  private restrains: Set<() => Promise<boolean>> = new Set();\n\n  constructor(options: RouterOptions) {\n    switch (options.mode) {\n      case '#':\n        // just filter that # mode\n        break;\n      case '?':\n        throw new Error(`${options.mode} is not supported yet!`);\n      default:\n        throw new Error(`${options.mode} is not supported!`);\n    }\n    this.options = OBJ_PROCESSOR.deepFreeze(options);\n\n    window.addEventListener('popstate', async () => {\n      if (window.location.href === this.currRoute) return;\n\n      if (this.restrains.size > 0) {\n        const wantedRoute = window.location.href;\n\n        if (this.currRoute) {\n          window.location.href = this.currRoute;\n        } else if (this.options.defaultRoot) {\n          window.location.href = `${window.location.host}/${this.options.defaultRoot}`;\n        }\n        const arr = [...this.restrains.values()];\n        const promises = arr.map(arrow => arrow());\n        const result = await Promise.all(promises);\n        let cancelRouteChange = false;\n\n        if (Array.isArray(result)) {\n          for (let i = 0; i < result.length; i++) {\n            if (typeof result[i] !== 'boolean')\n              throw new Error('restrict func returned not boolean value!');\n\n            if (!result[i]) cancelRouteChange = true;\n            else {\n              const func = arr[i];\n\n              if (func) this.restrains.delete(func);\n              if (this.restrains.size === 0)\n                this.broadcastRoutingStatus('free');\n            }\n          }\n        }\n\n        if (!cancelRouteChange) window.location.href = wantedRoute;\n      } else {\n        this.activateWantedAgents();\n      }\n    });\n  }\n\n  private broadcastRoutingStatus(status: RouterStatus) {\n    const msg = new DBusMsgRoutingStatusMsg(status);\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  activateWantedAgents(addInfo?: unknown): boolean | Error[] {\n    this.currRoute = window.location.href;\n    let activatedCount = 0;\n    const errors = [];\n\n    if (!this.options.onlyDBus && this.options.mode === '#') {\n      const agentsArr = [...this.agents];\n      for (let i = 0; i < this.agents.size; i++) {\n        if (agentsArr[i]?.path === window.location.hash) {\n          try {\n            agentsArr[i]?.callback(addInfo);\n          } catch (error) {\n            error.push(error);\n          }\n          activatedCount++;\n          break;\n        }\n      }\n\n      if (activatedCount === 0) {\n        if (\n          this.defaultAgent &&\n          this.options.defaultRoot === window.location.hash\n        ) {\n          this.defaultAgent.callback(addInfo);\n        } else {\n          errors.push(new Error('Agent is not finded'));\n        }\n      }\n    }\n\n    if (this.txs.size > 0) {\n      this.txs.forEach(tx => {\n        const msg = new DBusMsgRouteIsChangedMsg(window.location.hash, addInfo);\n        tx.transmit({\n          msg,\n          waitMode: DBusTXWaitModes.nowait,\n          prepMode: DBusTXPrepModes.freeze,\n        });\n      });\n    }\n\n    if (errors.length > 0) return errors;\n    return activatedCount > 0;\n  }\n\n  addRouterAgent(agent: SimpleRouterAgent): void {\n    this.agents.add(agent);\n  }\n\n  removeRouterAgent(agent: SimpleRouterAgent): void {\n    this.agents.delete(agent);\n  }\n\n  flushRouterAgents(): void {\n    this.agents.clear();\n  }\n\n  // /* not refactored yet\n  private watchRestrictions = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgRoutingRestrainMsg) {\n      const { action, callback } = data.msg;\n      if (action === 'restrain') {\n        this.restrains.add(callback);\n        if (this.restrains.size === 1)\n          this.broadcastRoutingStatus('restrained');\n      } else {\n        this.restrains.delete(callback);\n        if (this.restrains.size === 0) this.broadcastRoutingStatus('free');\n      }\n    }\n  };\n\n  connect(int: DBusInterface): void {\n    const tx = int.getNewTX('broadcasting route changes');\n    this.txs.add(tx);\n\n    const rx = int.getNewRX(\n      this.watchRestrictions,\n      'router watch restrictions requests',\n    );\n    int.plugRX(DBusTopics.ROUTING, rx);\n  }\n}\n","import { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { RestClient } from '../rest-client';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\n\nexport type EngineResponse = {\n  velocity: number;\n  distance: number;\n};\n\nclass RestClientEngine extends RestClient {\n  constructor(baseUrl: string) {\n    super(baseUrl, '/engine');\n  }\n\n  toggleEngine(\n    id: number,\n    status: 'started' | 'stopped',\n  ): Promise<EngineResponse> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}?id=${id}&status=${status}`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as EngineResponse))\n        .catch((error: Error) => RestClient.handleError(error, rej));\n    });\n  }\n\n  enterDriveMode(id: number): Promise<true | false> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}?id=${id}&status=drive`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          else if (response.status === 500) res(false);\n          else rej(new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT));\n        })\n        .catch((error: Error) => RestClient.handleError(error, rej));\n    });\n  }\n}\n\nconst obj = new RestClientEngine('http://127.0.0.1:3000');\n\nconst REST_CLIENT_ENGINE = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_ENGINE };\n","import { RegCarData, UnregCarData } from '../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { RestClient } from '../rest-client';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\n\nclass RestClientGarage extends RestClient {\n  constructor(baseUrl: string) {\n    super(baseUrl, '/garage');\n  }\n\n  getCars(\n    page?: number,\n    limit?: number,\n  ): Promise<{ limit: string; cars: RegCarData[] }> {\n    return new Promise((res, rej) => {\n      const limitStr = limit || '';\n      const url = `${this.fullUrl}?_page=${page}&_limit=${limitStr}`;\n      let limitResponse = '';\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) {\n            limitResponse = response.headers.get('X-Total-Count') as string;\n            return response.json();\n          }\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res({ limit: limitResponse, cars: json as RegCarData[] }))\n        .catch((error: Error) => RestClient.handleError(error, rej));\n    });\n  }\n\n  getCar(id: number): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as RegCarData))\n        .catch((error: Error) => RestClient.handleError(error, rej));\n    });\n  }\n\n  createCar(unregCar: UnregCarData): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      fetch(this.fullUrl, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(unregCar),\n      })\n        .then(response => {\n          if (response.status === 201) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as RegCarData))\n        .catch((error: Error) => RestClient.handleError(error, rej));\n    });\n  }\n\n  deleteCar(id: number): Promise<true> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'DELETE',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .catch((error: Error) => RestClient.handleError(error, rej));\n    });\n  }\n\n  updateCar(regCar: RegCarData): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${regCar.id}`;\n      const data: UnregCarData = regCar;\n      fetch(url, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data),\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json))\n        .catch((error: Error) => RestClient.handleError(error, rej));\n    });\n  }\n}\n\nconst obj = new RestClientGarage('http://127.0.0.1:3000');\n\nconst REST_CLIENT_GARAGE = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_GARAGE };\n","import { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\n\nclass RestClientWinnersSortOptions {\n  readonly id = 'id';\n\n  readonly wins = 'wins';\n\n  readonly time = 'time';\n}\n\nconst obj = new RestClientWinnersSortOptions();\n\nconst REST_CLIENT_WINNERS_SORT_OPTIONS = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_WINNERS_SORT_OPTIONS };\n\nexport type RestClientWinnersSortOptionsList =\n  keyof RestClientWinnersSortOptions;\n","import { WinnerCarData } from '../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { RestClient } from '../rest-client';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\nimport { RestClientWinnersSortOptionsList } from './rest-client-winners.def';\n\nclass RestClientWinners extends RestClient {\n  constructor(baseUrl: string) {\n    super(baseUrl, '/winners');\n  }\n\n  getWinners(\n    page = 0,\n    limit?: number,\n    sort?: RestClientWinnersSortOptionsList,\n    order?: 'ASC' | 'DESC',\n  ): Promise<{ limit: string; cars: WinnerCarData[] }> {\n    return new Promise((res, rej) => {\n      const limitStr = limit || '';\n      let url = `${this.fullUrl}?_page=${page}&_limit=${limitStr}`;\n      if (sort) url += `&_sort=${sort}`;\n      if (order) url += `&_order=${order}`;\n      let limitResponse = '';\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) {\n            limitResponse = response.headers.get('X-Total-Count') as string;\n            return response.json();\n          }\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json =>\n          res({ limit: limitResponse, cars: json as WinnerCarData[] }),\n        )\n        .catch((error: Error) => RestClient.handleError(error, rej));\n    });\n  }\n\n  getWinner(id: number): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch((error: Error) => RestClient.handleError(error, rej));\n    });\n  }\n\n  createWinner(winnerCarData: WinnerCarData): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      fetch(this.fullUrl, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(winnerCarData),\n      })\n        .then(response => {\n          if (response.status === 201) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch((error: Error) => RestClient.handleError(error, rej));\n    });\n  }\n\n  deleteWinner(id: number): Promise<true> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'DELETE',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .catch((error: Error) => RestClient.handleError(error, rej));\n    });\n  }\n\n  updateWinner(winnerData: WinnerCarData): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${winnerData.id}`;\n      const data: WinnerCarData = winnerData;\n      fetch(url, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data),\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch((error: Error) => RestClient.handleError(error, rej));\n    });\n  }\n}\n\nconst obj = new RestClientWinners('http://127.0.0.1:3000');\n\nconst REST_CLIENT_WINNERS = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_WINNERS };\n","import { REST_CLIENT_ERROR } from './rest-clients-errors.def';\n\nexport abstract class RestClient {\n  protected resUrl: string;\n\n  protected fullUrl: string;\n\n  protected baseUrl: string;\n\n  constructor(baseUrl: string, resUrl: string) {\n    this.baseUrl = baseUrl;\n    this.resUrl = resUrl;\n    this.fullUrl = baseUrl + resUrl;\n  }\n\n  static handleError(error: Error, rejFunc: (reason?: unknown) => void): void {\n    if (error.message in REST_CLIENT_ERROR) {\n      const key = error.message as keyof typeof REST_CLIENT_ERROR;\n      rejFunc(new Error(REST_CLIENT_ERROR[key]));\n    } else rejFunc(new Error(REST_CLIENT_ERROR.UNKNOWN_ERROR));\n  }\n}\n","import { OBJ_PROCESSOR } from '../../lib/processors/obj-processor';\n\nconst restClientError = {\n  UNEXPECTED_RESULT: 'UNEXPECTED_RESULT',\n  UNKNOWN_ERROR: 'UNKNOWN_ERROR',\n  NOT_FOUND: 'NOT_FOUND',\n  CONNECTION_REFUSED: 'CONNECTION_REFUSED',\n  'Failed to fetch': 'CONNECTION_REFUSED',\n  'NetworkError when attempting to fetch resource.': 'CONNECTION_REFUSED',\n};\n\nconst REST_CLIENT_ERROR = OBJ_PROCESSOR.deepFreeze(\n  restClientError,\n) as typeof restClientError;\n\nexport { REST_CLIENT_ERROR };\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { App } from './app/app';\n\nwindow.addEventListener('load', () => {\n  const appDiv = document.createElement('div');\n  document.body.append(appDiv);\n  const app = new App(appDiv);\n  app.start();\n});\n"],"sourceRoot":""}