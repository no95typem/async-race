{"version":3,"sources":["webpack://async-race/./src/components/garage/garage.scss?dc9e","webpack://async-race/./src/components/garage/subcomps/car/car.scss?1a27","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/create-update.scss?4682","webpack://async-race/./src/components/garage/subcomps/main-controls/main-controls.scss?1eb1","webpack://async-race/./src/components/garage/subcomps/track/track.scss?9419","webpack://async-race/./src/components/header/header.scss?92c0","webpack://async-race/./src/components/popups/fitrst-open/popup-choice-first-open.scss?c499","webpack://async-race/./src/components/popups/popup-notes/popup-notes.scss?0064","webpack://async-race/./src/components/winners/winners.scss?feec","webpack://async-race/./src/lib/components/popups/standalone/modal/popup-standalone-modal.scss?0629","webpack://async-race/./src/lib/components/popups/standalone/modal/progress/popup-progress.scss?22c3","webpack://async-race/./src/styles/styles.scss?0948","webpack://async-race/./src/lib/components/btn-close/btn-close.svg","webpack://async-race/./src/app/app.ts","webpack://async-race/./src/app/dbus-msgs/reboot-msg.def.ts","webpack://async-race/./src/app/dbus-msgs/reconfigure-req.def.ts","webpack://async-race/./src/components/garage/car-actions.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-action-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-created-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-remove-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-select-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-page-is-changed.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-request-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-status-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-reset-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-reset-req-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-status-msg.def.ts","webpack://async-race/./src/components/garage/garage-controller.ts","webpack://async-race/./src/components/garage/garage-driver.ts","webpack://async-race/./src/components/garage/garage-managers-team.ts","webpack://async-race/./src/components/garage/garage.ts","webpack://async-race/./src/components/garage/subcomps/car/car.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-create.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-proto.def.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-update.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/create-update.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/dbus-msgs/generate-cars-msg.def.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/main-controls.ts","webpack://async-race/./src/components/garage/subcomps/popup-winner/popup-winner.ts","webpack://async-race/./src/components/garage/subcomps/track/track.ts","webpack://async-race/./src/components/header/header.ts","webpack://async-race/./src/components/header/subcomps/nav-item/nav-item.ts","webpack://async-race/./src/components/popups/fitrst-open/popup-choice-first-open.ts","webpack://async-race/./src/components/popups/popup-notes/popup-notes.ts","webpack://async-race/./src/components/winners/subcomps/winner-entry.ts","webpack://async-race/./src/components/winners/winners.ts","webpack://async-race/./src/definitions/car-random-data.def.ts","webpack://async-race/./src/lib/components/base-comp/base-comp.ts","webpack://async-race/./src/lib/components/btn-close/btn-close.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/404/popup-404.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/choice/popup-choice.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/popup-standalone-modal.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/progress/popup-progress.ts","webpack://async-race/./src/lib/components/popups/standalone/popup-standalone.ts","webpack://async-race/./src/lib/convertors/colors.ts","webpack://async-race/./src/lib/generators/generators.ts","webpack://async-race/./src/lib/gui/animation.ts","webpack://async-race/./src/lib/interfaces/notifiable.ts","webpack://async-race/./src/lib/processors/obj-processor.ts","webpack://async-race/./src/lib/services/dbus/dbus.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-common-responses.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-errors.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-hub-names.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-interface.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-rx/dbus-rx.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-topics.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-data-headers.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-data.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx.def.ts","webpack://async-race/./src/lib/services/dbus/defs/msgs/dbus-msg.def.ts","webpack://async-race/./src/lib/services/pager/pager.ts","webpack://async-race/./src/lib/services/simple-router/dbus-msgs-defs/dbus-msg-routing-msg.def.ts","webpack://async-race/./src/lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg.ts","webpack://async-race/./src/lib/services/simple-router/dbus-msgs-defs/types/router-status-msg.def.ts","webpack://async-race/./src/lib/services/simple-router/dbus-msgs-defs/types/routing-restrict-msg.def.ts","webpack://async-race/./src/lib/services/simple-router/simple-router-agent.ts","webpack://async-race/./src/lib/services/simple-router/simple-router.ts","webpack://async-race/./src/services/rest-clients/client-engine/rest-client-engine.ts","webpack://async-race/./src/services/rest-clients/client-garage/rest-client-garage.ts","webpack://async-race/./src/services/rest-clients/client-winners/rest-client-winners.def.ts","webpack://async-race/./src/services/rest-clients/client-winners/rest-client-winners.ts","webpack://async-race/./src/services/rest-clients/rest-clients-errors.def.ts","webpack://async-race/./src/services/rest-clients/rest-clients-names.def.ts","webpack://async-race/webpack/bootstrap","webpack://async-race/webpack/runtime/define property getters","webpack://async-race/webpack/runtime/hasOwnProperty shorthand","webpack://async-race/webpack/runtime/make namespace object","webpack://async-race/./src/entry.ts"],"names":["module","exports","App","rootElement","hubName","DBUS_HUB_NAMES","APP","TEXT_CONTENT","TEXT_CONTENT_ENG","loadedMainComponents","defaultRouterAgent","SimpleRouterAgent","this","loadMainComponent","router","SimpleRouter","mode","defaultRoot","defaultAgent","mainlineDBus","DBus","rebootMsg","DBusMsgRebootMsg","emergencyHandlerIsWorking","popup404","PopupStandaloneModal404Comp","welcomePopup","PopupStandaloneModalChoiceFirstOpenComp","toggleGlitch","document","cookie","includes","GLITCH_COOKIE","ENABLED","body","classList","remove","add","sendRebootMsg","tx","transmit","msg","prepMode","DBusTXPrepModes","freeze","waitMode","DBusTXWaitModes","allSetled","rxFuncForAppCtl","async","data","DBusMsgAppCtlReconfureReqMsg","checkFirstOpen","DBUS_COMMON_RESPONSES","VOID","watchRouterMsgs","DBusMsgRouteIsChangedMsg","newRoute","setupEmergencyHandler","app","setTextContent","asyncSetup","setText","POPUPS","POPUP404","TEXT","header","HeaderComponent","HEADER","append","attachHub","activateWantedAgents","force","OPENED_COOKIE","recharge","awaitDesicion","DISABLED","hide","window","addEventListener","e","preventDefault","promise","catch","error","message","REST_CLIENT_ERROR","CONNECTION_REFUSED","show","retry","REST_CLIENT_GARAGE","getCars","Promise","res","setTimeout","int","rxRouting","getNewRX","plugRX","DBusTopics","ROUTING","rxAppCtl","APP_CTL","getNewTX","name","GarageComp","WinnersComp","location","hash","newComponent","currMainComponent","isDBusHub","isNotifiable","notify","DBusMsg","signal","rxIds","prefResponseRxIds","super","CarActions","DBusMsgCarActionMsg","action","CAR_ACTION","DBusMsgCarActionCreatedMsg","car","CREATED","DBusMsgCarActionRemovedMsg","nullifiedContract","REMOVED","DBusMsgCarActionSelectedMsg","notifyChanges","SELECTED","DBusMsgGarageMsg","GARAGE","DBusMsgGaragePageIsChangedMsg","DBusMsgGarageRaceMsg","DBusMsgRaceRequestMsg","DBusMsgGarageRaceStatusMsg","status","DBusMsgGarageResetMsg","DBusMsgGarageResetReqMsg","DBusMsgGarageStatusMsg","GarageCompCtlAkaDirector","tracksContainer","carCtlsBlock","GARAGE_CONTROLLER","txs","Set","entriesPerPage","pagerContainer","createElement","ctlBlocks","pagerCallback","dir","console","log","resetState","reloadData","appCtlRXFunc","generatorRXFunc","DBusMsgGenerateCarsMsg","racingRXFunc","pager","toogleLock","performRace","carCtlsBlockBlockListener","stopPropagation","routingRestrainFunc","carActionsRXFunc","racePromise","garageManagersTeam","handleCarRm","finally","tryChangePage","createCarCtlBlock","index","btns","btnSelect","btnStart","btnReset","btnRm","forEach","btn","numberSpan","textContent","toString","container","connectCtlAndTrack","ctlElem","track","illuminateSelf","GarageManagersTeam","lockCallback","Pager","setupPager","btnNextPage","getBtnNextPage","btnPrevPage","getBtnPrevPage","pagerInfo","getPagerSpan","redraw","autoConnect","carActionsMsgsRX","raceMsgsRX","generatorMsgsRX","GENERATE","appCtlMsgsRX","restrainFunc","toggleRoutingRestrains","rej","toggleCtlsBlockDisabled","then","state","capture","block","style","setProperty","length","removeEventListener","removeProperty","DBusMsgRoutingRestrainMsg","transmissions","x","push","allSettled","undefined","page","getCurrPageNumber","getEntriesPerPage","response","limit","cars","setEntriesCount","Number","parseInt","broadcastPaging","nullifyContracts","newContracts","TrackComp","carComp","CarComp","placeCar","addContracts","nowait","clearDOM","geometry","calcGeometry","setStylesForTracks","drawTracks","drawCarsCtls","firstChild","getComputedStyle","containerHeight","parseFloat","height","paddingBottom","paddingTop","firstAutoHeight","Math","min","innerWidth","CAR_WIDTH_RATIO","CAR_MAX_WIDTH","CAR_IMG_RATIO","heights","heightSum","contracts","getContracts","contract","factor","SCALE_FACTOR","carTrackHeight","excessHeight","heightsReversed","sort","a","b","displacementBase","size","SKIPPED_PROGRESSION_MEMBERS_COUNT","displacements","midIndex","displacement","DISPLACEMENT_FIX","paddingBase","paddingShift","PADDING_SHIFT_BASE","PADDING_SHIFT_BASE_VW","trackHeights","map","playFirstIntroAnim","GarageDriverCommands","GarageDriver","emergencyAwaitServer","timeInMS","delayInMS","resPromise","popup","PopupStandaloneModalProgressComp","setProgress","startTime","Date","now","interval","IamResolved","resFunc","clearInterval","setInterval","elapsedTime","progress","Error","flags","disableCtls","thisDriveId","genUniqId","currDriveId","ignitionPromise","TurnOnTheIgnition","driveParams","drivePromise","drive","toggleIgniteAnim","REST_CLIENT_ENGINE","toggleEngine","currCar","id","stopCar","rollBack","msgBlock","updateProgress","playAwaitingAnim","clearTimeout","lastTimeInMs","lastStart","driveId","time","calculateDriveTime","start","enterDriveMode","success","rollForward","playbackRate","onlyAnim","rollover","broken","stop","params","distance","velocity","directorLockCb","freeDrivers","busyDrivers","Map","movingDrivers","winnerPopup","GaragePopupWinner","carCtlsClickListener","target","HTMLElement","elem","HTMLButtonElement","parentElement","disabled","currRaceId","handleRemoving","startDriving","handleRestoreState","handleSelection","handleWinner","isFinishVisible","duration","getTransitionDuration","awaitTime","isRoadMoves","winnerCar","setData","toFixed","REST_CLIENT_WINNERS","getWinner","winnerRecord","updatedWinnerData","wins","updateWinner","NOT_FOUND","newWinnerData","createWinner","get","getOutOfTheCar","tryFreeDrivers","delete","clear","сontracts","newContract","prepareForRace","rollbackCars","broadcastGarageStatus","broadcastRaceStatus","driver","returnToStart","broadcastIfAllInStart","every","isInStartPosition","choosedDriver","find","isFree","set","putBehindTheWheel","performDrivingProtocol","deleteCar","deleteWinner","genSelectCallback","rollbackPromise","rollbacks","all","thisRaceId","raceData","raceId","arrivedByOrder","notArrived","participantsCount","roadElem","stratedCount","processRace","result","handleDriveResult","has","updateData","BaseComp","isControllerWorking","mainControlsComp","MainControlsComp","carsCtlsBlock","bgVideo","bgVideoProgressListener","buffered","end","bgVideoCanPlayListener","reset","controller","startWorking","play","_rootElement","garage","selfCtlsBlock","bg","garage__bg","setupBgVideo","renderBgVideo","controls","loop","defaultMuted","muted","autoplay","src","attachSubHub","_currCar","canvas","tireBack","btnSelect$","btnRm$","_spanCarName","btnStart$","btnReset$","isReseted","movingClassName","clearAnimFromElem","anim","commitStyles","selectSpan","rmSpan","startSpan","resetSpan","drawCar","color","drawWheels","observer","MutationObserver","mutations","mutation","oldValue","currOutOfSceneAnim","pause","disconnect","contains","outOfScene","rootElem","wheelImg","Image","CAR_WHEEL_IMG_SRC","onload","backwardWheelImg","OBJ_PROCESSOR","deepClone","carData","finishPromise","resolve","playOutAnim","cancel","currAnimation","finished","playInAnim","asyncFunc","animOut","animate","opacity","easing","fill","promiseToAwait","animIn","iterations","POSITIVE_INFINITY","filter","transform","handleBtns","rootStyle","selfStyle","rootWidth","width","paddingLeft","paddingRight","selfWidth","coordinateInPercents","onfinish","oncancel","playState","observe","attributes","attributeOldValue","img","frameNumber","CAR_EXPLOSION_IMG_DATA","BASE_URL","EXTENSION","FRAME_TIME_MS","FRAMES_COUNT","hexColor","CAR_BODY_IMG_SRC","ctx","getContext","shadowColor","shadowBlur","drawImage","paintCarBody","imageData","getImageData","rgb","hexToRgb","j","i","red","green","blue","blueDiff","blueDiffThreshold","threshold","r","g","putImageData","TIMING_FUNCTION","CreateCompController","CreateUpdateCompControllerProto","elements","inputText","inputColor","setupBtnCreate","reportValidity","unregCar","value","createCar","clone","ctlsStateMap","ctls","valid","setCustomValidity","pattern","removeAttribute","ctl","pushCtlsState","toogleCtlsDisabled","popCtlsState","UpdateCompController","garageMsgsListener","carActionsListener","choosedCar","notifyCb","setupBtnUpdate","rxCarActions","rxGarage","updateCar","CreateUpdateComponent","type","btnText","CREATE_UPDATE","textInput","colorInput","root","MAIN_CONTROLS","createComponent","updateComponent","btnRace","btnGenerate","generateClickListener","transmission","generate","genCb","resolveMsg","raceClickListener","resetClickListener","genRandomCarName","manufacturerNumber","getRandomInt","CAR_MODEL_LIST_KEYS","manufacturerName","models","CAR_MODEL_LIST","rxFuncForRaceMsgs","getController","enable","disable","rxFuncForGarageMsgs","btnsBlock","renderBtns","span","btnBlock","total","left","cb","genLeft","unregCarData","genRandomHexColor","rx","rx2","textTime","textName","textId","textNumber","timeStr","indexStr","topBlock","illuminate","track_illuminated","hasChildNodes","childNodes","child","spanCarName","buses","illuminateNavItem","anchors","anchor","getAttribute","DBusMsgRoutingStatusMsg","navContainer","logo","header__logo","firstSpan","dataset","secondSpan","ul","li","svg","navItems","NavItem","item","illuminateRX","text","href","styles","iconSrc","_anchor","setAttribute","iconImage","PopupStandaloneModalChoiceComp","renderText","enableBtn","outerSpan","innerSpan","glitch","disableBtn","mapBtnsAndChoices","desicion","PopupStandaloneModalNotes","PopupStandaloneModalComp","list","btnOk","btnCloseContainer","caption","renderList","renderCloseBtns","setupCloseActions","renderOtherThings","btnCloseComp","BtnClose","btnOkOuterSpan","btnOkInnerSpan","liArray","Object","values","OL","ol","CAPTION","closeSelf","key","P1","LI1","LI2","LI3","LI4","LI5","LI6","LI7","WinnerRowComp","winnerData","indexElem","idElem","carPreviewBox","nameElem","winsElem","bestTimeElem","carPreview","genPreview","WINNERS","table","tableBody","tableHead","thId","thCar","thName","thWins","thBestTime","pagerBtnsContainer","currOrder","currSort","bottomBtnsContainer","btnReconfigureGlitch","btnNotes","btnCredits","popupNotes","createBtnWithTwoSpans","btnOuterSpan","btnInnerSpan","tableHeadClickListener","REST_CLIENT_WINNERS_SORT_OPTIONS","refreshTableHeader","currSortedElem","pagerSpan","asyncLoading","loadBg","renderPager","renderTable","renderBottomBtnsContainer","setupBottomBtnsActions","winners","currBGInfo","randomIndex","BG_SRCS","bgInfo","getRandomBGInfo","fetch","headers","imgRead","Response","ReadableStream","reader","getReader","done","loadedBytes","read","val","byteLength","enqueue","close","blob","btnReconfigureGlitchObj","obj","renderTableHeader","tr","thIndex","getWinners","rows","Array","promises","indexInc","winner","getCar","totalIndex","row","getCarPreview","deepFreeze","Lamborghini","Ferrari","Koenigsegg","Porsche","Jaguar","Maserati","McLaren","Spyker","keys","tag","image","choicePromise","resolveFunc","control","PopupStandaloneComp","closeArea","barContainer","bar","setHeader","hex","c","test","split","slice","arr","Uint8Array","crypto","getRandomValues","join","max","floor","random","prop","transPropArr","getPropertyValue","replace","propIndex","lastIndexOf","transformAndAutoresolve","delay","forceAutoresolveIn","valToWait","eventHandler","propertyName","transformAndWaitEvent","object","record","isFrozen","isArray","v","n","cloneNode","Blob","k","setPrototypeOf","getPrototypeOf","network","idCounter","rxs","createdRXs","createdTXs","attachedHubs","occupiedNames","callRXFunc","clonedData","func","handleClone","freezedData","handleFreeze","DBUS_ERRORS","UNEXPECTED_PREP_MODE","busId","hub","suffix","createInterfaceForHub","prefix","HUB_IS_ALREADY_ATTACHED","HUB_NAME_NOT_AUTHORIZED","HUB_NAME_IS_OCCUPIED","dbusInterface","DBusInterface","desc","genNewRX","topic","unplugRX","subHub","subSuffix","connect","regNumber","DBusTX","opts","head","DBusTXDataHeaders","DBusTXData","freezedTX","DBusRX","freezedRX","XENO_RX","TOPIC_IS_NOT_EXIST","TOPIC_HAS_NO_RXS","choosedRXs","PREF_RXS_ARE_NOT_EXIST","manual","BAD_REQUEST","ROUTER","objAsRecord","arrowedGetNewTX","arrowedGetNewRX","arrowedPlugRX","arrowedUnplugRX","RXs","TXs","RXsPlugMap","txId","txRegNumber","txDesc","listCallback","firstPageNumber","currPageNumber","lastPageNumber","entriesCount","callbackIsCalled","btnNextSpan","btnPrevSpan","callCallback","lock","toggleBtnsDisabled","ceil","updateSpanText","pageNumber","pageIsChanged","DBusMsgRoutingMsg","addInfo","callback","path","getStateCallback","setStateCallback","options","agents","restrains","watchRestrictions","broadcastRoutingStatus","currRoute","wantedRoute","host","arrow","cancelRouteChange","activatedCount","errors","onlyDBus","agentsArr","agent","baseUrl","resUrl","fullUrl","url","method","json","UNEXPECTED_RESULT","UNKNOWN_ERROR","clientName","REST_CLIENT_NAMES","limitStr","limitResponse","JSON","stringify","regCar","order","winnerCarData","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call","d","definition","o","defineProperty","enumerable","prototype","hasOwnProperty","Symbol","toStringTag","appDiv"],"mappings":"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","file":"main.1e62896343b34196e9bd.js","sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"garage\":\"_21SC4SGf5mTamWfNdNRR\",\"intro\":\"_1_6B8epjerqfM9sjWaJS0B\",\"garage__bg\":\"_2VnbeeG4HKnZfSWUedizHh\",\"garage__track-container\":\"_1rsPT6UvHnbHI-FUFvPaSe\",\"hue-rotate\":\"_3MSD3skhU7RLqKdx6pBax7\",\"garage__track-container_finish\":\"_1khEfVJzcbQlBMhoHPdhzY\",\"garage__winner-popup\":\"_17InT8lGlAlk8k1JRcrTCM\",\"garage-bg\":\"-BA3r_cxZwAYkgGQVVZeo\",\"garage-bg__video\":\"_3byu86MCf3s6B7JQuetNAw\",\"garage-bg__car-ctl-btn\":\"_3upDU-ngLjybmFg4wiVvfl\",\"garage-bg__car-ctl-block-number\":\"_3dT19pzigDW1UKuPVLEguq\",\"garage-bg__car-ctl-block\":\"_2e0Ox8Joh0jw60ztR_rVt5\",\"garage-bg__cars-ctls-block\":\"wMVLCRcoluFnZleBHWXlm\",\"garage-bg__self-ctls-block\":\"_2VQVmkB2amN4PG9XCyFye9\",\"garage-bg__pager\":\"_2avafWgl8XDS2KLJswKq0H\",\"garage-bg__pager-span\":\"_3ktlpozBQghco3VMHLJBo1\",\"garage-bg__pager-btn\":\"_2QdjLaEnj3Balh89eZAya4\",\"synthwave-background\":\"_2pUKJme_w_0KTS_JoVNV5b\",\"synthwave-background_race-mode\":\"n1z9UH35nfilmkK2lmQvV\",\"race\":\"_375ItX4gjZY-ZT7KrEfBgG\",\"move-grid\":\"_1MqERRNbzZtvdd9iE43L04\"};","// extracted by mini-css-extract-plugin\nexport default {\"car-div\":\"_3pRKwGaRv59JcJqlApAnkk\",\"car-div__canvas\":\"rH6_OMXna8-zeemMHF11D\",\"car-div__wheel\":\"_3WNDl-LGGtViqzAfLLX4CB\",\"car-div__wheel_forward\":\"_3Rdh32fs7fi-95LcabV_Ed\",\"car-div__wheel_backward\":\"_3xptMXOOFn6YcMVYMigRMa\",\"car-div__explosion\":\"_3w8-mlW0m2zLABohqiDQ3e\",\"car-div_ignite\":\"_3gEkh_UHPsV03BNqNGmyBe\",\"car-div_borken\":\"UxI1dTvw1TMcYTYZRUsCf\",\"car-div_rollForward\":\"_3xWmq3Q2UpNiq2nICrGAIN\",\"car-div-anim\":\"_381V-1xCMVwSdGT0FxnQiO\",\"hue-rotate-360\":\"_2xfuDYbUjW8QtSLtmjzC7b\",\"tire-anim\":\"_2Qs9DAZPIqZivw_0ON2Vot\",\"glitch-animation-1\":\"_18DmdiFkNll__X_lkGV0vb\",\"glitch-animation-2\":\"_3dfetHNRAa7hXqdHw76Uur\",\"glitch-animation-3-xy\":\"qr9kE_7wWzjw836QOZH4l\",\"glitch-animation-4-xy\":\"bBFhOAPzr7ZHO1gMz8m2a\",\"hue-rotate-90\":\"_3V692dxTWP4I0NCS1rUiMn\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"_2uo9WXSTJyDD3jBlT_quev\",\"text-input\":\"_2YNdYEaErpy02Ske_bZONx\",\"color-input\":\"_3Ye7rbfoBnq4HZn4H-yDB8\"};","// extracted by mini-css-extract-plugin\nexport default {\"main-controls\":\"_2b_svto1O0DGSO3_579_Xj\",\"btn-block\":\"_262VSHreYXfZUHLGeCJEvZ\"};","// extracted by mini-css-extract-plugin\nexport default {\"track\":\"_2hDrLwwwZMiv2NrI-XZZqJ\",\"track_illuminated\":\"_3zXlLAoKpXJ_jlpauHLjHR\",\"track__controls-block\":\"_3pqcODoHFqX9rxmLKBnhD4\"};","// extracted by mini-css-extract-plugin\nexport default {\"header\":\"_3TTTWNe5aoHesw4iV0YUGU\",\"header__logo\":\"_2idUQTZia_1M_0xkhMkXf8\",\"glitch-animation-1\":\"_15gesIXTXGxm1uBGCwmmqp\",\"glitch-animation-2\":\"s3dyJTG8fG5lknNowsTqO\",\"header-nav\":\"_7vejZGT8OzUejTiWyGs1P\",\"header-nav__item\":\"_1NYwlHRXmh2YGu63soBsjx\",\"header-nav__anchor\":\"_2n39qEg5Iz5Tym2Z0Jrjz9\",\"header-nav__anchor_active\":\"_2bRvd3RlExbbSpyXLuxSdS\",\"header-nav_not-active\":\"_3gNs_UBLjSUG-Bq-Vf2T67\",\"glitch-animation-3-xy\":\"_3uLEqFHW9zkb7hCp_s1nFC\",\"header-nav__svg\":\"_2FCXcgNK7Jgl9f3ZK-O56I\",\"header-nav__span\":\"_1NVrpdaSQLvqho4VNqQqit\",\"header-nav__list\":\"_1vy8OijKt-Cy7SGXyM4ek9\",\"header-nav__list_disabled\":\"_25SilQm6mkAlbl-WpajKBY\",\"glitch-animation-4-xy\":\"_1oG3arGYS7T4HAPVRP9NtY\",\"hue-rotate-90\":\"_3ejf9WYQ_keT8RXiF6nTIR\",\"hue-rotate-360\":\"_7lIM2sgFifv2jKmceFM04\"};","// extracted by mini-css-extract-plugin\nexport default {\"body\":\"_3tVLnvk3q7kf60N7EfAsgP\",\"btn-block\":\"_1jkUqwfJwBTeZA_PwMXeCg\",\"btn\":\"_2bwmpgTrhG5WrJx-0mrkhx\",\"glitch-parent\":\"_2smmCfANEjhtt4BzpG_sLO\",\"glitch\":\"_3ekpIOxutzsrjgHi6vaoRD\",\"glitch-animation-3-xy\":\"VB0xzvIXCf2IHNQxhbOz8\",\"glitch-animation-1\":\"_9Kfwb6iucSGuo9YCmWXdk\",\"glitch-animation-2\":\"_3dHLnmaxXP_FHzxB_NlAdr\",\"glitch-animation-4-xy\":\"_2DypaqsNhdjJQN1C2baR7W\",\"hue-rotate-90\":\"_2rKbfZQT8JgPGaWisOZtuc\",\"hue-rotate-360\":\"_3pGjJdHvp_pWzeUh0WTbEO\"};","// extracted by mini-css-extract-plugin\nexport default {\"body\":\"_30Ij2pk1J9HFCWUnPVmS5l\",\"ol\":\"_2JQMTL_9siv6UDqpuU3wX1\",\"btn-close\":\"WqeZLQLFg2_7vMPH-pmGc\",\"rotate360\":\"k1fDe8G19iH0hLutDSbvU\",\"btn-close-container\":\"_1ND8MFUqu0KnQ5g_UFKKNT\",\"hue-rotate-360\":\"_1UQiz-WdnwkpgtqVsqjIyo\",\"btn-ok\":\"fHO3LlvlZCTh5MPMkZW2N\",\"btn-ok__innerSpan\":\"_3C1ftnZZFLIb96FY0O6_DZ\",\"glitch-animation-1\":\"_1TNyvsiPNai_ReJ_gpCgG-\",\"glitch-animation-2\":\"_1ShN5CyCYKGekWOdkDJOtA\",\"glitch-animation-3-xy\":\"_2UsjWEizzgiV7VNe4sB2ci\",\"glitch-animation-4-xy\":\"_2WhJn7Whg-LJYJXD4vbpM1\",\"hue-rotate-90\":\"_1pw1q2ZMgB77TxQV1b6Mjd\"};","// extracted by mini-css-extract-plugin\nexport default {\"winners\":\"HVDfoBgyIQ4teF5EKFzcD\",\"intro\":\"yZnUjHL-jkdakQQFCkqyq\",\"table\":\"_3mJKnd573Tt4WspNl7gf1J\",\"table__car-preview-box\":\"_86kcZK8UgXIsvYD-wpDED\",\"table__can-be-sorted\":\"_3Xa74hpyx3g6XUuZ9fB9Cm\",\"table__sorted-elem\":\"rfPuVNCW0Sd4nzQGO8-R8\",\"table__sorted-elem_asc\":\"N6296gY2c5AFEX4KjE4I4\",\"table__sorted-elem_desc\":\"_37bMOUs2OF28ZqMubJCPnM\",\"pager\":\"_2q-noyJbwIpKOMhl7AWlq5\",\"pager-span\":\"_1O8erRuDz9RWa3C9tqnUm-\",\"pager-btn\":\"_3OktYstRgXgDE6zlpOM6LA\",\"bottom-btns-container\":\"_3W15tscjdKQtes2IFf9GuC\",\"btn-glitch\":\"XFsunLW_IkuzOAT8jcND0\",\"btn-glitch__innerSpan\":\"_3MAkYSGRBaTwkvxCSVha72\",\"glitch-animation-1\":\"d3lBrA2HIOudPajPuC6Qc\",\"glitch-animation-2\":\"_268kxyhSlSSFPnx4Ajj8N3\",\"glitch-animation-3-xy\":\"_1WbYKA4KBGh4V1OT5dXIsS\",\"glitch-animation-4-xy\":\"Bqga7NnAzaDXnFYuV6T8R\",\"hue-rotate-90\":\"vj-f94Y0-qyHt_tBW9aAH\",\"hue-rotate-360\":\"_345l5rRWgIZ1hnilXXB-Pz\"};","// extracted by mini-css-extract-plugin\nexport default {\"popup-modal\":\"_3KlZOyoPt2P4FT1Ofdi1oz\",\"popup-bg\":\"_1QGzfQYEHvrYonFptRzkG6\",\"popup-body\":\"_3zDyJwNy615xogiYvCl4vt\",\"popup-body-header\":\"_2DglTs5KJlA1QJriRI6bVZ\",\"popup-body-text\":\"_2oMxBL_Jv1KW3bHu3sVdaA\",\"popup-body__btn-close\":\"HV1Imp7Np5N8O5nUXwQsS\"};","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"_1KBIW4BNGKHwQtRcKc6JIF\",\"hue-rotate\":\"_1t6lrd-wEBCB6ei-o9kDmk\",\"bar\":\"_2DWg3PnmWwM25SBd7sLJQK\",\"body\":\"_24wm1l_qZHsMTx2Oy-enF4\",\"text\":\"_1UFV3thankQQ1R2Ly1Zle2\"};","// extracted by mini-css-extract-plugin\nexport default {\"no-glitch\":\"_3jhfNB0kF108EhynXnwXt4\",\"app\":\"_2GlW9kbzGCCom4UEGnZpRF\",\"main-component\":\"GLMZ5rIXl-xoQfoZneWIs\",\"btn\":\"a_2w3d8M_c1utyjkPDogH\",\"btn-1\":\"_27iqs8X5NFef8-ZpiL_u3n\",\"btn-4\":\"_3exd3hkMJO4xoKflZ4jI0K\",\"btn-6\":\"vg6GhvI_oAd82g2nOcNB6\",\"btn-9\":\"_3mEdzCA2cTh_gbEuZrEqkT\",\"btn-13\":\"_1CI8MrNcZ0Zzun_fhIJH2p\",\"btn-15\":\"_1c4rHdMAWRFc5xA3fFj1Kh\",\"glitched-text\":\"_2WhQAYnvrw5r57jsvwHEcW\",\"glitch-animation-1\":\"_3SsWJY5j_rpKm4wbE1jggd\",\"glitch-animation-2\":\"_2T9jhQKkqS5XqoaN2hOjdC\",\"glitched-item\":\"_3ehw9TJADVx0W9b4WfYGWs\",\"glitch-animation-3-xy\":\"_3cq3m6zsAObFT1W9drsRbr\",\"glitch-animation-4-xy\":\"_2az41XGPhMc3_U4DsjhHiR\",\"hue-rotate-90\":\"_2KOyboeT9ymliFqM8Het0d\",\"hue-rotate-360\":\"_1eInkycuomIYicyYM2UGnf\"};","module.exports = \"data:image/svg+xml,%3csvg viewBox='0 0 30 30' xmlns='http://www.w3.org/2000/svg'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M29.5599 2.56066C30.1457 1.97487 30.1457 1.02512 29.5599 0.439337C28.9741 -0.146448 28.0243 -0.146445 27.4386 0.439343L14.9997 12.8783L2.56112 0.439648C1.97534 -0.14614 1.02559 -0.146143 0.4398 0.439642C-0.145987 1.02543 -0.14599 1.97517 0.439795 2.56096L12.8784 14.9996L0.439337 27.4387C-0.146448 28.0245 -0.146445 28.9743 0.439343 29.56C1.02513 30.1458 1.97488 30.1458 2.56066 29.56L14.9997 17.1209L27.439 29.5603C28.0248 30.1461 28.9745 30.1461 29.5603 29.5604C30.1461 28.9746 30.1461 28.0248 29.5603 27.439L17.121 14.9996L29.5599 2.56066Z'/%3e %3c/svg%3e\"","import { BaseComp } from '../lib/components/base-comp/base-comp';\nimport { SimpleRouterAgent } from '../lib/services/simple-router/simple-router-agent';\nimport { SimpleRouter } from '../lib/services/simple-router/simple-router';\nimport { DBus } from '../lib/services/dbus/dbus';\nimport { DBusMsgRouteIsChangedMsg } from '../lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport { DBusTopics } from '../lib/services/dbus/defs/dbus-topics.def';\nimport { DBUS_COMMON_RESPONSES } from '../lib/services/dbus/defs/dbus-common-responses.def';\nimport { HeaderComponent } from '../components/header/header';\n\nimport { DBusTXData } from '../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { GarageComp } from '../components/garage/garage';\nimport {\n  DBusHub,\n  isDBusHub,\n  DBusInterface,\n} from '../lib/services/dbus/defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from '../lib/services/dbus/defs/dbus-hub-names.def';\nimport { WinnersComp } from '../components/winners/winners';\nimport { REST_CLIENT_ERROR } from '../services/rest-clients/rest-clients-errors.def';\nimport { isNotifiable } from '../lib/interfaces/notifiable';\nimport { PopupStandaloneModal404Comp } from '../lib/components/popups/standalone/modal/404/popup-404';\nimport { REST_CLIENT_GARAGE } from '../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgRebootMsg } from './dbus-msgs/reboot-msg.def';\nimport { DBusTX } from '../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusMsgAppCtlReconfureReqMsg } from './dbus-msgs/reconfigure-req.def';\nimport {\n  FirstOpenDesicions,\n  PopupStandaloneModalChoiceFirstOpenComp,\n} from '../components/popups/fitrst-open/popup-choice-first-open';\n\nimport styles from '../styles/styles.scss';\n\nexport class App implements DBusHub {\n  static readonly TEXT_CONTENT_ENG = {\n    POPUPS: {\n      POPUP404: {\n        TEXT: `No connection! Check that the server is online\n        and nothing is blocking the connection!`,\n      },\n    },\n  };\n\n  static readonly OPENED_COOKIE = 'no95typem-async-race=opened';\n\n  static readonly GLITCH_COOKIE = {\n    ENABLED: 'no95typem-async-race-glitch=enabled',\n    DISABLED: 'no95typem-async-race-glitch=disabled',\n  };\n\n  readonly hubName = DBUS_HUB_NAMES.APP;\n\n  protected TEXT_CONTENT = App.TEXT_CONTENT_ENG;\n\n  protected loadedMainComponents: Record<string, BaseComp> = {};\n\n  protected currMainComponent: BaseComp | undefined;\n\n  protected defaultRouterAgent = new SimpleRouterAgent('hash', '', () =>\n    this.loadMainComponent('default'),\n  );\n\n  protected router = new SimpleRouter({\n    mode: '#',\n    defaultRoot: '',\n    defaultAgent: this.defaultRouterAgent,\n  });\n\n  protected mainlineDBus = new DBus();\n\n  protected tx: DBusTX | undefined;\n\n  protected rebootMsg = new DBusMsgRebootMsg('reboot');\n\n  protected emergencyHandlerIsWorking = false;\n\n  protected popup404 = new PopupStandaloneModal404Comp();\n\n  protected welcomePopup = new PopupStandaloneModalChoiceFirstOpenComp();\n\n  // * good\n  constructor(private readonly rootElement: HTMLElement) {\n    this.setupEmergencyHandler();\n\n    this.rootElement.classList.add(styles.app);\n\n    this.setTextContent();\n\n    this.asyncSetup();\n  }\n\n  // * good\n  // !!! MAKE IT BASECOMP PROP IN NEXT PROJECT\n  setTextContent(): void {\n    this.popup404.setText(this.TEXT_CONTENT.POPUPS.POPUP404.TEXT);\n  }\n\n  // * good\n  private async asyncSetup() {\n    await this.checkFirstOpen();\n\n    const header = new HeaderComponent(DBUS_HUB_NAMES.HEADER);\n    this.rootElement.append(header.rootElement);\n\n    this.mainlineDBus.attachHub(this);\n    this.mainlineDBus.attachHub(header);\n    this.mainlineDBus.attachHub(this.router);\n    this.router.activateWantedAgents();\n  }\n\n  // !!! IN NEXT PROJ MAKE APP A POPUP HANDLER VIA DBUS AND ATTACH POPUPS TO APP\n  // !!! OR RETURN A POPUP HANDLER...\n  // * good\n  private async checkFirstOpen(force?: true) {\n    if (!document.cookie.includes(App.OPENED_COOKIE) || force) {\n      this.rootElement.append(this.welcomePopup.rootElement);\n      const desicion = (await this.welcomePopup\n        .recharge()\n        .awaitDesicion()) as FirstOpenDesicions;\n      switch (desicion) {\n        case 'enable glitch':\n          document.cookie = App.GLITCH_COOKIE.ENABLED;\n          break;\n        default:\n          document.cookie = App.GLITCH_COOKIE.DISABLED;\n          break;\n      }\n      document.cookie = App.OPENED_COOKIE;\n      this.welcomePopup.hide();\n    }\n    this.toggleGlitch();\n  }\n\n  // * good\n  private toggleGlitch = () => {\n    if (document.cookie.includes(App.GLITCH_COOKIE.ENABLED)) {\n      document.body.classList.remove(styles['no-glitch']);\n    } else {\n      document.body.classList.add(styles['no-glitch']);\n    }\n  };\n\n  // * it may be better\n  private setupEmergencyHandler() {\n    window.addEventListener('unhandledrejection', e => {\n      e.preventDefault();\n      e.promise.catch((error: Error) => {\n        if (\n          !this.emergencyHandlerIsWorking &&\n          error.message in REST_CLIENT_ERROR &&\n          error.message === REST_CLIENT_ERROR.CONNECTION_REFUSED\n        ) {\n          this.emergencyHandlerIsWorking = true;\n\n          this.popup404.show();\n          const retry = async () => {\n            try {\n              await REST_CLIENT_GARAGE.getCars();\n              await this.sendRebootMsg();\n              this.popup404.hide();\n              this.emergencyHandlerIsWorking = false;\n            } catch {\n              await new Promise(res => setTimeout(res, 1000));\n              retry();\n            }\n          };\n          retry();\n        }\n      });\n    });\n  }\n\n  // * good\n  private sendRebootMsg = () => {\n    return this.tx?.transmit({\n      msg: this.rebootMsg,\n      prepMode: DBusTXPrepModes.freeze,\n      waitMode: DBusTXWaitModes.allSetled,\n    });\n  };\n\n  //* This is the first appearance of TX RX Dbus\n  //* So if you wonder why, You can read this:\n  //* https://www.avrfreaks.net/forum/why-txrx\n  // * good\n  connect(int: DBusInterface): void {\n    const rxRouting = int.getNewRX(this.watchRouterMsgs);\n    int.plugRX(DBusTopics.ROUTING, rxRouting);\n\n    const rxAppCtl = int.getNewRX(this.rxFuncForAppCtl);\n    int.plugRX(DBusTopics.APP_CTL, rxAppCtl);\n\n    this.tx = int.getNewTX('APP SYSTEM MSGS TX');\n  }\n\n  // * now from dbus i can get data with typed msg and headers\n  // * in headers i can get TX name\n  // * this is useful for debugging and could be useful in match match,\n  // * but I did not find any use in this porject\n  // * good\n  private rxFuncForAppCtl = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgAppCtlReconfureReqMsg) {\n      return this.checkFirstOpen(true);\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * good\n  private watchRouterMsgs = async (data: DBusTXData) => {\n    const { msg } = data;\n    if (msg instanceof DBusMsgRouteIsChangedMsg) {\n      // TODO: Rework with enum!?\n      this.loadMainComponent(msg.newRoute);\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // ! I do not like this.loadedMainComponents as Record<string, unknown> change this in next proj to map\n  // * mid tier\n  private loadMainComponent(name: string): void {\n    if (!(name in this.loadedMainComponents)) {\n      switch (name) {\n        case '#garage':\n          this.loadedMainComponents[`${name}`] = new GarageComp();\n          break;\n        case '#winners':\n          this.loadedMainComponents[`${name}`] = new WinnersComp();\n          break;\n        default:\n          window.location.hash = '#garage';\n          break;\n      }\n    }\n    const newComponent = this.loadedMainComponents[`${name}`];\n\n    if (newComponent) {\n      if (this.currMainComponent) {\n        this.currMainComponent.rootElement.remove();\n      }\n\n      this.currMainComponent = newComponent;\n      newComponent.rootElement.classList.add(styles['main-component']);\n      this.rootElement.append(newComponent.rootElement);\n\n      if (isDBusHub(this.currMainComponent)) {\n        try {\n          this.mainlineDBus.attachHub(this.currMainComponent);\n        } catch {\n          // no need to do something\n        }\n      }\n      if (isNotifiable(this.currMainComponent))\n        this.currMainComponent.notify(null);\n    }\n  }\n}\n","import { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport class DBusMsgRebootMsg extends DBusMsg {\n  constructor(\n    readonly signal: 'reboot',\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.APP_CTL, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport class DBusMsgAppCtlReconfureReqMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.APP_CTL, rxIds, prefResponseRxIds);\n  }\n}\n","export enum CarActions {\n  CREATED,\n  SELECTED,\n  REMOVED,\n  UPDATED,\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\nimport { CarActions } from '../../../car-actions.def';\n\nexport class DBusMsgCarActionMsg extends DBusMsg {\n  constructor(\n    readonly action: CarActions,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.CAR_ACTION, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionCreatedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.CREATED, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { GarageServicemanContract } from '../../../garage-serviceman-contract.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionRemovedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly nullifiedContract: GarageServicemanContract,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.REMOVED, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionSelectedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly notifyChanges?: (car: RegCarData) => unknown,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.SELECTED, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgGarageMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GARAGE, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageMsg } from './garage-msg.def';\n\nexport class DBusMsgGaragePageIsChangedMsg extends DBusMsgGarageMsg {}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgGarageRaceMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GARAGE, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageRaceMsg } from './garage-race-msg.def';\n\nexport class DBusMsgRaceRequestMsg extends DBusMsgGarageRaceMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { RaceStatusesList } from '../../../race-statuses.def';\nimport { DBusMsgGarageRaceMsg } from './garage-race-msg.def';\n\nexport class DBusMsgGarageRaceStatusMsg extends DBusMsgGarageRaceMsg {\n  constructor(\n    readonly status: RaceStatusesList,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgGarageResetMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GARAGE, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageResetMsg } from './garage-reset-msg.def';\n\nexport class DBusMsgGarageResetReqMsg extends DBusMsgGarageResetMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageMsg } from './garage-msg.def';\n\nexport type GarageStatus =\n  | 'need reset'\n  | 'car moves'\n  | 'all cars stopped'\n  | 'reset is not needed';\n\nexport class DBusMsgGarageStatusMsg extends DBusMsgGarageMsg {\n  constructor(\n    readonly status: GarageStatus,\n    rxIds?: string[],\n    prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBUS_COMMON_RESPONSES } from '../../lib/services/dbus/defs/dbus-common-responses.def';\nimport { DBUS_HUB_NAMES } from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBusTX } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionRemovedMsg } from './dbus-msgs/by-topic/car-action/garage-car-remove-msg.def';\nimport { GarageManagersTeam } from './garage-managers-team';\nimport { CarComp } from './subcomps/car/car';\nimport { TrackComp } from './subcomps/track/track';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\nimport { DBusMsgCarActionCreatedMsg } from './dbus-msgs/by-topic/car-action/garage-car-created-msg.def';\nimport { DBusMsgRaceRequestMsg } from './dbus-msgs/by-topic/garage/garage-race-request-msg.def';\nimport { DBusMsgGarageResetReqMsg } from './dbus-msgs/by-topic/garage/garage-reset-req-msg.def';\n\nimport styles from './garage.scss';\nimport sharedStyles from '../../styles/styles.scss';\nimport { Pager } from '../../lib/services/pager/pager';\nimport { DBusMsgGenerateCarsMsg } from './subcomps/main-controls/dbus-msgs/generate-cars-msg.def';\nimport { DBusMsgRebootMsg } from '../../app/dbus-msgs/reboot-msg.def';\nimport { DBusMsgGaragePageIsChangedMsg } from './dbus-msgs/by-topic/garage/garage-page-is-changed.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport {\n  DBusMsgRoutingRestrainMsg,\n  RoutingRestrainActions,\n} from '../../lib/services/simple-router/dbus-msgs-defs/types/routing-restrict-msg.def';\n\ntype TracksGeometry = {\n  trackHeights: number[];\n  displacements: number[];\n  paddingBase: number;\n  paddingShift: number;\n};\n\nexport class GarageCompCtlAkaDirector implements DBusHub {\n  static readonly DISPLACEMENT_FIX = -24;\n\n  static readonly CAR_WIDTH_RATIO = 0.2;\n\n  static readonly CAR_MAX_WIDTH =\n    1920 * GarageCompCtlAkaDirector.CAR_WIDTH_RATIO;\n\n  static readonly SKIPPED_PROGRESSION_MEMBERS_COUNT = 2;\n\n  static readonly PADDING_SHIFT_BASE = 35;\n\n  static readonly PADDING_SHIFT_BASE_VW = 1920;\n\n  static readonly CAR_IMG_RATIO = 3.78;\n\n  static readonly SCALE_FACTOR = 0.95;\n\n  readonly hubName = DBUS_HUB_NAMES.GARAGE_CONTROLLER;\n\n  protected txs = new Set<DBusTX>();\n\n  private garageManagersTeam: GarageManagersTeam;\n\n  private pager: Pager;\n\n  private entriesPerPage = 7;\n\n  private pagerContainer = document.createElement('div');\n\n  private racePromise: Promise<unknown> | undefined;\n\n  private ctlBlocks: HTMLElement[] = [];\n\n  // * FINISHED < 40 LINES *\n  constructor(\n    private tracksContainer: HTMLElement,\n    private carCtlsBlock: HTMLElement,\n  ) {\n    this.garageManagersTeam = new GarageManagersTeam(\n      tracksContainer,\n      carCtlsBlock,\n      this.lockCallback,\n    );\n\n    this.pager = new Pager(this.entriesPerPage, this.pagerCallback);\n    this.setupPager();\n  }\n\n  // * FINISHED < 40 LINES *\n  private setupPager() {\n    const btnNextPage = this.pager.getBtnNextPage();\n    btnNextPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['garage-bg__pager-btn'],\n    );\n\n    const btnPrevPage = this.pager.getBtnPrevPage();\n    btnPrevPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['garage-bg__pager-btn'],\n    );\n\n    const pagerInfo = this.pager.getPagerSpan();\n    pagerInfo.classList.add(styles['garage-bg__pager-span']);\n\n    this.pagerContainer.classList.add(styles['garage-bg__pager']);\n    this.pagerContainer.append(btnPrevPage, btnNextPage, pagerInfo);\n  }\n\n  // * FINISHED < 40 LINES *\n  private pagerCallback = async (dir: 'prev' | 'next'): Promise<boolean> => {\n    try {\n      console.log('await 1');\n      await this.resetState();\n      console.log('await 2');\n      await this.reloadData(dir);\n      return true;\n    } catch {\n      return false;\n    }\n  };\n\n  // * FINISHED < 40 LINES *\n  async startWorking(): Promise<boolean> {\n    try {\n      await this.reloadData();\n      window.addEventListener('resize', () => this.redraw());\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  // * FINISHED < 40 LINES *\n  async connect(int: DBusInterface): Promise<void> {\n    this.txs.add(int.getNewTX('broadcast paging'));\n    this.garageManagersTeam.autoConnect(int);\n\n    const carActionsMsgsRX = int.getNewRX(\n      this.carActionsRXFunc,\n      'monitor cars removes',\n    );\n    int.plugRX(DBusTopics.CAR_ACTION, carActionsMsgsRX);\n\n    const raceMsgsRX = int.getNewRX(this.racingRXFunc, 'handle race requsets');\n    int.plugRX(DBusTopics.GARAGE, raceMsgsRX);\n\n    const generatorMsgsRX = int.getNewRX(this.generatorRXFunc);\n    int.plugRX(DBusTopics.GENERATE, generatorMsgsRX);\n\n    const appCtlMsgsRX = int.getNewRX(\n      this.appCtlRXFunc,\n      'handle app reboot msgs',\n    );\n    int.plugRX(DBusTopics.APP_CTL, appCtlMsgsRX);\n  }\n\n  private appCtlRXFunc = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgRebootMsg && data.msg.signal === 'reboot') {\n      await this.resetState();\n      await this.reloadData();\n      return true;\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private generatorRXFunc = async (data: DBusTXData) => {\n    if (\n      data.msg instanceof DBusMsgGenerateCarsMsg &&\n      data.msg.status === 'end'\n    ) {\n      await this.resetState();\n      await this.reloadData();\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private racingRXFunc = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgRaceRequestMsg) {\n      this.pager.toogleLock(true);\n      await this.performRace();\n      this.pager.toogleLock(false);\n      return true;\n    }\n    if (data.msg instanceof DBusMsgGarageResetReqMsg) {\n      return this.resetState();\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private async resetState() {\n    const restrainFunc = async () => false;\n    await this.toggleRoutingRestrains('restrain', restrainFunc);\n    return new Promise((res, rej) => {\n      this.toggleCtlsBlockDisabled(true);\n      this.pager.toogleLock(true);\n      this.garageManagersTeam\n        .resetState()\n        .then(() => res(true))\n        .catch((error: Error) => {\n          rej(error);\n        })\n        .finally(() => {\n          this.pager.toogleLock(false);\n          this.toggleCtlsBlockDisabled(false);\n        });\n    }).finally(() => {\n      this.toggleRoutingRestrains('unleash', restrainFunc);\n    });\n  }\n\n  private async lockCallback(state: boolean) {\n    this.pager.toogleLock(state);\n    return true;\n  }\n\n  private toggleCtlsBlockDisabled(state: boolean) {\n    if (state === true) {\n      this.carCtlsBlock.addEventListener(\n        'click',\n        this.carCtlsBlockBlockListener,\n        {\n          capture: true,\n        },\n      );\n      this.ctlBlocks.forEach((block, index) => {\n        block.style.setProperty(\n          '--glitch-delay',\n          `${index / this.ctlBlocks.length}s`,\n        );\n        block.classList.add(sharedStyles['glitched-item']);\n      });\n    } else {\n      this.carCtlsBlock.removeEventListener(\n        'click',\n        this.carCtlsBlockBlockListener,\n        {\n          capture: true,\n        },\n      );\n      this.ctlBlocks.forEach(block => {\n        block.classList.remove(sharedStyles['glitched-item']);\n        block.style.removeProperty('--glitch-delay');\n      });\n    }\n  }\n\n  private carCtlsBlockBlockListener = (e: Event) => {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  toggleRoutingRestrains(\n    action: RoutingRestrainActions,\n    restrainFunc?: () => Promise<boolean>,\n  ) {\n    const msg = new DBusMsgRoutingRestrainMsg(\n      action,\n      restrainFunc || this.routingRestrainFunc,\n    );\n    const transmissions: Promise<unknown>[] = [];\n    this.txs.forEach(tx => {\n      const x = tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n      transmissions.push(x);\n    });\n    return Promise.allSettled(transmissions);\n  }\n\n  private routingRestrainFunc = async () => {\n    return false;\n  };\n\n  // * FINISHED < 40 LINES *\n  // ! NOT TESTED PROMISE !\n  private async performRace() {\n    this.racePromise = this.garageManagersTeam.performRace().finally(() => {\n      this.racePromise = undefined;\n    });\n    return this.racePromise;\n  }\n\n  // * FINISHED < 40 LINES *\n  private carActionsRXFunc = async (data: DBusTXData) => {\n    if (\n      data.msg instanceof DBusMsgCarActionRemovedMsg ||\n      data.msg instanceof DBusMsgCarActionCreatedMsg\n    ) {\n      if (this.racePromise) await this.racePromise;\n      try {\n        if (data.msg instanceof DBusMsgCarActionRemovedMsg) {\n          this.garageManagersTeam.handleCarRm(data.msg.car);\n        }\n        this.resetState().finally(() => this.reloadData());\n      } catch {\n        this.pager.tryChangePage('prev');\n      }\n    }\n\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private reloadData(dir?: 'prev' | 'next') {\n    return new Promise<boolean>((res, rej) => {\n      const page = dir\n        ? dir === 'next'\n          ? this.pager.getCurrPageNumber() + 1\n          : this.pager.getCurrPageNumber() - 1\n        : this.pager.getCurrPageNumber();\n      REST_CLIENT_GARAGE.getCars(page, this.pager.getEntriesPerPage()).then(\n        async response => {\n          const { limit, cars } = response;\n          this.pager.setEntriesCount(Number.parseInt(limit, 10));\n          if (response.cars.length === 0) {\n            if (dir) {\n              rej();\n              return;\n            }\n\n            if (page > 1) {\n              await this.pager.tryChangePage('prev');\n              res(true);\n              return;\n            }\n          }\n          this.broadcastPaging();\n\n          await this.garageManagersTeam.nullifyContracts();\n          const newContracts: GarageServicemanContract[] = [];\n\n          cars.forEach((car, index) => {\n            const track = new TrackComp();\n            const carComp = new CarComp(car, index + 1);\n            track.placeCar(carComp);\n            newContracts.push({ track, car: carComp });\n          });\n\n          this.garageManagersTeam.addContracts(...newContracts);\n          this.garageManagersTeam.resetState();\n          this.redraw();\n          res(true);\n        },\n      );\n    });\n  }\n\n  private broadcastPaging() {\n    const msg = new DBusMsgGaragePageIsChangedMsg();\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  // * FINISHED < 40 LINES *\n  private async redraw() {\n    this.clearDOM();\n\n    const geometry = this.calcGeometry();\n    this.setStylesForTracks(geometry);\n\n    this.drawTracks();\n    this.drawCarsCtls();\n  }\n\n  // * FINISHED < 40 LINES *\n  private clearDOM() {\n    while (this.tracksContainer.firstChild)\n      this.tracksContainer.firstChild.remove();\n    while (this.carCtlsBlock.firstChild) this.carCtlsBlock.firstChild.remove();\n  }\n\n  // ! MORE THAN 40 LINES ! BUT IT IS AN ONE-PIECE FUNCTION !\n  // ! BETTER TO SAVE IT AS IS\n  private calcGeometry(): TracksGeometry {\n    const style = window.getComputedStyle(this.tracksContainer);\n    const containerHeight =\n      Number.parseFloat(style.height) -\n      Number.parseFloat(style.paddingBottom) -\n      Number.parseFloat(style.paddingTop);\n    const firstAutoWidth = Math.min(\n      window.innerWidth * GarageCompCtlAkaDirector.CAR_WIDTH_RATIO,\n      GarageCompCtlAkaDirector.CAR_MAX_WIDTH,\n    );\n    const firstAutoHeight =\n      firstAutoWidth / GarageCompCtlAkaDirector.CAR_IMG_RATIO;\n    const heights: number[] = [];\n    let heightSum = 0;\n    const contracts = [...this.garageManagersTeam.getContracts()];\n\n    contracts.forEach((contract, index) => {\n      const factor = GarageCompCtlAkaDirector.SCALE_FACTOR ** index;\n      const carTrackHeight = firstAutoHeight * factor;\n      heightSum += carTrackHeight;\n      heights.push(carTrackHeight);\n    });\n\n    const excessHeight = heightSum - containerHeight;\n    const heightsReversed = heights.sort((a, b) => a - b);\n    const displacementBase =\n      excessHeight > 0\n        ? excessHeight / this.garageManagersTeam.getContracts().size -\n          GarageCompCtlAkaDirector.SKIPPED_PROGRESSION_MEMBERS_COUNT\n        : 0;\n\n    const displacements: number[] = [];\n    const midIndex = (contracts.length - 1) / 2;\n\n    contracts.forEach((contract, index) => {\n      const diff = index - midIndex;\n      const displacement =\n        displacementBase * -diff + GarageCompCtlAkaDirector.DISPLACEMENT_FIX;\n      displacements.push(displacement);\n    });\n\n    const paddingBase =\n      (heightsReversed[0] as number) * GarageCompCtlAkaDirector.CAR_IMG_RATIO;\n    const paddingShift =\n      (GarageCompCtlAkaDirector.PADDING_SHIFT_BASE * window.innerWidth) /\n      GarageCompCtlAkaDirector.PADDING_SHIFT_BASE_VW;\n\n    return {\n      trackHeights: heightsReversed,\n      displacements,\n      paddingBase,\n      paddingShift,\n    };\n  }\n\n  // * FINISHED < 40 LINES *\n  private setStylesForTracks(geometry: TracksGeometry) {\n    const contracts = [...this.garageManagersTeam.getContracts()];\n\n    contracts.forEach((contract, index) => {\n      contract.track.rootElement.style.setProperty(\n        'height',\n        `${geometry.trackHeights[index]}px`,\n      );\n\n      contract.track.rootElement.style.setProperty(\n        'top',\n        `${geometry.displacements[index]}px`,\n      );\n\n      contract.track.rootElement.style.setProperty('z-index', `${index + 1}`);\n\n      contract.track.rootElement.style.setProperty(\n        '--padding-w',\n        `${\n          (geometry.trackHeights[\n            geometry.trackHeights.length - 1 - index\n          ] as number) *\n            GarageCompCtlAkaDirector.CAR_IMG_RATIO -\n          geometry.paddingBase +\n          geometry.paddingShift * (contracts.length - 1 - index)\n        }px`,\n      );\n    });\n  }\n\n  // * FINISHED < 40 LINES *\n  private drawTracks() {\n    this.tracksContainer.append(\n      this.pagerContainer,\n      ...[...this.garageManagersTeam.getContracts()].map(contract => {\n        contract.car.playFirstIntroAnim();\n        return contract.track.rootElement;\n      }),\n    );\n  }\n\n  // * FINISHED < 40 LINES *\n  private drawCarsCtls() {\n    const contracts = [...this.garageManagersTeam.getContracts()];\n    this.ctlBlocks = contracts.map((contract, index) => {\n      const block = this.createCarCtlBlock(contract.car, index + 1);\n      this.connectCtlAndTrack(block, contract.track);\n      return block;\n    });\n    this.carCtlsBlock.append(...this.ctlBlocks);\n  }\n\n  // * FINISHED < 40 LINES *\n  private createCarCtlBlock = (car: CarComp, index: number): HTMLElement => {\n    const btns = [car.btnSelect, car.btnStart, car.btnReset, car.btnRm];\n\n    btns.forEach(btn => {\n      btn.classList.add(sharedStyles.btn, styles['garage-bg__car-ctl-btn']);\n    });\n\n    car.btnStart.classList.add(sharedStyles['btn-15']);\n    car.btnSelect.classList.add(sharedStyles['btn-13']);\n    car.btnReset.classList.add(sharedStyles['btn-9']);\n    car.btnRm.classList.add(sharedStyles['btn-4']);\n\n    const numberSpan = document.createElement('span');\n    numberSpan.classList.add(styles['garage-bg__car-ctl-block-number']);\n    numberSpan.textContent = index.toString();\n\n    const container = document.createElement('div');\n    container.classList.add(styles['garage-bg__car-ctl-block']);\n    container.append(numberSpan, ...btns);\n\n    return container;\n  };\n\n  // * FINISHED < 40 LINES *\n  // ? REFACTOR TO BE ABLE TO RM EVENT LISTENERS ?\n  private connectCtlAndTrack = (ctlElem: HTMLElement, track: TrackComp) => {\n    ctlElem.addEventListener(\n      'mouseover',\n      () => track.illuminateSelf(true),\n      true,\n    );\n    ctlElem.addEventListener(\n      'mouseout',\n      () => track.illuminateSelf(false),\n      true,\n    );\n  };\n}\n","import { PopupStandaloneModalProgressComp } from '../../lib/components/popups/standalone/modal/progress/popup-progress';\nimport { genUniqId } from '../../lib/generators/generators';\nimport {\n  EngineResponse,\n  REST_CLIENT_ENGINE,\n} from '../../services/rest-clients/client-engine/rest-client-engine';\nimport { REST_CLIENT_ERROR } from '../../services/rest-clients/rest-clients-errors.def';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\n\nexport enum GarageDriverCommands {\n  START_DRIVING,\n  STOP_DRIVING,\n}\n\nexport class GarageDriver {\n  private contract: GarageServicemanContract | undefined;\n\n  private currDriveId: string | undefined;\n\n  private drivePromise: Promise<unknown> | undefined;\n\n  private ignitionPromise: Promise<unknown> | undefined;\n\n  private lastStart: number | undefined;\n\n  private lastTimeInMs: number | undefined;\n\n  public isFree(): boolean {\n    if (!this.contract) return true;\n    return false;\n  }\n\n  putBehindTheWheel(contract: GarageServicemanContract): void {\n    if (this.contract) throw new Error('ALREADY IN CAR');\n    this.contract = contract;\n  }\n\n  async getOutOfTheCar() {\n    this.contract = undefined;\n  }\n\n  async performDrivingProtocol(flags?: Record<string, unknown>) {\n    const newPromise = new Promise<{\n      driveParams: EngineResponse;\n      drivePromise: Promise<number | false>;\n    }>((res, rej) => {\n      if (flags) this.contract?.car.disableCtls(); // race\n      const thisDriveId = genUniqId();\n      this.currDriveId = thisDriveId;\n      console.log('ignite');\n      this.ignitionPromise = this.TurnOnTheIgnition()\n        .then(driveParams => {\n          console.log('ignited');\n          if (thisDriveId !== this.currDriveId) rej(new Error('interrupted'));\n          // console.log(driveParams);\n          const drivePromise = this.drive(driveParams, thisDriveId, flags);\n          res({\n            driveParams,\n            drivePromise,\n          });\n        })\n        .catch((error: Error) => {\n          console.log(error);\n          if (thisDriveId !== this.currDriveId) rej(new Error('interrupted'));\n          else rej(error);\n        });\n    });\n    return newPromise;\n  }\n\n  private async TurnOnTheIgnition() {\n    if (!this.contract) throw new Error('NOT_BEHIND_THE_WHEEL');\n    if (this.drivePromise) await Promise.allSettled([this.drivePromise]);\n    console.log('new promise');\n    const { car } = this.contract;\n    car.toggleIgniteAnim(true);\n    const params = await REST_CLIENT_ENGINE.toggleEngine(\n      this.contract.car.currCar.id,\n      'started',\n    ).finally(() => {\n      car.toggleIgniteAnim(false);\n    });\n    // console.log('ENGINE STARTED');\n    return params;\n  }\n\n  public isInStartPosition() {\n    return !this.currDriveId;\n  }\n\n  // !!! If animation fails, this promise never resolves!\n  async returnToStart() {\n    this.currDriveId = undefined;\n    if (this.contract) {\n      if (this.ignitionPromise) await this.ignitionPromise;\n      if (this.drivePromise) {\n        console.log('return', this.contract);\n        await this.stopCar(true, false);\n        console.log('return', this.contract);\n        await this.contract.car.rollBack(this.drivePromise);\n        console.log('return', this.contract);\n        const msgBlock = document.createElement('div');\n        msgBlock.style.setProperty('height', '100%');\n        msgBlock.style.setProperty('width', '40%');\n        msgBlock.style.setProperty('position', 'absolute');\n        msgBlock.style.setProperty('right', '0px');\n        msgBlock.style.setProperty('top', '100%');\n        msgBlock.style.setProperty('transform', 'translate(-40%, -120%)');\n        this.contract.track.rootElement.append(msgBlock);\n        const popup = new PopupStandaloneModalProgressComp();\n\n        popup\n          .setText(\n            `I can't let the engine start again until\n          the server finishes its business, read the notes, please.`,\n          )\n          .show(msgBlock);\n        const interval = this.updateProgress(popup);\n        await this.contract.car.playAwaitingAnim(this.drivePromise);\n        if (interval) clearTimeout(interval);\n        popup.hide();\n        msgBlock.remove();\n      } else {\n        await this.stopCar(false, false);\n        await this.contract.car.rollBack();\n      }\n    }\n    return true;\n  }\n\n  private updateProgress(\n    popup: PopupStandaloneModalProgressComp,\n  ): NodeJS.Timeout {\n    const interval = setInterval(() => {\n      if (this.lastTimeInMs && this.lastStart) {\n        const progress =\n          ((Date.now() - this.lastStart) / this.lastTimeInMs) * 100;\n        popup.setProgress(progress);\n      } else clearInterval(interval);\n    }, 500);\n    return interval;\n  }\n\n  private async drive(\n    driveParams: EngineResponse,\n    driveId: string,\n    flags?: Record<string, unknown>,\n  ): Promise<false | number> {\n    return new Promise<false | number>((res, rej) => {\n      if (this.contract) {\n        const { contract } = this;\n        const time = GarageDriver.calculateDriveTime(driveParams);\n        this.lastStart = Date.now();\n        this.lastTimeInMs = time * 1000;\n        const start = Date.now();\n        console.log('enter drive mode');\n        this.drivePromise = REST_CLIENT_ENGINE.enterDriveMode(\n          contract.car.currCar.id,\n        ).then(success => {\n          if (\n            !(contract === this.contract) ||\n            !(driveId === this.currDriveId)\n          ) {\n            rej(new Error('interrupted'));\n          } else if (success) {\n            res(time);\n            console.log('stop car finish');\n            this.stopCar(true, true, false, flags);\n          } else {\n            console.log('stop car broken');\n            this.stopCar(true, false, true, flags);\n            res(false);\n          }\n          console.log(`time from start: ${Date.now() - start}`);\n        });\n        contract.car\n          .rollForward(time, !flags)\n          .catch(() => {\n            res(false);\n          })\n          .then(async playbackRate => {\n            if (playbackRate && playbackRate > 0) {\n              this.stopCar(true, true, false, flags);\n              const connectionRestored = await this.emergencyAwaitServer(\n                time * 1000,\n                1000,\n                this.drivePromise,\n              );\n              if (!connectionRestored) {\n                rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n              }\n            }\n          });\n      } else rej(new Error('No car'));\n    });\n  }\n\n  private emergencyAwaitServer = (\n    timeInMS: number,\n    delayInMS: number,\n    resPromise?: Promise<unknown>,\n  ) => {\n    const popup = new PopupStandaloneModalProgressComp();\n    popup.setText(`Connection is lost... awaiting server`).setProgress(1);\n    return new Promise<boolean>(res => {\n      const startTime = Date.now();\n      let IamResolved = false;\n      let interval: NodeJS.Timeout;\n      const resFunc = () => {\n        IamResolved = true;\n        if (interval) clearInterval(interval);\n        popup.hide();\n        res(false);\n      };\n      const chargeInterval = () => {\n        interval = setInterval(() => {\n          if (IamResolved) {\n            clearInterval(interval);\n            return;\n          }\n          popup.show();\n          const currTime = Date.now();\n          const elapsedTime = currTime - startTime;\n          if (elapsedTime < timeInMS) {\n            const progress = (elapsedTime / timeInMS) * 100;\n            popup.setProgress(progress);\n          } else resFunc();\n        }, timeInMS / 20); // 5%\n      };\n\n      resPromise?.finally(() => {\n        resFunc();\n      });\n      setTimeout(() => {\n        chargeInterval();\n      }, delayInMS);\n    });\n  };\n\n  private async stopCar(\n    onlyAnim = false,\n    rollover = true,\n    broken = false,\n    flags?: Record<string, unknown>,\n  ) {\n    if (this.contract) {\n      if (!broken && !onlyAnim) {\n        const response = await REST_CLIENT_ENGINE.toggleEngine(\n          this.contract.car.currCar.id,\n          'stopped',\n        );\n        console.log('stopped by server', response);\n      }\n      await this.contract.car.stop(rollover, broken, flags);\n      return true;\n    }\n    throw new Error('No car');\n  }\n\n  private static calculateDriveTime(params: EngineResponse) {\n    const time = params.distance / 1000 / params.velocity; /// !!! distance units???\n    return time;\n  }\n}\n","import { RegCarData, WinnerCarData } from '../../definitions/car-data.def';\nimport { DBusInterface } from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../lib/services/dbus/defs/dbus-port.def';\nimport { DBusRX } from '../../lib/services/dbus/defs/dbus-rx/dbus-rx.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgCarActionSelectedMsg } from './dbus-msgs/by-topic/car-action/garage-car-select-msg.def';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionRemovedMsg } from './dbus-msgs/by-topic/car-action/garage-car-remove-msg.def';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\nimport { GarageDriver, GarageDriverCommands } from './garage-driver';\nimport { genUniqId } from '../../lib/generators/generators';\n\nimport styles from './garage.scss';\nimport { REST_CLIENT_WINNERS } from '../../services/rest-clients/client-winners/rest-client-winners';\nimport { REST_CLIENT_ERROR } from '../../services/rest-clients/rest-clients-errors.def';\nimport { DBusMsgGarageRaceStatusMsg } from './dbus-msgs/by-topic/garage/garage-race-status-msg.def';\nimport { RaceStatusesList } from './race-statuses.def';\nimport {\n  getTransitionDuration,\n  transitionPromise,\n} from '../../lib/gui/animation';\nimport { GaragePopupWinner } from './subcomps/popup-winner/popup-winner';\nimport {\n  DBusMsgRoutingRestrainMsg,\n  RoutingRestrainActions,\n} from '../../lib/services/simple-router/dbus-msgs-defs/types/routing-restrict-msg.def';\nimport {\n  DBusMsgGarageStatusMsg,\n  GarageStatus,\n} from './dbus-msgs/by-topic/garage/garage-status-msg.def';\n\ntype RaceData = {\n  raceId: string;\n  arrivedByOrder: GarageServicemanContract[];\n  notArrived: GarageServicemanContract[];\n  participantsCount: number;\n  flags: Record<string, unknown>;\n  stratedCount: number;\n};\n\ntype RaceResults = {\n  arrivedByOrder: GarageServicemanContract[];\n  notArrived: GarageServicemanContract[];\n};\nexport class GarageManagersTeam implements DBusPort {\n  protected txs = new Set<DBusTX>();\n\n  protected contracts = new Set<GarageServicemanContract>();\n\n  protected freeDrivers = new Set<GarageDriver>();\n\n  protected busyDrivers = new Map<GarageServicemanContract, GarageDriver>();\n\n  protected movingDrivers = new Map<GarageServicemanContract, GarageDriver>();\n\n  protected currRaceId: string | undefined;\n\n  protected winnerPopup = new GaragePopupWinner();\n\n  protected rollbackPromise: Promise<unknown> | undefined;\n\n  constructor(\n    private readonly tracksContainer: HTMLElement,\n    private readonly carCtlsBlock: HTMLElement,\n    private readonly directorLockCb: (state: boolean) => Promise<boolean>,\n  ) {\n    this.carCtlsBlock.addEventListener('click', this.carCtlsClickListener);\n    this.winnerPopup.rootElement.classList.add(styles['garage__winner-popup']);\n  }\n\n  autoConnect(int: DBusInterface) {\n    const tx = int.getNewTX('garage serviceman');\n    this.txs.add(tx);\n  }\n\n  public getContracts() {\n    return this.contracts;\n  }\n\n  public handleCarRm(car: RegCarData) {\n    this.contracts.forEach(contract => {\n      if (contract.car.currCar.id === car.id)\n        this.busyDrivers.get(contract)?.getOutOfTheCar();\n    });\n  }\n\n  async nullifyContracts(contracts?: GarageServicemanContract[]) {\n    if (contracts) {\n      this.tryFreeDrivers(...contracts);\n      contracts.forEach(contract => {\n        this.contracts.delete(contract);\n      });\n    } else {\n      this.tryFreeDrivers(...this.contracts);\n      this.contracts.clear();\n    }\n  }\n\n  addContracts(...сontracts: GarageServicemanContract[]) {\n    сontracts.forEach(newContract => this.contracts.add(newContract));\n  }\n\n  private carCtlsClickListener = (e: Event) => {\n    if (e.target instanceof HTMLElement) {\n      const elem = e.target;\n      let btn: HTMLButtonElement | undefined;\n\n      if (elem instanceof HTMLButtonElement) btn = elem;\n      else if (elem.parentElement instanceof HTMLButtonElement)\n        btn = elem.parentElement;\n\n      if (btn && btn.disabled !== true) {\n        this.contracts.forEach(contract => {\n          if (this.currRaceId) return;\n          if (btn === contract.car.btnSelect) {\n            this.handleSelection(contract);\n            return;\n          }\n          if (btn === contract.car.btnRm) {\n            contract.car.btnRm.disabled = true;\n            this.handleRemoving(contract);\n            return;\n          }\n          if (btn === contract.car.btnStart) {\n            contract.car.btnStart.disabled = true;\n            this.startDriving(contract);\n            return;\n          }\n          if (btn === contract.car.btnReset) {\n            contract.car.btnReset.disabled = true;\n            this.handleRestoreState(contract);\n          }\n        });\n      }\n    }\n  };\n\n  async resetState(prepareForRace?: boolean) {\n    if (!prepareForRace) this.currRaceId = undefined;\n    this.winnerPopup.rootElement.remove();\n    this.tracksContainer.classList.remove(\n      styles['synthwave-background_race-mode'],\n    );\n    console.log('await rollbacks');\n    await this.rollbackCars();\n    console.log('rollbacks done');\n    this.broadcastGarageStatus('reset is not needed');\n\n    if (!prepareForRace) {\n      this.broadcastRaceStatus('READY_TO_GO');\n    }\n  }\n\n  private async handleRestoreState(contract: GarageServicemanContract) {\n    const driver = this.busyDrivers.get(contract);\n    if (driver) {\n      await driver.returnToStart();\n      await this.broadcastIfAllInStart();\n    }\n  }\n\n  private async broadcastIfAllInStart() {\n    const allInStart = [...this.busyDrivers].every(contract =>\n      contract[1].isInStartPosition(),\n    );\n    if (allInStart) {\n      this.broadcastGarageStatus('reset is not needed');\n    }\n  }\n\n  private async startDriving(\n    contract: GarageServicemanContract,\n    flags?: Record<string, unknown>,\n  ) {\n    let choosedDriver = this.busyDrivers.get(contract);\n\n    if (!choosedDriver) {\n      // !!! excess check?\n      choosedDriver = [...this.freeDrivers].find(driver => driver.isFree());\n\n      if (choosedDriver) {\n        this.freeDrivers.delete(choosedDriver);\n      } else {\n        choosedDriver = new GarageDriver();\n      }\n\n      this.busyDrivers.set(contract, choosedDriver);\n\n      choosedDriver.putBehindTheWheel(contract);\n    }\n\n    this.movingDrivers.set(contract, choosedDriver);\n    if (this.movingDrivers.size === 1) {\n      await this.broadcastGarageStatus('need reset');\n      await this.toggleRoutingRestrains('restrain');\n      await this.broadcastGarageStatus('car moves');\n    }\n\n    return choosedDriver\n      .performDrivingProtocol(flags)\n      .then(response => {\n        response.drivePromise.finally(() => {\n          this.movingDrivers.delete(contract);\n          console.log(`MOVING DRIVERS: ${this.movingDrivers.size}`);\n\n          if (this.movingDrivers.size === 0) {\n            this.toggleRoutingRestrains('unleash');\n            this.broadcastGarageStatus('all cars stopped');\n          }\n        });\n        return response;\n      })\n      .catch(error => {\n        this.movingDrivers.delete(contract);\n\n        if (this.movingDrivers.size === 0) {\n          this.toggleRoutingRestrains('unleash');\n          this.broadcastGarageStatus('all cars stopped');\n        }\n\n        console.log(`MOVING DRIVERS: ${this.movingDrivers.size}`);\n        throw error;\n      });\n  }\n\n  private async broadcastGarageStatus(status: GarageStatus) {\n    const msg = new DBusMsgGarageStatusMsg(status);\n    const transmissions: Promise<unknown>[] = [];\n    this.txs.forEach(tx => {\n      const x = tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n      transmissions.push(x);\n    });\n    return Promise.allSettled(transmissions);\n  }\n\n  toggleRoutingRestrains(action: RoutingRestrainActions) {\n    const msg = new DBusMsgRoutingRestrainMsg(action, this.routingRestrainFunc);\n    const transmissions: Promise<unknown>[] = [];\n    this.txs.forEach(tx => {\n      const x = tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n      transmissions.push(x);\n    });\n    return Promise.allSettled(transmissions);\n  }\n\n  private routingRestrainFunc = async () => {\n    return false;\n  };\n\n  private handleRemoving(contract: GarageServicemanContract) {\n    REST_CLIENT_GARAGE.deleteCar(contract.car.currCar.id).then(async () => {\n      await REST_CLIENT_WINNERS.deleteWinner(contract.car.currCar.id).catch(\n        () => {},\n      );\n      this.tryFreeDrivers(contract);\n      this.contracts.delete(contract);\n      const msg = new DBusMsgCarActionRemovedMsg(\n        contract.car.currCar,\n        contract,\n      );\n      this.txs.forEach(tx => {\n        tx.transmit({\n          msg,\n          prepMode: DBusTXPrepModes.freeze,\n          waitMode: DBusTXWaitModes.nowait,\n        });\n      });\n    });\n  }\n\n  private handleSelection(contract: GarageServicemanContract) {\n    const msg = new DBusMsgCarActionSelectedMsg(\n      contract.car.currCar,\n      this.genSelectCallback(contract),\n    );\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  private async rollbackCars() {\n    if (this.rollbackPromise) {\n      await this.rollbackPromise;\n      return;\n    }\n    this.tracksContainer.classList.remove(\n      styles['garage__track-container_finish'],\n    );\n    this.tracksContainer.style.setProperty('--translate-x', '0px');\n    // rollback cars\n    const rollbacks: Promise<unknown>[] = [];\n    this.busyDrivers.forEach(driver => {\n      rollbacks.push(driver.returnToStart());\n    });\n    console.log('awaiting', rollbacks);\n    this.rollbackPromise = Promise.all(rollbacks).finally(() => {\n      this.rollbackPromise = undefined;\n    });\n    await this.rollbackPromise;\n    console.log('awaiting rollbacks done');\n  }\n\n  async performRace() {\n    // prepare\n    const thisRaceId = genUniqId();\n    this.currRaceId = thisRaceId;\n    await this.resetState(true);\n    // check if user cancell a race\n    if (thisRaceId !== this.currRaceId) return;\n\n    // process race\n    const raceData: RaceData = {\n      raceId: thisRaceId,\n      arrivedByOrder: [],\n      notArrived: [],\n      participantsCount: this.contracts.size,\n      flags: {\n        roadElem: this.tracksContainer,\n        isFinishVisible: false, // TODO: rm\n      },\n      stratedCount: 0,\n    };\n    this.broadcastRaceStatus('IN_PROCESS');\n    await this.processRace(raceData)\n      .catch((error: Error) => {\n        if (!(thisRaceId !== this.currRaceId)) throw error;\n      })\n      .finally(() => {\n        this.tracksContainer.classList.remove(\n          styles['synthwave-background_race-mode'],\n        );\n      });\n\n    // check if user cancell a race\n    if (thisRaceId !== this.currRaceId) return;\n\n    // console.log(raceData);\n\n    this.broadcastRaceStatus('NEED_RESET');\n    // TODO: Do something else?\n  }\n\n  private broadcastRaceStatus(status: RaceStatusesList) {\n    const msg = new DBusMsgGarageRaceStatusMsg(status);\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  // false if race was interrupted\n  private processRace(raceData: RaceData) {\n    return new Promise<RaceData | false>(res => {\n      this.contracts.forEach(contract => {\n        this.startDriving(contract, raceData.flags).then(response => {\n          if (raceData.raceId !== this.currRaceId) {\n            res(false);\n            return;\n          }\n\n          if (raceData.stratedCount === raceData.participantsCount - 1) {\n            this.tracksContainer.classList.add(\n              styles['synthwave-background_race-mode'],\n            );\n            raceData.flags.isRoadMoves = true;\n          } else raceData.stratedCount++;\n\n          if (!(response instanceof Error)) {\n            response.drivePromise\n              .then(result =>\n                this.handleDriveResult(raceData, contract, result),\n              )\n              .catch((error: Error) => {\n                if (error.message === 'interrupted') res(false);\n              })\n              .finally(() => {\n                console.log(raceData);\n                if (\n                  raceData.arrivedByOrder.length +\n                    raceData.notArrived.length ===\n                  raceData.participantsCount\n                ) {\n                  console.log(raceData);\n                  res(raceData);\n                }\n              });\n          } else {\n            throw response;\n          }\n        });\n      });\n    });\n  }\n\n  private handleDriveResult(\n    raceData: RaceData,\n    contract: GarageServicemanContract,\n    result: number | false,\n  ) {\n    if (raceData.raceId !== this.currRaceId) return;\n    if (result !== false) {\n      if (raceData.arrivedByOrder.length === 0) {\n        this.handleWinner(contract, result, raceData.flags);\n      }\n      raceData.arrivedByOrder.push(contract);\n    } else {\n      raceData.notArrived.push(contract);\n    }\n  }\n\n  private handleWinner = async (\n    contract: GarageServicemanContract,\n    time: number,\n    flags: Record<string, unknown>,\n  ) => {\n    flags.isFinishVisible = true;\n    this.tracksContainer.classList.add(\n      styles['garage__track-container_finish'],\n    );\n    const style = window.getComputedStyle(this.tracksContainer, '::after');\n    const duration = getTransitionDuration(style, 'right');\n    if (duration) {\n      const awaitTime = Number.parseFloat(duration);\n      if (awaitTime > 0)\n        await new Promise(res => setTimeout(res, awaitTime * 1000));\n    }\n    this.tracksContainer.classList.remove(\n      styles['synthwave-background_race-mode'],\n    );\n    flags.isRoadMoves = false;\n    const winnerCar = contract.car.currCar;\n    this.winnerPopup.setData(\n      winnerCar,\n      time.toFixed(2),\n      contract.car.index?.toString(),\n    );\n    this.tracksContainer.append(this.winnerPopup.rootElement);\n    REST_CLIENT_WINNERS.getWinner(winnerCar.id)\n      .then(winnerRecord => {\n        const updatedWinnerData: WinnerCarData = {\n          id: winnerRecord.id,\n          wins: winnerRecord.wins + 1,\n          time:\n            time < winnerRecord.time\n              ? Number.parseFloat(time.toFixed(2))\n              : winnerRecord.time,\n        };\n        REST_CLIENT_WINNERS.updateWinner(updatedWinnerData);\n      })\n      .catch((error: Error) => {\n        if (error.message === REST_CLIENT_ERROR.NOT_FOUND) {\n          const newWinnerData: WinnerCarData = {\n            id: winnerCar.id,\n            wins: 1,\n            time: Number.parseFloat(time.toFixed(2)),\n          };\n          REST_CLIENT_WINNERS.createWinner(newWinnerData);\n        }\n      });\n  };\n\n  private tryFreeDrivers(...contracts: GarageServicemanContract[]) {\n    contracts.forEach(contract => {\n      const driver = this.busyDrivers.get(contract);\n      if (driver) {\n        driver.getOutOfTheCar().then(() => {\n          this.busyDrivers.delete(contract);\n          this.freeDrivers.add(driver);\n        });\n      }\n    });\n  }\n\n  private genSelectCallback(contract: GarageServicemanContract) {\n    return (car: RegCarData) => {\n      if (!this.contracts.has(contract)) return;\n      contract.car.updateData(car);\n    };\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { DBUS_HUB_NAMES } from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { GarageCompCtlAkaDirector } from './garage-controller';\nimport { MainControlsComp } from './subcomps/main-controls/main-controls';\n\nimport styles from './garage.scss';\nimport { Notifiable } from '../../lib/interfaces/notifiable';\nimport { PopupStandaloneModalProgressComp } from '../../lib/components/popups/standalone/modal/progress/popup-progress';\n\nexport class GarageComp extends BaseComp implements DBusHub, Notifiable {\n  readonly hubName = DBUS_HUB_NAMES.GARAGE;\n\n  private controller: GarageCompCtlAkaDirector;\n\n  private isControllerWorking = false;\n\n  private mainControlsComp = new MainControlsComp();\n\n  private carsCtlsBlock = document.createElement('div');\n\n  private bgVideo = document.createElement('video');\n\n  private popup = new PopupStandaloneModalProgressComp();\n\n  constructor() {\n    super('section');\n    console.log('show');\n    this.popup.setText('Loading...').setProgress(1).show();\n    this._rootElement.classList.add(styles.garage);\n\n    const selfCtlsBlock = document.createElement('div');\n    selfCtlsBlock.classList.add(styles['garage-bg__self-ctls-block']);\n    selfCtlsBlock.append(this.mainControlsComp.rootElement);\n\n    const bg = document.createElement('div');\n    bg.classList.add(styles.garage__bg, styles['garage-bg']);\n    bg.append(this.bgVideo, selfCtlsBlock);\n\n    const tracksContainer = document.createElement('div');\n    tracksContainer.classList.add(\n      styles['garage__track-container'],\n      styles['synthwave-background'],\n    );\n\n    this.carsCtlsBlock.classList.add(styles['garage-bg__cars-ctls-block']);\n\n    this.controller = new GarageCompCtlAkaDirector(\n      tracksContainer,\n      this.carsCtlsBlock,\n    );\n\n    this.setupBgVideo();\n\n    this._rootElement.append(bg, tracksContainer, this.carsCtlsBlock);\n  }\n\n  private setupBgVideo() {\n    this.bgVideo.addEventListener('progress', this.bgVideoProgressListener);\n    this.bgVideo.addEventListener(\n      'canplaythrough',\n      this.bgVideoCanPlayListener,\n    );\n    this.renderBgVideo();\n  }\n\n  private renderBgVideo() {\n    this.bgVideo.classList.add(styles['garage-bg__video']);\n    this.bgVideo.controls = false;\n    this.bgVideo.loop = true;\n    this.bgVideo.defaultMuted = true;\n    this.bgVideo.muted = true;\n    this.bgVideo.autoplay = true;\n    this.bgVideo.src = './assets/videos/bg/cyberpunk2077-garage.mp4';\n  }\n\n  private bgVideoProgressListener = () => {\n    if (this.bgVideo.buffered.length > 0) {\n      const progress =\n        (this.bgVideo.buffered.end(0) / this.bgVideo.duration) * 100;\n      this.popup.setProgress(progress);\n    }\n  };\n\n  private bgVideoCanPlayListener = async () => {\n    this.bgVideo.removeEventListener(\n      'canplaythrough',\n      this.bgVideoCanPlayListener,\n    );\n    this.bgVideo.removeEventListener('progress', this.bgVideoProgressListener);\n    this.popup.setProgress(100).reset().hide();\n    this.isControllerWorking = await this.controller.startWorking();\n  };\n\n  connect(int: DBusInterface): void {\n    int.attachSubHub(this.controller);\n    int.attachSubHub(this.mainControlsComp);\n  }\n\n  notify = async (): Promise<void> => {\n    try {\n      this.bgVideo.play();\n    } catch {\n      // do nothing...\n    }\n    if (!this.isControllerWorking) {\n      this.isControllerWorking = await this.controller.startWorking();\n    }\n  };\n}\n","import { RegCarData, UnregCarData } from '../../../../definitions/car-data.def';\nimport { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { hexToRgb } from '../../../../lib/convertors/colors';\nimport { transitionPromise } from '../../../../lib/gui/animation';\nimport { OBJ_PROCESSOR } from '../../../../lib/processors/obj-processor';\n\nimport styles from './car.scss';\nimport garageStyles from '../../garage.scss';\nimport sharedStyles from '../../../../styles/styles.scss';\n\nexport class CarComp extends BaseComp {\n  static readonly TIMING_FUNCTION = 'cubic-bezier(.72,.2,.54,.77)';\n\n  static readonly CAR_BODY_IMG_SRC = './assets/imgs/cars/body.gif';\n\n  static readonly CAR_WHEEL_IMG_SRC = './assets/imgs/cars/tire back.gif';\n\n  static readonly CAR_EXPLOSION_IMG_DATA = {\n    BASE_URL: './assets/imgs/cars/explosion/',\n    EXTENSION: '.png',\n    FRAMES_COUNT: 9,\n    FRAME_TIME_MS: 200,\n  };\n\n  protected canvas = document.createElement('canvas');\n\n  protected tireBack = document.createElement('img');\n\n  private btnSelect$ = document.createElement('button');\n\n  private btnRm$ = document.createElement('button');\n\n  private _spanCarName = document.createElement('span');\n\n  private btnStart$ = document.createElement('button');\n\n  private btnReset$ = document.createElement('button');\n\n  private currAnimation: Animation | undefined;\n\n  private currOutOfSceneAnim: Animation | undefined;\n\n  private isReseted = true;\n\n  private observer: MutationObserver;\n\n  private movingClassName = garageStyles['synthwave-background_race-mode'];\n\n  constructor(private _currCar: RegCarData, public index?: number) {\n    super('div');\n\n    this._rootElement.classList.add(styles['car-div']);\n    this.canvas.classList.add(styles['car-div__canvas']);\n    this._rootElement.append(this.canvas);\n\n    const selectSpan = document.createElement('span');\n    const rmSpan = document.createElement('span');\n    const startSpan = document.createElement('span');\n    const resetSpan = document.createElement('span');\n\n    selectSpan.textContent = 'select';\n    rmSpan.textContent = 'remove';\n    startSpan.textContent = 'start!';\n    resetSpan.textContent = 'reset';\n\n    this.btnSelect$.append(selectSpan);\n    this.btnRm$.append(rmSpan);\n    this.btnReset$.append(resetSpan);\n    this.btnStart$.append(startSpan);\n\n    this.btnReset$.disabled = true;\n\n    CarComp.drawCar(this.canvas, this._currCar.color);\n    this._spanCarName.textContent = `${index}: ${_currCar.name}`;\n    CarComp.drawWheels(this._rootElement);\n\n    this.observer = new MutationObserver(mutations => {\n      mutations.forEach(mutation => {\n        if (mutation.oldValue?.includes(this.movingClassName)) {\n          this.currOutOfSceneAnim?.pause();\n          this.observer.disconnect();\n        } else {\n          const elem = mutation.target as HTMLElement;\n          if (elem.classList.contains(this.movingClassName)) {\n            this.outOfScene();\n          }\n        }\n      });\n    });\n  }\n\n  static drawWheels(rootElem: HTMLElement) {\n    const wheelImg = new Image();\n    wheelImg.src = CarComp.CAR_WHEEL_IMG_SRC;\n    wheelImg.onload = () => {\n      wheelImg.classList.add(styles['car-div__wheel']);\n      const backwardWheelImg = OBJ_PROCESSOR.deepClone(wheelImg);\n      wheelImg.classList.add(styles['car-div__wheel_forward']);\n      backwardWheelImg.classList.add(styles['car-div__wheel_backward']);\n\n      rootElem.append(wheelImg);\n      rootElem.append(backwardWheelImg);\n    };\n  }\n\n  updateData(carData: RegCarData) {\n    this._currCar = carData;\n    CarComp.drawCar(this.canvas, this._currCar.color);\n    this._spanCarName.textContent = `${this.index}: ${carData.name}`;\n    // this._rootElement.style.setProperty('background-color', carData.color);\n  }\n\n  public toggleIgniteAnim(state: boolean) {\n    if (state) this._rootElement.classList.add(styles['car-div_ignite']);\n    else this._rootElement.classList.remove(styles['car-div_ignite']);\n  }\n\n  public async rollBack(finishPromise: Promise<unknown> = Promise.resolve()) {\n    return new Promise(res => {\n      const asyncFunc = async () => {\n        if (!this.isReseted) {\n          this.observer.disconnect();\n          this._rootElement.classList.remove(styles['car-div_borken']);\n          await this.playOutAnim();\n          if (this.currOutOfSceneAnim) {\n            this.currOutOfSceneAnim.cancel();\n            // await this.currOutOfSceneAnim.finished;\n            this.clearAnimFromElem(this.currOutOfSceneAnim);\n            this.currOutOfSceneAnim = undefined;\n          }\n          if (this.currAnimation) {\n            await this.stop();\n            this.currAnimation.playbackRate = -10;\n            this.currAnimation.play();\n            console.log(`wait curr anim ${this.index}`);\n            await this.currAnimation.finished;\n            this.clearAnimFromElem(this.currAnimation);\n            this.currAnimation = undefined;\n            this._rootElement.classList.remove(styles['car-div_rollForward']);\n          }\n          this._rootElement.style.removeProperty('transition');\n          this._rootElement.style.removeProperty('transform');\n          await this.playInAnim();\n          this._rootElement.style.removeProperty('opacity');\n          finishPromise.finally(() => {\n            this.btnStart$.disabled = false;\n            this.btnReset$.disabled = true;\n            this.btnRm$.disabled = false;\n            this.btnSelect$.disabled = false;\n          });\n        }\n        console.log(`reseted ${this.index}`);\n        this.isReseted = true;\n        res(true);\n      };\n      asyncFunc();\n    });\n  }\n\n  async playOutAnim() {\n    if (document.body.classList.contains(sharedStyles['no-glitch'])) return;\n    const animOut = this._rootElement.animate(\n      [\n        { opacity: `0.5` },\n        { opacity: `0.9` },\n        { opacity: `0.3` },\n        { opacity: `0.7` },\n        { opacity: `0.1` },\n        { opacity: `0.4` },\n        { opacity: `0` },\n      ],\n      {\n        duration: 300,\n        easing: 'linear',\n        fill: 'forwards',\n      },\n    );\n    await animOut.finished;\n    this.clearAnimFromElem(animOut);\n  }\n\n  async playAwaitingAnim(promiseToAwait: Promise<unknown>) {\n    return new Promise<void>(res => {\n      let animIn: Animation | undefined;\n      if (!document.body.classList.contains(sharedStyles['no-glitch'])) {\n        animIn = this._rootElement.animate(\n          [\n            { opacity: `0` },\n            { opacity: `0.6` },\n            { opacity: `0.3` },\n            { opacity: `0.8` },\n            { opacity: `0.3` },\n            { opacity: `0.6` },\n            { opacity: `0` },\n          ],\n          {\n            duration: 400,\n            easing: 'linear',\n            fill: 'forwards',\n            iterations: Number.POSITIVE_INFINITY,\n          },\n        );\n      }\n      promiseToAwait.finally(() => {\n        if (animIn) {\n          animIn.cancel();\n          this.clearAnimFromElem(animIn);\n        }\n        res();\n      });\n    });\n  }\n\n  async playFirstIntroAnim(timeInMS = 500) {\n    const animIn = this._rootElement.animate(\n      [\n        { opacity: `0`, filter: 'blur(30px)' },\n        { opacity: `1`, filter: 'none' },\n      ],\n      {\n        duration: timeInMS,\n        easing: 'ease-in-out',\n        fill: 'forwards',\n      },\n    );\n    await animIn.finished;\n    this.clearAnimFromElem(animIn);\n  }\n\n  async playInAnim(timeInMS = 300) {\n    if (document.body.classList.contains(sharedStyles['no-glitch'])) return;\n    const animIn = this._rootElement.animate(\n      [\n        { opacity: `0` },\n        { opacity: `0.6` },\n        { opacity: `0.3` },\n        { opacity: `0.8` },\n        { opacity: `0.5` },\n        { opacity: `1` },\n      ],\n      {\n        duration: timeInMS,\n        easing: 'linear',\n        fill: 'forwards',\n      },\n    );\n    await animIn.finished;\n    this.clearAnimFromElem(animIn);\n  }\n\n  private clearAnimFromElem = (a: Animation) => {\n    const anim = a as unknown as Record<string, unknown>;\n    if ('commitStyles' in anim && typeof anim.commitStyles === 'function')\n      anim.commitStyles();\n  };\n\n  private outOfScene() {\n    // console.log(`OUT OF SCENE ${this.index}`);\n    this.isReseted = false;\n    this.currOutOfSceneAnim = this._rootElement.animate(\n      [{ transform: `translateX(${-1000}%)` }],\n      {\n        duration: 3600,\n        easing: 'ease-in',\n        fill: 'forwards',\n      },\n    );\n  }\n\n  public disableCtls() {\n    this.btnStart$.disabled = true;\n    this.btnRm$.disabled = true;\n    this.btnSelect$.disabled = true;\n    this.btnReset$.disabled = true;\n  }\n\n  public async rollForward(time: number, handleBtns = true) {\n    this.isReseted = false;\n    // console.log(`anim time: ${time} ${this.index}`);\n    return new Promise<number | undefined>((res, rej) => {\n      const start = Date.now();\n      if (handleBtns) {\n        this.btnStart$.disabled = true;\n        this.btnRm$.disabled = true;\n        this.btnSelect$.disabled = true;\n        this.btnReset$.disabled = false;\n      }\n      const rootStyle = window.getComputedStyle(\n        this._rootElement.parentElement as HTMLElement,\n      );\n      const selfStyle = window.getComputedStyle(this.rootElement);\n\n      const rootWidth =\n        Number.parseFloat(rootStyle.width) -\n        Number.parseFloat(rootStyle.paddingLeft) -\n        Number.parseFloat(rootStyle.paddingRight);\n      const selfWidth = Number.parseFloat(selfStyle.width);\n\n      const coordinateInPercents = ((rootWidth - selfWidth) / selfWidth) * 100;\n\n      this._rootElement.classList.add(styles['car-div_rollForward']);\n\n      this.currAnimation = this._rootElement.animate(\n        [{ transform: `translateX(${coordinateInPercents}%)` }],\n        {\n          duration: time * 1000 + 1000,\n          easing: 'ease-in-out',\n          fill: 'forwards',\n        },\n      );\n\n      this.currAnimation.onfinish = (e: Event) => {\n        // console.log(`time from anim start: ${Date.now() - start}`);\n        // console.log('stop animation by roll forward finish');\n        // this._rootElement.classList.remove(styles['car-div_rollForward']);\n        // this.stop();\n        // console.log('TRUE', e);\n        res(this.currAnimation?.playbackRate);\n      };\n\n      this.currAnimation.oncancel = () => {\n        // console.log(`curr Anim cancel ${this.index}`);\n        this._rootElement.classList.remove(styles['car-div_rollForward']);\n        rej();\n      };\n    });\n  }\n\n  public async stop(\n    rollover = true,\n    broken = false,\n    flags?: Record<string, unknown>,\n  ) {\n    // console.log(`STOP, broken: ${broken}, ${this.index}`);\n    // this.rootElement.style.setProperty('transition', '');\n    if (rollover) {\n      await new Promise(res => {\n        if (this.currAnimation?.playState === 'running') {\n          // console.log(\n          //   this.currAnimation,\n          //   `awaiting for animation ${this.index}`,\n          // );\n          this.currAnimation.addEventListener('finish', () => res(true));\n          this.currAnimation.addEventListener('cancel', () => res(true));\n        } else res(true);\n      });\n    }\n    this._rootElement.classList.remove(styles['car-div_rollForward']);\n    this.currAnimation?.pause();\n    if (broken) {\n      if (flags) {\n        const roadElem = flags.roadElem as HTMLElement;\n        const roadIsMoving = roadElem.classList.contains(this.movingClassName);\n        if (roadIsMoving) this.outOfScene();\n        this.observer.observe(roadElem, {\n          attributes: true,\n          attributeOldValue: true,\n        });\n      }\n      console.log(`exp anim ${this.index}`);\n      const img = new Image();\n      let frameNumber = 0;\n      img.classList.add(styles['car-div__explosion']);\n      img.src = `${CarComp.CAR_EXPLOSION_IMG_DATA.BASE_URL}${frameNumber}${CarComp.CAR_EXPLOSION_IMG_DATA.EXTENSION}`;\n      img.onload = async () => {\n        this._rootElement.append(img);\n        await new Promise(res =>\n          setTimeout(res, CarComp.CAR_EXPLOSION_IMG_DATA.FRAME_TIME_MS),\n        );\n        frameNumber++;\n        if (frameNumber < CarComp.CAR_EXPLOSION_IMG_DATA.FRAMES_COUNT) {\n          img.src = `${CarComp.CAR_EXPLOSION_IMG_DATA.BASE_URL}${frameNumber}${CarComp.CAR_EXPLOSION_IMG_DATA.EXTENSION}`;\n        } else {\n          img.remove();\n        }\n      };\n      this._rootElement.classList.add(styles['car-div_borken']);\n    }\n  }\n\n  public get currCar(): RegCarData {\n    return this._currCar;\n  }\n\n  public get btnSelect() {\n    return this.btnSelect$;\n  }\n\n  public get btnRm() {\n    return this.btnRm$;\n  }\n\n  public get btnStart() {\n    return this.btnStart$;\n  }\n\n  public get btnReset() {\n    return this.btnReset$;\n  }\n\n  public get spanCarName() {\n    return this._spanCarName;\n  }\n\n  static drawCar(canvas: HTMLCanvasElement, hexColor: string) {\n    const img = new Image();\n    img.src = CarComp.CAR_BODY_IMG_SRC;\n    img.onload = () => {\n      canvas.height = img.height / 3;\n      canvas.width = img.width / 3;\n      const ctx = canvas.getContext('2d');\n\n      if (ctx) {\n        ctx.shadowColor = hexColor;\n        ctx.shadowBlur = 25;\n        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n      }\n\n      CarComp.paintCarBody(canvas, hexColor);\n    };\n  }\n\n  static paintCarBody(canvas: HTMLCanvasElement, hexColor: string) {\n    const imageData = canvas\n      .getContext('2d')\n      ?.getImageData(0, 0, canvas.width, canvas.height);\n    if (imageData) {\n      const rgb = hexToRgb(hexColor);\n      for (let j = 0; j < imageData.width; j++) {\n        for (let i = 0; i < imageData.height; i++) {\n          // index: red, green, blue, alpha, red, green, blue, alpha..etc.\n          const index = i * 4 * imageData.width + j * 4;\n          const red = imageData.data[index] as number;\n          const green = imageData.data[index + 1] as number;\n          const blue = imageData.data[index + 2] as number;\n          // const alpha = imageData.data[index + 3] as number;\n\n          const blueDiff = 2 * blue - red - green;\n          const blueDiffThreshold = 10;\n          const threshold = 70;\n          if (\n            red > threshold &&\n            green > threshold &&\n            blue > threshold &&\n            blueDiff < blueDiffThreshold\n          ) {\n            imageData.data[index] = (red / 255) * rgb.r;\n            imageData.data[index + 1] = (green / 255) * rgb.g;\n            imageData.data[index + 2] = (blue / 255) * rgb.b;\n            // imageData.data[index + 3] = 225; /// !!! TEST !!!\n          }\n        }\n      }\n      canvas\n        .getContext('2d')\n        ?.putImageData(imageData, 0, 0, 0, 0, canvas.width, canvas.height);\n    }\n  }\n\n  static genPreview(car: UnregCarData): HTMLElement {\n    const container = document.createElement('div');\n    const canvas = document.createElement('canvas');\n    canvas.classList.add(styles['car-div__canvas']);\n    container.append(canvas);\n    CarComp.drawWheels(container);\n    CarComp.drawCar(canvas, car.color);\n    return container;\n  }\n}\n","import { UnregCarData } from '../../../../../definitions/car-data.def';\nimport { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { REST_CLIENT_GARAGE } from '../../../../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionCreatedMsg } from '../../../dbus-msgs/by-topic/car-action/garage-car-created-msg.def';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\n\nexport class CreateCompController extends CreateUpdateCompControllerProto {\n  private txs = new Set<DBusTX>();\n\n  constructor(elements: CreateUpdateCompControllerReqElems) {\n    super(elements.inputText, elements.inputColor, elements.btn);\n\n    this.setupBtnCreate();\n  }\n\n  private setupBtnCreate() {\n    this.btn.addEventListener('click', () => {\n      if (!this.reportValidity()) return;\n      this.btn.disabled = true;\n      const unregCar: UnregCarData = {\n        name: this.inputText.value,\n        color: this.inputColor.value,\n      };\n      REST_CLIENT_GARAGE.createCar(unregCar)\n        .then(car => {\n          // TODO: Notify with DBus\n          const msg = new DBusMsgCarActionCreatedMsg(car);\n          this.txs.forEach(tx => {\n            tx.transmit({\n              msg,\n              prepMode: DBusTXPrepModes.clone,\n              waitMode: DBusTXWaitModes.nowait,\n            });\n          });\n        })\n        .finally(() => {\n          this.btn.disabled = false;\n        });\n    });\n  }\n\n  autoConnect(int: DBusInterface) {\n    const tx = int.getNewTX('send created car msgs');\n    this.txs.add(tx);\n  }\n}\n","import { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../../../../lib/services/dbus/defs/dbus-port.def';\n\nexport interface CreateUpdateCompControllerReqElems {\n  inputText: HTMLInputElement;\n  inputColor: HTMLInputElement;\n  btn: HTMLButtonElement;\n}\n\nexport abstract class CreateUpdateCompControllerProto implements DBusPort {\n  protected ctlsStateMap = new Map<HTMLElement, boolean>();\n\n  protected ctls = [this.inputText, this.inputColor, this.btn];\n\n  protected disabled = false;\n\n  constructor(\n    protected inputText: HTMLInputElement,\n    protected inputColor: HTMLInputElement,\n    protected btn: HTMLButtonElement,\n  ) {}\n\n  abstract autoConnect(int: DBusInterface): void | Promise<void>;\n\n  protected reportValidity() {\n    const { length } = this.inputText.value;\n    let valid = true;\n\n    if (length === 0) {\n      this.inputText.setCustomValidity('Please, enter a name');\n      valid = false;\n    }\n\n    if (length > 30) {\n      this.inputText.setCustomValidity('Name is too long!');\n      valid = false;\n    }\n\n    if (!valid) {\n      this.inputText.pattern = '';\n      this.inputText.reportValidity();\n      this.inputText.removeAttribute('pattern');\n      return false;\n    }\n\n    return true;\n  }\n\n  protected toogleCtlsDisabled(state: boolean) {\n    this.inputText.disabled = state;\n    this.inputColor.disabled = state;\n    this.btn.disabled = state;\n  }\n\n  protected pushCtlsState() {\n    this.ctls.forEach(ctl => {\n      this.ctlsStateMap.set(ctl, ctl.disabled);\n    });\n  }\n\n  protected popCtlsState() {\n    this.ctls.forEach(ctl => {\n      const state = this.ctlsStateMap.get(ctl);\n      if (state !== undefined) ctl.disabled = state;\n    });\n    this.ctlsStateMap.clear();\n  }\n\n  disable() {\n    if (this.disabled) return;\n    this.disabled = true;\n    this.pushCtlsState();\n    this.toogleCtlsDisabled(true);\n  }\n\n  enable() {\n    if (!this.disabled) return;\n    this.disabled = false;\n    this.popCtlsState();\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../../../lib/processors/obj-processor';\nimport { DBUS_COMMON_RESPONSES } from '../../../../../lib/services/dbus/defs/dbus-common-responses.def';\nimport { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../../../../lib/services/dbus/defs/dbus-port.def';\nimport { DBusRX } from '../../../../../lib/services/dbus/defs/dbus-rx/dbus-rx.def';\nimport { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { REST_CLIENT_GARAGE } from '../../../../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionRemovedMsg } from '../../../dbus-msgs/by-topic/car-action/garage-car-remove-msg.def';\nimport { DBusMsgCarActionSelectedMsg } from '../../../dbus-msgs/by-topic/car-action/garage-car-select-msg.def';\nimport { DBusMsgGaragePageIsChangedMsg } from '../../../dbus-msgs/by-topic/garage/garage-page-is-changed.def';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\n\nexport class UpdateCompController\n  extends CreateUpdateCompControllerProto\n  implements DBusPort\n{\n  private choosedCar: RegCarData | undefined;\n\n  private notifyCb: ((car: RegCarData) => unknown) | undefined;\n\n  constructor(elements: CreateUpdateCompControllerReqElems) {\n    super(elements.inputText, elements.inputColor, elements.btn);\n\n    this.setupBtnUpdate();\n  }\n\n  autoConnect(int: DBusInterface) {\n    const rxCarActions = int.getNewRX(\n      this.carActionsListener,\n      'listen car choosing',\n    );\n    int.plugRX(DBusTopics.CAR_ACTION, rxCarActions);\n\n    const rxGarage = int.getNewRX(\n      this.garageMsgsListener,\n      'listen garage paging',\n    );\n    int.plugRX(DBusTopics.GARAGE, rxGarage);\n  }\n\n  private garageMsgsListener = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgGaragePageIsChangedMsg) {\n      this.reset();\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private reset() {\n    this.notifyCb = undefined;\n    this.choosedCar = undefined;\n    this.inputText.value = '';\n    this.inputColor.value = '#000000';\n    this.toogleCtlsDisabled(true);\n  }\n\n  private carActionsListener = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgCarActionSelectedMsg) {\n      this.choosedCar = OBJ_PROCESSOR.deepClone(data.msg.car);\n      this.notifyCb = data.msg.notifyChanges;\n      this.inputColor.value = data.msg.car.color;\n      this.inputText.value = data.msg.car.name;\n      this.toogleCtlsDisabled(false);\n    }\n    if (\n      data.msg instanceof DBusMsgCarActionRemovedMsg &&\n      data.msg.car.id === this.choosedCar?.id\n    ) {\n      this.reset();\n    }\n\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private setupBtnUpdate() {\n    this.toogleCtlsDisabled(true);\n    this.btn.addEventListener('click', () => {\n      if (!this.reportValidity()) return;\n      this.toogleCtlsDisabled(true);\n      if (!this.choosedCar) return;\n      this.choosedCar.color = this.inputColor.value;\n      this.choosedCar.name = this.inputText.value;\n      REST_CLIENT_GARAGE.updateCar(this.choosedCar)\n        .then(car => {\n          if (this.notifyCb) this.notifyCb(car);\n        })\n        .finally(() => {\n          this.toogleCtlsDisabled(false);\n        });\n    });\n  }\n}\n","import { BaseComp } from '../../../../../lib/components/base-comp/base-comp';\nimport { DBUS_HUB_NAMES } from '../../../../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { CreateCompController } from './controller-create';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\nimport { UpdateCompController } from './controller-update';\n\nimport styles from './create-update.scss';\nimport sharedStyles from '../../../../../styles/styles.scss';\n\nexport class CreateUpdateComponent extends BaseComp implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.CREATE_UPDATE;\n\n  protected textInput = document.createElement('input');\n\n  protected colorInput = document.createElement('input');\n\n  protected btn = document.createElement('button');\n\n  protected controller: CreateUpdateCompControllerProto;\n\n  constructor(type: 'CREATE' | 'UPDATE', btnText: string) {\n    super('div');\n    this._rootElement.classList.add(styles.root);\n    this.textInput.type = 'text';\n    this.textInput.classList.add(styles['text-input']);\n    this.colorInput.type = 'color';\n    this.colorInput.classList.add(styles['color-input']);\n    this.btn.textContent = btnText;\n    this.btn.classList.add(sharedStyles.btn);\n    this._rootElement.append(this.textInput, this.colorInput, this.btn);\n\n    const elements: CreateUpdateCompControllerReqElems = {\n      inputText: this.textInput,\n      inputColor: this.colorInput,\n      btn: this.btn,\n    };\n\n    switch (type) {\n      case 'UPDATE':\n        this.controller = new UpdateCompController(elements);\n        this.btn.classList.add(sharedStyles['btn-13']);\n        break;\n      case 'CREATE':\n      default:\n        this.controller = new CreateCompController(elements);\n        this.btn.classList.add(sharedStyles['btn-13']); // TODO: maybe change?\n        break;\n    }\n  }\n\n  getController() {\n    return this.controller;\n  }\n\n  connect(int: DBusInterface) {\n    this.controller.autoConnect(int);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport class DBusMsgGenerateCarsMsg extends DBusMsg {\n  constructor(\n    readonly status: 'start' | 'end',\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GENERATE, rxIds, prefResponseRxIds);\n  }\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { CreateUpdateComponent } from './create-update/create-update';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from '../../../../lib/services/dbus/defs/dbus-hub-names.def';\nimport { DBusMsgRaceRequestMsg } from '../../dbus-msgs/by-topic/garage/garage-race-request-msg.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusMsgGarageResetReqMsg } from '../../dbus-msgs/by-topic/garage/garage-reset-req-msg.def';\n\nimport styles from './main-controls.scss';\nimport sharedStyles from '../../../../styles/styles.scss';\nimport { REST_CLIENT_GARAGE } from '../../../../services/rest-clients/client-garage/rest-client-garage';\nimport {\n  CAR_MODEL_LIST,\n  CAR_MODEL_LIST_KEYS,\n} from '../../../../definitions/car-random-data.def';\nimport {\n  genRandomHexColor,\n  getRandomInt,\n} from '../../../../lib/generators/generators';\nimport { UnregCarData } from '../../../../definitions/car-data.def';\nimport { DBusTXData } from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBUS_COMMON_RESPONSES } from '../../../../lib/services/dbus/defs/dbus-common-responses.def';\nimport { DBusMsgGarageRaceStatusMsg } from '../../dbus-msgs/by-topic/garage/garage-race-status-msg.def';\nimport { DBusTopics } from '../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTX } from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgGenerateCarsMsg } from './dbus-msgs/generate-cars-msg.def';\nimport { PopupStandaloneModalProgressComp } from '../../../../lib/components/popups/standalone/modal/progress/popup-progress';\nimport { DBusMsgGarageStatusMsg } from '../../dbus-msgs/by-topic/garage/garage-status-msg.def';\n\nexport class MainControlsComp extends BaseComp implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.MAIN_CONTROLS;\n\n  private txs = new Set<DBusTX>();\n\n  private createComponent = new CreateUpdateComponent('CREATE', 'create');\n\n  private updateComponent = new CreateUpdateComponent('UPDATE', 'update');\n\n  private btnRace = document.createElement('button');\n\n  private btnReset = document.createElement('button');\n\n  private btnGenerate = document.createElement('button');\n\n  private popup = new PopupStandaloneModalProgressComp();\n\n  constructor() {\n    super('div');\n    this._rootElement.classList.add(styles['main-controls']);\n\n    const btnsBlock = this.renderBtns();\n    this.btnRace.addEventListener('click', this.raceClickListener);\n    this.btnReset.addEventListener('click', this.resetClickListener);\n    this.btnGenerate.addEventListener('click', this.generateClickListener);\n\n    this.btnReset.disabled = true;\n    this.btnRace.disabled = true;\n\n    this._rootElement.append(\n      this.createComponent.rootElement,\n      this.updateComponent.rootElement,\n      btnsBlock,\n    );\n  }\n\n  private generateClickListener = async () => {\n    this.btnGenerate.disabled = true;\n    const msg = new DBusMsgGenerateCarsMsg('start');\n    const transmissions: Promise<unknown>[] = [];\n    this.txs.forEach(tx => {\n      const transmission = tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n      transmissions.push(transmission);\n    });\n    await Promise.allSettled(transmissions);\n    this.popup\n      .reset()\n      .setText('please wait while the entries are generated')\n      .show();\n    await this.generate(100, undefined, this.genCb);\n    this.popup.reset().hide();\n    const resolveMsg = new DBusMsgGenerateCarsMsg('end');\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg: resolveMsg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n    this.btnGenerate.disabled = false;\n  };\n\n  private genCb = (progress: number) => {\n    this.popup.setProgress(progress);\n  };\n\n  private raceClickListener = async () => {\n    this.btnRace.disabled = true;\n    this.btnGenerate.disabled = true;\n    const msg = new DBusMsgRaceRequestMsg();\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n    });\n  };\n\n  private resetClickListener = async () => {\n    this.btnReset.disabled = true;\n    this.btnGenerate.disabled = true;\n    const msg = new DBusMsgGarageResetReqMsg();\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n    });\n  };\n\n  private renderBtns(): HTMLElement {\n    // setip btns\n    const span = document.createElement('span');\n    span.textContent = 'race';\n    this.btnRace.append(span);\n    this.btnRace.classList.add(sharedStyles.btn, sharedStyles['btn-15']);\n    this.btnReset.textContent = 'reset';\n    this.btnReset.classList.add(sharedStyles.btn, sharedStyles['btn-9']);\n    this.btnGenerate.textContent = 'generate cars';\n    this.btnGenerate.classList.add(sharedStyles.btn, sharedStyles['btn-1']);\n\n    const btnBlock = document.createElement('div');\n    btnBlock.classList.add(styles['btn-block']);\n    btnBlock.append(this.btnRace, this.btnReset, this.btnGenerate);\n    return btnBlock;\n  }\n\n  private async generate(\n    total: number,\n    left?: number,\n    cb?: (progress: number) => unknown,\n  ): Promise<boolean> {\n    let genLeft = left || total;\n    const randomName = this.genRandomCarName();\n    const color = genRandomHexColor();\n    const unregCarData: UnregCarData = {\n      name: randomName,\n      color,\n    };\n    const car = await REST_CLIENT_GARAGE.createCar(unregCarData);\n    // const winner: WinnerCarData = {\n    //   id: car.id,\n    //   wins: getRandomArbitraryInt(1, 3),\n    //   time: Number.parseFloat((getRandomArbitraryInt(40, 50) / 3).toFixed(2)),\n    // };\n    // await REST_CLIENT_WINNERS.createWinner(winner);\n    genLeft--;\n\n    if (cb) {\n      const progress = (1 - genLeft / total) * 100;\n      cb(progress);\n    }\n\n    if (genLeft > 0) return this.generate(total, genLeft, cb);\n\n    return true;\n  }\n\n  private genRandomCarName = (): string => {\n    const manufacturerNumber = getRandomInt(CAR_MODEL_LIST_KEYS.length - 1);\n    const manufacturerName = CAR_MODEL_LIST_KEYS[\n      manufacturerNumber\n    ] as keyof typeof CAR_MODEL_LIST;\n    const models = CAR_MODEL_LIST[manufacturerName];\n    const modelNumber = getRandomInt(models.length - 1);\n    const modelName = models[modelNumber] as string;\n    return `${manufacturerName} ${modelName}`;\n  };\n\n  private rxFuncForRaceMsgs = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgGarageRaceStatusMsg) {\n      const { status } = data.msg;\n      switch (status) {\n        case 'READY_TO_GO':\n          this.btnRace.disabled = false;\n          this.btnReset.disabled = true;\n          this.btnGenerate.disabled = false;\n          this.createComponent.getController().enable();\n          this.updateComponent.getController().enable();\n          break;\n        case 'IN_PROCESS':\n          this.btnRace.disabled = true;\n          this.btnReset.disabled = false;\n          this.btnGenerate.disabled = true;\n          this.createComponent.getController().disable();\n          this.updateComponent.getController().disable();\n          break;\n        case 'NEED_RESET':\n          this.btnRace.disabled = true;\n          this.btnReset.disabled = false;\n          this.btnGenerate.disabled = false;\n          this.createComponent.getController().enable();\n          this.updateComponent.getController().enable();\n          break;\n        default:\n          break;\n      }\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private rxFuncForGarageMsgs = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgGarageStatusMsg) {\n      switch (data.msg.status) {\n        case 'car moves':\n          this.btnGenerate.disabled = true;\n          this.createComponent.getController().disable();\n          this.updateComponent.getController().disable();\n          break;\n        case 'all cars stopped':\n          this.btnGenerate.disabled = false;\n          this.createComponent.getController().enable();\n          this.updateComponent.getController().enable();\n          break;\n        case 'need reset':\n          this.btnReset.disabled = false;\n          break;\n        case 'reset is not needed':\n          this.btnReset.disabled = true;\n          break;\n        default:\n          break;\n      }\n    }\n  };\n\n  connect(int: DBusInterface) {\n    int.attachSubHub(this.createComponent, 'cu_create');\n    int.attachSubHub(this.updateComponent, 'cu_delete');\n\n    const rx = int.getNewRX(\n      this.rxFuncForRaceMsgs,\n      'toggle btns in main-ctls-block',\n    );\n    int.plugRX(DBusTopics.GARAGE, rx);\n\n    const rx2 = int.getNewRX(\n      this.rxFuncForGarageMsgs,\n      'toggle btns in main-ctls-block',\n    );\n    int.plugRX(DBusTopics.GARAGE, rx2);\n\n    const tx = int.getNewTX('start race | broadcast generate');\n    this.txs.add(tx);\n  }\n}\n","import { RegCarData } from '../../../../definitions/car-data.def';\nimport { BaseComp } from '../../../../lib/components/base-comp/base-comp';\n\nexport class GaragePopupWinner extends BaseComp {\n  private header = document.createElement('h3');\n\n  private textTime = document.createElement('span');\n\n  private textName = document.createElement('span');\n\n  private textId = document.createElement('span');\n\n  private textNumber = document.createElement('span');\n\n  constructor() {\n    super('div');\n    this.header.textContent = 'WE HAVE A WINNER!';\n    this._rootElement.append(\n      this.header,\n      this.textTime,\n      this.textName,\n      this.textId,\n      this.textNumber,\n    );\n  }\n\n  setData(car: RegCarData, timeStr: string, indexStr?: string) {\n    this.textTime.textContent = `Time: ${timeStr}s`;\n    this.textName.textContent = `Name of the car: \\n ${car.name}`;\n    this.textId.textContent = `ID of the car: ${car.id}`;\n    this.textNumber.textContent = indexStr\n      ? `Position on the track: ${indexStr}`\n      : ``;\n  }\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { CarComp } from '../car/car';\n\nimport styles from './track.scss';\n\nexport class TrackComp extends BaseComp {\n  private topBlock = document.createElement('div');\n\n  constructor() {\n    super('div');\n    this._rootElement.classList.add(styles.track);\n    this._rootElement.append();\n    this.topBlock.classList.add(styles['track__controls-block']);\n  }\n\n  illuminateSelf = (illuminate: boolean) => {\n    if (illuminate) this._rootElement.classList.add(styles.track_illuminated);\n    else this._rootElement.classList.remove(styles.track_illuminated);\n  };\n\n  placeCar(carComp: CarComp) {\n    if (this._rootElement.hasChildNodes()) {\n      this._rootElement.childNodes.forEach(child => child.remove());\n    }\n    this.topBlock.append(carComp.spanCarName);\n    this._rootElement.append(this.topBlock, carComp.rootElement);\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { DBus } from '../../lib/services/dbus/dbus';\nimport { DBUS_COMMON_RESPONSES } from '../../lib/services/dbus/defs/dbus-common-responses.def';\nimport {\n  DBusHubNamesList,\n  DBUS_HUB_NAMES,\n} from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBusMsgRouteIsChangedMsg } from '../../lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport { DBusMsgRoutingStatusMsg } from '../../lib/services/simple-router/dbus-msgs-defs/types/router-status-msg.def';\n\nimport styles from './header.scss';\nimport { NavItem } from './subcomps/nav-item/nav-item';\n\nexport class HeaderComponent extends BaseComp implements DBusHub {\n  private navContainer: HTMLElement;\n\n  private logo: HTMLElement;\n\n  protected anchors: HTMLAnchorElement[];\n\n  protected buses: DBus[] = [];\n\n  constructor(readonly hubName: DBusHubNamesList = DBUS_HUB_NAMES.HEADER) {\n    super('header');\n    this.rootElement.classList.add(styles.header);\n\n    // logo\n    this.logo = document.createElement('h1');\n    this.logo.classList.add(styles.header__logo);\n    const firstSpan = document.createElement('span');\n    firstSpan.textContent = 'async';\n    firstSpan.dataset.textContent = 'async';\n    const secondSpan = document.createElement('span');\n    secondSpan.textContent = 'race';\n    secondSpan.dataset.textContent = 'race';\n    this.logo.append(firstSpan, secondSpan);\n    this.rootElement.append(this.logo);\n\n    // nav\n    this.navContainer = document.createElement('nav');\n    this.navContainer.classList.add(styles['header-nav']);\n    this.rootElement.append(this.navContainer);\n\n    // ul\n    const ul = document.createElement('ul');\n    ul.classList.add(styles['header-nav__list']);\n    this.navContainer.append(ul);\n\n    // ul items\n    const classList = {\n      li: styles['header-nav__item'],\n      a: styles['header-nav__anchor'],\n      svg: styles['header-nav__svg'],\n      span: styles['header-nav__span'],\n    };\n\n    const garageNavItem = new NavItem('garage', '#garage', classList);\n    const winnersNavItem = new NavItem('winners', '#winners', classList);\n\n    const navItems = [garageNavItem, winnersNavItem];\n    this.anchors = navItems.map(item => item.anchor);\n\n    ul.append(...navItems.map(item => item.rootElement));\n  }\n\n  connect(int: DBusInterface) {\n    const illuminateRX = int.getNewRX(\n      this.illuminateNavItem,\n      'illuminate nav items',\n    );\n    int.plugRX(DBusTopics.ROUTING, illuminateRX);\n  }\n\n  private illuminateNavItem = async (data: DBusTXData) => {\n    const { msg } = data;\n    if (msg instanceof DBusMsgRouteIsChangedMsg) {\n      this.anchors.forEach(anchor => {\n        if (anchor.getAttribute('href') === msg.newRoute) {\n          anchor.classList.add(styles['header-nav__anchor_active']);\n        } else {\n          anchor.classList.remove(styles['header-nav__anchor_active']);\n        }\n      });\n    }\n    if (msg instanceof DBusMsgRoutingStatusMsg) {\n      if (msg.status === 'restrained')\n        this.navContainer.classList.add(styles['header-nav_not-active']);\n      else if (msg.status === 'free')\n        this.navContainer.classList.remove(styles['header-nav_not-active']);\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\n\nexport interface NavItemStyles {\n  li?: string;\n  a?: string;\n  svg?: string;\n  span?: string;\n}\n\nexport class NavItem extends BaseComp {\n  private _anchor: HTMLAnchorElement;\n\n  protected iconImage: HTMLImageElement | undefined;\n\n  protected span: HTMLSpanElement;\n\n  constructor(\n    text: string,\n    href: string,\n    styles?: NavItemStyles,\n    iconSrc?: string,\n  ) {\n    super('li');\n\n    if (styles?.li) this._rootElement.classList.add(styles.li);\n    this._anchor = document.createElement('a');\n    this._anchor.setAttribute('href', href);\n\n    if (styles?.a) this._anchor.classList.add(styles.a);\n\n    if (iconSrc) {\n      this.iconImage = document.createElement('img');\n      this.iconImage.src = iconSrc;\n\n      if (styles?.svg) this.iconImage.classList.add(styles.svg);\n      this._anchor.append(this.iconImage);\n    }\n    this.span = document.createElement('span');\n    this.span.textContent = text;\n    this.span.dataset.textContent = text;\n\n    if (styles?.span) this.span.classList.add(styles.span);\n    this._anchor.append(this.span);\n\n    this.rootElement.append(this._anchor);\n  }\n\n  get anchor(): HTMLAnchorElement {\n    return this._anchor;\n  }\n}\n","import { PopupStandaloneModalChoiceComp } from '../../../lib/components/popups/standalone/modal/choice/popup-choice';\n\nimport styles from './popup-choice-first-open.scss';\nimport sharedStyles from '../../../styles/styles.scss';\n\nexport type FirstOpenDesicions = 'disable glitch' | 'enable glitch';\n\nexport class PopupStandaloneModalChoiceFirstOpenComp extends PopupStandaloneModalChoiceComp {\n  static readonly TEXT_CONTENT_ENG = {\n    HEADER: 'Welcome to ASYNC RACE by no95typem',\n    TEXT: `Hey! Before starting,\n      I ask you to restart the server\n      because I cannot predict what was done with it before me!\n      In addition, the application seems to be overloaded with effects,\n      some of which can be dangerous for people with epilepsy.\n      So choose whether to disable them or not.\n      And please read the notes on the \"Winners\" page.`,\n  };\n\n  private TEXT_CONTENT =\n    PopupStandaloneModalChoiceFirstOpenComp.TEXT_CONTENT_ENG;\n\n  constructor() {\n    super();\n    this.body.classList.add(styles.body);\n    this.renderText();\n\n    const enableBtn = document.createElement('button');\n    const outerSpan = document.createElement('span');\n    const innerSpan = document.createElement('span');\n    innerSpan.textContent = 'enable glitch';\n    innerSpan.dataset.textContent = 'enable glitch';\n    outerSpan.append(innerSpan);\n    enableBtn.append(outerSpan);\n    innerSpan.classList.add(styles.glitch);\n    enableBtn.classList.add(styles['glitch-parent']);\n\n    const disableBtn = document.createElement('button');\n    const span = document.createElement('span');\n    span.textContent = 'disable glitch';\n    disableBtn.append(span);\n\n    this.btns.push(enableBtn, disableBtn);\n    this.mapBtnsAndChoices(\n      { btn: enableBtn, desicion: 'enable glitch' },\n      { btn: disableBtn, desicion: 'disable glitch' },\n    );\n\n    this.btns.forEach(btn => {\n      btn.classList.add(sharedStyles.btn, sharedStyles['btn-6'], styles.btn);\n    });\n\n    this.btnBlock.append(...this.btns);\n\n    this.btnBlock.classList.add(styles['btn-block']);\n  }\n\n  private renderText() {\n    this.header.textContent = this.TEXT_CONTENT.HEADER;\n    this.text.textContent = this.TEXT_CONTENT.TEXT;\n  }\n}\n","import { BtnClose } from '../../../lib/components/btn-close/btn-close';\nimport { PopupStandaloneModalComp } from '../../../lib/components/popups/standalone/modal/popup-standalone-modal';\n\nimport styles from './popup-notes.scss';\nimport sharedStyles from '../../../styles/styles.scss';\n\nexport class PopupStandaloneModalNotes extends PopupStandaloneModalComp {\n  static readonly TEXT_CONTENT_ENG = {\n    HEADER: `Dear visitor!`,\n    P1: `Please pay attention to the following points:`,\n    OL: {\n      LI1: `The server must be restarted before testing -\n      a previous FE that you may have tested before could,\n      for example, save colors in non-hex format,\n      create machines with incredibly long names,\n      leave engines enabled, etc.`,\n      LI2: `Unfortunately, the server works in such a way\n        that I have to take control of the machines\n        before the setTimeout happens on the server.\n        The fact is that the server turns off the engine in any case,\n        it does not look whether the engine was turned off manually earlier\n        and turned on again. As a result,\n        depending on your luck, you can run into different mistakes.`,\n      LI3: `The application has been tested in various scenarios in Chromium and Firefox.\n        You can even try shutting down the server after starting the race.\n        But if you suddenly find a bug, please write to me in discord (no95typem @ 9889).`,\n      LI4: `For a nicer look, turn on glitch if you can.`,\n      LI5: `I hope your hardware is not weak!\n        I have a little slowdown on chromium,\n        but on FF with webrender enabled, everything is fine!`,\n      LI6: `By the way, if we are talking about browsers,\n        please enable autoplay video permission (and reload the page)\n        if you have blocked this feature for pages (as I do).\n        The background on the garage page should be a playing video.`,\n      LI7: `For cross checkers - if you find flaws,\n        write at least in detail and do not do it anonymously, please!`,\n    },\n    CAPTION: `Thanks for reading!`,\n  };\n\n  protected TEXT_CONTENT = PopupStandaloneModalNotes.TEXT_CONTENT_ENG;\n\n  protected list = document.createElement('ol');\n\n  protected btnOk = document.createElement('button');\n\n  protected btnCloseContainer = document.createElement('div');\n\n  protected caption = document.createElement('p');\n\n  constructor() {\n    super();\n    this.header.textContent = this.TEXT_CONTENT.HEADER;\n\n    this.renderList();\n\n    this.renderCloseBtns();\n    this.setupCloseActions();\n\n    this.renderOtherThings();\n\n    this.body.classList.add(styles.body);\n    this.body.append(\n      this.list,\n      this.btnCloseContainer,\n      this.caption,\n      this.btnOk,\n    );\n  }\n\n  private renderCloseBtns() {\n    const btnCloseComp = new BtnClose();\n    this.btnCloseContainer.classList.add(styles['btn-close-container']);\n    btnCloseComp.rootElement.classList.add(styles['btn-close']);\n    this.btnCloseContainer.append(btnCloseComp.rootElement);\n\n    this.btnOk.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['btn-ok'],\n    );\n\n    const btnOkOuterSpan = document.createElement('span');\n    const btnOkInnerSpan = document.createElement('span');\n    btnOkInnerSpan.textContent = 'OK';\n    btnOkInnerSpan.dataset.textContent = 'OK';\n    btnOkInnerSpan.classList.add(styles['btn-ok__innerSpan']);\n    btnOkOuterSpan.append(btnOkInnerSpan);\n    this.btnOk.append(btnOkOuterSpan);\n  }\n\n  private renderList() {\n    const liTextsArray = Object.values(this.TEXT_CONTENT.OL);\n    const liArray = liTextsArray.map(text => {\n      const li = document.createElement('li');\n      const span = document.createElement('span');\n      span.textContent = text;\n      li.append(span);\n      return li;\n    });\n    this.list.append(...liArray);\n    this.list.classList.add(styles.ol);\n  }\n\n  private renderOtherThings() {\n    this.caption.textContent = this.TEXT_CONTENT.CAPTION;\n  }\n\n  private setupCloseActions() {\n    this.btnCloseContainer.addEventListener('click', () => this.closeSelf());\n    this.btnOk.addEventListener('click', () => this.closeSelf());\n    document.body.addEventListener('keydown', e => {\n      if (e.key === 'Escape') this.closeSelf();\n    });\n  }\n\n  show(rootElem?: HTMLElement) {\n    super.show(rootElem);\n    const anim = this._rootElement.animate(\n      [{ opacity: `0` }, { opacity: `1` }],\n      {\n        duration: 500,\n        easing: 'ease-in-out',\n        fill: 'forwards',\n      },\n    );\n    anim.oncancel = () => this.clearAnimFromElem(anim);\n    anim.onfinish = () => this.clearAnimFromElem(anim);\n    return this;\n  }\n\n  private async closeSelf() {\n    const anim = this._rootElement.animate(\n      [{ opacity: `1` }, { opacity: `0` }],\n      {\n        duration: 500,\n        easing: 'ease-in-out',\n        fill: 'forwards',\n      },\n    );\n    await anim.finished;\n    this._rootElement.remove();\n    this.clearAnimFromElem(anim);\n    this._rootElement.style.removeProperty('opacity');\n  }\n\n  private clearAnimFromElem = (a: Animation) => {\n    const anim = a as unknown as Record<string, unknown>;\n    if ('commitStyles' in anim && typeof anim.commitStyles === 'function')\n      anim.commitStyles();\n  };\n}\n","import { UnregCarData, WinnerCarData } from '../../../definitions/car-data.def';\nimport { BaseComp } from '../../../lib/components/base-comp/base-comp';\nimport { CarComp } from '../../garage/subcomps/car/car';\n\nexport class WinnerRowComp extends BaseComp {\n  private indexElem = document.createElement('td');\n\n  private idElem = document.createElement('td');\n\n  private carPreviewBox = document.createElement('td');\n\n  private nameElem = document.createElement('td');\n\n  private winsElem = document.createElement('td');\n\n  private bestTimeElem = document.createElement('td');\n\n  private carPreview: HTMLElement;\n\n  constructor(index: number, winnerData: WinnerCarData, carData: UnregCarData) {\n    super('tr');\n\n    this.indexElem.textContent = index.toString();\n    this.idElem.textContent = winnerData.id.toString();\n    this.carPreview = CarComp.genPreview(carData);\n    this.carPreviewBox.append(this.carPreview);\n    this.nameElem.textContent = carData.name;\n    this.winsElem.textContent = winnerData.wins.toString();\n    this.bestTimeElem.textContent = winnerData.time.toString();\n\n    this._rootElement.append(\n      this.indexElem,\n      this.idElem,\n      this.carPreviewBox,\n      this.nameElem,\n      this.winsElem,\n      this.bestTimeElem,\n    );\n  }\n\n  public getCarPreview() {\n    return this.carPreview;\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { REST_CLIENT_WINNERS } from '../../services/rest-clients/client-winners/rest-client-winners';\nimport {\n  RestClientWinnersSortOptionsList,\n  REST_CLIENT_WINNERS_SORT_OPTIONS,\n} from '../../services/rest-clients/client-winners/rest-client-winners.def';\nimport { WinnerRowComp } from './subcomps/winner-entry';\nimport { Pager } from '../../lib/services/pager/pager';\n\nimport styles from './winners.scss';\nimport sharedStyles from '../../styles/styles.scss';\nimport { Notifiable } from '../../lib/interfaces/notifiable';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport { DBusTX } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgAppCtlReconfureReqMsg } from '../../app/dbus-msgs/reconfigure-req.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { PopupStandaloneModalProgressComp } from '../../lib/components/popups/standalone/modal/progress/popup-progress';\nimport { PopupStandaloneModalNotes } from '../popups/popup-notes/popup-notes';\nimport { getRandomInt } from '../../lib/generators/generators';\n\ntype BGInfo = {\n  src: string;\n  styles: string;\n};\n\nexport class WinnersComp extends BaseComp implements DBusHub, Notifiable {\n  static readonly TEXT_CONTENT_ENG = {};\n\n  static readonly BG_SRCS: BGInfo[] = [\n    {\n      src: './assets/imgs/backgrounds/winners/alessandro-aramino-artboard-1.jpg',\n      styles: 'no-repeat left 50% top 0% / cover',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/lukasz-sprada-18.jpg',\n      styles: 'no-repeat right 0% top 0% / cover',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/charlotte-hughes-18.jpg',\n      styles: '',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/ward-lindhout-nomadgarage-conceptart.jpg',\n      styles: '',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/andrzej-bury-1-12.jpg',\n      styles: '',\n    },\n    {\n      src: './assets/imgs/backgrounds/winners/wiktoria-stachowska-ow-05.jpg',\n      styles: '',\n    },\n  ];\n\n  readonly hubName = DBUS_HUB_NAMES.WINNERS;\n\n  private table = document.createElement('table');\n\n  private tableBody = document.createElement('tbody');\n\n  private tableHead = document.createElement('thead');\n\n  private thId = document.createElement('th');\n\n  private thCar = document.createElement('th');\n\n  private thName = document.createElement('th');\n\n  private thWins = document.createElement('th');\n\n  private thBestTime = document.createElement('th');\n\n  private pager: Pager;\n\n  private pagerBtnsContainer = document.createElement('div');\n\n  private pagerSpan: HTMLSpanElement;\n\n  private currSortedElem: HTMLElement | undefined;\n\n  private currOrder: 'ASC' | 'DESC' = 'ASC';\n\n  private currSort: RestClientWinnersSortOptionsList = 'time';\n\n  private entriesPerPage = 10;\n\n  protected txs = new Set<DBusTX>();\n\n  protected bottomBtnsContainer = document.createElement('div');\n\n  protected btnReconfigureGlitch = document.createElement('button');\n\n  protected btnNotes = document.createElement('button');\n\n  protected btnCredits = document.createElement('button');\n\n  protected popupNotes = new PopupStandaloneModalNotes();\n\n  protected currBGInfo: BGInfo | undefined;\n\n  constructor() {\n    super('section');\n\n    this.pager = new Pager(this.entriesPerPage, this.pagerCallback);\n    this.pagerSpan = this.pager.getPagerSpan();\n\n    this.asyncLoading();\n  }\n\n  private async asyncLoading() {\n    await this.loadBg();\n\n    this.renderPager();\n\n    this.renderTable();\n\n    this.renderBottomBtnsContainer();\n\n    this.setupBottomBtnsActions();\n\n    // const popupNotes = new PopupStandaloneModalNotes(); // !\n    // this.rootElement.append(popupNotes.rootElement); // !\n\n    this._rootElement.classList.add(styles.winners);\n    this._rootElement.append(this.table, this.bottomBtnsContainer);\n  }\n\n  static getRandomBGInfo(currBGInfo?: BGInfo): BGInfo {\n    const randomIndex = getRandomInt(WinnersComp.BG_SRCS.length);\n    const bgInfo = WinnersComp.BG_SRCS[randomIndex] as BGInfo;\n\n    if (currBGInfo === bgInfo) return this.getRandomBGInfo(currBGInfo);\n\n    return bgInfo;\n  }\n\n  loadBg() {\n    return new Promise<boolean>(res => {\n      const bgInfo = WinnersComp.getRandomBGInfo(this.currBGInfo);\n      this.currBGInfo = bgInfo;\n      const { src } = bgInfo;\n\n      this.rootElement.style.setProperty(\n        'background',\n        `url('${src}') ${bgInfo.styles}`,\n      );\n\n      const popup = new PopupStandaloneModalProgressComp();\n      popup.setText('Loading').setProgress(1).show();\n\n      const resolve = () => {\n        popup.setProgress(100).hide();\n        res(true);\n      };\n\n      fetch(src)\n        .then(async response => {\n          const length = response.headers.get('content-length');\n\n          if (!length) {\n            resolve();\n            return;\n          }\n          const total = Number.parseInt(length, 10);\n\n          const imgRead = new Response(\n            new ReadableStream({\n              async start(controller) {\n                if (!response.body) {\n                  resolve();\n                  return;\n                }\n                const reader = response.body.getReader();\n                let done = false;\n                let loadedBytes = 0;\n\n                do {\n                  const read = await reader.read();\n                  done = read.done;\n\n                  const val = read.value;\n\n                  if (val) {\n                    loadedBytes += val.byteLength;\n                    popup.setProgress((loadedBytes / total) * 100);\n                    controller.enqueue(val);\n                  }\n                } while (!done);\n\n                controller.close();\n              },\n            }),\n          );\n\n          await imgRead.blob();\n          resolve();\n        })\n        .catch(() => res(false));\n    });\n  }\n\n  private setupBottomBtnsActions() {\n    this.btnNotes.addEventListener('click', () => this.popupNotes.show());\n    // this.btnCredits\n    this.btnReconfigureGlitch.addEventListener('click', () => {\n      const msg = new DBusMsgAppCtlReconfureReqMsg();\n      this.txs.forEach(tx => {\n        tx.transmit({\n          msg,\n          prepMode: DBusTXPrepModes.freeze,\n          waitMode: DBusTXWaitModes.nowait,\n        });\n      });\n    });\n  }\n\n  private renderBottomBtnsContainer() {\n    const btnReconfigureGlitchObj = this.createBtnWithTwoSpans(\n      this.btnReconfigureGlitch,\n      'reconfigure glitch',\n    );\n    const btnNotesObj = this.createBtnWithTwoSpans(this.btnNotes, 'notes');\n    const btnCreditsObj = this.createBtnWithTwoSpans(\n      this.btnCredits,\n      'credits',\n    );\n\n    [btnNotesObj, btnCreditsObj, btnReconfigureGlitchObj].forEach(obj => {\n      obj.btn.classList.add(\n        sharedStyles.btn,\n        sharedStyles['btn-6'],\n        styles['btn-glitch'],\n      );\n      obj.btnInnerSpan.classList.add(styles['btn-glitch__innerSpan']);\n    });\n\n    this.bottomBtnsContainer.classList.add(styles['bottom-btns-container']);\n    this.bottomBtnsContainer.append(\n      this.btnNotes,\n      this.btnCredits,\n      this.btnReconfigureGlitch,\n    );\n  }\n\n  private createBtnWithTwoSpans = (btn: HTMLElement, textContent: string) => {\n    const btnOuterSpan = document.createElement('span');\n    const btnInnerSpan = document.createElement('span');\n    btnInnerSpan.textContent = textContent;\n    btnInnerSpan.dataset.textContent = textContent;\n    btnOuterSpan.append(btnInnerSpan);\n    btn.append(btnOuterSpan);\n    return {\n      btn,\n      btnOuterSpan,\n      btnInnerSpan,\n    };\n  };\n\n  private renderTable() {\n    this.renderTableHeader();\n    this.table.classList.add(styles.table);\n    this.table.append(\n      this.tableHead,\n      this.tableBody,\n      this.pagerBtnsContainer,\n      this.pagerSpan,\n    );\n  }\n\n  private renderTableHeader() {\n    const tr = document.createElement('tr');\n\n    const thIndex = document.createElement('th');\n    thIndex.textContent = '№';\n    this.thId.textContent = 'ID';\n    this.thId.classList.add(styles['table__can-be-sorted']);\n    this.thCar.textContent = 'CAR';\n    this.thName.textContent = 'NAME';\n    this.thWins.textContent = 'WINS';\n    this.thWins.classList.add(styles['table__can-be-sorted']);\n    this.thBestTime.textContent = 'BEST TIME';\n    this.thBestTime.classList.add(styles['table__can-be-sorted']);\n\n    tr.append(\n      thIndex,\n      this.thId,\n      this.thCar,\n      this.thName,\n      this.thWins,\n      this.thBestTime,\n    );\n    this.tableHead.append(tr);\n    this.tableHead.addEventListener('click', this.tableHeadClickListener);\n  }\n\n  private renderPager() {\n    const btnPrevPage = this.pager.getBtnPrevPage();\n\n    btnPrevPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['pager-btn'],\n    );\n\n    const btnNextPage = this.pager.getBtnNextPage();\n\n    btnNextPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['pager-btn'],\n    );\n\n    this.pagerBtnsContainer.classList.add(styles.pager);\n    this.pagerBtnsContainer.append(btnPrevPage, btnNextPage);\n\n    this.pagerSpan.classList.add(styles['pager-span']);\n  }\n\n  async notify(): Promise<void> {\n    this.reloadData().then(() =>\n      this.refreshTableHeader(this.currSortedElem || this.thBestTime),\n    );\n    await this.loadBg();\n  }\n\n  private pagerCallback = async (dir: 'prev' | 'next'): Promise<boolean> => {\n    try {\n      await this.reloadData(dir);\n      return true;\n    } catch {\n      return false;\n    }\n  };\n\n  private async reloadData(dir?: 'prev' | 'next'): Promise<void> {\n    return new Promise((res, rej) => {\n      const page = dir\n        ? dir === 'next'\n          ? this.pager.getCurrPageNumber() + 1\n          : this.pager.getCurrPageNumber() - 1\n        : this.pager.getCurrPageNumber();\n\n      REST_CLIENT_WINNERS.getWinners(\n        page,\n        this.entriesPerPage,\n        this.currSort,\n        this.currOrder,\n      ).then(async response => {\n        this.pager.setEntriesCount(Number.parseInt(response.limit, 10));\n        if (response.cars.length === 0) {\n          if (dir) {\n            rej();\n            return;\n          }\n\n          if (page > 1) {\n            await this.pager.tryChangePage('prev');\n            res();\n            return;\n          }\n        }\n        const rows = new Array<WinnerRowComp>(response.cars.length);\n        const promises: Promise<unknown>[] = [];\n        const indexInc = (page - 1) * 10;\n        response.cars.forEach((winner, index) => {\n          const promise = REST_CLIENT_GARAGE.getCar(winner.id).then(car => {\n            const totalIndex = index + indexInc + 1;\n            const row = new WinnerRowComp(totalIndex, winner, car);\n            rows[index] = row;\n          });\n          promises.push(promise);\n        });\n        await Promise.allSettled(promises);\n        while (this.tableBody.firstChild) this.tableBody.firstChild.remove();\n        this.tableBody.append(\n          ...rows.map(row => {\n            row.getCarPreview().classList.add(styles['table__car-preview-box']);\n            return row.rootElement;\n          }),\n        );\n        res();\n      });\n    });\n  }\n\n  private tableHeadClickListener = async (e: Event) => {\n    let sort: RestClientWinnersSortOptionsList | undefined;\n    switch (e.target) {\n      case this.thId:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.id;\n        break;\n      case this.thWins:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.wins;\n        break;\n      case this.thBestTime:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.time;\n        break;\n      default:\n        break;\n    }\n    if (sort) {\n      this.pager.toogleLock(true);\n      const elem = e.target as HTMLElement;\n      this.currOrder = elem.classList.contains(\n        styles['table__sorted-elem_desc'],\n      )\n        ? 'ASC'\n        : 'DESC';\n      this.currSort = sort;\n      await this.reloadData();\n      this.refreshTableHeader(elem);\n      this.pager.toogleLock(false);\n    }\n  };\n\n  private refreshTableHeader = (elem: HTMLElement) => {\n    if (this.currSortedElem)\n      this.currSortedElem.classList.remove(styles['table__sorted-elem']);\n\n    elem.classList.add(styles['table__sorted-elem']);\n    this.currSortedElem = elem;\n\n    if (this.currOrder === 'ASC') {\n      elem.classList.remove(styles['table__sorted-elem_desc']);\n      elem.classList.add(styles['table__sorted-elem_asc']);\n    } else {\n      elem.classList.remove(styles['table__sorted-elem_asc']);\n      elem.classList.add(styles['table__sorted-elem_desc']);\n    }\n  };\n\n  connect(int: DBusInterface) {\n    const tx = int.getNewTX('winners tx');\n    this.txs.add(tx);\n  }\n}\n","import { OBJ_PROCESSOR } from '../lib/processors/obj-processor';\n\nconst models = {\n  Lamborghini: [\n    'Murciélago',\n    '350 GT',\n    '400 GT',\n    'Sián FKP 37',\n    'Essenza SCV12',\n    'Urus',\n    'Centenario',\n    'Huracán',\n    'Veneno',\n    'Sesto Elementо',\n    'Aventador',\n    'Reventón',\n    'Gallardo',\n    'Diablo',\n    'LM002',\n    'Jalpa',\n    'Silhouette',\n    'Countach',\n    'Urraco',\n    'Jarama',\n    'Islero',\n    'Espada',\n    'Miura',\n  ],\n  'Aston Martin': [\n    'Project 003',\n    'Valkyrie',\n    'DBS',\n    'Vanquish Zagato',\n    'Vanquish',\n    'Virage/Virage Volante',\n    'V12 Zagato',\n    'One-77',\n    'V8 Coupe/V8 Volante',\n    'V8 Zagato',\n  ],\n  Ferrari: [\n    'Roma',\n    'Portfolio',\n    '488 GTB',\n    'California T',\n    '360 Spider',\n    '355 F1 Berlinetta',\n    'F355 GTS',\n    '456 GT',\n    'Testarossa',\n    'SF1000',\n  ],\n  Koenigsegg: [\n    'Jesko Absolut',\n    'Jesko',\n    'Agera Final',\n    'Agera XS',\n    'Agera X',\n    'Agera S',\n    'Regera',\n    'Agera RS',\n    'One:1',\n    'CCGT',\n  ],\n  Porsche: [\n    '918 Spyder',\n    'Boxster 982',\n    'Macan',\n    'Taycan',\n    'Panamera',\n    'Carrera GT',\n    'Cayenne',\n    '968',\n    '928',\n    '919 Hybrid',\n  ],\n  Jaguar: [\n    'F-Type',\n    'Jaguar XKR X100',\n    'Jaguar XKR X150',\n    'R5',\n    'R4',\n    'R3',\n    'R2',\n    'R1',\n    'F-Pace',\n    'E-Pace',\n  ],\n  Maserati: [\n    'Kyalami',\n    'Khamsin',\n    'Indy',\n    'Mexico',\n    'Merak',\n    'MC12',\n    'Spyder',\n    'Gransport',\n    '4300 GT Coupe',\n    '3200 GT',\n  ],\n  'Mercedes-Benz': [\n    'AMG GT',\n    'SLS AMG',\n    'SLR-McLaren',\n    'R170',\n    'R171',\n    'W220',\n    'W221',\n    'W222',\n    'W223',\n    'W163',\n  ],\n  McLaren: [\n    'Artura',\n    'Elva',\n    'Speedtail',\n    'GT',\n    'Senna',\n    '720S',\n    '570S',\n    '675LT',\n    '650S',\n    'P1',\n  ],\n  Spyker: [\n    'C8 Laviolette',\n    'C8 Spyder',\n    'C8 Spyder T (Turbo)',\n    'Spyker C8 Double 12 S',\n    'Spyker C8 Aileron',\n    'C12',\n    'B6 Venator',\n    'C12 Zagato',\n    'D12 Peking-to-Paris',\n    'C12 La Turbie',\n  ],\n};\n\nconst CAR_MODEL_LIST = OBJ_PROCESSOR.deepFreeze(models);\n\nexport { CAR_MODEL_LIST };\n\nconst CAR_MODEL_LIST_KEYS = OBJ_PROCESSOR.deepFreeze(\n  Object.keys(CAR_MODEL_LIST),\n);\n\nexport { CAR_MODEL_LIST_KEYS };\n","export class BaseComp {\n  protected _rootElement: HTMLElement;\n\n  constructor(tag: keyof HTMLElementTagNameMap = 'div') {\n    this._rootElement = document.createElement(tag);\n  }\n\n  public get rootElement(): HTMLElement {\n    return this._rootElement;\n  }\n}\n","import { BaseComp } from '../base-comp/base-comp';\nimport svg from './btn-close.svg';\n\nexport class BtnClose extends BaseComp {\n  constructor() {\n    super('div');\n    const image = new Image();\n    image.src = svg;\n    this._rootElement.append(image);\n  }\n}\n","import { PopupStandaloneModalComp } from '../popup-standalone-modal';\n\nimport sharedStyles from '../../../../../../styles/styles.scss';\n\nexport class PopupStandaloneModal404Comp extends PopupStandaloneModalComp {\n  constructor() {\n    super();\n    this.header.textContent = 'ERROR: 404';\n    this.header.dataset.textContent = this.header.textContent;\n    this.header.classList.add(sharedStyles['glitched-text']);\n    this.text.classList.add(sharedStyles['glitched-text']);\n  }\n}\n","import { PopupStandaloneModalComp } from '../popup-standalone-modal';\n\nexport type PopupChoiceCtl = {\n  btn: HTMLButtonElement;\n  desicion: string;\n};\n\nexport class PopupStandaloneModalChoiceComp extends PopupStandaloneModalComp {\n  protected btnBlock = document.createElement('div');\n\n  protected resolveFunc:\n    | ((value: string | PromiseLike<string>) => void)\n    | undefined;\n\n  protected choicePromise: Promise<string>;\n\n  protected btns: HTMLButtonElement[] = [];\n\n  constructor() {\n    super();\n    this.choicePromise = new Promise<string>(res => {\n      this.resolveFunc = res;\n    });\n    this.body.append(this.btnBlock);\n  }\n\n  recharge() {\n    this.choicePromise = new Promise<string>(res => {\n      this.resolveFunc = res;\n    });\n    return this;\n  }\n\n  async awaitDesicion() {\n    return this.choicePromise;\n  }\n\n  mapBtnsAndChoices(...ctls: PopupChoiceCtl[]) {\n    ctls.forEach(control => {\n      control.btn.addEventListener('click', () =>\n        this.resolveFunc?.(control.desicion),\n      );\n    });\n  }\n}\n","import { PopupStandaloneComp } from '../popup-standalone';\n\nimport styles from './popup-standalone-modal.scss';\n\nexport abstract class PopupStandaloneModalComp extends PopupStandaloneComp {\n  constructor() {\n    super();\n    this._rootElement.classList.add(styles['popup-modal']);\n    const closeArea = document.createElement('div');\n    closeArea.classList.add(styles['popup-bg']);\n    this._rootElement.append(closeArea);\n    this.body.classList.add(styles['popup-body']);\n    closeArea.append(this.body);\n    this.header.classList.add(styles['popup-body-header']);\n    this.text.classList.add(styles['popup-body-text']);\n  }\n\n  setHeader(text: string): PopupStandaloneModalComp {\n    this.header.textContent = text;\n    this.header.dataset.textContent = text;\n    return this;\n  }\n\n  setText(text: string): PopupStandaloneModalComp {\n    this.text.textContent = text;\n    this.text.dataset.textContent = text;\n    return this;\n  }\n\n  show(rootElem?: HTMLElement): PopupStandaloneModalComp {\n    const root = rootElem || document.body;\n    root.append(this._rootElement);\n    return this;\n  }\n\n  hide(): PopupStandaloneModalComp {\n    this._rootElement.remove();\n    return this;\n  }\n}\n","import { PopupStandaloneModalComp } from '../popup-standalone-modal';\n\nimport styles from './popup-progress.scss';\nimport sharedStyles from '../../../../../../styles/styles.scss';\n\nexport class PopupStandaloneModalProgressComp extends PopupStandaloneModalComp {\n  private barContainer = document.createElement('div');\n\n  private bar = document.createElement('div');\n\n  constructor() {\n    super();\n    this.barContainer.classList.add(styles.container);\n    this.bar.classList.add(styles.bar);\n    this.barContainer.append(this.bar);\n    this.text.classList.add(styles.text, sharedStyles['glitched-text']);\n    this.body.classList.add(styles.body);\n    this.body.append(this.barContainer);\n  }\n\n  setHeader(text: string): PopupStandaloneModalProgressComp {\n    super.setHeader(text);\n    return this;\n  }\n\n  setText(text: string): PopupStandaloneModalProgressComp {\n    super.setText(text);\n    return this;\n  }\n\n  reset(): PopupStandaloneModalProgressComp {\n    this.bar.style.removeProperty('--progress');\n    this.text.textContent = '';\n    this.text.dataset.textContent = '';\n    return this;\n  }\n\n  setProgress(progress: number): PopupStandaloneModalProgressComp {\n    this.bar.style.setProperty('--progress', `${progress}%`);\n    return this;\n  }\n}\n","import { BaseComp } from '../../base-comp/base-comp';\n\nexport interface BasePopupAttrs {\n  configurable: boolean;\n}\n\nexport abstract class PopupStandaloneComp extends BaseComp {\n  protected body: HTMLElement;\n\n  protected header: HTMLHeadingElement;\n\n  protected text: HTMLParagraphElement;\n\n  constructor() {\n    super('div');\n\n    this.body = document.createElement('div');\n    this.header = document.createElement('h3');\n    this.text = document.createElement('p');\n\n    this.body.append(this.header, this.text);\n    this._rootElement.append(this.body);\n  }\n}\n","export function hexToRgb(hex: string): { r: number; g: number; b: number } {\n  let c: string[];\n  if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\n    // c = hex.substring(1).split('');\n    c = hex.split('');\n    if (c.length === 4) {\n      c = [c[1], c[1], c[2], c[2], c[3], c[3]] as string[];\n    }\n    const r = Number.parseInt(hex.slice(1, 3), 16);\n    const g = Number.parseInt(hex.slice(3, 5), 16);\n    const b = Number.parseInt(hex.slice(5, 7), 16);\n    // return `rgb(${r}, ${g}, ${b})`;\n    return { r, g, b };\n  }\n  throw new Error('Bad Hex');\n}\n","export function genUniqId(): string {\n  const arr = new Uint8Array(4);\n  return window.crypto.getRandomValues(arr).join('');\n}\n\nexport function getRandomInt(max: number): number {\n  return Math.floor(Math.random() * max);\n}\n\nexport function getRandomArbitraryInt(min: number, max: number): number {\n  return Math.floor(Math.random() * (max - min) + min);\n}\n\nexport function genRandomHexColor(): string {\n  const color = `#${Math.floor(Math.random() * 16_777_215).toString(16)}`;\n  if (color.length === 7) return color;\n  return genRandomHexColor();\n}\n","export interface TransitionPromiseInterface {\n  elem: HTMLElement;\n  prop: string;\n  val?: string;\n  valToWait?: string;\n  forceAutoresolveIn?: number;\n}\n\nexport function getTransitionDuration(\n  style: CSSStyleDeclaration,\n  prop: string,\n) {\n  const transPropArr = style\n    .getPropertyValue('transition-property')\n    .replace(',', '')\n    .split(' ');\n  let propIndex = transPropArr.lastIndexOf(prop);\n\n  if (propIndex === -1) propIndex = transPropArr.lastIndexOf('all');\n\n  if (propIndex !== -1) {\n    const transDurationsArr = style\n      .getPropertyValue('transition-duration')\n      .replace(',', '')\n      .split(' ');\n    return transDurationsArr[propIndex];\n  }\n\n  return undefined;\n}\n\nexport function transitionPromise(\n  params: TransitionPromiseInterface,\n): Promise<boolean> {\n  return new Promise(resolve => {\n    const transformAndAutoresolve = (delay?: number): void => {\n      if (params.val) params.elem.style.setProperty(params.prop, params.val);\n      const time = delay || 20;\n      setTimeout(() => {\n        resolve(true);\n        // doesn't work - for cause look forward\n        // window.getComputedStyle(elem)[prop] == val ? resolve(true) : resolve(false);\n      }, time);\n    };\n\n    const transformAndWaitEvent = () => {\n      const eventHandler = (e: TransitionEvent): void => {\n        if (e.target !== params.elem) return;\n\n        if (e.propertyName !== params.prop) return;\n\n        if (\n          params.valToWait &&\n          window.getComputedStyle(params.elem).getPropertyValue(params.prop) !==\n            params.valToWait\n        ) {\n          return;\n        }\n\n        params.elem.removeEventListener('transitionend', eventHandler);\n        params.elem.removeEventListener('transitionend', eventHandler);\n\n        // val should be equal to style ! For example translate != matrix...\n        // if(val) window.getComputedStyle(elem)[prop] == val ? resolve(true) : reject(false);\n        // else\n        resolve(true);\n      };\n\n      params.elem.addEventListener('transitionend', eventHandler);\n      params.elem.addEventListener('transitioncancel', eventHandler);\n\n      if (params.val) params.elem.style.setProperty(params.prop, params.val);\n    };\n\n    if (params.forceAutoresolveIn)\n      transformAndAutoresolve(params.forceAutoresolveIn);\n    else if (\n      params.valToWait &&\n      window.getComputedStyle(params.elem).getPropertyValue(params.prop) ===\n        params.valToWait\n    )\n      transformAndAutoresolve();\n    else {\n      const style = window.getComputedStyle(params.elem);\n      const duration = getTransitionDuration(style, params.prop);\n\n      if (!duration || duration === '0s') {\n        transformAndAutoresolve();\n      } else {\n        transformAndWaitEvent();\n      }\n    }\n  });\n}\n","export interface Notifiable {\n  notify: <T>(params: T) => void | Promise<void>;\n}\n\nexport function isNotifiable(object: unknown): object is Notifiable {\n  const objAsRecord = object as Record<string, unknown>;\n  return 'notify' in objAsRecord && typeof objAsRecord.notify === 'function';\n}\n","class ObjProcessor {\n  readonly deepFreeze = <T>(obj: T): T => {\n    if (typeof obj === 'object' && obj !== null) {\n      const record = obj as Record<string, unknown>;\n      Object.keys(record).forEach(prop => {\n        if (\n          typeof record[prop] === 'object' &&\n          !Object.isFrozen(record[prop])\n        ) {\n          this.deepFreeze(record[prop]);\n        }\n      });\n      return Object.freeze(obj);\n    }\n    throw new Error('not object');\n  };\n\n  readonly deepClone = <T>(target: T): T => {\n    if (Array.isArray(target)) {\n      const clone = [] as unknown[];\n      (target as unknown[]).forEach(v => {\n        clone.push(v);\n      });\n      return clone.map((n: unknown) => this.deepClone(n)) as unknown as T;\n    }\n\n    if (typeof target === 'object' && target !== null) {\n      if (target instanceof HTMLElement)\n        return target.cloneNode(true) as unknown as T;\n      if (target instanceof Blob) return target.slice() as unknown as T;\n      const clone = {\n        ...(target as unknown as { [key: string]: unknown }),\n      } as {\n        [key: string]: unknown;\n      };\n      Object.keys(clone).forEach(k => {\n        clone[k] = this.deepClone(clone[k]);\n      });\n      Object.setPrototypeOf(clone, Object.getPrototypeOf(target));\n      return clone as unknown as T;\n    }\n    return target;\n  };\n}\n\nconst OBJ_PROCESSOR = new ObjProcessor();\nOBJ_PROCESSOR.deepFreeze(OBJ_PROCESSOR);\nexport { OBJ_PROCESSOR };\n","import { DBusTopics } from './defs/dbus-topics.def';\nimport { genUniqId } from '../../generators/generators';\nimport { OBJ_PROCESSOR } from '../../processors/obj-processor';\nimport { DBUS_ERRORS } from './defs/dbus-errors.def';\nimport { DBusRX, DBusRXFunc } from './defs/dbus-rx/dbus-rx.def';\nimport { DBusTX } from './defs/dbus-tx/dbus-tx.def';\nimport { DBusTXOptions } from './defs/dbus-tx/dbus-tx-options.def';\nimport { DBusTXData } from './defs/dbus-tx/dbus-tx-data.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from './defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTXDataHeaders } from './defs/dbus-tx/dbus-tx-data-headers.def';\nimport { DBusHub, DBusInterface } from './defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from './defs/dbus-hub-names.def';\n\nexport class DBus {\n  private network: Map<DBusTopics, Set<DBusRX>> = new Map();\n\n  private idCounter = {\n    txs: 0,\n    rxs: 0,\n  };\n\n  private createdRXs = new Set<DBusRX>();\n\n  private createdTXs = new Set<DBusTX>();\n\n  private attachedHubs = new Map<DBusHub, DBusInterface>();\n\n  private occupiedNames = new Set<string>();\n\n  readonly busId: string;\n\n  constructor() {\n    this.busId = genUniqId();\n    return Object.freeze(this) as unknown as DBus;\n  }\n\n  public attachHub(hub: DBusHub, suffix?: string): void | Promise<void> {\n    return this.createInterfaceForHub(hub, undefined, suffix);\n  }\n\n  private createInterfaceForHub(\n    hub: DBusHub,\n    prefix?: string,\n    suffix?: string,\n  ): void | Promise<void> {\n    if (this.attachedHubs.has(hub))\n      throw new Error(DBUS_ERRORS.HUB_IS_ALREADY_ATTACHED);\n\n    if (!(hub.hubName in DBUS_HUB_NAMES))\n      throw new Error(DBUS_ERRORS.HUB_NAME_NOT_AUTHORIZED);\n\n    let hubName = prefix ? `${prefix}_${hub.hubName}` : hub.hubName;\n    if (suffix) hubName += `_${suffix}`;\n\n    if (this.occupiedNames.has(hubName))\n      throw new Error(DBUS_ERRORS.HUB_NAME_IS_OCCUPIED);\n\n    const arrowedGetNewTX = (desc?: string) => this.getNewTX(hubName, desc);\n    const arrowedGetNewRX = (func: DBusRXFunc, desc?: string) =>\n      this.genNewRX(func, desc);\n    const arrowedPlugRX = (topic: DBusTopics, rx: DBusRX) =>\n      this.plugRX(topic, rx);\n    const arrowedUnplugRX = (topic: DBusTopics, rx: DBusRX) =>\n      this.unplugRX(topic, rx);\n    const decoratedAttachHub = (subHub: DBusHub, subSuffix?: string) =>\n      this.createInterfaceForHub(subHub, hubName, subSuffix);\n\n    const dbusInterface = new DBusInterface(\n      arrowedGetNewTX,\n      arrowedGetNewRX,\n      arrowedPlugRX,\n      arrowedUnplugRX,\n      decoratedAttachHub,\n    );\n\n    this.occupiedNames.add(hubName);\n    this.attachedHubs.set(hub, dbusInterface);\n\n    OBJ_PROCESSOR.deepFreeze(dbusInterface);\n\n    return hub.connect(dbusInterface);\n  }\n\n  private getNewTX(hubName: string, desc?: string): DBusTX {\n    const id = genUniqId();\n    const regNumber = this.idCounter.txs++;\n\n    const arrowedTransmit = async (opts: DBusTXOptions) => {\n      const head = new DBusTXDataHeaders(\n        hubName,\n        id,\n        regNumber,\n        opts.waitMode,\n        opts.prepMode,\n        desc,\n      );\n      const data = new DBusTXData(head, opts.msg);\n      const result = await this.transmit(data);\n      return result;\n    };\n\n    const tx = new DBusTX(regNumber, id, this.busId, arrowedTransmit);\n\n    const freezedTX = OBJ_PROCESSOR.deepFreeze(tx);\n\n    this.createdTXs.add(freezedTX);\n\n    return freezedTX;\n  }\n\n  private genNewRX(func: DBusRXFunc, desc?: string): DBusRX {\n    const id = genUniqId();\n    const regNumber = this.idCounter.rxs++;\n    const rx = new DBusRX(regNumber, id, this.busId, func, desc);\n    const freezedRX = OBJ_PROCESSOR.deepFreeze(rx);\n    this.createdRXs.add(freezedRX);\n    return freezedRX;\n  }\n\n  private plugRX(topic: DBusTopics, rx: DBusRX): void {\n    if (!this.createdRXs.has(rx)) throw new Error(DBUS_ERRORS.XENO_RX);\n    if (!this.network.has(topic)) this.network.set(topic, new Set());\n    this.network.get(topic)?.add(rx);\n  }\n\n  private unplugRX(topic: DBusTopics, rx: DBusRX): void {\n    this.network.get(topic)?.delete(rx);\n  }\n\n  private async transmit(data: DBusTXData): Promise<unknown> {\n    if (!this.network.has(data.msg.topic)) {\n      throw new Error(DBUS_ERRORS.TOPIC_IS_NOT_EXIST);\n    }\n\n    const rxs = this.network.get(data.msg.topic);\n\n    if (rxs === undefined || rxs.size === 0)\n      throw new Error(DBUS_ERRORS.TOPIC_HAS_NO_RXS);\n\n    let choosedRXs: DBusRX[] = [];\n\n    if (data.msg.prefResponseRxIds) {\n      rxs.forEach(rx => {\n        if (data.msg.prefResponseRxIds?.includes(rx.id)) choosedRXs.push(rx);\n      });\n      if (choosedRXs.length === 0)\n        throw new Error(DBUS_ERRORS.PREF_RXS_ARE_NOT_EXIST);\n    } else choosedRXs = [...rxs];\n\n    let result;\n    switch (data.headers.waitMode) {\n      case DBusTXWaitModes.all:\n        result = await Promise.all(\n          choosedRXs.map(rx => this.callRXFunc(data, rx)),\n        );\n        break;\n      case DBusTXWaitModes.allSetled:\n        result = await Promise.allSettled(\n          choosedRXs.map(rx => this.callRXFunc(data, rx)),\n        );\n        break;\n      case DBusTXWaitModes.manual:\n        result = choosedRXs;\n        break;\n      case DBusTXWaitModes.nowait:\n      default:\n        choosedRXs.map(rx => this.callRXFunc(data, rx));\n        result = true;\n        break;\n    }\n    return result;\n  }\n\n  private callRXFunc = (data: DBusTXData, rx: DBusRX) => {\n    const handleClone = () => {\n      const clonedData = OBJ_PROCESSOR.deepClone(data);\n      return rx.func(clonedData);\n    };\n\n    const handleFreeze = () => {\n      const freezedData = OBJ_PROCESSOR.deepFreeze(data);\n      return rx.func(freezedData);\n    };\n\n    switch (data.headers.prepMode) {\n      case DBusTXPrepModes.clone:\n        return handleClone();\n      case DBusTXPrepModes.freeze:\n        return handleFreeze();\n      default:\n        throw new Error(DBUS_ERRORS.UNEXPECTED_PREP_MODE);\n    }\n  };\n}\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nconst dbusCommonResponses = {\n  VOID: 'VOID',\n  BAD_REQUEST: 'BAD_REQUEST',\n};\n\nconst DBUS_COMMON_RESPONSES = OBJ_PROCESSOR.deepFreeze(dbusCommonResponses);\n\nexport { DBUS_COMMON_RESPONSES };\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nconst dbusErrors = {\n  HUB_NAME_IS_OCCUPIED: 'HUB_NAME_IS_OCCUPIED',\n  HUB_IS_ALREADY_ATTACHED: 'HUB_IS_ALREADY_ATTACHED',\n  HUB_NAME_NOT_AUTHORIZED: 'HUB_NAME_NOT_AUTHORIZED',\n  XENO_RX: 'XENO_RX',\n  TOPIC_IS_NOT_EXIST: 'TOPIC_IS_NOT_EXIST',\n  TOPIC_HAS_NO_RXS: 'TOPIC_HAS_NO_RXS',\n  PREF_RXS_ARE_NOT_EXIST: 'PREF_RXS_ARE_NOT_EXIST',\n  UNEXPECTED_PREP_MODE: 'UNEXPECTED_PREP_MODE',\n};\n\nconst DBUS_ERRORS = OBJ_PROCESSOR.deepFreeze(dbusErrors);\n\nexport { DBUS_ERRORS };\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nclass DBusHubNames {\n  readonly APP = 'APP';\n\n  readonly ROUTER = 'ROUTER';\n\n  readonly GARAGE = 'GARAGE';\n\n  readonly HEADER = 'HEADER';\n\n  readonly MAIN_CONTROLS = 'MAIN_CONTROLS';\n\n  readonly CREATE_UPDATE = 'CREATE_UPDATE';\n\n  readonly GARAGE_CONTROLLER = 'GARAGE_CONTROLLER';\n\n  readonly WINNERS = 'WINNERS';\n}\n\nconst obj = new DBusHubNames();\n\nconst DBUS_HUB_NAMES = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { DBUS_HUB_NAMES };\n\nexport type DBusHubNamesList = keyof DBusHubNames;\n","import { DBusHubNamesList, DBUS_HUB_NAMES } from './dbus-hub-names.def';\nimport { DBusRX, DBusRXFunc } from './dbus-rx/dbus-rx.def';\nimport { DBusTopics } from './dbus-topics.def';\nimport { DBusTX } from './dbus-tx/dbus-tx.def';\n\nexport interface DBusHub {\n  readonly hubName: DBusHubNamesList;\n  connect: (dbusInterface: DBusInterface) => void | Promise<void>;\n  // TODO: handleSystemRequset: (request: unknown) => unknown | Promise<unknown>;\n}\n\nexport function isDBusHub(object: unknown): object is DBusHub {\n  const objAsRecord = object as Record<string, unknown>;\n  return (\n    'connect' in objAsRecord &&\n    'hubName' in objAsRecord &&\n    typeof objAsRecord.hubName === 'string' &&\n    objAsRecord.hubName in DBUS_HUB_NAMES\n  );\n}\n\nexport class DBusInterface {\n  private RXs = new Set<DBusRX>();\n\n  private TXs = new Set<DBusTX>();\n\n  private RXsPlugMap = new Map<DBusTopics, Set<DBusRX>>();\n\n  constructor(\n    private readonly arrowedGetNewTX: (desc?: string) => DBusTX,\n    private readonly arrowedGetNewRX: (\n      func: DBusRXFunc,\n      desc?: string,\n    ) => DBusRX,\n    private readonly arrowedPlugRX: (topic: DBusTopics, rx: DBusRX) => void,\n    private readonly arrowedUnplugRX: (topic: DBusTopics, rx: DBusRX) => void,\n    public readonly attachSubHub: (\n      subHub: DBusHub,\n      subSuffix?: string,\n    ) => void | Promise<void>,\n  ) {}\n\n  getNewRX(func: DBusRXFunc, desc?: string) {\n    const rx = this.arrowedGetNewRX(func, desc);\n    this.RXs.add(rx);\n    return rx;\n  }\n\n  getNewTX(desc?: string) {\n    const tx = this.arrowedGetNewTX(desc);\n    this.TXs.add(tx);\n    return tx;\n  }\n\n  plugRX(topic: DBusTopics, rx: DBusRX): void {\n    if (!this.RXsPlugMap.has(topic)) this.RXsPlugMap.set(topic, new Set());\n    this.RXsPlugMap.get(topic)?.add(rx);\n    this.arrowedPlugRX(topic, rx);\n  }\n\n  unplugRX(topic: DBusTopics, rx: DBusRX): void {\n    this.RXsPlugMap.get(topic)?.delete(rx);\n    this.arrowedUnplugRX(topic, rx);\n  }\n}\n","import { DBusTXData } from '../dbus-tx/dbus-tx-data.def';\n\nexport type DBusRXFunc = (data: DBusTXData) => Promise<unknown>;\n\nexport class DBusRX {\n  constructor(\n    readonly regNumber: number,\n    readonly id: string,\n    readonly busId: string,\n    readonly func: DBusRXFunc,\n    readonly desc?: string,\n  ) {}\n}\n","export enum DBusTopics {\n  APP_CTL,\n  ROUTING,\n  CAR_ACTION,\n  GARAGE,\n  REST_CLIENT_REQUESTS,\n  GENERATE,\n}\n","import { DBusTXPrepModes, DBusTXWaitModes } from './dbus-tx-modes.def';\n\nexport class DBusTXDataHeaders {\n  constructor(\n    readonly hubName: string,\n    readonly txId: string,\n    readonly txRegNumber: number,\n    readonly waitMode: DBusTXWaitModes,\n    readonly prepMode: DBusTXPrepModes,\n    readonly txDesc?: string,\n  ) {}\n}\n","import { DBusMsg } from '../msgs/dbus-msg.def';\nimport { DBusTXDataHeaders } from './dbus-tx-data-headers.def';\n\nexport class DBusTXData {\n  constructor(readonly headers: DBusTXDataHeaders, readonly msg: DBusMsg) {}\n}\n","export enum DBusTXWaitModes {\n  nowait,\n  all,\n  allSetled,\n  manual,\n}\n\nexport enum DBusTXPrepModes {\n  clone,\n  freeze,\n}\n","import { DBusTXOptions } from './dbus-tx-options.def';\n\nexport class DBusTX {\n  constructor(\n    readonly regNumber: number,\n    readonly id: string,\n    readonly busId: string,\n    readonly transmit: (options: DBusTXOptions) => Promise<unknown>,\n  ) {}\n}\n","import { DBusTopics } from '../dbus-topics.def';\n\nexport abstract class DBusMsg {\n  constructor(\n    readonly topic: DBusTopics,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {}\n}\n","export class Pager {\n  private firstPageNumber = 1;\n\n  private currPageNumber = this.firstPageNumber;\n\n  private lastPageNumber = 0;\n\n  private pagerSpan = document.createElement('span');\n\n  private entriesCount = 0;\n\n  private callbackIsCalled = false;\n\n  constructor(\n    private entriesPerPage: number,\n    protected readonly listCallback: (dir: 'prev' | 'next') => Promise<boolean>,\n    private btnPrevPage = document.createElement('button'),\n    private btnNextPage = document.createElement('button'),\n  ) {\n    const btnNextSpan = document.createElement('span');\n    btnNextSpan.textContent = 'Next page';\n    this.btnNextPage.append(btnNextSpan);\n\n    const btnPrevSpan = document.createElement('span');\n    btnPrevSpan.textContent = 'Prev page';\n    this.btnPrevPage.append(btnPrevSpan);\n\n    this.btnNextPage.addEventListener('click', () => this.callCallback('next'));\n    this.btnPrevPage.addEventListener('click', () => this.callCallback('prev'));\n  }\n\n  public toogleLock(lock: boolean) {\n    this.toggleBtnsDisabled(lock);\n  }\n\n  public getEntriesPerPage(): number {\n    return this.entriesPerPage;\n  }\n\n  public setLastPageNumber(n: number) {\n    this.lastPageNumber = n;\n    if (!this.callbackIsCalled) this.toggleBtnsDisabled(false);\n  }\n\n  public setEntriesCount(n: number) {\n    this.entriesCount = n;\n    this.lastPageNumber = Math.ceil(this.entriesCount / this.entriesPerPage);\n    this.updateSpanText();\n    if (!this.callbackIsCalled) this.toggleBtnsDisabled(false);\n  }\n\n  public getCurrPageNumber() {\n    return this.currPageNumber;\n  }\n\n  public getBtnPrevPage(): HTMLSpanElement {\n    return this.btnPrevPage;\n  }\n\n  public getBtnNextPage(): HTMLSpanElement {\n    return this.btnNextPage;\n  }\n\n  public getPagerSpan(): HTMLSpanElement {\n    return this.pagerSpan;\n  }\n\n  tryChangePage(dir: 'prev' | 'next') {\n    return this.callCallback(dir);\n  }\n\n  private updateSpanText() {\n    const pageNumber = this.entriesCount > 0 ? this.currPageNumber : 0;\n    this.pagerSpan.textContent = `Entries: ${this.entriesCount}, Page: ${pageNumber}/${this.lastPageNumber}`;\n  }\n\n  private async callCallback(dir: 'prev' | 'next') {\n    if (this.callbackIsCalled) return;\n    console.log('lock');\n    this.callbackIsCalled = true;\n    this.toggleBtnsDisabled(true);\n    this.listCallback(dir)\n      .then(pageIsChanged => {\n        if (pageIsChanged) {\n          switch (dir) {\n            case 'next':\n              this.currPageNumber++;\n              break;\n            case 'prev':\n              this.currPageNumber--;\n              break;\n            default:\n              break;\n          }\n          this.updateSpanText();\n        }\n      })\n      .finally(() => {\n        this.toggleBtnsDisabled(false);\n        console.log('unlock');\n        this.callbackIsCalled = false;\n      });\n  }\n\n  private toggleBtnsDisabled(state: boolean) {\n    if (state === true) {\n      this.btnPrevPage.disabled = true;\n      this.btnNextPage.disabled = true;\n      return;\n    }\n\n    if (this.currPageNumber > this.firstPageNumber)\n      this.btnPrevPage.disabled = false;\n    else this.btnPrevPage.disabled = true;\n\n    if (this.currPageNumber < this.lastPageNumber)\n      this.btnNextPage.disabled = false;\n    else this.btnNextPage.disabled = true;\n  }\n}\n","import { DBusTopics } from '../../dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgRoutingMsg extends DBusMsg {\n  constructor(rxIds?: string[], prefResponseRxIds?: string[]) {\n    super(DBusTopics.ROUTING, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgRoutingMsg } from '../dbus-msg-routing-msg.def';\nimport { ROUTES } from '../../routes.def';\n\nexport class DBusMsgRouteIsChangedMsg extends DBusMsgRoutingMsg {\n  constructor(\n    readonly newRoute: keyof typeof ROUTES | string,\n    readonly addInfo?: unknown,\n    rxIds?: string[],\n    prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgRoutingMsg } from '../dbus-msg-routing-msg.def';\n\nexport type RouterStatus = 'restrained' | 'free';\n\nexport class DBusMsgRoutingStatusMsg extends DBusMsgRoutingMsg {\n  constructor(\n    readonly status: RouterStatus,\n    rxIds?: string[],\n    prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgRoutingMsg } from '../dbus-msg-routing-msg.def';\n\nexport type RoutingRestrainActions = 'restrain' | 'unleash';\n\nexport class DBusMsgRoutingRestrainMsg extends DBusMsgRoutingMsg {\n  constructor(\n    readonly action: RoutingRestrainActions,\n    readonly callback: () => Promise<boolean>,\n    rxIds?: string[],\n    prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","export class SimpleRouterAgent {\n  constructor(\n    readonly type: string,\n    readonly path: string,\n    readonly callback: CallableFunction,\n    readonly getStateCallback?: CallableFunction,\n    readonly setStateCallback?: CallableFunction,\n  ) {}\n}\n","import { OBJ_PROCESSOR } from '../../processors/obj-processor';\nimport { DBUS_HUB_NAMES } from '../dbus/defs/dbus-hub-names.def';\nimport { DBusHub, DBusInterface } from '../dbus/defs/dbus-interface.def';\nimport { DBusTopics } from '../dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../dbus/defs/dbus-tx/dbus-tx-data.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgRouteIsChangedMsg } from './dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport {\n  DBusMsgRoutingStatusMsg,\n  RouterStatus,\n} from './dbus-msgs-defs/types/router-status-msg.def';\nimport { DBusMsgRoutingRestrainMsg } from './dbus-msgs-defs/types/routing-restrict-msg.def';\nimport { SimpleRouterAgent } from './simple-router-agent';\n\nexport interface RouterOptions {\n  mode: string;\n  onlyDBus?: true;\n  defaultRoot?: string;\n  defaultAgent?: SimpleRouterAgent;\n}\n\nexport class SimpleRouter implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.ROUTER;\n\n  private agents: Set<SimpleRouterAgent> = new Set();\n\n  private options: RouterOptions;\n\n  private currRoute: string | undefined;\n\n  private txs: Set<DBusTX> = new Set();\n\n  private defaultAgent: SimpleRouterAgent | undefined;\n\n  private restrains: Set<() => Promise<boolean>> = new Set();\n\n  constructor(options: RouterOptions) {\n    switch (options.mode) {\n      case '#':\n        // just filter that # mode\n        break;\n      case '?':\n        throw new Error(`${options.mode} is not supported yet!`);\n      default:\n        throw new Error(`${options.mode} is not supported!`);\n    }\n    this.options = OBJ_PROCESSOR.deepFreeze(options);\n\n    window.addEventListener('popstate', async () => {\n      if (window.location.href === this.currRoute) return;\n\n      if (this.restrains.size > 0) {\n        const wantedRoute = window.location.href;\n\n        if (this.currRoute) {\n          window.location.href = this.currRoute;\n        } else if (this.options.defaultRoot) {\n          window.location.href = `${window.location.host}/${this.options.defaultRoot}`;\n        }\n        const arr = [...this.restrains.values()];\n        const promises = arr.map(arrow => arrow());\n        const result = await Promise.all(promises);\n        let cancelRouteChange = false;\n\n        if (Array.isArray(result)) {\n          for (let i = 0; i < result.length; i++) {\n            if (typeof result[i] !== 'boolean')\n              throw new Error('restrict func returned not boolean value!');\n\n            if (!result[i]) cancelRouteChange = true;\n            else {\n              const func = arr[i];\n\n              if (func) this.restrains.delete(func);\n              if (this.restrains.size === 0)\n                this.broadcastRoutingStatus('free');\n            }\n          }\n        }\n\n        if (!cancelRouteChange) window.location.href = wantedRoute;\n      } else {\n        this.activateWantedAgents();\n      }\n    });\n  }\n\n  private broadcastRoutingStatus(status: RouterStatus) {\n    const msg = new DBusMsgRoutingStatusMsg(status);\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  activateWantedAgents(addInfo?: unknown): boolean | Error[] {\n    this.currRoute = window.location.href;\n    let activatedCount = 0;\n    const errors = [];\n\n    if (!this.options.onlyDBus && this.options.mode === '#') {\n      const agentsArr = [...this.agents];\n      for (let i = 0; i < this.agents.size; i++) {\n        if (agentsArr[i]?.path === window.location.hash) {\n          try {\n            agentsArr[i]?.callback(addInfo);\n          } catch (error) {\n            error.push(error);\n          }\n          activatedCount++;\n          break;\n        }\n      }\n\n      if (activatedCount === 0) {\n        if (\n          this.defaultAgent &&\n          this.options.defaultRoot === window.location.hash\n        ) {\n          this.defaultAgent.callback(addInfo);\n        } else {\n          errors.push(new Error('Agent is not finded'));\n        }\n      }\n    }\n\n    if (this.txs.size > 0) {\n      this.txs.forEach(tx => {\n        const msg = new DBusMsgRouteIsChangedMsg(window.location.hash, addInfo);\n        tx.transmit({\n          msg,\n          waitMode: DBusTXWaitModes.nowait,\n          prepMode: DBusTXPrepModes.freeze,\n        });\n      });\n    }\n\n    if (errors.length > 0) return errors;\n    return activatedCount > 0;\n  }\n\n  addRouterAgent(agent: SimpleRouterAgent): void {\n    this.agents.add(agent);\n  }\n\n  removeRouterAgent(agent: SimpleRouterAgent): void {\n    this.agents.delete(agent);\n  }\n\n  flushRouterAgents(): void {\n    this.agents.clear();\n  }\n\n  // /* not refactored yet\n  private watchRestrictions = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgRoutingRestrainMsg) {\n      const { action, callback } = data.msg;\n      if (action === 'restrain') {\n        this.restrains.add(callback);\n        if (this.restrains.size === 1)\n          this.broadcastRoutingStatus('restrained');\n      } else {\n        this.restrains.delete(callback);\n        if (this.restrains.size === 0) this.broadcastRoutingStatus('free');\n      }\n    }\n  };\n\n  connect(int: DBusInterface): void {\n    const tx = int.getNewTX('broadcasting route changes');\n    this.txs.add(tx);\n\n    const rx = int.getNewRX(\n      this.watchRestrictions,\n      'router watch restrictions requests',\n    );\n    int.plugRX(DBusTopics.ROUTING, rx);\n  }\n}\n","import { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\n\nexport type EngineResponse = {\n  velocity: number;\n  distance: number;\n};\n\nclass RestClientEngine {\n  private resUrl = '/engine';\n\n  private fullUrl: string;\n\n  constructor(private baseUrl: string) {\n    this.fullUrl = baseUrl + this.resUrl;\n  }\n\n  toggleEngine(\n    id: number,\n    status: 'started' | 'stopped',\n  ): Promise<EngineResponse> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}?id=${id}&status=${status}`;\n      console.log(url);\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as EngineResponse))\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  enterDriveMode(id: number): Promise<true | false | 404> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}?id=${id}&status=drive`;\n      console.log(url);\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          else if (response.status === 500) res(false);\n          else rej(new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT));\n        })\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n}\n\nconst obj = new RestClientEngine('http://127.0.0.1:3000');\n\nconst REST_CLIENT_ENGINE = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_ENGINE };\n","import { RegCarData, UnregCarData } from '../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\nimport { REST_CLIENT_NAMES } from '../rest-clients-names.def';\n\nclass RestClientGarage {\n  protected clientName = REST_CLIENT_NAMES.GARAGE;\n\n  private resUrl = '/garage';\n\n  private fullUrl: string;\n\n  constructor(private baseUrl: string) {\n    this.fullUrl = baseUrl + this.resUrl;\n  }\n\n  getCars(\n    page?: number,\n    limit?: number,\n  ): Promise<{ limit: string; cars: RegCarData[] }> {\n    return new Promise((res, rej) => {\n      const limitStr = limit || '';\n      const url = `${this.fullUrl}?_page=${page}&_limit=${limitStr}`;\n      let limitResponse = '';\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) {\n            limitResponse = response.headers.get('X-Total-Count') as string;\n            return response.json();\n          }\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res({ limit: limitResponse, cars: json as RegCarData[] }))\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  getCar(id: number): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as RegCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  createCar(unregCar: UnregCarData): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      fetch(this.fullUrl, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(unregCar),\n      })\n        .then(response => {\n          if (response.status === 201) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as RegCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  deleteCar(id: number): Promise<true> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'DELETE',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  updateCar(regCar: RegCarData): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${regCar.id}`;\n      const data: UnregCarData = regCar;\n      fetch(url, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data),\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n}\n\nconst obj = new RestClientGarage('http://127.0.0.1:3000');\n\nconst REST_CLIENT_GARAGE = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_GARAGE };\n","import { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\n\nclass RestClientWinnersSortOptions {\n  readonly id = 'id';\n\n  readonly wins = 'wins';\n\n  readonly time = 'time';\n}\n\nconst obj = new RestClientWinnersSortOptions();\n\nconst REST_CLIENT_WINNERS_SORT_OPTIONS = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_WINNERS_SORT_OPTIONS };\n\nexport type RestClientWinnersSortOptionsList =\n  keyof RestClientWinnersSortOptions;\n","import { WinnerCarData } from '../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\nimport { RestClientWinnersSortOptionsList } from './rest-client-winners.def';\n\nclass RestClientWinners {\n  private resUrl = '/winners';\n\n  private fullUrl: string;\n\n  constructor(private baseUrl: string) {\n    this.fullUrl = baseUrl + this.resUrl;\n  }\n\n  getWinners(\n    page = 0,\n    limit?: number,\n    sort?: RestClientWinnersSortOptionsList,\n    order?: 'ASC' | 'DESC',\n  ): Promise<{ limit: string; cars: WinnerCarData[] }> {\n    return new Promise((res, rej) => {\n      const limitStr = limit || '';\n      let url = `${this.fullUrl}?_page=${page}&_limit=${limitStr}`;\n      if (sort) url += `&_sort=${sort}`;\n      if (order) url += `&_order=${order}`;\n      let limitResponse = '';\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) {\n            limitResponse = response.headers.get('X-Total-Count') as string;\n            return response.json();\n          }\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json =>\n          res({ limit: limitResponse, cars: json as WinnerCarData[] }),\n        )\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  getWinner(id: number): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  createWinner(winnerCarData: WinnerCarData): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      fetch(this.fullUrl, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(winnerCarData),\n      })\n        .then(response => {\n          if (response.status === 201) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  deleteWinner(id: number): Promise<true> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'DELETE',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  updateWinner(winnerData: WinnerCarData): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${winnerData.id}`;\n      const data: WinnerCarData = winnerData;\n      fetch(url, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data),\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n}\n\nconst obj = new RestClientWinners('http://127.0.0.1:3000');\n\nconst REST_CLIENT_WINNERS = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_WINNERS };\n","import { OBJ_PROCESSOR } from '../../lib/processors/obj-processor';\n\nconst restClientError = {\n  UNEXPECTED_RESULT: 'UNEXPECTED_RESULT',\n  UNKNOWN_ERROR: 'UNKNOWN_ERROR',\n  NOT_FOUND: 'NOT_FOUND',\n  CONNECTION_REFUSED: 'CONNECTION_REFUSED',\n};\n\nconst REST_CLIENT_ERROR = OBJ_PROCESSOR.deepFreeze(\n  restClientError,\n) as typeof restClientError;\n\nexport { REST_CLIENT_ERROR };\n","import { OBJ_PROCESSOR } from '../../lib/processors/obj-processor';\n\nclass RestClientNames {\n  readonly GARAGE = 'GARAGE';\n\n  readonly WINNERS = 'WINNERS';\n}\n\nconst REST_CLIENT_NAMES = new RestClientNames();\n\nOBJ_PROCESSOR.deepFreeze(REST_CLIENT_NAMES);\n\nexport { REST_CLIENT_NAMES };\n\nexport type RestClientNamesList = keyof RestClientNames;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { App } from './app/app';\n\nwindow.addEventListener('load', () => {\n  const appDiv = document.createElement('div');\n  document.body.append(appDiv);\n  const app = new App(appDiv);\n});\n"],"sourceRoot":""}