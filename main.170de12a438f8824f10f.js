(()=>{var t={3916:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>a});const a={garage:"_21SC4SGf5mTamWfNdNRR",intro:"_1_6B8epjerqfM9sjWaJS0B",garage__bg:"_2VnbeeG4HKnZfSWUedizHh","garage__track-container":"_1rsPT6UvHnbHI-FUFvPaSe","hue-rotate":"_3MSD3skhU7RLqKdx6pBax7","garage__track-container_finish":"_1khEfVJzcbQlBMhoHPdhzY","garage__winner-popup":"_17InT8lGlAlk8k1JRcrTCM","garage-bg":"-BA3r_cxZwAYkgGQVVZeo","garage-bg__video":"_3byu86MCf3s6B7JQuetNAw","garage-bg__car-ctl-btn":"_3upDU-ngLjybmFg4wiVvfl","garage-bg__car-ctl-block-number":"_3dT19pzigDW1UKuPVLEguq","garage-bg__car-ctl-block":"_2e0Ox8Joh0jw60ztR_rVt5","garage-bg__cars-ctls-block":"wMVLCRcoluFnZleBHWXlm","garage-bg__self-ctls-block":"_2VQVmkB2amN4PG9XCyFye9","garage-bg__pager":"_2avafWgl8XDS2KLJswKq0H","garage-bg__pager-span":"_3ktlpozBQghco3VMHLJBo1","garage-bg__pager-btn":"_2QdjLaEnj3Balh89eZAya4","synthwave-background":"_2pUKJme_w_0KTS_JoVNV5b","synthwave-background_race-mode":"n1z9UH35nfilmkK2lmQvV",race:"_375ItX4gjZY-ZT7KrEfBgG","move-grid":"_1MqERRNbzZtvdd9iE43L04"}},6010:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>a});const a={"car-div":"_3pRKwGaRv59JcJqlApAnkk","car-div__canvas":"rH6_OMXna8-zeemMHF11D","car-div__wheel":"_3WNDl-LGGtViqzAfLLX4CB","car-div__wheel_forward":"_3Rdh32fs7fi-95LcabV_Ed","car-div__wheel_backward":"_3xptMXOOFn6YcMVYMigRMa","car-div__explosion":"_3w8-mlW0m2zLABohqiDQ3e","car-div_ignite":"_3gEkh_UHPsV03BNqNGmyBe","car-div_borken":"UxI1dTvw1TMcYTYZRUsCf","car-div_rollForward":"_3xWmq3Q2UpNiq2nICrGAIN","car-div-anim":"_381V-1xCMVwSdGT0FxnQiO","hue-rotate-360":"_2xfuDYbUjW8QtSLtmjzC7b","tire-anim":"_2Qs9DAZPIqZivw_0ON2Vot","glitch-animation-1":"_18DmdiFkNll__X_lkGV0vb","glitch-animation-2":"_3dfetHNRAa7hXqdHw76Uur","glitch-animation-3-xy":"qr9kE_7wWzjw836QOZH4l","glitch-animation-4-xy":"bBFhOAPzr7ZHO1gMz8m2a","hue-rotate-90":"_3V692dxTWP4I0NCS1rUiMn"}},2022:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>a});const a={root:"_2uo9WXSTJyDD3jBlT_quev","text-input":"_2YNdYEaErpy02Ske_bZONx","color-input":"_3Ye7rbfoBnq4HZn4H-yDB8"}},7715:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>a});const a={"main-controls":"_2b_svto1O0DGSO3_579_Xj","btn-block":"_262VSHreYXfZUHLGeCJEvZ"}},2096:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>a});const a={track:"_2hDrLwwwZMiv2NrI-XZZqJ",track_illuminated:"_3zXlLAoKpXJ_jlpauHLjHR","track__controls-block":"_3pqcODoHFqX9rxmLKBnhD4"}},3544:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>a});const a={header:"_3TTTWNe5aoHesw4iV0YUGU",header__logo:"_2idUQTZia_1M_0xkhMkXf8","glitch-animation-1":"_15gesIXTXGxm1uBGCwmmqp","glitch-animation-2":"s3dyJTG8fG5lknNowsTqO","header-nav":"_7vejZGT8OzUejTiWyGs1P","header-nav__item":"_1NYwlHRXmh2YGu63soBsjx","header-nav__anchor":"_2n39qEg5Iz5Tym2Z0Jrjz9","header-nav__anchor_active":"_2bRvd3RlExbbSpyXLuxSdS","header-nav_not-active":"_3gNs_UBLjSUG-Bq-Vf2T67","glitch-animation-3-xy":"_3uLEqFHW9zkb7hCp_s1nFC","header-nav__svg":"_2FCXcgNK7Jgl9f3ZK-O56I","header-nav__span":"_1NVrpdaSQLvqho4VNqQqit","header-nav__list":"_1vy8OijKt-Cy7SGXyM4ek9","header-nav__list_disabled":"_25SilQm6mkAlbl-WpajKBY","glitch-animation-4-xy":"_1oG3arGYS7T4HAPVRP9NtY","hue-rotate-90":"_3ejf9WYQ_keT8RXiF6nTIR","hue-rotate-360":"_7lIM2sgFifv2jKmceFM04"}},9541:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>a});const a={body:"_3tVLnvk3q7kf60N7EfAsgP","btn-block":"_1jkUqwfJwBTeZA_PwMXeCg",btn:"_2bwmpgTrhG5WrJx-0mrkhx","glitch-parent":"_2smmCfANEjhtt4BzpG_sLO",glitch:"_3ekpIOxutzsrjgHi6vaoRD","glitch-animation-3-xy":"VB0xzvIXCf2IHNQxhbOz8","glitch-animation-1":"_9Kfwb6iucSGuo9YCmWXdk","glitch-animation-2":"_3dHLnmaxXP_FHzxB_NlAdr","glitch-animation-4-xy":"_2DypaqsNhdjJQN1C2baR7W","hue-rotate-90":"_2rKbfZQT8JgPGaWisOZtuc","hue-rotate-360":"_3pGjJdHvp_pWzeUh0WTbEO"}},8625:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>a});const a={body:"_1HdHF-02knc5SKDPjQ6D2-",ol:"eAvfZ_Z8yQCULeXIjq3-G","btn-close":"GNY0R7d-Ad5AS2UOZ7yps",rotate360:"_3gtxvh81CAFXLzkaUGlfKh","btn-close-container":"jItdRkRWCFtbNhv5xpdUC","hue-rotate-360":"_2hz6JNRu4bvDfPbTnBQ5V2","btn-ok":"_14IPB-YWgyQRP3qstS_Ade","btn-ok__innerSpan":"_1_FQyYyG2Fwqho6LSJWbZ-","glitch-animation-1":"_1j1k5OCsoD8-WtIGxQqUln","glitch-animation-2":"J-GZe1o1bK_Q2fKIxIW9s","glitch-animation-3-xy":"_3FKHYtzhv7_wotaeIY_jom","glitch-animation-4-xy":"_3Gvn6xqDi0qGQHXbItP29f","hue-rotate-90":"_1oo2FQqnFJI_g2nEdnhjC0"}},9052:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>a});const a={winners:"HVDfoBgyIQ4teF5EKFzcD",intro:"yZnUjHL-jkdakQQFCkqyq",table:"_3mJKnd573Tt4WspNl7gf1J","table__car-preview-box":"_86kcZK8UgXIsvYD-wpDED","table__can-be-sorted":"_3Xa74hpyx3g6XUuZ9fB9Cm","table__sorted-elem":"rfPuVNCW0Sd4nzQGO8-R8","table__sorted-elem_asc":"N6296gY2c5AFEX4KjE4I4","table__sorted-elem_desc":"_37bMOUs2OF28ZqMubJCPnM",pager:"_2q-noyJbwIpKOMhl7AWlq5","pager-span":"_1O8erRuDz9RWa3C9tqnUm-","pager-btn":"_3OktYstRgXgDE6zlpOM6LA","bottom-btns-container":"_3W15tscjdKQtes2IFf9GuC","btn-glitch":"XFsunLW_IkuzOAT8jcND0","btn-glitch__innerSpan":"_3MAkYSGRBaTwkvxCSVha72","glitch-animation-1":"d3lBrA2HIOudPajPuC6Qc","glitch-animation-2":"_268kxyhSlSSFPnx4Ajj8N3","glitch-animation-3-xy":"_1WbYKA4KBGh4V1OT5dXIsS","glitch-animation-4-xy":"Bqga7NnAzaDXnFYuV6T8R","hue-rotate-90":"vj-f94Y0-qyHt_tBW9aAH","hue-rotate-360":"_345l5rRWgIZ1hnilXXB-Pz"}},3588:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>a});const a={"popup-modal":"_3KlZOyoPt2P4FT1Ofdi1oz","popup-bg":"_1QGzfQYEHvrYonFptRzkG6","popup-body":"_3zDyJwNy615xogiYvCl4vt","popup-body-header":"_2DglTs5KJlA1QJriRI6bVZ","popup-body-text":"_2oMxBL_Jv1KW3bHu3sVdaA","popup-body__btn-close":"HV1Imp7Np5N8O5nUXwQsS"}},9715:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>a});const a={container:"_1KBIW4BNGKHwQtRcKc6JIF","hue-rotate":"_1t6lrd-wEBCB6ei-o9kDmk",bar:"_2DWg3PnmWwM25SBd7sLJQK",body:"_24wm1l_qZHsMTx2Oy-enF4",text:"_1UFV3thankQQ1R2Ly1Zle2"}},4985:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>a});const a={"no-glitch":"_3jhfNB0kF108EhynXnwXt4",app:"_2GlW9kbzGCCom4UEGnZpRF","main-component":"GLMZ5rIXl-xoQfoZneWIs",btn:"a_2w3d8M_c1utyjkPDogH","btn-1":"_27iqs8X5NFef8-ZpiL_u3n","btn-4":"_3exd3hkMJO4xoKflZ4jI0K","btn-6":"vg6GhvI_oAd82g2nOcNB6","btn-9":"_3mEdzCA2cTh_gbEuZrEqkT","btn-13":"_1CI8MrNcZ0Zzun_fhIJH2p","btn-15":"_1c4rHdMAWRFc5xA3fFj1Kh","glitched-text":"_2WhQAYnvrw5r57jsvwHEcW","glitch-animation-1":"_3SsWJY5j_rpKm4wbE1jggd","glitch-animation-2":"_2T9jhQKkqS5XqoaN2hOjdC","glitched-item":"_3ehw9TJADVx0W9b4WfYGWs","glitch-animation-3-xy":"_3cq3m6zsAObFT1W9drsRbr","glitch-animation-4-xy":"_2az41XGPhMc3_U4DsjhHiR","hue-rotate-90":"_2KOyboeT9ymliFqM8Het0d","hue-rotate-360":"_1eInkycuomIYicyYM2UGnf"}},4246:t=>{t.exports="data:image/svg+xml,%3csvg viewBox='0 0 30 30' xmlns='http://www.w3.org/2000/svg'%3e %3cpath fill-rule='evenodd' clip-rule='evenodd' d='M29.5599 2.56066C30.1457 1.97487 30.1457 1.02512 29.5599 0.439337C28.9741 -0.146448 28.0243 -0.146445 27.4386 0.439343L14.9997 12.8783L2.56112 0.439648C1.97534 -0.14614 1.02559 -0.146143 0.4398 0.439642C-0.145987 1.02543 -0.14599 1.97517 0.439795 2.56096L12.8784 14.9996L0.439337 27.4387C-0.146448 28.0245 -0.146445 28.9743 0.439343 29.56C1.02513 30.1458 1.97488 30.1458 2.56066 29.56L14.9997 17.1209L27.439 29.5603C28.0248 30.1461 28.9745 30.1461 29.5603 29.5604C30.1461 28.9746 30.1461 28.0248 29.5603 27.439L17.121 14.9996L29.5599 2.56066Z'/%3e %3c/svg%3e"},9962:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.App=void 0;const r=s(1209),n=s(5207),i=s(7172),o=s(7950),c=s(4690),l=s(2994),d=s(4977),h=s(8785),u=s(7656),p=s(5856),g=s(3287),m=s(3231),_=s(9630),E=s(2841),b=s(379),C=s(8149),f=s(745),R=s(479),T=s(1179),S=a(s(4985));class v{constructor(t){this.rootElement=t,this.hubName=p.DBUS_HUB_NAMES.APP,this.TEXT_CONTENT=v.TEXT_CONTENT_ENG,this.loadedMainComponents={},this.defaultRouterAgent=new r.SimpleRouterAgent("hash","",(()=>this.loadMainComponent("default"))),this.router=new n.SimpleRouter({mode:"#",defaultRoot:"",defaultAgent:this.defaultRouterAgent}),this.mainlineDBus=new i.DBus,this.rebootMsg=new C.DBusMsgRebootMsg("reboot"),this.emergencyHandlerIsWorking=!1,this.popup404=new E.PopupStandaloneModal404Comp,this.welcomePopup=new T.PopupStandaloneModalChoiceFirstOpenComp,this.toggleGlitch=()=>{document.cookie.includes(v.GLITCH_COOKIE.ENABLED)?document.body.classList.remove(S.default["no-glitch"]):document.body.classList.add(S.default["no-glitch"])},this.sendRebootMsg=()=>this.tx?.transmit({msg:this.rebootMsg,prepMode:f.DBusTXPrepModes.freeze,waitMode:f.DBusTXWaitModes.allSetled}),this.rxFuncForAppCtl=async t=>t.msg instanceof R.DBusMsgAppCtlReconfureReqMsg?this.checkFirstOpen(!0):l.DBUS_COMMON_RESPONSES.VOID,this.watchRouterMsgs=async t=>{const{msg:e}=t;return e instanceof o.DBusMsgRouteIsChangedMsg&&this.loadMainComponent(e.newRoute),l.DBUS_COMMON_RESPONSES.VOID},this.setupEmergencyHandler(),this.rootElement.classList.add(S.default.app),this.setTextContent()}setTextContent(){this.popup404.setText(this.TEXT_CONTENT.POPUPS.POPUP404.TEXT)}async start(){await this.checkFirstOpen();const t=new d.HeaderComponent(p.DBUS_HUB_NAMES.HEADER);this.rootElement.append(t.rootElement),this.mainlineDBus.attachHub(this),this.mainlineDBus.attachHub(t),this.mainlineDBus.attachHub(this.router),this.router.activateWantedAgents()}async checkFirstOpen(t){if(!document.cookie.includes(v.OPENED_COOKIE)||t){switch(this.rootElement.append(this.welcomePopup.rootElement),await this.welcomePopup.recharge().awaitDesicion()){case"enable glitch":document.cookie=v.GLITCH_COOKIE.ENABLED;break;default:document.cookie=v.GLITCH_COOKIE.DISABLED}document.cookie=v.OPENED_COOKIE,this.welcomePopup.hide()}this.toggleGlitch()}setupEmergencyHandler(){window.addEventListener("unhandledrejection",(t=>{t.preventDefault(),t.promise.catch((t=>{if(!this.emergencyHandlerIsWorking&&t.message===m.REST_CLIENT_ERROR.CONNECTION_REFUSED){this.emergencyHandlerIsWorking=!0,this.popup404.show();const t=async()=>{try{await b.REST_CLIENT_GARAGE.getCars(),await this.sendRebootMsg(),this.popup404.hide(),this.emergencyHandlerIsWorking=!1}catch{await new Promise((t=>setTimeout(t,1e3))),t()}};t()}}))}))}connect(t){const e=t.getNewRX(this.watchRouterMsgs);t.plugRX(c.DBusTopics.ROUTING,e);const s=t.getNewRX(this.rxFuncForAppCtl);t.plugRX(c.DBusTopics.APP_CTL,s),this.tx=t.getNewTX("APP SYSTEM MSGS TX")}loadMainComponent(t){if(!(t in this.loadedMainComponents))switch(t){case"#garage":this.loadedMainComponents[`${t}`]=new h.GarageComp;break;case"#winners":this.loadedMainComponents[`${t}`]=new g.WinnersComp;break;default:window.location.hash="#garage"}const e=this.loadedMainComponents[`${t}`];if(e){if(this.currMainComponent&&this.currMainComponent.rootElement.remove(),this.currMainComponent=e,e.rootElement.classList.add(S.default["main-component"]),this.rootElement.append(e.rootElement),u.isDBusHub(this.currMainComponent))try{this.mainlineDBus.attachHub(this.currMainComponent)}catch{}_.isNotifiable(this.currMainComponent)&&this.currMainComponent.notify(null)}}}e.App=v,v.TEXT_CONTENT_ENG={POPUPS:{POPUP404:{TEXT:"No connection! Check that the server is online\n        and nothing is blocking the connection!"}}},v.OPENED_COOKIE="no95typem-async-race=opened",v.GLITCH_COOKIE={ENABLED:"no95typem-async-race-glitch=enabled",DISABLED:"no95typem-async-race-glitch=disabled"}},8149:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgRebootMsg=void 0;const a=s(4690),r=s(7469);class n extends r.DBusMsg{constructor(t,e,s){super(a.DBusTopics.APP_CTL,e,s),this.signal=t,this.rxIds=e,this.prefResponseRxIds=s}}e.DBusMsgRebootMsg=n},479:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgAppCtlReconfureReqMsg=void 0;const a=s(4690),r=s(7469);class n extends r.DBusMsg{constructor(t,e){super(a.DBusTopics.APP_CTL,t,e),this.rxIds=t,this.prefResponseRxIds=e}}e.DBusMsgAppCtlReconfureReqMsg=n},1069:(t,e)=>{"use strict";var s;Object.defineProperty(e,"__esModule",{value:!0}),e.CarActions=void 0,(s=e.CarActions||(e.CarActions={}))[s.CREATED=0]="CREATED",s[s.SELECTED=1]="SELECTED",s[s.REMOVED=2]="REMOVED",s[s.UPDATED=3]="UPDATED"},2223:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgCarActionMsg=void 0;const a=s(4690),r=s(7469);class n extends r.DBusMsg{constructor(t,e,s){super(a.DBusTopics.CAR_ACTION,e,s),this.action=t,this.rxIds=e,this.prefResponseRxIds=s}}e.DBusMsgCarActionMsg=n},9237:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgCarActionCreatedMsg=void 0;const a=s(1069),r=s(2223);class n extends r.DBusMsgCarActionMsg{constructor(t,e,s){super(a.CarActions.CREATED,e,s),this.car=t,this.rxIds=e,this.prefResponseRxIds=s}}e.DBusMsgCarActionCreatedMsg=n},8577:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgCarActionRemovedMsg=void 0;const a=s(1069),r=s(2223);class n extends r.DBusMsgCarActionMsg{constructor(t,e,s,r){super(a.CarActions.REMOVED,s,r),this.car=t,this.nullifiedContract=e,this.rxIds=s,this.prefResponseRxIds=r}}e.DBusMsgCarActionRemovedMsg=n},6911:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgCarActionSelectedMsg=void 0;const a=s(1069),r=s(2223);class n extends r.DBusMsgCarActionMsg{constructor(t,e,s,r){super(a.CarActions.SELECTED,s,r),this.car=t,this.notifyChanges=e,this.rxIds=s,this.prefResponseRxIds=r}}e.DBusMsgCarActionSelectedMsg=n},1682:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgGarageMsg=void 0;const a=s(4690),r=s(7469);class n extends r.DBusMsg{constructor(t,e){super(a.DBusTopics.GARAGE,t,e),this.rxIds=t,this.prefResponseRxIds=e}}e.DBusMsgGarageMsg=n},8455:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgGaragePageIsChangedMsg=void 0;const a=s(1682);class r extends a.DBusMsgGarageMsg{}e.DBusMsgGaragePageIsChangedMsg=r},9565:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgGarageRaceMsg=void 0;const a=s(4690),r=s(7469);class n extends r.DBusMsg{constructor(t,e){super(a.DBusTopics.GARAGE,t,e),this.rxIds=t,this.prefResponseRxIds=e}}e.DBusMsgGarageRaceMsg=n},8381:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgRaceRequestMsg=void 0;const a=s(9565);class r extends a.DBusMsgGarageRaceMsg{constructor(t,e){super(t,e),this.rxIds=t,this.prefResponseRxIds=e}}e.DBusMsgRaceRequestMsg=r},3018:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgGarageRaceStatusMsg=void 0;const a=s(9565);class r extends a.DBusMsgGarageRaceMsg{constructor(t,e,s){super(e,s),this.status=t,this.rxIds=e,this.prefResponseRxIds=s}}e.DBusMsgGarageRaceStatusMsg=r},7977:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgGarageResetMsg=void 0;const a=s(4690),r=s(7469);class n extends r.DBusMsg{constructor(t,e){super(a.DBusTopics.GARAGE,t,e),this.rxIds=t,this.prefResponseRxIds=e}}e.DBusMsgGarageResetMsg=n},3102:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgGarageResetReqMsg=void 0;const a=s(7977);class r extends a.DBusMsgGarageResetMsg{constructor(t,e){super(t,e),this.rxIds=t,this.prefResponseRxIds=e}}e.DBusMsgGarageResetReqMsg=r},6949:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgGarageStatusMsg=void 0;const a=s(1682);class r extends a.DBusMsgGarageMsg{constructor(t,e,s){super(e,s),this.status=t}}e.DBusMsgGarageStatusMsg=r},4768:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.GarageCompCtlAkaDirector=void 0;const r=s(2994),n=s(5856),i=s(4690),o=s(379),c=s(8577),l=s(1658),d=s(8990),h=s(1598),u=s(9237),p=s(8381),g=s(3102),m=a(s(3916)),_=a(s(4985)),E=s(7612),b=s(3173),C=s(8149),f=s(8455),R=s(745),T=s(3772);class S{constructor(t,e){this.tracksContainer=t,this.carCtlsBlock=e,this.hubName=n.DBUS_HUB_NAMES.GARAGE_CONTROLLER,this.txs=new Set,this.entriesPerPage=7,this.pagerContainer=document.createElement("div"),this.ctlBlocks=[],this.pagerCallback=async t=>{try{return await this.resetState(),await this.reloadData(t),!0}catch{return!1}},this.appCtlRXFunc=async t=>t.msg instanceof C.DBusMsgRebootMsg&&"reboot"===t.msg.signal?(await this.resetState(),await this.reloadData(),!0):r.DBUS_COMMON_RESPONSES.VOID,this.generatorRXFunc=async t=>(t.msg instanceof b.DBusMsgGenerateCarsMsg&&"end"===t.msg.status&&(await this.resetState(),await this.reloadData()),r.DBUS_COMMON_RESPONSES.VOID),this.racingRXFunc=async t=>t.msg instanceof p.DBusMsgRaceRequestMsg?(this.pager.toogleLock(!0),await this.performRace(),this.pager.toogleLock(!1),!0):t.msg instanceof g.DBusMsgGarageResetReqMsg?this.resetState():r.DBUS_COMMON_RESPONSES.VOID,this.carCtlsBlockBlockListener=t=>{t.preventDefault(),t.stopPropagation()},this.routingRestrainFunc=async()=>!1,this.carActionsRXFunc=async t=>{if(t.msg instanceof c.DBusMsgCarActionRemovedMsg||t.msg instanceof u.DBusMsgCarActionCreatedMsg){this.racePromise&&await this.racePromise;try{t.msg instanceof c.DBusMsgCarActionRemovedMsg&&this.garageManagersTeam.handleCarRm(t.msg.car),this.resetState().finally((()=>this.reloadData()))}catch{this.pager.tryChangePage("prev")}}return r.DBUS_COMMON_RESPONSES.VOID},this.createCarCtlBlock=(t,e)=>{const s=[t.btnSelect,t.btnStart,t.btnReset,t.btnRm];s.forEach((t=>{t.classList.add(_.default.btn,m.default["garage-bg__car-ctl-btn"])})),t.btnStart.classList.add(_.default["btn-15"]),t.btnSelect.classList.add(_.default["btn-13"]),t.btnReset.classList.add(_.default["btn-9"]),t.btnRm.classList.add(_.default["btn-4"]);const a=document.createElement("span");a.classList.add(m.default["garage-bg__car-ctl-block-number"]),a.textContent=e.toString();const r=document.createElement("div");return r.classList.add(m.default["garage-bg__car-ctl-block"]),r.append(a,...s),r},this.connectCtlAndTrack=(t,e)=>{t.addEventListener("mouseover",(()=>e.illuminateSelf(!0)),!0),t.addEventListener("mouseout",(()=>e.illuminateSelf(!1)),!0)},this.garageManagersTeam=new l.GarageManagersTeam(t,e,this.lockCallback),this.pager=new E.Pager(this.entriesPerPage,this.pagerCallback),this.setupPager()}setupPager(){const t=this.pager.getBtnNextPage();t.classList.add(_.default.btn,_.default["btn-6"],m.default["garage-bg__pager-btn"]);const e=this.pager.getBtnPrevPage();e.classList.add(_.default.btn,_.default["btn-6"],m.default["garage-bg__pager-btn"]);const s=this.pager.getPagerSpan();s.classList.add(m.default["garage-bg__pager-span"]),this.pagerContainer.classList.add(m.default["garage-bg__pager"]),this.pagerContainer.append(e,t,s)}async startWorking(){try{return await this.reloadData(),window.addEventListener("resize",(()=>this.redraw())),!0}catch{return!1}}async connect(t){this.txs.add(t.getNewTX("broadcast paging")),this.garageManagersTeam.autoConnect(t);const e=t.getNewRX(this.carActionsRXFunc,"monitor cars removes");t.plugRX(i.DBusTopics.CAR_ACTION,e);const s=t.getNewRX(this.racingRXFunc,"handle race requsets");t.plugRX(i.DBusTopics.GARAGE,s);const a=t.getNewRX(this.generatorRXFunc);t.plugRX(i.DBusTopics.GENERATE,a);const r=t.getNewRX(this.appCtlRXFunc,"handle app reboot msgs");t.plugRX(i.DBusTopics.APP_CTL,r)}async resetState(){const t=async()=>!1;return await this.toggleRoutingRestrains("restrain",t),new Promise(((t,e)=>{this.toggleCtlsBlockDisabled(!0),this.pager.toogleLock(!0),this.garageManagersTeam.resetState().then((()=>t(!0))).catch((t=>{e(t)})).finally((()=>{this.pager.toogleLock(!1),this.toggleCtlsBlockDisabled(!1)}))})).finally((()=>{this.toggleRoutingRestrains("unleash",t)}))}async lockCallback(t){return this.pager.toogleLock(t),!0}toggleCtlsBlockDisabled(t){!0===t?(this.carCtlsBlock.addEventListener("click",this.carCtlsBlockBlockListener,{capture:!0}),this.ctlBlocks.forEach(((t,e)=>{t.style.setProperty("--glitch-delay",e/this.ctlBlocks.length+"s"),t.classList.add(_.default["glitched-item"])}))):(this.carCtlsBlock.removeEventListener("click",this.carCtlsBlockBlockListener,{capture:!0}),this.ctlBlocks.forEach((t=>{t.classList.remove(_.default["glitched-item"]),t.style.removeProperty("--glitch-delay")})))}toggleRoutingRestrains(t,e){const s=new T.DBusMsgRoutingRestrainMsg(t,e||this.routingRestrainFunc),a=[];return this.txs.forEach((t=>{const e=t.transmit({msg:s,prepMode:R.DBusTXPrepModes.freeze,waitMode:R.DBusTXWaitModes.allSetled});a.push(e)})),Promise.allSettled(a)}async performRace(){return this.racePromise=this.garageManagersTeam.performRace().finally((()=>{this.racePromise=void 0})),this.racePromise}reloadData(t){return new Promise(((e,s)=>{const a=t?"next"===t?this.pager.getCurrPageNumber()+1:this.pager.getCurrPageNumber()-1:this.pager.getCurrPageNumber();o.REST_CLIENT_GARAGE.getCars(a,this.pager.getEntriesPerPage()).then((async r=>{const{limit:n,cars:i}=r;if(this.pager.setEntriesCount(Number.parseInt(n,10)),0===i.length){if(t)return void s();if(a>1)return await this.pager.tryChangePage("prev"),void e(!0)}this.broadcastPaging(),await this.garageManagersTeam.nullifyContracts();const o=[];i.forEach(((t,e)=>{const s=new h.TrackComp,a=new d.CarComp(t,e+1);s.placeCar(a),o.push({track:s,car:a})})),this.garageManagersTeam.addContracts(...o),this.garageManagersTeam.resetState(),this.redraw(),e(!0)}))}))}broadcastPaging(){const t=new f.DBusMsgGaragePageIsChangedMsg;this.txs.forEach((e=>{e.transmit({msg:t,prepMode:R.DBusTXPrepModes.freeze,waitMode:R.DBusTXWaitModes.nowait})}))}async redraw(){this.clearDOM();const t=this.calcGeometry();this.setStylesForTracks(t),this.drawTracks(),this.drawCarsCtls()}clearDOM(){for(;this.tracksContainer.firstChild;)this.tracksContainer.firstChild.remove();for(;this.carCtlsBlock.firstChild;)this.carCtlsBlock.firstChild.remove()}calcGeometry(){const t=window.getComputedStyle(this.tracksContainer),e=Number.parseFloat(t.height)-Number.parseFloat(t.paddingBottom)-Number.parseFloat(t.paddingTop),s=Math.min(window.innerWidth*S.CAR_WIDTH_RATIO,S.CAR_MAX_WIDTH)/S.CAR_IMG_RATIO,a=[];let r=0;const n=[...this.garageManagersTeam.getContracts()];n.forEach(((t,e)=>{const n=S.SCALE_FACTOR**e,i=s*n;r+=i,a.push(i)}));const i=r-e,o=a.sort(((t,e)=>t-e)),c=i>0?i/this.garageManagersTeam.getContracts().size-S.SKIPPED_PROGRESSION_MEMBERS_COUNT:0,l=[],d=(n.length-1)/2;n.forEach(((t,e)=>{const s=c*-(e-d)+S.DISPLACEMENT_FIX;l.push(s)}));const h=o[0]*S.CAR_IMG_RATIO,u=S.PADDING_SHIFT_BASE*window.innerWidth/S.PADDING_SHIFT_BASE_VW;return{trackHeights:o,displacements:l,paddingBase:h,paddingShift:u}}setStylesForTracks(t){const e=[...this.garageManagersTeam.getContracts()];e.forEach(((s,a)=>{s.track.rootElement.style.setProperty("height",`${t.trackHeights[a]}px`),s.track.rootElement.style.setProperty("top",`${t.displacements[a]}px`),s.track.rootElement.style.setProperty("z-index",`${a+1}`),s.track.rootElement.style.setProperty("--padding-w",t.trackHeights[t.trackHeights.length-1-a]*S.CAR_IMG_RATIO-t.paddingBase+t.paddingShift*(e.length-1-a)+"px")}))}drawTracks(){this.tracksContainer.append(this.pagerContainer,...[...this.garageManagersTeam.getContracts()].map((t=>(t.car.playFirstIntroAnim(),t.track.rootElement))))}drawCarsCtls(){const t=[...this.garageManagersTeam.getContracts()];this.ctlBlocks=t.map(((t,e)=>{const s=this.createCarCtlBlock(t.car,e+1);return this.connectCtlAndTrack(s,t.track),s})),this.carCtlsBlock.append(...this.ctlBlocks)}}e.GarageCompCtlAkaDirector=S,S.DISPLACEMENT_FIX=-24,S.CAR_WIDTH_RATIO=.2,S.CAR_MAX_WIDTH=1920*S.CAR_WIDTH_RATIO,S.SKIPPED_PROGRESSION_MEMBERS_COUNT=2,S.PADDING_SHIFT_BASE=35,S.PADDING_SHIFT_BASE_VW=1920,S.CAR_IMG_RATIO=3.78,S.SCALE_FACTOR=.95},1294:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GarageDriver=e.GarageDriverCommands=void 0;const a=s(1011),r=s(4590),n=s(9461),i=s(3231);var o;(o=e.GarageDriverCommands||(e.GarageDriverCommands={}))[o.START_DRIVING=0]="START_DRIVING",o[o.STOP_DRIVING=1]="STOP_DRIVING";class c{constructor(){this.emergencyAwaitServer=(t,e,s)=>{const r=new a.PopupStandaloneModalProgressComp;return r.setText("Connection is lost... awaiting server").setProgress(1),new Promise((a=>{const n=Date.now();let i,o=!1;const c=()=>{o=!0,i&&clearInterval(i),r.hide(),a(!1)};s?.finally((()=>{c()})),setTimeout((()=>{i=setInterval((()=>{if(o)return void clearInterval(i);r.show();const e=Date.now()-n;if(e<t){const s=e/t*100;r.setProgress(s)}else c()}),t/20)}),e)}))}}isFree(){return!this.contract}putBehindTheWheel(t){if(this.contract)throw new Error("ALREADY IN CAR");this.contract=t}async getOutOfTheCar(){this.contract=void 0}performDrivingProtocol(t){return new Promise(((e,s)=>{t&&this.contract?.car.disableCtls();const a=r.genUniqId();this.currDriveId=a,this.ignitionPromise=this.TurnOnTheIgnition().then((r=>{a!==this.currDriveId&&s(new Error("interrupted"));const n=this.drive(r,a,t);e({driveParams:r,drivePromise:n})})).catch((t=>{a!==this.currDriveId?s(new Error("interrupted")):s(t)}))}))}async TurnOnTheIgnition(){if(!this.contract)throw new Error("NOT_BEHIND_THE_WHEEL");this.drivePromise&&await Promise.allSettled([this.drivePromise]);const{car:t}=this.contract;return t.toggleIgniteAnim(!0),await n.REST_CLIENT_ENGINE.toggleEngine(t.currCar.id,"started").finally((()=>{t.toggleIgniteAnim(!1)}))}isInStartPosition(){return!this.currDriveId}async returnToStart(){if(this.currDriveId=void 0,this.contract)if(this.ignitionPromise&&await this.ignitionPromise,this.drivePromise){await this.stopCar(!0,!1),await this.contract.car.rollBack(this.drivePromise);const t=c.createMsgBlock();this.contract.track.rootElement.append(t);const e=new a.PopupStandaloneModalProgressComp;e.setText("I can't let the engine start again until\n          the server finishes its business, read the notes, please.").show(t);const s=this.updateProgress(e);await this.contract.car.playAwaitingAnim(this.drivePromise),s&&clearTimeout(s),e.hide(),t.remove()}else await this.stopCar(!1,!1),await this.contract.car.rollBack();return!0}updateProgress(t){const e=setInterval((()=>{if(this.lastTimeInMs&&this.lastStart){const e=(Date.now()-this.lastStart)/this.lastTimeInMs*100;t.setProgress(e)}else clearInterval(e)}),500);return e}static createMsgBlock(){const t=document.createElement("div");return t.style.setProperty("height","100%"),t.style.setProperty("width","40%"),t.style.setProperty("position","absolute"),t.style.setProperty("right","0px"),t.style.setProperty("top","100%"),t.style.setProperty("transform","translate(-40%, -120%)"),t}async drive(t,e,s){return new Promise(((a,r)=>{if(this.contract){const{contract:i}=this,o=c.calculateDriveTime(t);this.lastStart=Date.now(),this.lastTimeInMs=1e3*o,this.drivePromise=n.REST_CLIENT_ENGINE.enterDriveMode(i.car.currCar.id).then((t=>this.processSuccessfullDriveReslut(t,a,r,i,e,o,s))),this.controlCarAnim(i,a,r,o,s)}else r(new Error("No car"))}))}controlCarAnim(t,e,s,a,r){t.car.rollForward(a,!r).catch((()=>{e(!1)})).then((async t=>{t&&t>0&&(this.stopCar(!0,!0,!1,r),await this.emergencyAwaitServer(1e3*a,1e3,this.drivePromise)||s(new Error(i.REST_CLIENT_ERROR["Failed to fetch"])))}))}processSuccessfullDriveReslut(t,e,s,a,r,n,i){a!==this.contract||r!==this.currDriveId?s(new Error("interrupted")):t?(e(n),this.stopCar(!0,!0,!1,i)):(this.stopCar(!0,!1,!0,i),e(!1))}async stopCar(t=!1,e=!0,s=!1,a){if(this.contract)return s||t||await n.REST_CLIENT_ENGINE.toggleEngine(this.contract.car.currCar.id,"stopped"),await this.contract.car.stop(e,s,a),!0;throw new Error("No car")}static calculateDriveTime(t){return t.distance/1e3/t.velocity}}e.GarageDriver=c},1658:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.GarageManagersTeam=void 0;const r=s(745),n=s(6911),i=s(379),o=s(8577),c=s(1294),l=s(4590),d=a(s(3916)),h=s(928),u=s(3231),p=s(3018),g=s(3662),m=s(6670),_=s(3772),E=s(6949);class b{constructor(t,e,s){this.tracksContainer=t,this.carCtlsBlock=e,this.directorLockCb=s,this.txs=new Set,this.contracts=new Set,this.freeDrivers=new Set,this.busyDrivers=new Map,this.movingDrivers=new Map,this.winnerPopup=new m.GaragePopupWinner,this.carCtlsClickListener=t=>{if(t.target instanceof HTMLElement){const e=t.target;let s;e instanceof HTMLButtonElement?s=e:e.parentElement instanceof HTMLButtonElement&&(s=e.parentElement),s&&!0!==s.disabled&&this.contracts.forEach((t=>{if(!this.currRaceId){if(s!==t.car.btnSelect)return s===t.car.btnRm?(t.car.btnRm.disabled=!0,void this.handleRemoving(t)):s===t.car.btnStart?(t.car.btnStart.disabled=!0,void this.startDriving(t)):void(s===t.car.btnReset&&(t.car.btnReset.disabled=!0,this.handleRestoreState(t)));this.handleSelection(t)}}))}},this.routingRestrainFunc=async()=>!1,this.handleWinner=async(t,e,s)=>{s.flags.isFinishVisible=!0,this.tracksContainer.classList.add(d.default["garage__track-container_finish"]);const a=window.getComputedStyle(this.tracksContainer,"::after"),r=g.getTransitionDuration(a,"right");if(r){const t=Number.parseFloat(r);t>0&&await new Promise((e=>setTimeout(e,1e3*t)))}if(this.tracksContainer.classList.remove(d.default["synthwave-background_race-mode"]),s.flags.isRoadMoves=!1,this.currRaceId!==s.raceId)return;const n=t.car.currCar;b.saveWinner(n,e),this.winnerPopup.setData(n,e.toFixed(2),t.car.index?.toString()),this.tracksContainer.append(this.winnerPopup.rootElement)},this.carCtlsBlock.addEventListener("click",this.carCtlsClickListener),this.winnerPopup.rootElement.classList.add(d.default["garage__winner-popup"])}autoConnect(t){const e=t.getNewTX("garage serviceman");this.txs.add(e)}getContracts(){return this.contracts}handleCarRm(t){this.contracts.forEach((e=>{e.car.currCar.id===t.id&&this.busyDrivers.get(e)?.getOutOfTheCar()}))}async nullifyContracts(t){t?(this.tryFreeDrivers(...t),t.forEach((t=>{this.contracts.delete(t)}))):(this.tryFreeDrivers(...this.contracts),this.contracts.clear())}addContracts(...t){t.forEach((t=>this.contracts.add(t)))}async resetState(t){t||(this.currRaceId=void 0),this.winnerPopup.rootElement.remove(),this.tracksContainer.classList.remove(d.default["synthwave-background_race-mode"]),await this.rollbackCars(),this.broadcastGarageStatus("reset is not needed"),t||this.broadcastRaceStatus("READY_TO_GO")}async handleRestoreState(t){const e=this.busyDrivers.get(t);e&&(await e.returnToStart(),await this.broadcastIfAllInStart())}async broadcastIfAllInStart(){[...this.busyDrivers].every((t=>t[1].isInStartPosition()))&&this.broadcastGarageStatus("reset is not needed")}async startDriving(t,e){let s=this.busyDrivers.get(t);return s||(s=[...this.freeDrivers].find((t=>t.isFree())),s?this.freeDrivers.delete(s):s=new c.GarageDriver,this.busyDrivers.set(t,s),s.putBehindTheWheel(t)),this.movingDrivers.set(t,s),1===this.movingDrivers.size&&(await this.broadcastGarageStatus("need reset"),await this.toggleRoutingRestrains("restrain"),await this.broadcastGarageStatus("car moves")),s.performDrivingProtocol(e).then((e=>(e.drivePromise.finally((()=>{this.movingDrivers.delete(t),0===this.movingDrivers.size&&(this.toggleRoutingRestrains("unleash"),this.broadcastGarageStatus("all cars stopped"))})),e))).catch((e=>{throw this.movingDrivers.delete(t),0===this.movingDrivers.size&&(this.toggleRoutingRestrains("unleash"),this.broadcastGarageStatus("all cars stopped")),e}))}async broadcastGarageStatus(t){const e=new E.DBusMsgGarageStatusMsg(t),s=[];return this.txs.forEach((t=>{const a=t.transmit({msg:e,prepMode:r.DBusTXPrepModes.freeze,waitMode:r.DBusTXWaitModes.allSetled});s.push(a)})),Promise.allSettled(s)}toggleRoutingRestrains(t){const e=new _.DBusMsgRoutingRestrainMsg(t,this.routingRestrainFunc),s=[];return this.txs.forEach((t=>{const a=t.transmit({msg:e,prepMode:r.DBusTXPrepModes.freeze,waitMode:r.DBusTXWaitModes.allSetled});s.push(a)})),Promise.allSettled(s)}handleRemoving(t){i.REST_CLIENT_GARAGE.deleteCar(t.car.currCar.id).then((async()=>{await h.REST_CLIENT_WINNERS.deleteWinner(t.car.currCar.id).catch((()=>{})),this.tryFreeDrivers(t),this.contracts.delete(t);const e=new o.DBusMsgCarActionRemovedMsg(t.car.currCar,t);this.txs.forEach((t=>{t.transmit({msg:e,prepMode:r.DBusTXPrepModes.freeze,waitMode:r.DBusTXWaitModes.nowait})}))}))}handleSelection(t){const e=new n.DBusMsgCarActionSelectedMsg(t.car.currCar,this.genSelectCallback(t));this.txs.forEach((t=>{t.transmit({msg:e,prepMode:r.DBusTXPrepModes.freeze,waitMode:r.DBusTXWaitModes.nowait})}))}async rollbackCars(){if(this.rollbackPromise)return void await this.rollbackPromise;this.tracksContainer.classList.remove(d.default["garage__track-container_finish"]),this.tracksContainer.style.setProperty("--translate-x","0px");const t=[];this.busyDrivers.forEach((e=>{t.push(e.returnToStart())})),this.rollbackPromise=Promise.all(t).finally((()=>{this.rollbackPromise=void 0})),await this.rollbackPromise}async performRace(){const t=l.genUniqId();if(this.currRaceId=t,await this.resetState(!0),t!==this.currRaceId)return;const e={raceId:t,arrivedByOrder:[],notArrived:[],participantsCount:this.contracts.size,flags:{roadElem:this.tracksContainer,isFinishVisible:!1},stratedCount:0};this.broadcastRaceStatus("IN_PROCESS"),await this.processRace(e).catch((e=>{if(t===this.currRaceId)throw e})).finally((()=>{this.tracksContainer.classList.remove(d.default["synthwave-background_race-mode"])})),t===this.currRaceId&&this.broadcastRaceStatus("NEED_RESET")}broadcastRaceStatus(t){const e=new p.DBusMsgGarageRaceStatusMsg(t);this.txs.forEach((t=>{t.transmit({msg:e,prepMode:r.DBusTXPrepModes.freeze,waitMode:r.DBusTXWaitModes.nowait})}))}processRace(t){return new Promise((e=>{this.contracts.forEach((s=>{this.startDriving(s,t.flags).then((a=>{if(t.raceId===this.currRaceId){if(t.stratedCount===t.participantsCount-1?(this.tracksContainer.classList.add(d.default["synthwave-background_race-mode"]),t.flags.isRoadMoves=!0):t.stratedCount++,a instanceof Error)throw a;a.drivePromise.then((e=>this.handleDriveResult(t,s,e))).catch((t=>{"interrupted"===t.message&&e(!1)})).finally((()=>{t.arrivedByOrder.length+t.notArrived.length===t.participantsCount&&e(t)}))}else e(!1)}))}))}))}handleDriveResult(t,e,s){t.raceId===this.currRaceId&&(!1!==s?(0===t.arrivedByOrder.length&&this.handleWinner(e,s,t),t.arrivedByOrder.push(e)):t.notArrived.push(e))}static saveWinner(t,e){h.REST_CLIENT_WINNERS.getWinner(t.id).then((t=>{const s={id:t.id,wins:t.wins+1,time:e<t.time?Number.parseFloat(e.toFixed(2)):t.time};h.REST_CLIENT_WINNERS.updateWinner(s)})).catch((s=>{if(s.message===u.REST_CLIENT_ERROR.NOT_FOUND){const s={id:t.id,wins:1,time:Number.parseFloat(e.toFixed(2))};h.REST_CLIENT_WINNERS.createWinner(s)}}))}tryFreeDrivers(...t){t.forEach((t=>{const e=this.busyDrivers.get(t);e&&e.getOutOfTheCar().then((()=>{this.busyDrivers.delete(t),this.freeDrivers.add(e)}))}))}genSelectCallback(t){return e=>{this.contracts.has(t)&&t.car.updateData(e)}}}e.GarageManagersTeam=b},8785:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.GarageComp=void 0;const r=s(1168),n=s(5856),i=s(4768),o=s(44),c=a(s(3916)),l=s(1011);class d extends r.BaseComp{constructor(){super("section"),this.hubName=n.DBUS_HUB_NAMES.GARAGE,this.isControllerWorking=!1,this.mainControlsComp=new o.MainControlsComp,this.carsCtlsBlock=document.createElement("div"),this.bgVideo=document.createElement("video"),this.popup=new l.PopupStandaloneModalProgressComp,this.bgVideoProgressListener=()=>{if(this.bgVideo.buffered.length>0){const t=this.bgVideo.buffered.end(0)/this.bgVideo.duration*100;this.popup.setProgress(t)}},this.bgVideoCanPlayListener=async()=>{this.bgVideo.removeEventListener("canplaythrough",this.bgVideoCanPlayListener),this.bgVideo.removeEventListener("progress",this.bgVideoProgressListener),this.popup.setProgress(100).reset().hide(),this.isControllerWorking=await this.controller.startWorking()},this.notify=async()=>{try{this.bgVideo.play()}catch{}this.isControllerWorking||(this.isControllerWorking=await this.controller.startWorking())},this.popup.setText("Loading...").setProgress(1).show(),this._rootElement.classList.add(c.default.garage);const t=document.createElement("div");t.classList.add(c.default["garage-bg__self-ctls-block"]),t.append(this.mainControlsComp.rootElement);const e=document.createElement("div");e.classList.add(c.default.garage__bg,c.default["garage-bg"]),e.append(this.bgVideo,t);const s=document.createElement("div");s.classList.add(c.default["garage__track-container"],c.default["synthwave-background"]),this.carsCtlsBlock.classList.add(c.default["garage-bg__cars-ctls-block"]),this.controller=new i.GarageCompCtlAkaDirector(s,this.carsCtlsBlock),this.setupBgVideo(),this._rootElement.append(e,s,this.carsCtlsBlock)}setupBgVideo(){this.bgVideo.addEventListener("progress",this.bgVideoProgressListener),this.bgVideo.addEventListener("canplaythrough",this.bgVideoCanPlayListener),this.renderBgVideo()}renderBgVideo(){this.bgVideo.classList.add(c.default["garage-bg__video"]),this.bgVideo.controls=!1,this.bgVideo.loop=!0,this.bgVideo.defaultMuted=!0,this.bgVideo.muted=!0,this.bgVideo.autoplay=!0,this.bgVideo.src="./assets/videos/bg/cyberpunk2077-garage.mp4"}connect(t){t.attachSubHub(this.controller),t.attachSubHub(this.mainControlsComp)}}e.GarageComp=d},8990:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.CarComp=void 0;const r=s(1168),n=s(9007),i=s(5094),o=a(s(6010)),c=a(s(3916)),l=a(s(4985)),d=s(3662);class h extends r.BaseComp{constructor(t,e){super("div"),this._currCar=t,this.index=e,this.canvas=document.createElement("canvas"),this.tireBack=document.createElement("img"),this.btnSelect$=document.createElement("button"),this.btnRm$=document.createElement("button"),this.spanCarName$=document.createElement("span"),this.btnStart$=document.createElement("button"),this.btnReset$=document.createElement("button"),this.isReseted=!0,this.movingClassName=c.default["synthwave-background_race-mode"],this.observerFunc=t=>{t.forEach((t=>{t.oldValue?.includes(this.movingClassName)?(this.currOutOfSceneAnim?.pause(),this.observer.disconnect()):t.target.classList.contains(this.movingClassName)&&this.outOfScene()}))},this.calcDestinationInPercents=t=>{const e=Number.parseFloat(t.parentStyle.width)-Number.parseFloat(t.parentStyle.paddingLeft)-Number.parseFloat(t.parentStyle.paddingRight),s=Number.parseFloat(t.selfStyle.width);return(e-s)/s*100},this._rootElement.classList.add(o.default["car-div"]),this.canvas.classList.add(o.default["car-div__canvas"]),this._rootElement.append(this.canvas),this.renderBtns(),this.renderCar(),this.btnReset$.disabled=!0,this.observer=new MutationObserver(this.observerFunc)}renderCar(){h.drawCar(this.canvas,this._currCar.color),h.drawWheels(this._rootElement),this.spanCarName$.textContent=`${this.index}: ${this._currCar.name}`}renderBtns(){const t=document.createElement("span"),e=document.createElement("span"),s=document.createElement("span"),a=document.createElement("span");t.textContent="select",e.textContent="remove",s.textContent="start!",a.textContent="reset",this.btnSelect$.append(t),this.btnRm$.append(e),this.btnReset$.append(a),this.btnStart$.append(s)}static drawWheels(t){const e=new Image;e.src=h.CAR_WHEEL_IMG_SRC,e.onload=()=>{e.classList.add(o.default["car-div__wheel"]);const s=i.OBJ_PROCESSOR.deepClone(e);e.classList.add(o.default["car-div__wheel_forward"]),s.classList.add(o.default["car-div__wheel_backward"]),t.append(e),t.append(s)}}updateData(t){this._currCar=t,h.drawCar(this.canvas,this._currCar.color),this.spanCarName$.textContent=`${this.index}: ${t.name}`}toggleIgniteAnim(t){t?this._rootElement.classList.add(o.default["car-div_ignite"]):this._rootElement.classList.remove(o.default["car-div_ignite"])}async rollBack(t=Promise.resolve()){return new Promise((e=>{(async()=>{this.isReseted||(this.observer.disconnect(),this._rootElement.classList.remove(o.default["car-div_borken"]),await this.playOutAnim(),this.currOutOfSceneAnim&&(this.currOutOfSceneAnim.cancel(),d.commitStyles(this.currOutOfSceneAnim),this.currOutOfSceneAnim=void 0),this.currAnimation&&(await this.stop(),this.currAnimation.playbackRate=-10,this.currAnimation.play(),await this.currAnimation.finished,d.commitStyles(this.currAnimation),this.currAnimation=void 0,this._rootElement.classList.remove(o.default["car-div_rollForward"])),this._rootElement.style.removeProperty("transition"),this._rootElement.style.removeProperty("transform"),await this.playInAnim(),this._rootElement.style.removeProperty("opacity"),t.finally((()=>{this.btnStart$.disabled=!1,this.btnReset$.disabled=!0,this.btnRm$.disabled=!1,this.btnSelect$.disabled=!1}))),this.isReseted=!0,e(!0)})()}))}async playOutAnim(){if(document.body.classList.contains(l.default["no-glitch"]))return;const t=this._rootElement.animate([{opacity:"0.5"},{opacity:"0.9"},{opacity:"0.3"},{opacity:"0.7"},{opacity:"0.1"},{opacity:"0.4"},{opacity:"0"}],{duration:300,easing:"linear",fill:"forwards"});await t.finished,d.commitStyles(t)}async playAwaitingAnim(t){return new Promise((e=>{let s;document.body.classList.contains(l.default["no-glitch"])||(s=this._rootElement.animate([{opacity:"0"},{opacity:"0.6"},{opacity:"0.3"},{opacity:"0.8"},{opacity:"0.3"},{opacity:"0.6"},{opacity:"0"}],{duration:400,easing:"linear",fill:"forwards",iterations:Number.POSITIVE_INFINITY})),t.finally((()=>{s&&(s.cancel(),d.commitStyles(s)),e()}))}))}async playFirstIntroAnim(t=500){const e=this._rootElement.animate([{opacity:"0",filter:"blur(30px)"},{opacity:"1",filter:"none"}],{duration:t,easing:"ease-in-out",fill:"forwards"});await e.finished,d.commitStyles(e)}async playInAnim(t=300){if(document.body.classList.contains(l.default["no-glitch"]))return;const e=this._rootElement.animate([{opacity:"0"},{opacity:"0.6"},{opacity:"0.3"},{opacity:"0.8"},{opacity:"0.5"},{opacity:"1"}],{duration:t,easing:"linear",fill:"forwards"});await e.finished,d.commitStyles(e)}outOfScene(){this.isReseted=!1,this.currOutOfSceneAnim=this._rootElement.animate([{transform:"translateX(-1000%)"}],{duration:3600,easing:"ease-in",fill:"forwards"})}disableCtls(){this.btnStart$.disabled=!0,this.btnRm$.disabled=!0,this.btnSelect$.disabled=!0,this.btnReset$.disabled=!0}async rollForward(t,e=!0){return this.isReseted=!1,new Promise(((s,a)=>{e&&(this.btnStart$.disabled=!0,this.btnRm$.disabled=!0,this.btnSelect$.disabled=!0,this.btnReset$.disabled=!1);const r=this.getStyles(),n=this.calcDestinationInPercents(r);this._rootElement.classList.add(o.default["car-div_rollForward"]),this.currAnimation=this._rootElement.animate([{transform:`translateX(${n}%)`}],{duration:1e3*t+1e3,easing:"ease-in-out",fill:"forwards"}),this.currAnimation.onfinish=()=>{s(this.currAnimation?.playbackRate)},this.currAnimation.oncancel=()=>{this._rootElement.classList.remove(o.default["car-div_rollForward"]),a()}}))}getStyles(){return{parentStyle:window.getComputedStyle(this._rootElement.parentElement),selfStyle:window.getComputedStyle(this.rootElement)}}async stop(t=!0,e=!1,s){if(t&&await new Promise((t=>{"running"===this.currAnimation?.playState?(this.currAnimation.addEventListener("finish",(()=>t(!0))),this.currAnimation.addEventListener("cancel",(()=>t(!0)))):t(!0)})),this._rootElement.classList.remove(o.default["car-div_rollForward"]),this.currAnimation?.pause(),e){if(s){const t=s.roadElem;t.classList.contains(this.movingClassName)&&this.outOfScene(),this.observer.observe(t,{attributes:!0,attributeOldValue:!0})}this.playExplosionAnim(),this._rootElement.classList.add(o.default["car-div_borken"])}}playExplosionAnim(){const t=new Image;let e=0;t.classList.add(o.default["car-div__explosion"]),t.src=`${h.CAR_EXPLOSION_IMG_DATA.BASE_URL}${e}${h.CAR_EXPLOSION_IMG_DATA.EXTENSION}`,t.onload=async()=>{this._rootElement.append(t),await new Promise((t=>setTimeout(t,h.CAR_EXPLOSION_IMG_DATA.FRAME_TIME_MS))),e++,e<h.CAR_EXPLOSION_IMG_DATA.FRAMES_COUNT?t.src=`${h.CAR_EXPLOSION_IMG_DATA.BASE_URL}${e}${h.CAR_EXPLOSION_IMG_DATA.EXTENSION}`:t.remove()}}get currCar(){return this._currCar}get btnSelect(){return this.btnSelect$}get btnRm(){return this.btnRm$}get btnStart(){return this.btnStart$}get btnReset(){return this.btnReset$}get spanCarName(){return this.spanCarName$}static drawCar(t,e){const s=new Image;s.src=h.CAR_BODY_IMG_SRC,s.onload=()=>{t.height=s.height/3,t.width=s.width/3;const a=t.getContext("2d");a&&(a.shadowColor=e,a.shadowBlur=25,a.drawImage(s,0,0,t.width,t.height)),h.paintCarBody(t,e)}}static paintCarBody(t,e){const s=t.getContext("2d")?.getImageData(0,0,t.width,t.height);if(s){const a=n.hexToRgb(e);for(let t=0;t<s.width;t++)for(let e=0;e<s.height;e++){const r=4*e*s.width+4*t,n=s.data[r],i=s.data[r+1],o=s.data[r+2],c=2*o-n-i,l=10,d=70;n>d&&i>d&&o>d&&c<l&&(s.data[r]=n/255*a.r,s.data[r+1]=i/255*a.g,s.data[r+2]=o/255*a.b)}t.getContext("2d")?.putImageData(s,0,0,0,0,t.width,t.height)}}static genPreview(t){const e=document.createElement("div"),s=document.createElement("canvas");return s.classList.add(o.default["car-div__canvas"]),e.append(s),h.drawWheels(e),h.drawCar(s,t.color),e}}e.CarComp=h,h.TIMING_FUNCTION="cubic-bezier(.72,.2,.54,.77)",h.CAR_BODY_IMG_SRC="./assets/imgs/cars/body.gif",h.CAR_WHEEL_IMG_SRC="./assets/imgs/cars/tire back.gif",h.CAR_EXPLOSION_IMG_DATA={BASE_URL:"./assets/imgs/cars/explosion/",EXTENSION:".png",FRAMES_COUNT:9,FRAME_TIME_MS:200}},4312:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CreateCompController=void 0;const a=s(745),r=s(379),n=s(9237),i=s(8982);class o extends i.CreateUpdateCompControllerProto{constructor(t){super(t.inputText,t.inputColor,t.btn),this.txs=new Set,this.setupBtnCreate()}setupBtnCreate(){this.btn.addEventListener("click",(()=>{if(!this.reportValidity())return;this.btn.disabled=!0;const t={name:this.inputText.value,color:this.inputColor.value};r.REST_CLIENT_GARAGE.createCar(t).then((t=>{const e=new n.DBusMsgCarActionCreatedMsg(t);this.txs.forEach((t=>{t.transmit({msg:e,prepMode:a.DBusTXPrepModes.clone,waitMode:a.DBusTXWaitModes.nowait})}))})).finally((()=>{this.btn.disabled=!1}))}))}autoConnect(t){const e=t.getNewTX("send created car msgs");this.txs.add(e)}}e.CreateCompController=o},8982:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CreateUpdateCompControllerProto=void 0,e.CreateUpdateCompControllerProto=class{constructor(t,e,s){this.inputText=t,this.inputColor=e,this.btn=s,this.ctlsStateMap=new Map,this.ctls=[this.inputText,this.inputColor,this.btn],this.disabled=!1}reportValidity(){const{length:t}=this.inputText.value;let e=!0;return 0===t&&(this.inputText.setCustomValidity("Please, enter a name"),e=!1),t>30&&(this.inputText.setCustomValidity("Name is too long!"),e=!1),!!e||(this.inputText.pattern="",this.inputText.reportValidity(),this.inputText.removeAttribute("pattern"),!1)}toogleCtlsDisabled(t){this.inputText.disabled=t,this.inputColor.disabled=t,this.btn.disabled=t}pushCtlsState(){this.ctls.forEach((t=>{this.ctlsStateMap.set(t,t.disabled)}))}popCtlsState(){this.ctls.forEach((t=>{const e=this.ctlsStateMap.get(t);void 0!==e&&(t.disabled=e)})),this.ctlsStateMap.clear()}disable(){this.disabled||(this.disabled=!0,this.pushCtlsState(),this.toogleCtlsDisabled(!0))}enable(){this.disabled&&(this.disabled=!1,this.popCtlsState())}}},2477:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UpdateCompController=void 0;const a=s(5094),r=s(2994),n=s(4690),i=s(379),o=s(8577),c=s(6911),l=s(8455),d=s(8982);class h extends d.CreateUpdateCompControllerProto{constructor(t){super(t.inputText,t.inputColor,t.btn),this.garageMsgsListener=async t=>(t.msg instanceof l.DBusMsgGaragePageIsChangedMsg&&this.reset(),r.DBUS_COMMON_RESPONSES.VOID),this.carActionsListener=async t=>(t.msg instanceof c.DBusMsgCarActionSelectedMsg&&(this.choosedCar=a.OBJ_PROCESSOR.deepClone(t.msg.car),this.notifyCb=t.msg.notifyChanges,this.inputColor.value=t.msg.car.color,this.inputText.value=t.msg.car.name,this.toogleCtlsDisabled(!1)),t.msg instanceof o.DBusMsgCarActionRemovedMsg&&t.msg.car.id===this.choosedCar?.id&&this.reset(),r.DBUS_COMMON_RESPONSES.VOID),this.setupBtnUpdate()}autoConnect(t){const e=t.getNewRX(this.carActionsListener,"listen car choosing");t.plugRX(n.DBusTopics.CAR_ACTION,e);const s=t.getNewRX(this.garageMsgsListener,"listen garage paging");t.plugRX(n.DBusTopics.GARAGE,s)}reset(){this.notifyCb=void 0,this.choosedCar=void 0,this.inputText.value="",this.inputColor.value="#000000",this.toogleCtlsDisabled(!0)}setupBtnUpdate(){this.toogleCtlsDisabled(!0),this.btn.addEventListener("click",(()=>{this.reportValidity()&&(this.toogleCtlsDisabled(!0),this.choosedCar&&(this.choosedCar.color=this.inputColor.value,this.choosedCar.name=this.inputText.value,i.REST_CLIENT_GARAGE.updateCar(this.choosedCar).then((t=>{this.notifyCb&&this.notifyCb(t)})).finally((()=>{this.toogleCtlsDisabled(!1)}))))}))}}e.UpdateCompController=h},3525:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.CreateUpdateComponent=void 0;const r=s(1168),n=s(5856),i=s(4312),o=s(2477),c=a(s(2022)),l=a(s(4985));class d extends r.BaseComp{constructor(t,e){super("div"),this.hubName=n.DBUS_HUB_NAMES.CREATE_UPDATE,this.textInput=document.createElement("input"),this.colorInput=document.createElement("input"),this.btn=document.createElement("button"),this._rootElement.classList.add(c.default.root),this.textInput.type="text",this.textInput.classList.add(c.default["text-input"]),this.colorInput.type="color",this.colorInput.classList.add(c.default["color-input"]),this.btn.textContent=e,this.btn.classList.add(l.default.btn),this._rootElement.append(this.textInput,this.colorInput,this.btn);const s={inputText:this.textInput,inputColor:this.colorInput,btn:this.btn};switch(t){case"UPDATE":this.controller=new o.UpdateCompController(s),this.btn.classList.add(l.default["btn-13"]);break;case"CREATE":default:this.controller=new i.CreateCompController(s),this.btn.classList.add(l.default["btn-13"])}}getController(){return this.controller}connect(t){this.controller.autoConnect(t)}}e.CreateUpdateComponent=d},3173:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgGenerateCarsMsg=void 0;const a=s(4690),r=s(7469);class n extends r.DBusMsg{constructor(t,e,s){super(a.DBusTopics.GENERATE,e,s),this.status=t,this.rxIds=e,this.prefResponseRxIds=s}}e.DBusMsgGenerateCarsMsg=n},44:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.MainControlsComp=void 0;const r=s(1168),n=s(3525),i=s(5856),o=s(8381),c=s(745),l=s(3102),d=a(s(7715)),h=a(s(4985)),u=s(379),p=s(9653),g=s(4590),m=s(2994),_=s(3018),E=s(4690),b=s(3173),C=s(1011),f=s(6949);class R extends r.BaseComp{constructor(){super("div"),this.hubName=i.DBUS_HUB_NAMES.MAIN_CONTROLS,this.txs=new Set,this.createComponent=new n.CreateUpdateComponent("CREATE","create"),this.updateComponent=new n.CreateUpdateComponent("UPDATE","update"),this.btnRace=document.createElement("button"),this.btnReset=document.createElement("button"),this.btnGenerate=document.createElement("button"),this.popup=new C.PopupStandaloneModalProgressComp,this.generateClickListener=async()=>{this.btnGenerate.disabled=!0;const t=new b.DBusMsgGenerateCarsMsg("start"),e=[];this.txs.forEach((s=>{const a=s.transmit({msg:t,prepMode:c.DBusTXPrepModes.freeze,waitMode:c.DBusTXWaitModes.allSetled});e.push(a)})),await Promise.allSettled(e),this.popup.reset().setText("please wait while the entries are generated").show(),this.generate(100,void 0,this.genCb).finally((()=>{this.popup.reset().hide();const t=new b.DBusMsgGenerateCarsMsg("end");this.txs.forEach((e=>{e.transmit({msg:t,prepMode:c.DBusTXPrepModes.freeze,waitMode:c.DBusTXWaitModes.nowait})})),this.btnGenerate.disabled=!1}))},this.genCb=t=>{this.popup.setProgress(t)},this.raceClickListener=async()=>{this.btnRace.disabled=!0,this.btnGenerate.disabled=!0;const t=new o.DBusMsgRaceRequestMsg;this.txs.forEach((e=>{e.transmit({msg:t,prepMode:c.DBusTXPrepModes.freeze,waitMode:c.DBusTXWaitModes.allSetled})}))},this.resetClickListener=async()=>{this.btnReset.disabled=!0,this.btnGenerate.disabled=!0;const t=new l.DBusMsgGarageResetReqMsg;this.txs.forEach((e=>{e.transmit({msg:t,prepMode:c.DBusTXPrepModes.freeze,waitMode:c.DBusTXWaitModes.allSetled})}))},this.genRandomCarName=()=>{const t=g.getRandomInt(p.CAR_MODEL_LIST_KEYS.length-1),e=p.CAR_MODEL_LIST_KEYS[t],s=p.CAR_MODEL_LIST[e];return`${e} ${s[g.getRandomInt(s.length-1)]}`},this.rxFuncForRaceMsgs=async t=>{if(t.msg instanceof _.DBusMsgGarageRaceStatusMsg){const{status:e}=t.msg;switch(e){case"READY_TO_GO":this.btnRace.disabled=!1,this.btnReset.disabled=!0,this.btnGenerate.disabled=!1,this.createComponent.getController().enable(),this.updateComponent.getController().enable();break;case"IN_PROCESS":this.btnRace.disabled=!0,this.btnReset.disabled=!1,this.btnGenerate.disabled=!0,this.createComponent.getController().disable(),this.updateComponent.getController().disable();break;case"NEED_RESET":this.btnRace.disabled=!0,this.btnReset.disabled=!1,this.btnGenerate.disabled=!1,this.createComponent.getController().enable(),this.updateComponent.getController().enable()}}return m.DBUS_COMMON_RESPONSES.VOID},this.rxFuncForGarageMsgs=async t=>{if(t.msg instanceof f.DBusMsgGarageStatusMsg)switch(t.msg.status){case"car moves":this.btnGenerate.disabled=!0,this.createComponent.getController().disable(),this.updateComponent.getController().disable();break;case"all cars stopped":this.btnGenerate.disabled=!1,this.createComponent.getController().enable(),this.updateComponent.getController().enable();break;case"need reset":this.btnReset.disabled=!1;break;case"reset is not needed":this.btnReset.disabled=!0}},this._rootElement.classList.add(d.default["main-controls"]);const t=this.renderBtns();this.btnRace.addEventListener("click",this.raceClickListener),this.btnReset.addEventListener("click",this.resetClickListener),this.btnGenerate.addEventListener("click",this.generateClickListener),this.btnReset.disabled=!0,this.btnRace.disabled=!0,this._rootElement.append(this.createComponent.rootElement,this.updateComponent.rootElement,t)}renderBtns(){const t=document.createElement("span");t.textContent="race",this.btnRace.append(t),this.btnRace.classList.add(h.default.btn,h.default["btn-15"]),this.btnReset.textContent="reset",this.btnReset.classList.add(h.default.btn,h.default["btn-9"]),this.btnGenerate.textContent="generate cars",this.btnGenerate.classList.add(h.default.btn,h.default["btn-1"]);const e=document.createElement("div");return e.classList.add(d.default["btn-block"]),e.append(this.btnRace,this.btnReset,this.btnGenerate),e}async generate(t,e,s){let a=e||t;const r={name:this.genRandomCarName(),color:g.genRandomHexColor()};return await u.REST_CLIENT_GARAGE.createCar(r),a--,s&&s(100*(1-a/t)),!(a>0)||this.generate(t,a,s)}connect(t){t.attachSubHub(this.createComponent,"cu_create"),t.attachSubHub(this.updateComponent,"cu_delete");const e=t.getNewRX(this.rxFuncForRaceMsgs,"toggle btns in main-ctls-block");t.plugRX(E.DBusTopics.GARAGE,e);const s=t.getNewRX(this.rxFuncForGarageMsgs,"toggle btns in main-ctls-block");t.plugRX(E.DBusTopics.GARAGE,s);const a=t.getNewTX("start race | broadcast generate");this.txs.add(a)}}e.MainControlsComp=R},6670:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GaragePopupWinner=void 0;const a=s(1168);class r extends a.BaseComp{constructor(){super("div"),this.header=document.createElement("h3"),this.textTime=document.createElement("span"),this.textName=document.createElement("span"),this.textId=document.createElement("span"),this.textNumber=document.createElement("span"),this.header.textContent="WE HAVE A WINNER!",this._rootElement.append(this.header,this.textTime,this.textName,this.textId,this.textNumber)}setData(t,e,s){this.textTime.textContent=`Time: ${e}s`,this.textName.textContent=`Name of the car: \n ${t.name}`,this.textId.textContent=`ID of the car: ${t.id}`,this.textNumber.textContent=s?`Position on the track: ${s}`:""}}e.GaragePopupWinner=r},1598:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.TrackComp=void 0;const r=s(1168),n=a(s(2096));class i extends r.BaseComp{constructor(){super("div"),this.topBlock=document.createElement("div"),this.illuminateSelf=t=>{t?this._rootElement.classList.add(n.default.track_illuminated):this._rootElement.classList.remove(n.default.track_illuminated)},this._rootElement.classList.add(n.default.track),this._rootElement.append(),this.topBlock.classList.add(n.default["track__controls-block"])}placeCar(t){this._rootElement.hasChildNodes()&&this._rootElement.childNodes.forEach((t=>t.remove())),this.topBlock.append(t.spanCarName),this._rootElement.append(this.topBlock,t.rootElement)}}e.TrackComp=i},4977:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.HeaderComponent=void 0;const r=s(1168),n=s(2994),i=s(5856),o=s(4690),c=s(7950),l=s(5633),d=a(s(3544)),h=s(9546);class u extends r.BaseComp{constructor(t=i.DBUS_HUB_NAMES.HEADER){super("header"),this.hubName=t,this.buses=[],this.illuminateNavItem=async t=>{const{msg:e}=t;return e instanceof c.DBusMsgRouteIsChangedMsg&&this.anchors.forEach((t=>{t.getAttribute("href")===e.newRoute?t.classList.add(d.default["header-nav__anchor_active"]):t.classList.remove(d.default["header-nav__anchor_active"])})),e instanceof l.DBusMsgRoutingStatusMsg&&("restrained"===e.status?this.navContainer.classList.add(d.default["header-nav_not-active"]):"free"===e.status&&this.navContainer.classList.remove(d.default["header-nav_not-active"])),n.DBUS_COMMON_RESPONSES.VOID},this.rootElement.classList.add(d.default.header),this.logo=u.renderLogo(),this.rootElement.append(this.logo),this.navContainer=document.createElement("nav"),this.navContainer.classList.add(d.default["header-nav"]),this.rootElement.append(this.navContainer);const e=document.createElement("ul");e.classList.add(d.default["header-nav__list"]),this.navContainer.append(e);const s={li:d.default["header-nav__item"],a:d.default["header-nav__anchor"],svg:d.default["header-nav__svg"],span:d.default["header-nav__span"]},a=[new h.NavItem("garage","#garage",s),new h.NavItem("winners","#winners",s)];this.anchors=a.map((t=>t.anchor)),e.append(...a.map((t=>t.rootElement)))}static renderLogo(){const t=document.createElement("h1");t.classList.add(d.default.header__logo);const e=document.createElement("span");e.textContent="async",e.dataset.textContent="async";const s=document.createElement("span");return s.textContent="race",s.dataset.textContent="race",t.append(e,s),t}connect(t){const e=t.getNewRX(this.illuminateNavItem,"illuminate nav items");t.plugRX(o.DBusTopics.ROUTING,e)}}e.HeaderComponent=u},9546:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NavItem=void 0;const a=s(1168);class r extends a.BaseComp{constructor(t,e,s,a){super("li"),s?.li&&this._rootElement.classList.add(s.li),this._anchor=document.createElement("a"),this._anchor.setAttribute("href",e),s?.a&&this._anchor.classList.add(s.a),a&&(this.iconImage=document.createElement("img"),this.iconImage.src=a,s?.svg&&this.iconImage.classList.add(s.svg),this._anchor.append(this.iconImage)),this.span=document.createElement("span"),this.span.textContent=t,this.span.dataset.textContent=t,s?.span&&this.span.classList.add(s.span),this._anchor.append(this.span),this.rootElement.append(this._anchor)}get anchor(){return this._anchor}}e.NavItem=r},1179:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PopupStandaloneModalChoiceFirstOpenComp=void 0;const r=s(7362),n=a(s(9541)),i=a(s(4985));class o extends r.PopupStandaloneModalChoiceComp{constructor(){super(),this.TEXT_CONTENT=o.TEXT_CONTENT_ENG,this.body.classList.add(n.default.body),this.renderText();const t=document.createElement("button"),e=document.createElement("span"),s=document.createElement("span");s.textContent="enable glitch",s.dataset.textContent="enable glitch",e.append(s),t.append(e),s.classList.add(n.default.glitch),t.classList.add(n.default["glitch-parent"]);const a=document.createElement("button"),r=document.createElement("span");r.textContent="disable glitch",a.append(r),this.btns.push(t,a),this.mapBtnsAndChoices({btn:t,desicion:"enable glitch"},{btn:a,desicion:"disable glitch"}),this.btns.forEach((t=>{t.classList.add(i.default.btn,i.default["btn-6"],n.default.btn)})),this.btnBlock.append(...this.btns),this.btnBlock.classList.add(n.default["btn-block"])}renderText(){this.header.textContent=this.TEXT_CONTENT.HEADER,this.text.textContent=this.TEXT_CONTENT.TEXT}}e.PopupStandaloneModalChoiceFirstOpenComp=o,o.TEXT_CONTENT_ENG={HEADER:"Welcome to ASYNC RACE by no95typem",TEXT:'Hey! Before starting,\n      I ask you to restart the server\n      because I cannot predict what was done with it before me!\n      In addition, the application seems to be overloaded with effects,\n      some of which can be dangerous for people with epilepsy.\n      So choose whether to disable them or not.\n      And please read the notes on the "Winners" page.'}},5794:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PopupStandaloneModalListCredits=void 0;const a=s(4278);class r extends a.PopupStandaloneModalList{constructor(){super(r.TEXT_CONTENT_ENG)}}e.PopupStandaloneModalListCredits=r,r.TEXT_CONTENT_ENG={HEADER:"CREDITS",P1:"All assets were taken from open sources,\n      used for non-commercial purposes,\n      so I believe no one's rights were violated.\n      But nevertheless, I want to give links to the works used.",OL:{LI1:{text:"The video and background images are taken from materials\n        for the video game 'Cyberpunk 2077'. ",anchors:[{text:"Thanks to CD Red Project and their designers!",href:"https://magazine.artstation.com/2021/01/cd-projekt-red-cyberpunk-2077art-blast/`",target:"_blank"}]},LI2:{text:"Beautiful car template created ",anchors:[{text:'by "overcrafted"',href:"https://overcrafted.itch.io/free-paid-vehicle-car-sprites-",target:"_blank"}]},LI3:{text:"Explosion animation ",anchors:[{text:"by NYKNCK",href:"https://kvsr.itch.io/explosion",target:"_blank"}]},LI4:{text:"Fire and exhause animations ",anchors:[{text:"by XYEzawr",href:"https://xyezawr.itch.io/free",target:"_blank"}]},LI5:{text:"Font is Audiowide Mono ",anchors:[{text:"by gilescope ",href:"https://github.com/gilescope/cyberpunkfonts",target:"_blank"},{text:"[is licensed under SIL Open Font License 1.1]",href:"./licenses/audiowide-regular.txt",target:"_blank"}]},LI6:{text:'Beautiful animations is a fork of "Neon Buttons Animation" pen ',anchors:[{text:"by Yuhomyan ",href:"https://codepen.io/yuhomyan/pen/GRobbXB",target:"_blank"},{text:"[license].",href:"./licenses/neon-buttons-animations.txt",target:"_blank"}]},LI7:{text:'The track background is a fork of "Synthwave background gradient" pen ',anchors:[{text:"by Adam Hollister ",href:"https://codepen.io/aaahollister/pen/daMMPg",target:"_blank"},{text:"[license].",href:"./licenses/synthwave-background-animation.txt",target:"_blank"}]}},CAPTION:"Thanks for reading!"}},9578:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PopupStandaloneModalListNotes=void 0;const a=s(4278);class r extends a.PopupStandaloneModalList{constructor(){super(r.TEXT_CONTENT_ENG)}}e.PopupStandaloneModalListNotes=r,r.TEXT_CONTENT_ENG={HEADER:"Dear visitor!",P1:"Please pay attention to the following points:",OL:{LI1:{text:"The server must be restarted before testing -\n        a previous FE that you may have tested before could,\n        for example, save colors in non-hex format,\n        create machines with incredibly long names,\n        leave engines enabled, etc."},LI2:{text:"Unfortunately, the server works in such a way\n        that I have to take control of the machines\n        before the setTimeout happens on the server.\n        The fact is that the server turns off the engine in any case,\n        it does not look whether the engine was turned off manually earlier\n        and turned on again. As a result,\n        depending on your luck, you can run into different mistakes."},LI3:{text:"The application has been tested in various scenarios in Chromium and Firefox.\n        You can even try shutting down the server after starting the race.\n        But if you suddenly find a bug, please write to me in discord (no95typem @ 9889)."},LI4:{text:"For a nicer look, turn on glitch if you can."},LI5:{text:"I hope your hardware is not weak!\n        I have a little slowdown on chromium,\n        but on FF with webrender enabled, everything is fine!"},LI6:{text:"By the way, if we are talking about browsers,\n        please enable autoplay video permission (and reload the page)\n        if you have blocked this feature for pages (as I do).\n        The background on the garage page should be a playing video."},LI7:{text:"For cross checkers - if you find flaws,\n        write at least in detail and do not do it anonymously, please!"}},CAPTION:"Thanks for reading!"}},4278:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PopupStandaloneModalList=void 0;const r=s(5743),n=s(8743),i=a(s(8625)),o=a(s(4985));class c extends n.PopupStandaloneModalComp{constructor(t){super(),this.list=document.createElement("ol"),this.btnOk=document.createElement("button"),this.btnCloseContainer=document.createElement("div"),this.caption=document.createElement("p"),this.TEXT_CONTENT=t,this.header.textContent=this.TEXT_CONTENT.HEADER,this.renderList(),this.renderCloseBtns(),this.setupCloseActions(),this.renderOtherThings(),this.body.classList.add(i.default.body),this.body.append(this.list,this.btnCloseContainer,this.caption,this.btnOk)}renderCloseBtns(){const t=new r.BtnClose;this.btnCloseContainer.classList.add(i.default["btn-close-container"]),t.rootElement.classList.add(i.default["btn-close"]),this.btnCloseContainer.append(t.rootElement),this.btnOk.classList.add(o.default.btn,o.default["btn-6"],i.default["btn-ok"]);const e=document.createElement("span"),s=document.createElement("span");s.textContent="OK",s.dataset.textContent="OK",s.classList.add(i.default["btn-ok__innerSpan"]),e.append(s),this.btnOk.append(e)}renderList(){const t=Object.values(this.TEXT_CONTENT.OL).map((t=>{const e=document.createElement("li");if(t.text){const s=document.createElement("span");s.textContent=t.text,e.append(s)}const s=t.anchors?.map((t=>{const e=document.createElement("a");return e.textContent=t.text,e.href=t.href,e.target=t.target,e}));return s&&e.append(...s),e}));this.list.append(...t),this.list.classList.add(i.default.ol)}renderOtherThings(){this.caption.textContent=this.TEXT_CONTENT.CAPTION}setupCloseActions(){this.btnCloseContainer.addEventListener("click",(()=>this.hideSmoothly())),this.btnOk.addEventListener("click",(()=>this.hideSmoothly())),document.body.addEventListener("keydown",(t=>{"Escape"===t.key&&this.hideSmoothly()}))}}e.PopupStandaloneModalList=c},8655:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WinnerRowComp=void 0;const a=s(1168),r=s(8990);class n extends a.BaseComp{constructor(t,e,s){super("tr"),this.indexElem=document.createElement("td"),this.idElem=document.createElement("td"),this.carPreviewBox=document.createElement("td"),this.nameElem=document.createElement("td"),this.winsElem=document.createElement("td"),this.bestTimeElem=document.createElement("td"),this.indexElem.textContent=t.toString(),this.idElem.textContent=e.id.toString(),this.carPreview=r.CarComp.genPreview(s),this.carPreviewBox.append(this.carPreview),this.nameElem.textContent=s.name,this.winsElem.textContent=e.wins.toString(),this.bestTimeElem.textContent=e.time.toString(),this._rootElement.append(this.indexElem,this.idElem,this.carPreviewBox,this.nameElem,this.winsElem,this.bestTimeElem)}getCarPreview(){return this.carPreview}}e.WinnerRowComp=n},3287:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.WinnersComp=void 0;const r=s(1168),n=s(379),i=s(928),o=s(5474),c=s(8655),l=s(7612),d=a(s(9052)),h=a(s(4985)),u=s(5856),p=s(479),g=s(745),m=s(1011),_=s(4590),E=s(9578),b=s(5794);class C extends r.BaseComp{constructor(){super("section"),this.hubName=u.DBUS_HUB_NAMES.WINNERS,this.table=document.createElement("table"),this.tableBody=document.createElement("tbody"),this.tableHead=document.createElement("thead"),this.thId=document.createElement("th"),this.thCar=document.createElement("th"),this.thName=document.createElement("th"),this.thWins=document.createElement("th"),this.thBestTime=document.createElement("th"),this.pagerBtnsContainer=document.createElement("div"),this.currOrder="ASC",this.currSort="time",this.entriesPerPage=10,this.txs=new Set,this.bottomBtnsContainer=document.createElement("div"),this.btnReconfigureGlitch=document.createElement("button"),this.btnNotes=document.createElement("button"),this.btnCredits=document.createElement("button"),this.popupNotes=new E.PopupStandaloneModalListNotes,this.popupCredits=new b.PopupStandaloneModalListCredits,this.popup=new m.PopupStandaloneModalProgressComp,this.getNewImgReadResponse=(t,e)=>new Response(new ReadableStream({async start(s){const a=t.headers.get("content-length");if(!t.body||!a)return void s.close();const r=t.body.getReader(),n=Number.parseInt(a,10);let i=0;const o=async()=>{const t=await r.read(),a=t.value;a&&(i+=a.byteLength,e?.setProgress(i/n*100),s.enqueue(a)),t.done?s.close():o()};o()}})),this.createBtnWithTwoSpans=(t,e)=>{const s=document.createElement("span"),a=document.createElement("span");return a.textContent=e,a.dataset.textContent=e,s.append(a),t.append(s),{btn:t,btnOuterSpan:s,btnInnerSpan:a}},this.pagerCallback=async t=>{try{return await this.reloadData(t),!0}catch{return!1}},this.tableHeadClickListener=async t=>{let e;switch(t.target){case this.thId:e=o.REST_CLIENT_WINNERS_SORT_OPTIONS.id;break;case this.thWins:e=o.REST_CLIENT_WINNERS_SORT_OPTIONS.wins;break;case this.thBestTime:e=o.REST_CLIENT_WINNERS_SORT_OPTIONS.time}if(e){this.pager.toogleLock(!0);const s=t.target;this.currOrder=s.classList.contains(d.default["table__sorted-elem_desc"])?"ASC":"DESC",this.currSort=e,await this.reloadData(),this.refreshTableHeader(s),this.pager.toogleLock(!1)}},this.refreshTableHeader=t=>{this.currSortedElem&&this.currSortedElem.classList.remove(d.default["table__sorted-elem"]),t.classList.add(d.default["table__sorted-elem"]),this.currSortedElem=t,"ASC"===this.currOrder?(t.classList.remove(d.default["table__sorted-elem_desc"]),t.classList.add(d.default["table__sorted-elem_asc"])):(t.classList.remove(d.default["table__sorted-elem_asc"]),t.classList.add(d.default["table__sorted-elem_desc"]))},this.pager=new l.Pager(this.entriesPerPage,this.pagerCallback),this.pagerSpan=this.pager.getPagerSpan(),this.start()}async start(){await this.loadBg(),this.renderPager(),this.renderTable(),this.renderBottomBtnsContainer(),this.setupBottomBtnsActions(),this._rootElement.classList.add(d.default.winners),this._rootElement.append(this.table,this.bottomBtnsContainer)}static getRandomBGInfo(t){const e=_.getRandomInt(C.BG_SRCS.length),s=C.BG_SRCS[e];return t===s?this.getRandomBGInfo(t):s}loadBg(){return new Promise((t=>{const e=C.getRandomBGInfo(this.currBGInfo);this.currBGInfo=e;const{src:s}=e;this.rootElement.style.setProperty("background",`url('${s}') ${e.styles}`),this.popup.reset().setText("Loading").setProgress(1).show();const a=()=>{this.popup.setProgress(100).hide(),t(!0)};fetch(s).then((async t=>{this.getNewImgReadResponse(t,this.popup).blob().finally((()=>{a()}))})).catch((()=>a()))}))}setupBottomBtnsActions(){this.btnNotes.addEventListener("click",(()=>this.popupNotes.showSmoothly())),this.btnCredits.addEventListener("click",(()=>this.popupCredits.showSmoothly())),this.btnReconfigureGlitch.addEventListener("click",(()=>{const t=new p.DBusMsgAppCtlReconfureReqMsg;this.txs.forEach((e=>{e.transmit({msg:t,prepMode:g.DBusTXPrepModes.freeze,waitMode:g.DBusTXWaitModes.nowait})}))}))}renderBottomBtnsContainer(){const t=this.createBtnWithTwoSpans(this.btnReconfigureGlitch,"reconfigure glitch");[this.createBtnWithTwoSpans(this.btnNotes,"notes"),this.createBtnWithTwoSpans(this.btnCredits,"credits"),t].forEach((t=>{t.btn.classList.add(h.default.btn,h.default["btn-6"],d.default["btn-glitch"]),t.btnInnerSpan.classList.add(d.default["btn-glitch__innerSpan"])})),this.bottomBtnsContainer.classList.add(d.default["bottom-btns-container"]),this.bottomBtnsContainer.append(this.btnNotes,this.btnCredits,this.btnReconfigureGlitch)}renderTable(){this.renderTableHeader(),this.table.classList.add(d.default.table),this.table.append(this.tableHead,this.tableBody,this.pagerBtnsContainer,this.pagerSpan)}renderTableHeader(){const t=document.createElement("tr"),e=document.createElement("th");e.textContent="№",this.thId.textContent="ID",this.thId.classList.add(d.default["table__can-be-sorted"]),this.thCar.textContent="CAR",this.thName.textContent="NAME",this.thWins.textContent="WINS",this.thWins.classList.add(d.default["table__can-be-sorted"]),this.thBestTime.textContent="BEST TIME",this.thBestTime.classList.add(d.default["table__can-be-sorted"]),t.append(e,this.thId,this.thCar,this.thName,this.thWins,this.thBestTime),this.tableHead.append(t),this.tableHead.addEventListener("click",this.tableHeadClickListener)}renderPager(){const t=this.pager.getBtnPrevPage();t.classList.add(h.default.btn,h.default["btn-6"],d.default["pager-btn"]);const e=this.pager.getBtnNextPage();e.classList.add(h.default.btn,h.default["btn-6"],d.default["pager-btn"]),this.pagerBtnsContainer.classList.add(d.default.pager),this.pagerBtnsContainer.append(t,e),this.pagerSpan.classList.add(d.default["pager-span"])}async notify(){this.reloadData().then((()=>this.refreshTableHeader(this.currSortedElem||this.thBestTime))),await this.loadBg()}async reloadData(t){return new Promise(((e,s)=>{const a=t?"next"===t?this.pager.getCurrPageNumber()+1:this.pager.getCurrPageNumber()-1:this.pager.getCurrPageNumber();i.REST_CLIENT_WINNERS.getWinners(a,this.entriesPerPage,this.currSort,this.currOrder).then((async r=>{if(this.pager.setEntriesCount(Number.parseInt(r.limit,10)),0===r.cars.length){if(t)return void s();if(a>1)return await this.pager.tryChangePage("prev"),void e()}await this.redrawWinners(r.cars,a),e()}))}))}async redrawWinners(t,e){const s=new Array(t.length),a=[],r=10*(e-1);for(t.forEach(((t,e)=>{const i=n.REST_CLIENT_GARAGE.getCar(t.id).then((a=>{const n=e+r+1,i=new c.WinnerRowComp(n,t,a);s[e]=i}));a.push(i)})),await Promise.allSettled(a);this.tableBody.firstChild;)this.tableBody.firstChild.remove();this.tableBody.append(...s.map((t=>(t.getCarPreview().classList.add(d.default["table__car-preview-box"]),t.rootElement))))}connect(t){const e=t.getNewTX("winners tx");this.txs.add(e)}}e.WinnersComp=C,C.TEXT_CONTENT_ENG={},C.BG_SRCS=[{src:"./assets/imgs/backgrounds/winners/alessandro-aramino-artboard-1.jpg",styles:"no-repeat left 50% top 0% / cover"},{src:"./assets/imgs/backgrounds/winners/alexander-dudar-q000-chase7-06.jpg",styles:"no-repeat right 0% top 0% / cover"},{src:"./assets/imgs/backgrounds/winners/alexander-dudar-q000-chase8.jpg",styles:"no-repeat right 0% top 0% / cover"},{src:"./assets/imgs/backgrounds/winners/andrzej-bury-1-9.jpg",styles:""},{src:"./assets/imgs/backgrounds/winners/andrzej-bury-1-12.jpg",styles:""},{src:"./assets/imgs/backgrounds/winners/charlotte-hughes-18.jpg",styles:""},{src:"./assets/imgs/backgrounds/winners/lukasz-sprada-18.jpg",styles:"no-repeat right 0% top 0% / cover"},{src:"./assets/imgs/backgrounds/winners/masahiro-sawada-arasaka-warehouse.jpg",styles:""},{src:"./assets/imgs/backgrounds/winners/ward-lindhout-charter-hill-highway2.jpg",styles:"no-repeat right 0% bottom 0% / cover"},{src:"./assets/imgs/backgrounds/winners/wiktoria-stachowska-ow-05.jpg",styles:""},{src:"./assets/imgs/backgrounds/winners/witold-justyniak-04-v19a.jpg",styles:""}]},9653:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CAR_MODEL_LIST_KEYS=e.CAR_MODEL_LIST=void 0;const a=s(5094),r=a.OBJ_PROCESSOR.deepFreeze({Lamborghini:["Murciélago","350 GT","400 GT","Sián FKP 37","Essenza SCV12","Urus","Centenario","Huracán","Veneno","Sesto Elementо","Aventador","Reventón","Gallardo","Diablo","LM002","Jalpa","Silhouette","Countach","Urraco","Jarama","Islero","Espada","Miura"],"Aston Martin":["Project 003","Valkyrie","DBS","Vanquish Zagato","Vanquish","Virage/Virage Volante","V12 Zagato","One-77","V8 Coupe/V8 Volante","V8 Zagato"],Ferrari:["Roma","Portfolio","488 GTB","California T","360 Spider","355 F1 Berlinetta","F355 GTS","456 GT","Testarossa","SF1000"],Koenigsegg:["Jesko Absolut","Jesko","Agera Final","Agera XS","Agera X","Agera S","Regera","Agera RS","One:1","CCGT"],Porsche:["918 Spyder","Boxster 982","Macan","Taycan","Panamera","Carrera GT","Cayenne","968","928","919 Hybrid"],Jaguar:["F-Type","Jaguar XKR X100","Jaguar XKR X150","R5","R4","R3","R2","R1","F-Pace","E-Pace"],Maserati:["Kyalami","Khamsin","Indy","Mexico","Merak","MC12","Spyder","Gransport","4300 GT Coupe","3200 GT"],"Mercedes-Benz":["AMG GT","SLS AMG","SLR-McLaren","R170","R171","W220","W221","W222","W223","W163"],McLaren:["Artura","Elva","Speedtail","GT","Senna","720S","570S","675LT","650S","P1"],Spyker:["C8 Laviolette","C8 Spyder","C8 Spyder T (Turbo)","Spyker C8 Double 12 S","Spyker C8 Aileron","C12","B6 Venator","C12 Zagato","D12 Peking-to-Paris","C12 La Turbie"]});e.CAR_MODEL_LIST=r;const n=a.OBJ_PROCESSOR.deepFreeze(Object.keys(r));e.CAR_MODEL_LIST_KEYS=n},1168:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BaseComp=void 0,e.BaseComp=class{constructor(t="div"){this._rootElement=document.createElement(t)}get rootElement(){return this._rootElement}}},5743:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.BtnClose=void 0;const r=s(1168),n=a(s(4246));class i extends r.BaseComp{constructor(){super("div");const t=new Image;t.src=n.default,this._rootElement.append(t)}}e.BtnClose=i},2841:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PopupStandaloneModal404Comp=void 0;const r=s(8743),n=a(s(4985));class i extends r.PopupStandaloneModalComp{constructor(){super(),this.header.textContent="ERROR: 404",this.header.dataset.textContent=this.header.textContent,this.header.classList.add(n.default["glitched-text"]),this.text.classList.add(n.default["glitched-text"])}}e.PopupStandaloneModal404Comp=i},7362:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PopupStandaloneModalChoiceComp=void 0;const a=s(8743);class r extends a.PopupStandaloneModalComp{constructor(){super(),this.btnBlock=document.createElement("div"),this.btns=[],this.choicePromise=new Promise((t=>{this.resolveFunc=t})),this.body.append(this.btnBlock)}recharge(){return this.choicePromise=new Promise((t=>{this.resolveFunc=t})),this}async awaitDesicion(){return this.choicePromise}mapBtnsAndChoices(...t){t.forEach((t=>{t.btn.addEventListener("click",(()=>this.resolveFunc?.(t.desicion)))}))}}e.PopupStandaloneModalChoiceComp=r},8743:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PopupStandaloneModalComp=void 0;const r=s(3662),n=s(3213),i=a(s(3588));class o extends n.PopupStandaloneComp{constructor(){super(),this._rootElement.classList.add(i.default["popup-modal"]);const t=document.createElement("div");t.classList.add(i.default["popup-bg"]),this._rootElement.append(t),this.body.classList.add(i.default["popup-body"]),t.append(this.body),this.header.classList.add(i.default["popup-body-header"]),this.text.classList.add(i.default["popup-body-text"])}setHeader(t){return this.header.textContent=t,this.header.dataset.textContent=t,this}setText(t){return this.text.textContent=t,this.text.dataset.textContent=t,this}show(t){return(t||document.body).append(this._rootElement),this}showSmoothly(t){this.show(t);const e=this._rootElement.animate([{opacity:"0"},{opacity:"1"}],{duration:500,easing:"ease-in-out",fill:"forwards"});return e.oncancel=()=>r.commitStyles(e),e.onfinish=()=>r.commitStyles(e),this}hide(){return this._rootElement.remove(),this}async hideSmoothly(){const t=this._rootElement.animate([{opacity:"1"},{opacity:"0"}],{duration:500,easing:"ease-in-out",fill:"forwards"});return await t.finished,this.hide(),r.commitStyles(t),this._rootElement.style.removeProperty("opacity"),this}}e.PopupStandaloneModalComp=o},1011:function(t,e,s){"use strict";var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PopupStandaloneModalProgressComp=void 0;const r=s(8743),n=a(s(9715)),i=a(s(4985));class o extends r.PopupStandaloneModalComp{constructor(){super(),this.barContainer=document.createElement("div"),this.bar=document.createElement("div"),this.barContainer.classList.add(n.default.container),this.bar.classList.add(n.default.bar),this.barContainer.append(this.bar),this.text.classList.add(n.default.text,i.default["glitched-text"]),this.body.classList.add(n.default.body),this.body.append(this.barContainer)}setHeader(t){return super.setHeader(t),this}setText(t){return super.setText(t),this}reset(){return this.bar.style.removeProperty("--progress"),this.text.textContent="",this.text.dataset.textContent="",this}setProgress(t){return this.bar.style.setProperty("--progress",`${t}%`),this}}e.PopupStandaloneModalProgressComp=o},3213:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PopupStandaloneComp=void 0;const a=s(1168);class r extends a.BaseComp{constructor(){super("div"),this.body=document.createElement("div"),this.header=document.createElement("h3"),this.text=document.createElement("p"),this.body.append(this.header,this.text),this._rootElement.append(this.body)}}e.PopupStandaloneComp=r},9007:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hexToRgb=void 0,e.hexToRgb=function(t){let e;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(t))return e=t.split(""),4===e.length&&(e=[e[1],e[1],e[2],e[2],e[3],e[3]]),{r:Number.parseInt(t.slice(1,3),16),g:Number.parseInt(t.slice(3,5),16),b:Number.parseInt(t.slice(5,7),16)};throw new Error("Bad Hex")}},4590:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.genRandomHexColor=e.getRandomArbitraryInt=e.getRandomInt=e.genUniqId=void 0,e.genUniqId=function(){const t=new Uint8Array(4);return window.crypto.getRandomValues(t).join("")},e.getRandomInt=function(t){return Math.floor(Math.random()*t)},e.getRandomArbitraryInt=function(t,e){return Math.floor(Math.random()*(e-t)+t)},e.genRandomHexColor=function t(){const e=`#${Math.floor(16777215*Math.random()).toString(16)}`;return 7===e.length?e:t()}},3662:(t,e)=>{"use strict";function s(t,e){const s=t.getPropertyValue("transition-property").replace(",","").split(" ");let a=s.lastIndexOf(e);if(-1===a&&(a=s.lastIndexOf("all")),-1!==a)return t.getPropertyValue("transition-duration").replace(",","").split(" ")[a]}Object.defineProperty(e,"__esModule",{value:!0}),e.commitStyles=e.transitionPromise=e.getTransitionDuration=void 0,e.getTransitionDuration=s,e.transitionPromise=function(t){return new Promise((e=>{const a=s=>{t.val&&t.elem.style.setProperty(t.prop,t.val),setTimeout((()=>{e(!0)}),s||20)};if(t.forceAutoresolveIn)a(t.forceAutoresolveIn);else if(t.valToWait&&window.getComputedStyle(t.elem).getPropertyValue(t.prop)===t.valToWait)a();else{const r=s(window.getComputedStyle(t.elem),t.prop);r&&"0s"!==r?(()=>{const s=a=>{a.target===t.elem&&a.propertyName===t.prop&&(t.valToWait&&window.getComputedStyle(t.elem).getPropertyValue(t.prop)!==t.valToWait||(t.elem.removeEventListener("transitionend",s),t.elem.removeEventListener("transitionend",s),e(!0)))};t.elem.addEventListener("transitionend",s),t.elem.addEventListener("transitioncancel",s),t.val&&t.elem.style.setProperty(t.prop,t.val)})():a()}}))},e.commitStyles=function(t){const e=t;"commitStyles"in e&&"function"==typeof e.commitStyles&&e.commitStyles()}},9630:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isNotifiable=void 0,e.isNotifiable=function(t){return"notify"in t&&"function"==typeof t.notify}},5094:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OBJ_PROCESSOR=void 0;const s=new class{constructor(){this.deepFreeze=t=>{if("object"==typeof t&&null!==t){const e=t;return Object.keys(e).forEach((t=>{"object"!=typeof e[t]||Object.isFrozen(e[t])||this.deepFreeze(e[t])})),Object.freeze(t)}throw new Error("not object")},this.deepClone=t=>{if(Array.isArray(t)){const e=[];return t.forEach((t=>{e.push(t)})),e.map((t=>this.deepClone(t)))}if("object"==typeof t&&null!==t){if(t instanceof HTMLElement)return t.cloneNode(!0);if(t instanceof Blob)return t.slice();const e={...t};return Object.keys(e).forEach((t=>{e[t]=this.deepClone(e[t])})),Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}return t}}};e.OBJ_PROCESSOR=s,s.deepFreeze(s)},7172:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBus=void 0;const a=s(4590),r=s(5094),n=s(7247),i=s(492),o=s(8927),c=s(2606),l=s(745),d=s(4441),h=s(7656),u=s(5856);e.DBus=class{constructor(){return this.network=new Map,this.idCounter={txs:0,rxs:0},this.createdRXs=new Set,this.createdTXs=new Set,this.attachedHubs=new Map,this.occupiedNames=new Set,this.callRXFunc=(t,e)=>{switch(t.headers.prepMode){case l.DBusTXPrepModes.clone:return(()=>{const s=r.OBJ_PROCESSOR.deepClone(t);return e.func(s)})();case l.DBusTXPrepModes.freeze:return(()=>{const s=r.OBJ_PROCESSOR.deepFreeze(t);return e.func(s)})();default:throw new Error(n.DBUS_ERRORS.UNEXPECTED_PREP_MODE)}},this.busId=a.genUniqId(),Object.freeze(this)}attachHub(t,e){return this.createInterfaceForHub(t,void 0,e)}createInterfaceForHub(t,e,s){if(this.attachedHubs.has(t))throw new Error(n.DBUS_ERRORS.HUB_IS_ALREADY_ATTACHED);if(!(t.hubName in u.DBUS_HUB_NAMES))throw new Error(n.DBUS_ERRORS.HUB_NAME_NOT_AUTHORIZED);let a=e?`${e}_${t.hubName}`:t.hubName;if(s&&(a+=`_${s}`),this.occupiedNames.has(a))throw new Error(n.DBUS_ERRORS.HUB_NAME_IS_OCCUPIED);const i=new h.DBusInterface((t=>this.getNewTX(a,t)),((t,e)=>this.genNewRX(t,e)),((t,e)=>this.plugRX(t,e)),((t,e)=>this.unplugRX(t,e)),((t,e)=>this.createInterfaceForHub(t,a,e)));return this.occupiedNames.add(a),this.attachedHubs.set(t,i),r.OBJ_PROCESSOR.deepFreeze(i),t.connect(i)}getNewTX(t,e){const s=a.genUniqId(),n=this.idCounter.txs++,i=new o.DBusTX(n,s,this.busId,(async a=>{const r=new d.DBusTXDataHeaders(t,s,n,a.waitMode,a.prepMode,e),i=new c.DBusTXData(r,a.msg);return await this.transmit(i)})),l=r.OBJ_PROCESSOR.deepFreeze(i);return this.createdTXs.add(l),l}genNewRX(t,e){const s=a.genUniqId(),n=this.idCounter.rxs++,o=new i.DBusRX(n,s,this.busId,t,e),c=r.OBJ_PROCESSOR.deepFreeze(o);return this.createdRXs.add(c),c}plugRX(t,e){if(!this.createdRXs.has(e))throw new Error(n.DBUS_ERRORS.XENO_RX);this.network.has(t)||this.network.set(t,new Set),this.network.get(t)?.add(e)}unplugRX(t,e){this.network.get(t)?.delete(e)}async transmit(t){if(!this.network.has(t.msg.topic))throw new Error(n.DBUS_ERRORS.TOPIC_IS_NOT_EXIST);const e=this.network.get(t.msg.topic);if(void 0===e||0===e.size)throw new Error(n.DBUS_ERRORS.TOPIC_HAS_NO_RXS);let s,a=[];if(t.msg.prefResponseRxIds){if(e.forEach((e=>{t.msg.prefResponseRxIds?.includes(e.id)&&a.push(e)})),0===a.length)throw new Error(n.DBUS_ERRORS.PREF_RXS_ARE_NOT_EXIST)}else a=[...e];switch(t.headers.waitMode){case l.DBusTXWaitModes.all:s=await Promise.all(a.map((e=>this.callRXFunc(t,e))));break;case l.DBusTXWaitModes.allSetled:s=await Promise.allSettled(a.map((e=>this.callRXFunc(t,e))));break;case l.DBusTXWaitModes.manual:s=a;break;case l.DBusTXWaitModes.nowait:default:a.map((e=>this.callRXFunc(t,e))),s=!0}return s}}},2994:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBUS_COMMON_RESPONSES=void 0;const a=s(5094).OBJ_PROCESSOR.deepFreeze({VOID:"VOID",BAD_REQUEST:"BAD_REQUEST"});e.DBUS_COMMON_RESPONSES=a},7247:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBUS_ERRORS=void 0;const a=s(5094).OBJ_PROCESSOR.deepFreeze({HUB_NAME_IS_OCCUPIED:"HUB_NAME_IS_OCCUPIED",HUB_IS_ALREADY_ATTACHED:"HUB_IS_ALREADY_ATTACHED",HUB_NAME_NOT_AUTHORIZED:"HUB_NAME_NOT_AUTHORIZED",XENO_RX:"XENO_RX",TOPIC_IS_NOT_EXIST:"TOPIC_IS_NOT_EXIST",TOPIC_HAS_NO_RXS:"TOPIC_HAS_NO_RXS",PREF_RXS_ARE_NOT_EXIST:"PREF_RXS_ARE_NOT_EXIST",UNEXPECTED_PREP_MODE:"UNEXPECTED_PREP_MODE"});e.DBUS_ERRORS=a},5856:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBUS_HUB_NAMES=void 0;const a=s(5094),r=new class{constructor(){this.APP="APP",this.ROUTER="ROUTER",this.GARAGE="GARAGE",this.HEADER="HEADER",this.MAIN_CONTROLS="MAIN_CONTROLS",this.CREATE_UPDATE="CREATE_UPDATE",this.GARAGE_CONTROLLER="GARAGE_CONTROLLER",this.WINNERS="WINNERS"}},n=a.OBJ_PROCESSOR.deepFreeze(r);e.DBUS_HUB_NAMES=n},7656:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusInterface=e.isDBusHub=void 0;const a=s(5856);e.isDBusHub=function(t){const e=t;return"connect"in e&&"hubName"in e&&"string"==typeof e.hubName&&e.hubName in a.DBUS_HUB_NAMES},e.DBusInterface=class{constructor(t,e,s,a,r){this.arrowedGetNewTX=t,this.arrowedGetNewRX=e,this.arrowedPlugRX=s,this.arrowedUnplugRX=a,this.attachSubHub=r,this.RXs=new Set,this.TXs=new Set,this.RXsPlugMap=new Map}getNewRX(t,e){const s=this.arrowedGetNewRX(t,e);return this.RXs.add(s),s}getNewTX(t){const e=this.arrowedGetNewTX(t);return this.TXs.add(e),e}plugRX(t,e){this.RXsPlugMap.has(t)||this.RXsPlugMap.set(t,new Set),this.RXsPlugMap.get(t)?.add(e),this.arrowedPlugRX(t,e)}unplugRX(t,e){this.RXsPlugMap.get(t)?.delete(e),this.arrowedUnplugRX(t,e)}}},492:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusRX=void 0,e.DBusRX=class{constructor(t,e,s,a,r){this.regNumber=t,this.id=e,this.busId=s,this.func=a,this.desc=r}}},4690:(t,e)=>{"use strict";var s;Object.defineProperty(e,"__esModule",{value:!0}),e.DBusTopics=void 0,(s=e.DBusTopics||(e.DBusTopics={}))[s.APP_CTL=0]="APP_CTL",s[s.ROUTING=1]="ROUTING",s[s.CAR_ACTION=2]="CAR_ACTION",s[s.GARAGE=3]="GARAGE",s[s.REST_CLIENT_REQUESTS=4]="REST_CLIENT_REQUESTS",s[s.GENERATE=5]="GENERATE"},4441:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusTXDataHeaders=void 0,e.DBusTXDataHeaders=class{constructor(t,e,s,a,r,n){this.hubName=t,this.txId=e,this.txRegNumber=s,this.waitMode=a,this.prepMode=r,this.txDesc=n}}},2606:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusTXData=void 0,e.DBusTXData=class{constructor(t,e){this.headers=t,this.msg=e}}},745:(t,e)=>{"use strict";var s,a;Object.defineProperty(e,"__esModule",{value:!0}),e.DBusTXPrepModes=e.DBusTXWaitModes=void 0,(a=e.DBusTXWaitModes||(e.DBusTXWaitModes={}))[a.nowait=0]="nowait",a[a.all=1]="all",a[a.allSetled=2]="allSetled",a[a.manual=3]="manual",(s=e.DBusTXPrepModes||(e.DBusTXPrepModes={}))[s.clone=0]="clone",s[s.freeze=1]="freeze"},8927:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusTX=void 0,e.DBusTX=class{constructor(t,e,s,a){this.regNumber=t,this.id=e,this.busId=s,this.transmit=a}}},7469:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsg=void 0,e.DBusMsg=class{constructor(t,e,s){this.topic=t,this.rxIds=e,this.prefResponseRxIds=s}}},7612:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Pager=void 0,e.Pager=class{constructor(t,e,s=document.createElement("button"),a=document.createElement("button")){this.entriesPerPage=t,this.listCallback=e,this.btnPrevPage=s,this.btnNextPage=a,this.firstPageNumber=1,this.currPageNumber=this.firstPageNumber,this.lastPageNumber=0,this.pagerSpan=document.createElement("span"),this.entriesCount=0,this.callbackIsCalled=!1;const r=document.createElement("span");r.textContent="Next page",this.btnNextPage.append(r);const n=document.createElement("span");n.textContent="Prev page",this.btnPrevPage.append(n),this.btnNextPage.addEventListener("click",(()=>this.callCallback("next"))),this.btnPrevPage.addEventListener("click",(()=>this.callCallback("prev")))}toogleLock(t){this.toggleBtnsDisabled(t)}getEntriesPerPage(){return this.entriesPerPage}setLastPageNumber(t){this.lastPageNumber=t,this.callbackIsCalled||this.toggleBtnsDisabled(!1)}setEntriesCount(t){this.entriesCount=t,this.lastPageNumber=Math.ceil(this.entriesCount/this.entriesPerPage),this.updateSpanText(),this.callbackIsCalled||this.toggleBtnsDisabled(!1)}getCurrPageNumber(){return this.currPageNumber}getBtnPrevPage(){return this.btnPrevPage}getBtnNextPage(){return this.btnNextPage}getPagerSpan(){return this.pagerSpan}tryChangePage(t){return this.callCallback(t)}updateSpanText(){const t=this.entriesCount>0?this.currPageNumber:0;this.pagerSpan.textContent=`Entries: ${this.entriesCount}, Page: ${t}/${this.lastPageNumber}`}async callCallback(t){this.callbackIsCalled||(this.callbackIsCalled=!0,this.toggleBtnsDisabled(!0),this.listCallback(t).then((e=>{if(e){switch(t){case"next":this.currPageNumber++;break;case"prev":this.currPageNumber--}this.updateSpanText()}})).finally((()=>{this.toggleBtnsDisabled(!1),this.callbackIsCalled=!1})))}toggleBtnsDisabled(t){if(!0===t)return this.btnPrevPage.disabled=!0,void(this.btnNextPage.disabled=!0);this.currPageNumber>this.firstPageNumber?this.btnPrevPage.disabled=!1:this.btnPrevPage.disabled=!0,this.currPageNumber<this.lastPageNumber?this.btnNextPage.disabled=!1:this.btnNextPage.disabled=!0}}},2623:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgRoutingMsg=void 0;const a=s(4690),r=s(7469);class n extends r.DBusMsg{constructor(t,e){super(a.DBusTopics.ROUTING,t,e)}}e.DBusMsgRoutingMsg=n},7950:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgRouteIsChangedMsg=void 0;const a=s(2623);class r extends a.DBusMsgRoutingMsg{constructor(t,e,s,a){super(s,a),this.newRoute=t,this.addInfo=e}}e.DBusMsgRouteIsChangedMsg=r},5633:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgRoutingStatusMsg=void 0;const a=s(2623);class r extends a.DBusMsgRoutingMsg{constructor(t,e,s){super(e,s),this.status=t}}e.DBusMsgRoutingStatusMsg=r},3772:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DBusMsgRoutingRestrainMsg=void 0;const a=s(2623);class r extends a.DBusMsgRoutingMsg{constructor(t,e,s,a){super(s,a),this.action=t,this.callback=e}}e.DBusMsgRoutingRestrainMsg=r},1209:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleRouterAgent=void 0,e.SimpleRouterAgent=class{constructor(t,e,s,a,r){this.type=t,this.path=e,this.callback=s,this.getStateCallback=a,this.setStateCallback=r}}},5207:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleRouter=void 0;const a=s(5094),r=s(5856),n=s(4690),i=s(745),o=s(7950),c=s(5633),l=s(3772);e.SimpleRouter=class{constructor(t){switch(this.hubName=r.DBUS_HUB_NAMES.ROUTER,this.agents=new Set,this.txs=new Set,this.restrains=new Set,this.watchRestrictions=async t=>{if(t.msg instanceof l.DBusMsgRoutingRestrainMsg){const{action:e,callback:s}=t.msg;"restrain"===e?(this.restrains.add(s),1===this.restrains.size&&this.broadcastRoutingStatus("restrained")):(this.restrains.delete(s),0===this.restrains.size&&this.broadcastRoutingStatus("free"))}},t.mode){case"#":break;case"?":throw new Error(`${t.mode} is not supported yet!`);default:throw new Error(`${t.mode} is not supported!`)}this.options=a.OBJ_PROCESSOR.deepFreeze(t),window.addEventListener("popstate",(async()=>{if(window.location.href!==this.currRoute)if(this.restrains.size>0){const t=window.location.href;this.currRoute?window.location.href=this.currRoute:this.options.defaultRoot&&(window.location.href=`${window.location.host}/${this.options.defaultRoot}`);const e=[...this.restrains.values()],s=e.map((t=>t())),a=await Promise.all(s);let r=!1;if(Array.isArray(a))for(let t=0;t<a.length;t++){if("boolean"!=typeof a[t])throw new Error("restrict func returned not boolean value!");if(a[t]){const s=e[t];s&&this.restrains.delete(s),0===this.restrains.size&&this.broadcastRoutingStatus("free")}else r=!0}r||(window.location.href=t)}else this.activateWantedAgents()}))}broadcastRoutingStatus(t){const e=new c.DBusMsgRoutingStatusMsg(t);this.txs.forEach((t=>{t.transmit({msg:e,prepMode:i.DBusTXPrepModes.freeze,waitMode:i.DBusTXWaitModes.nowait})}))}activateWantedAgents(t){this.currRoute=window.location.href;let e=0;const s=[];if(!this.options.onlyDBus&&"#"===this.options.mode){const a=[...this.agents];for(let s=0;s<this.agents.size;s++)if(a[s]?.path===window.location.hash){try{a[s]?.callback(t)}catch(t){t.push(t)}e++;break}0===e&&(this.defaultAgent&&this.options.defaultRoot===window.location.hash?this.defaultAgent.callback(t):s.push(new Error("Agent is not finded")))}return this.txs.size>0&&this.txs.forEach((e=>{const s=new o.DBusMsgRouteIsChangedMsg(window.location.hash,t);e.transmit({msg:s,waitMode:i.DBusTXWaitModes.nowait,prepMode:i.DBusTXPrepModes.freeze})})),s.length>0?s:e>0}addRouterAgent(t){this.agents.add(t)}removeRouterAgent(t){this.agents.delete(t)}flushRouterAgents(){this.agents.clear()}connect(t){const e=t.getNewTX("broadcasting route changes");this.txs.add(e);const s=t.getNewRX(this.watchRestrictions,"router watch restrictions requests");t.plugRX(n.DBusTopics.ROUTING,s)}}},9461:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.REST_CLIENT_ENGINE=void 0;const a=s(5094),r=s(4844),n=s(3231);class i extends r.RestClient{constructor(t){super(t,"/engine")}toggleEngine(t,e){return new Promise(((s,a)=>{const i=`${this.fullUrl}?id=${t}&status=${e}`;fetch(i,{method:"GET"}).then((t=>{if(200===t.status)return t.json();throw new Error(n.REST_CLIENT_ERROR.UNEXPECTED_RESULT)})).then((t=>s(t))).catch((t=>r.RestClient.handleError(t,a)))}))}enterDriveMode(t){return new Promise(((e,s)=>{const a=`${this.fullUrl}?id=${t}&status=drive`;fetch(a,{method:"GET"}).then((t=>{200===t.status?e(!0):500===t.status?e(!1):s(new Error(n.REST_CLIENT_ERROR.UNEXPECTED_RESULT))})).catch((t=>r.RestClient.handleError(t,s)))}))}}const o=new i("http://127.0.0.1:3000"),c=a.OBJ_PROCESSOR.deepFreeze(o);e.REST_CLIENT_ENGINE=c},379:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.REST_CLIENT_GARAGE=void 0;const a=s(5094),r=s(4844),n=s(3231);class i extends r.RestClient{constructor(t){super(t,"/garage")}getCars(t,e){return new Promise(((s,a)=>{const i=e||"",o=`${this.fullUrl}?_page=${t}&_limit=${i}`;let c="";fetch(o,{method:"GET"}).then((t=>{if(200===t.status)return c=t.headers.get("X-Total-Count"),t.json();throw new Error(n.REST_CLIENT_ERROR.UNEXPECTED_RESULT)})).then((t=>s({limit:c,cars:t}))).catch((t=>r.RestClient.handleError(t,a)))}))}getCar(t){return new Promise(((e,s)=>{const a=`${this.fullUrl}/${t}`;fetch(a,{method:"GET"}).then((t=>{if(200===t.status)return t.json();if(404===t.status)throw new Error(n.REST_CLIENT_ERROR.NOT_FOUND);throw new Error(n.REST_CLIENT_ERROR.UNEXPECTED_RESULT)})).then((t=>e(t))).catch((t=>r.RestClient.handleError(t,s)))}))}createCar(t){return new Promise(((e,s)=>{fetch(this.fullUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((t=>{if(201===t.status)return t.json();throw new Error(n.REST_CLIENT_ERROR.UNEXPECTED_RESULT)})).then((t=>e(t))).catch((t=>r.RestClient.handleError(t,s)))}))}deleteCar(t){return new Promise(((e,s)=>{const a=`${this.fullUrl}/${t}`;fetch(a,{method:"DELETE"}).then((t=>{if(200===t.status&&e(!0),404===t.status)throw new Error(n.REST_CLIENT_ERROR.NOT_FOUND);throw new Error(n.REST_CLIENT_ERROR.UNEXPECTED_RESULT)})).catch((t=>r.RestClient.handleError(t,s)))}))}updateCar(t){return new Promise(((e,s)=>{const a=`${this.fullUrl}/${t.id}`,i=t;fetch(a,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then((t=>{if(200===t.status)return t.json();if(404===t.status)throw new Error(n.REST_CLIENT_ERROR.NOT_FOUND);throw new Error(n.REST_CLIENT_ERROR.UNEXPECTED_RESULT)})).then((t=>e(t))).catch((t=>r.RestClient.handleError(t,s)))}))}}const o=new i("http://127.0.0.1:3000"),c=a.OBJ_PROCESSOR.deepFreeze(o);e.REST_CLIENT_GARAGE=c},5474:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.REST_CLIENT_WINNERS_SORT_OPTIONS=void 0;const a=s(5094),r=new class{constructor(){this.id="id",this.wins="wins",this.time="time"}},n=a.OBJ_PROCESSOR.deepFreeze(r);e.REST_CLIENT_WINNERS_SORT_OPTIONS=n},928:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.REST_CLIENT_WINNERS=void 0;const a=s(5094),r=s(4844),n=s(3231);class i extends r.RestClient{constructor(t){super(t,"/winners")}getWinners(t=0,e,s,a){return new Promise(((i,o)=>{const c=e||"";let l=`${this.fullUrl}?_page=${t}&_limit=${c}`;s&&(l+=`&_sort=${s}`),a&&(l+=`&_order=${a}`);let d="";fetch(l,{method:"GET"}).then((t=>{if(200===t.status)return d=t.headers.get("X-Total-Count"),t.json();throw new Error(n.REST_CLIENT_ERROR.UNEXPECTED_RESULT)})).then((t=>i({limit:d,cars:t}))).catch((t=>r.RestClient.handleError(t,o)))}))}getWinner(t){return new Promise(((e,s)=>{const a=`${this.fullUrl}/${t}`;fetch(a,{method:"GET"}).then((t=>{if(200===t.status)return t.json();if(404===t.status)throw new Error(n.REST_CLIENT_ERROR.NOT_FOUND);throw new Error(n.REST_CLIENT_ERROR.UNEXPECTED_RESULT)})).then((t=>e(t))).catch((t=>r.RestClient.handleError(t,s)))}))}createWinner(t){return new Promise(((e,s)=>{fetch(this.fullUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((t=>{if(201===t.status)return t.json();throw new Error(n.REST_CLIENT_ERROR.UNEXPECTED_RESULT)})).then((t=>e(t))).catch((t=>r.RestClient.handleError(t,s)))}))}deleteWinner(t){return new Promise(((e,s)=>{const a=`${this.fullUrl}/${t}`;fetch(a,{method:"DELETE"}).then((t=>{if(200===t.status&&e(!0),404===t.status)throw new Error(n.REST_CLIENT_ERROR.NOT_FOUND);throw new Error(n.REST_CLIENT_ERROR.UNEXPECTED_RESULT)})).catch((t=>r.RestClient.handleError(t,s)))}))}updateWinner(t){return new Promise(((e,s)=>{const a=`${this.fullUrl}/${t.id}`,i=t;fetch(a,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then((t=>{if(200===t.status)return t.json();if(404===t.status)throw new Error(n.REST_CLIENT_ERROR.NOT_FOUND);throw new Error(n.REST_CLIENT_ERROR.UNEXPECTED_RESULT)})).then((t=>e(t))).catch((t=>r.RestClient.handleError(t,s)))}))}}const o=new i("http://127.0.0.1:3000"),c=a.OBJ_PROCESSOR.deepFreeze(o);e.REST_CLIENT_WINNERS=c},4844:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RestClient=void 0;const a=s(3231);e.RestClient=class{constructor(t,e){this.baseUrl=t,this.resUrl=e,this.fullUrl=t+e}static handleError(t,e){if(t.message in a.REST_CLIENT_ERROR){const s=t.message;e(new Error(a.REST_CLIENT_ERROR[s]))}else e(new Error(a.REST_CLIENT_ERROR.UNKNOWN_ERROR))}}},3231:(t,e,s)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.REST_CLIENT_ERROR=void 0;const a=s(5094).OBJ_PROCESSOR.deepFreeze({UNEXPECTED_RESULT:"UNEXPECTED_RESULT",UNKNOWN_ERROR:"UNKNOWN_ERROR",NOT_FOUND:"NOT_FOUND",CONNECTION_REFUSED:"CONNECTION_REFUSED","Failed to fetch":"CONNECTION_REFUSED","NetworkError when attempting to fetch resource.":"CONNECTION_REFUSED"});e.REST_CLIENT_ERROR=a}},e={};function s(a){var r=e[a];if(void 0!==r)return r.exports;var n=e[a]={exports:{}};return t[a].call(n.exports,n,n.exports,s),n.exports}s.d=(t,e)=>{for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";const t=s(9962);window.addEventListener("load",(()=>{const e=document.createElement("div");document.body.append(e),new t.App(e).start()}))})()})();
//# sourceMappingURL=main.170de12a438f8824f10f.js.map