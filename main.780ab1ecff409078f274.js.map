{"version":3,"sources":["webpack://async-race/./src/components/garage/garage.scss?dc9e","webpack://async-race/./src/components/garage/subcomps/car/car.scss?1a27","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/create-update.scss?4682","webpack://async-race/./src/components/garage/subcomps/main-controls/main-controls.scss?1eb1","webpack://async-race/./src/components/garage/subcomps/track/track.scss?9419","webpack://async-race/./src/components/header/header.scss?92c0","webpack://async-race/./src/components/winners/winners.scss?feec","webpack://async-race/./src/lib/components/popups/standalone/modal/popup-standalone-modal.scss?0629","webpack://async-race/./src/lib/components/popups/standalone/modal/progress/popup-progress.scss?22c3","webpack://async-race/./src/styles.scss?cfb3","webpack://async-race/./src/app.ts","webpack://async-race/./src/components/garage/car-actions.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-action-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-created-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-remove-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-select-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-request-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-status-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-reset-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-reset-req-msg.def.ts","webpack://async-race/./src/components/garage/garage-controller.ts","webpack://async-race/./src/components/garage/garage-driver.ts","webpack://async-race/./src/components/garage/garage-servant.ts","webpack://async-race/./src/components/garage/garage.ts","webpack://async-race/./src/components/garage/subcomps/car/car.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-create.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-proto.def.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-update.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/create-update.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/dbus-msgs/generate-cars-msg.def.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/main-controls.ts","webpack://async-race/./src/components/garage/subcomps/popup-winner/popup-winner.ts","webpack://async-race/./src/components/garage/subcomps/track/track.ts","webpack://async-race/./src/components/header/header.ts","webpack://async-race/./src/components/header/subcomps/nav-item/nav-item.ts","webpack://async-race/./src/components/winners/subcomps/winner-entry.ts","webpack://async-race/./src/components/winners/winners.ts","webpack://async-race/./src/definitions/car-random-data.def.ts","webpack://async-race/./src/lib/components/base-comp/base-comp.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/404/popup-404.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/popup-standalone-modal.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/progress/popup-progress.ts","webpack://async-race/./src/lib/components/popups/standalone/popup-standalone.ts","webpack://async-race/./src/lib/convertors/colors.ts","webpack://async-race/./src/lib/generators/generators.ts","webpack://async-race/./src/lib/gui/animation.ts","webpack://async-race/./src/lib/interfaces/notifiable.ts","webpack://async-race/./src/lib/processors/obj-processor.ts","webpack://async-race/./src/lib/services/dbus/dbus.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-common-responses.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-errors.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-hub-names.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-interface.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-rx/dbus-rx.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-topics.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-data-headers.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-data.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx.def.ts","webpack://async-race/./src/lib/services/dbus/defs/msgs/dbus-msg.def.ts","webpack://async-race/./src/lib/services/pager/pager.ts","webpack://async-race/./src/lib/services/simple-router/dbus-msgs-defs/dbus-msg-routing-msg.def.ts","webpack://async-race/./src/lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg.ts","webpack://async-race/./src/lib/services/simple-router/simple-router-agent.ts","webpack://async-race/./src/lib/services/simple-router/simple-router.ts","webpack://async-race/./src/services/rest-clients/client-engine/rest-client-engine.ts","webpack://async-race/./src/services/rest-clients/client-garage/rest-client-garage.ts","webpack://async-race/./src/services/rest-clients/client-winners/rest-client-winners.def.ts","webpack://async-race/./src/services/rest-clients/client-winners/rest-client-winners.ts","webpack://async-race/./src/services/rest-clients/rest-clients-errors.def.ts","webpack://async-race/./src/services/rest-clients/rest-clients-names.def.ts","webpack://async-race/webpack/bootstrap","webpack://async-race/webpack/runtime/define property getters","webpack://async-race/webpack/runtime/hasOwnProperty shorthand","webpack://async-race/webpack/runtime/make namespace object","webpack://async-race/./src/entry.ts"],"names":["rootElement","hubName","DBUS_HUB_NAMES","APP","loadedMainComponents","defaultRouterAgent","SimpleRouterAgent","this","loadMainComponent","router","SimpleRouter","mode","defaultRoot","defaultAgent","mainlineDBus","DBus","watchRouterMsgs","async","data","msg","DBusMsgRouteIsChangedMsg","newRoute","DBUS_COMMON_RESPONSES","VOID","window","addEventListener","e","console","log","preventDefault","promise","catch","error","message","REST_CLIENT_ERROR","CONNECTION_REFUSED","popup","PopupStandaloneModal404Comp","setText","show","retry","REST_CLIENT_GARAGE","getCars","hide","activateWantedAgents","Promise","res","setTimeout","classList","add","app","header","HeaderComponent","HEADER","append","attachHub","intrfce","routeRX","getNewRX","plugRX","DBusTopics","ROUTING","name","GarageComp","WinnersComp","location","hash","newComponent","currMainComponent","remove","isDBusHub","isNotifiable","notify","CarActions","DBusMsgCarActionMsg","DBusMsg","action","rxIds","prefResponseRxIds","super","CAR_ACTION","DBusMsgCarActionCreatedMsg","car","CREATED","DBusMsgCarActionRemovedMsg","nullifiedContract","REMOVED","DBusMsgCarActionSelectedMsg","notifyChanges","SELECTED","DBusMsgGarageRaceMsg","GARAGE","DBusMsgRaceRequestMsg","DBusMsgGarageRaceStatusMsg","status","DBusMsgGarageResetMsg","DBusMsgGarageResetReqMsg","GarageComponentControllerAkaDirector","tracksContainer","carCtlsBlock","GARAGE_CONTROLLER","txs","Set","entriesPerPage","pagerContainer","document","createElement","carImgRatio","scaleFactor","pagerCallback","dir","reloadData","generatorRXFunc","DBusMsgGenerateCarsMsg","garageManagersTeam","getContracts","size","racingRXFunc","pager","toogleLock","performRace","resetState","carActionsRXFunc","tryChangePage","createCarCtlBlock","index","btns","btnSelect","btnStart","btnReset","btnRm","forEach","btn","numberSpan","textContent","toString","container","connectCtlAndTrack","ctlElem","track","illuminateSelf","GarageManagersTeam","Pager","btnNextPage","getBtnNextPage","btnPrevPage","getBtnPrevPage","pagerInfo","getPagerSpan","redraw","int","getNewTX","autoConnect","carActionsMsgsRX","raceMsgsRX","generatorMsgsRX","GENERATE","rej","page","getCurrPageNumber","getEntriesPerPage","then","response","limit","cars","setEntriesCount","Number","parseInt","length","nullifyContracts","newContracts","TrackComp","carComp","CarComp","placeCar","push","addContracts","clearDOM","map","contract","geometry","calcGeometry","setStylesForTracks","drawTracks","drawCarsCtls","firstChild","style","getComputedStyle","containerHeight","parseFloat","height","paddingBottom","paddingTop","firstAutoHeight","innerWidth","heights","heightSum","contracts","factor","carTrackHeight","excessHeight","heightsReversed","sort","a","b","displacementBase","displacements","midIndex","displacement","DISPLACEMENT_FIX","paddingBase","paddingAddShift","trackHeights","setProperty","ctlBlocks","block","GarageDriverCommands","GarageDriver","Error","undefined","flags","disableCtls","thisDriveId","genUniqId","currDriveId","ignitionPromise","TurnOnTheIgnition","driveParams","drivePromise","drive","REST_CLIENT_ENGINE","toggleEngine","currCar","id","stopCar","rollBack","msgBlock","PopupStandaloneModalProgressComp","interval","updateProgress","playAwaitingAnim","clearTimeout","setInterval","lastTimeInMs","lastStart","progress","Date","now","setProgress","clearInterval","driveId","time","calculateDriveTime","start","enterDriveMode","success","rollForward","onlyAnim","rollover","broken","stop","params","distance","velocity","freeDrivers","busyDrivers","Map","winnerPopup","GaragePopupWinner","carCtlsClickListener","target","HTMLElement","elem","HTMLButtonElement","parentElement","disabled","currRaceId","handleRemoving","startDriving","handleRestoreState","handleSelection","handleWinner","isFinishVisible","duration","getTransitionDuration","awaitTime","isRoadMoves","winnerCar","setData","toFixed","REST_CLIENT_WINNERS","getWinner","winnerRecord","updatedWinnerData","wins","updateWinner","NOT_FOUND","newWinnerData","createWinner","tx","tryFreeDrivers","delete","clear","сontracts","newContract","prepareForRace","rollbackCars","broadcastRaceStatus","driver","get","returnToStart","choosedDriver","find","isFree","set","putBehindTheWheel","performDrivingProtocol","deleteCar","deleteWinner","transmit","prepMode","DBusTXPrepModes","freeze","waitMode","DBusTXWaitModes","nowait","genSelectCallback","rollbacks","all","thisRaceId","raceData","raceId","arrivedByOrder","notArrived","participantsCount","roadElem","stratedCount","processRace","finally","result","handleDriveResult","getOutOfTheCar","has","updateData","BaseComp","isControllerWorking","mainControlsComp","MainControlsComp","carsCtlsBlock","bgVideo","bgVideoProgressListener","buffered","end","bgVideoCanPlayListener","removeEventListener","controller","startWorking","reset","play","_rootElement","garage","selfCtlsBlock","bg","garage__bg","controls","loop","defaultMuted","muted","autoplay","src","attachSubHub","_currCar","canvas","tireBack","btnSelect$","btnRm$","_spanCarName","btnStart$","btnReset$","isReseted","movingClassName","clearAnimFromElem","anim","commitStyles","selectSpan","rmSpan","startSpan","resetSpan","drawCar","color","drawWheels","observer","MutationObserver","mutations","mutation","oldValue","includes","currOutOfSceneAnim","pause","disconnect","contains","outOfScene","rootElem","wheelImg","Image","CAR_WHEEL_IMG_SRC","onload","backwardWheelImg","OBJ_PROCESSOR","deepClone","carData","finishPromise","resolve","playOutAnim","cancel","currAnimation","playbackRate","finished","removeProperty","playInAnim","asyncFunc","animOut","animate","opacity","easing","fill","promiseToAwait","animIn","iterations","POSITIVE_INFINITY","transform","handleBtns","rootStyle","selfStyle","rootWidth","width","paddingLeft","paddingRight","selfWidth","coordinateInPercents","onfinish","oncancel","playState","roadIsMoving","observe","attributes","attributeOldValue","img","frameNumber","CAR_EXPLOSION_IMG_DATA","BASE_URL","EXTENSION","FRAME_TIME_MS","FRAMES_COUNT","hexColor","CAR_BODY_IMG_SRC","ctx","getContext","shadowColor","shadowBlur","drawImage","paintCarBody","imageData","getImageData","rgb","hexToRgb","j","i","red","green","blue","blueDiff","blueDiffThreshold","threshold","r","g","putImageData","TIMING_FUNCTION","CreateCompController","CreateUpdateCompControllerProto","elements","inputText","inputColor","setupBtnCreate","unregCar","value","createCar","clone","state","UpdateCompController","rxs","chooseCarListener","choosedCar","notifyCb","toogleCtlsDisabled","setupBtnUpdate","rx","updateCar","CreateUpdateComponent","type","btnText","CREATE_UPDATE","textInput","colorInput","root","MAIN_CONTROLS","createComponent","updateComponent","btnRace","btnGenerate","generateClickListener","transmissions","transmission","allSetled","allSettled","generate","genCb","resolveMsg","raceClickListener","resetClickListener","genRandomCarName","manufacturerNumber","getRandomInt","CAR_MODEL_LIST_KEYS","manufacturerName","models","CAR_MODEL_LIST","rxFuncForRaceMsgs","btnsBlock","renderBtns","span","btnBlock","total","left","cb","genLeft","unregCarData","genRandomHexColor","winner","getRandomArbitraryInt","textTime","textName","textId","textNumber","timeStr","indexStr","topBlock","illuminate","track_illuminated","hasChildNodes","childNodes","child","spanCarName","buses","illuminateNavItem","anchors","anchor","getAttribute","logo","header__logo","firstSpan","secondSpan","navContainer","ul","li","svg","navItems","NavItem","item","illuminateRX","text","href","styles","iconSrc","_anchor","setAttribute","iconImage","WinnerRowComp","winnerData","indexElem","idElem","carPreviewBox","nameElem","winsElem","bestTimeElem","carPreview","genPreview","table","tableBody","tableHead","thId","thCar","thName","thWins","thBestTime","currOrder","currSort","refillTable","tableHeadClickListener","REST_CLIENT_WINNERS_SORT_OPTIONS","refreshTableHeader","currSortedElem","winners","pagerBtnsContainer","pagerSpan","renderHeader","tr","thIndex","specialSort","specialOrder","order","getWinners","rows","Array","promises","indexInc","getCar","totalIndex","row","getCarPreview","TEXT_CONTENT_ENG","deepFreeze","Lamborghini","Ferrari","Koenigsegg","Object","keys","tag","PopupStandaloneModalComp","dataset","PopupStandaloneComp","closeArea","body","barContainer","bar","hex","c","test","split","slice","arr","Uint8Array","crypto","getRandomValues","join","max","Math","floor","random","min","prop","transPropArr","getPropertyValue","replace","propIndex","lastIndexOf","transformAndAutoresolve","delay","val","forceAutoresolveIn","valToWait","eventHandler","propertyName","transformAndWaitEvent","object","obj","record","isFrozen","isArray","v","n","cloneNode","Blob","k","setPrototypeOf","getPrototypeOf","network","idCounter","createdRXs","createdTXs","attachedHubs","occupiedNames","callRXFunc","headers","clonedData","func","handleClone","freezedData","handleFreeze","DBUS_ERRORS","UNEXPECTED_PREP_MODE","busId","hub","suffix","createInterfaceForHub","prefix","HUB_IS_ALREADY_ATTACHED","HUB_NAME_NOT_AUTHORIZED","HUB_NAME_IS_OCCUPIED","dbusInterface","DBusInterface","desc","genNewRX","topic","unplugRX","subHub","subSuffix","connect","regNumber","DBusTX","opts","head","DBusTXDataHeaders","DBusTXData","freezedTX","DBusRX","freezedRX","XENO_RX","TOPIC_IS_NOT_EXIST","TOPIC_HAS_NO_RXS","choosedRXs","PREF_RXS_ARE_NOT_EXIST","manual","BAD_REQUEST","ROUTER","objAsRecord","arrowedGetNewTX","arrowedGetNewRX","arrowedPlugRX","arrowedUnplugRX","RXs","TXs","RXsPlugMap","txId","txRegNumber","txDesc","listCallback","firstPageNumber","currPageNumber","lastPageNumber","entriesCount","callbackIsCalled","btnNextSpan","btnPrevSpan","callCallback","lock","toggleBtnsDisabled","ceil","DBusMsgRoutingMsg","path","callback","getStateCallback","setStateCallback","options","agents","restrictions","currRoute","wantedRoute","host","values","arrow","cancelRouteChange","activatedCount","errors","onlyDBus","agentsArr","agent","baseUrl","resUrl","fullUrl","url","fetch","method","json","UNEXPECTED_RESULT","UNKNOWN_ERROR","clientName","REST_CLIENT_NAMES","limitStr","limitResponse","JSON","stringify","regCar","winnerCarData","WINNERS","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","d","definition","key","o","defineProperty","enumerable","prototype","hasOwnProperty","Symbol","toStringTag","appDiv","App"],"mappings":"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","file":"main.780ab1ecff409078f274.js","sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"garage\":\"_21SC4SGf5mTamWfNdNRR\",\"garage__bg\":\"_2VnbeeG4HKnZfSWUedizHh\",\"garage__track-container\":\"_1rsPT6UvHnbHI-FUFvPaSe\",\"hue-rotate\":\"_3MSD3skhU7RLqKdx6pBax7\",\"garage__track-container_finish\":\"_1khEfVJzcbQlBMhoHPdhzY\",\"garage__winner-popup\":\"_17InT8lGlAlk8k1JRcrTCM\",\"garage-bg\":\"-BA3r_cxZwAYkgGQVVZeo\",\"garage-bg__video\":\"_3byu86MCf3s6B7JQuetNAw\",\"garage-bg__car-ctl-btn\":\"_3upDU-ngLjybmFg4wiVvfl\",\"garage-bg__car-ctl-block-number\":\"_3dT19pzigDW1UKuPVLEguq\",\"garage-bg__car-ctl-block\":\"_2e0Ox8Joh0jw60ztR_rVt5\",\"garage-bg__cars-ctls-block\":\"wMVLCRcoluFnZleBHWXlm\",\"garage-bg__self-ctls-block\":\"_2VQVmkB2amN4PG9XCyFye9\",\"garage-bg__pager\":\"_2avafWgl8XDS2KLJswKq0H\",\"garage-bg__pager-span\":\"_3ktlpozBQghco3VMHLJBo1\",\"garage-bg__pager-btn\":\"_2QdjLaEnj3Balh89eZAya4\",\"synthwave-background\":\"_2pUKJme_w_0KTS_JoVNV5b\",\"synthwave-background_race-mode\":\"n1z9UH35nfilmkK2lmQvV\",\"race\":\"_375ItX4gjZY-ZT7KrEfBgG\",\"move-grid\":\"_1MqERRNbzZtvdd9iE43L04\"};","// extracted by mini-css-extract-plugin\nexport default {\"car-div\":\"_3pRKwGaRv59JcJqlApAnkk\",\"car-div__canvas\":\"rH6_OMXna8-zeemMHF11D\",\"car-div__wheel\":\"_3WNDl-LGGtViqzAfLLX4CB\",\"car-div__wheel_forward\":\"_3Rdh32fs7fi-95LcabV_Ed\",\"car-div__wheel_backward\":\"_3xptMXOOFn6YcMVYMigRMa\",\"car-div__explosion\":\"_3w8-mlW0m2zLABohqiDQ3e\",\"car-div_rollForward\":\"_3xWmq3Q2UpNiq2nICrGAIN\",\"car-div-anim\":\"_381V-1xCMVwSdGT0FxnQiO\",\"tire-anim\":\"_2Qs9DAZPIqZivw_0ON2Vot\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"_2uo9WXSTJyDD3jBlT_quev\",\"text-input\":\"_2YNdYEaErpy02Ske_bZONx\",\"color-input\":\"_3Ye7rbfoBnq4HZn4H-yDB8\"};","// extracted by mini-css-extract-plugin\nexport default {\"main-controls\":\"_2b_svto1O0DGSO3_579_Xj\",\"btn-block\":\"_262VSHreYXfZUHLGeCJEvZ\"};","// extracted by mini-css-extract-plugin\nexport default {\"track\":\"_2hDrLwwwZMiv2NrI-XZZqJ\",\"track_illuminated\":\"_3zXlLAoKpXJ_jlpauHLjHR\",\"track__controls-block\":\"_3pqcODoHFqX9rxmLKBnhD4\"};","// extracted by mini-css-extract-plugin\nexport default {\"header\":\"_3TTTWNe5aoHesw4iV0YUGU\",\"header__logo\":\"_2idUQTZia_1M_0xkhMkXf8\",\"header-nav\":\"_7vejZGT8OzUejTiWyGs1P\",\"header-nav__item\":\"_1NYwlHRXmh2YGu63soBsjx\",\"header-nav__anchor\":\"_2n39qEg5Iz5Tym2Z0Jrjz9\",\"header-nav__anchor_active\":\"_2bRvd3RlExbbSpyXLuxSdS\",\"header-nav__svg\":\"_2FCXcgNK7Jgl9f3ZK-O56I\",\"header-nav__span\":\"_1NVrpdaSQLvqho4VNqQqit\",\"header-nav__list\":\"_1vy8OijKt-Cy7SGXyM4ek9\",\"header-nav__list_disabled\":\"_25SilQm6mkAlbl-WpajKBY\"};","// extracted by mini-css-extract-plugin\nexport default {\"winners\":\"HVDfoBgyIQ4teF5EKFzcD\",\"table\":\"_3mJKnd573Tt4WspNl7gf1J\",\"table__car-preview-box\":\"_86kcZK8UgXIsvYD-wpDED\",\"table__can-be-sorted\":\"_3Xa74hpyx3g6XUuZ9fB9Cm\",\"table__sorted-elem\":\"rfPuVNCW0Sd4nzQGO8-R8\",\"table__sorted-elem_asc\":\"N6296gY2c5AFEX4KjE4I4\",\"table__sorted-elem_desc\":\"_37bMOUs2OF28ZqMubJCPnM\",\"pager\":\"_2q-noyJbwIpKOMhl7AWlq5\",\"pager-span\":\"_1O8erRuDz9RWa3C9tqnUm-\",\"pager-btn\":\"_3OktYstRgXgDE6zlpOM6LA\"};","// extracted by mini-css-extract-plugin\nexport default {\"popup-modal\":\"_3KlZOyoPt2P4FT1Ofdi1oz\",\"popup-bg\":\"_1QGzfQYEHvrYonFptRzkG6\",\"popup-body\":\"_3zDyJwNy615xogiYvCl4vt\",\"popup-body-header\":\"_2DglTs5KJlA1QJriRI6bVZ\",\"popup-body-text\":\"_2oMxBL_Jv1KW3bHu3sVdaA\",\"popup-body__btn-close\":\"HV1Imp7Np5N8O5nUXwQsS\"};","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"_1KBIW4BNGKHwQtRcKc6JIF\",\"hue-rotate\":\"_1t6lrd-wEBCB6ei-o9kDmk\",\"bar\":\"_2DWg3PnmWwM25SBd7sLJQK\",\"body\":\"_24wm1l_qZHsMTx2Oy-enF4\",\"text\":\"_1UFV3thankQQ1R2Ly1Zle2\"};","// extracted by mini-css-extract-plugin\nexport default {\"app\":\"_2ljk-3_Qk7EjDct5a15qZP\",\"main-component\":\"_394erWdWCWrQmkYlaBZ1L5\",\"btn\":\"_3cliA46UjEIGfEKGRnJzCZ\",\"btn-1\":\"_7q7sGuJSjnM-fV8DfMtl5\",\"btn-4\":\"KE9Fso9VtLV8xX_x8IAiF\",\"btn-6\":\"_35BryCkuNmCUsRxmBw_Y1\",\"btn-9\":\"_9jiLaDmXVuzxrmO3P-9mb\",\"btn-13\":\"_1872fOtVBrHuR0iXYtVhRT\",\"btn-15\":\"TNTO3dtfSfS40M6g8U274\",\"glitched-text\":\"xB_2phBrodgB6jPUYYf8V\",\"glitch-animation-1\":\"_2N8U2GaQpCAdpuVv32CY9B\",\"glitch-animation-2\":\"_1g8DjVAkpXimf-Ld9-LLk8\"};","import { BaseComp } from './lib/components/base-comp/base-comp';\nimport { SimpleRouterAgent } from './lib/services/simple-router/simple-router-agent';\nimport { SimpleRouter } from './lib/services/simple-router/simple-router';\nimport { DBus } from './lib/services/dbus/dbus';\nimport { DBusMsgRouteIsChangedMsg } from './lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport { DBusTopics } from './lib/services/dbus/defs/dbus-topics.def';\nimport { DBUS_COMMON_RESPONSES } from './lib/services/dbus/defs/dbus-common-responses.def';\nimport { HeaderComponent } from './components/header/header';\n\nimport sharedStyles from './styles.scss';\nimport { DBusTXData } from './lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { GarageComp } from './components/garage/garage';\nimport {\n  DBusHub,\n  isDBusHub,\n  DBusInterface,\n} from './lib/services/dbus/defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from './lib/services/dbus/defs/dbus-hub-names.def';\nimport { WinnersComp } from './components/winners/winners';\nimport { REST_CLIENT_ERROR } from './services/rest-clients/rest-clients-errors.def';\nimport { isNotifiable } from './lib/interfaces/notifiable';\nimport { PopupStandaloneModal404Comp } from './lib/components/popups/standalone/modal/404/popup-404';\nimport { REST_CLIENT_GARAGE } from './services/rest-clients/client-garage/rest-client-garage';\n\nexport class App implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.APP;\n\n  protected loadedMainComponents: Record<string, BaseComp> = {};\n\n  protected currMainComponent: BaseComp | undefined;\n\n  protected defaultRouterAgent = new SimpleRouterAgent('hash', '', () =>\n    this.loadMainComponent('default'),\n  );\n\n  protected router = new SimpleRouter({\n    mode: '#',\n    defaultRoot: '',\n    defaultAgent: this.defaultRouterAgent,\n  });\n\n  protected mainlineDBus = new DBus();\n\n  // protected garageRestClient = new RestClientGarage('http://127.0.0.1:3000');\n\n  constructor(private readonly rootElement: HTMLElement) {\n    window.addEventListener('error', e => console.log(e));\n    window.addEventListener('unhandledrejection', e => {\n      e.preventDefault();\n      e.promise.catch((error: Error) => {\n        if (\n          error.message in REST_CLIENT_ERROR &&\n          error.message === REST_CLIENT_ERROR.CONNECTION_REFUSED\n        ) {\n          const popup = new PopupStandaloneModal404Comp();\n          popup.setText(`No connection, check if server is started!`).show();\n          const retry = async () => {\n            try {\n              await REST_CLIENT_GARAGE.getCars();\n              popup.hide();\n              this.router.activateWantedAgents();\n            } catch {\n              await new Promise(res => setTimeout(res, 1000));\n              retry();\n            }\n          };\n          retry();\n        }\n      });\n    });\n\n    this.rootElement.classList.add(sharedStyles.app);\n\n    // asyncFunc();\n    const header = new HeaderComponent(DBUS_HUB_NAMES.HEADER);\n    this.rootElement.append(header.rootElement);\n\n    // this.garage.rootElement.classList.add(sharedStyles['main-component']);\n    // this.rootElement.append(this.garage.rootElement);\n\n    this.mainlineDBus.attachHub(header);\n    this.mainlineDBus.attachHub(this);\n    this.mainlineDBus.attachHub(this.router);\n\n    this.router.activateWantedAgents();\n  }\n\n  connect(intrfce: DBusInterface) {\n    const routeRX = intrfce.getNewRX(this.watchRouterMsgs);\n    intrfce.plugRX(DBusTopics.ROUTING, routeRX);\n  }\n\n  private watchRouterMsgs = async (data: DBusTXData) => {\n    const { msg } = data;\n    if (msg instanceof DBusMsgRouteIsChangedMsg) {\n      // TODO: Rework with enum!?\n      this.loadMainComponent(msg.newRoute);\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private loadMainComponent(name: string): void {\n    if (!(name in this.loadedMainComponents)) {\n      switch (name) {\n        case '#garage':\n          this.loadedMainComponents[`${name}`] = new GarageComp();\n          break;\n        case '#winners':\n          this.loadedMainComponents[`${name}`] = new WinnersComp();\n          break;\n        default:\n          window.location.hash = '#garage';\n          break;\n      }\n    }\n    const newComponent = this.loadedMainComponents[`${name}`];\n\n    if (newComponent) {\n      if (this.currMainComponent) {\n        this.currMainComponent.rootElement.remove();\n      }\n\n      this.currMainComponent = newComponent;\n      newComponent.rootElement.classList.add(sharedStyles['main-component']);\n      this.rootElement.append(newComponent.rootElement);\n\n      if (isDBusHub(this.currMainComponent)) {\n        try {\n          this.mainlineDBus.attachHub(this.currMainComponent);\n        } catch {\n          // no need to catch\n        }\n      }\n      if (isNotifiable(this.currMainComponent)) {\n        console.log('notify');\n        this.currMainComponent.notify(null);\n      }\n    }\n  }\n}\n","export enum CarActions {\n  CREATED,\n  SELECTED,\n  REMOVED,\n  UPDATED,\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\nimport { CarActions } from '../../../car-actions.def';\n\nexport class DBusMsgCarActionMsg extends DBusMsg {\n  constructor(\n    readonly action: CarActions,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.CAR_ACTION, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionCreatedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.CREATED, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { GarageServicemanContract } from '../../../garage-serviceman-contract.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionRemovedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly nullifiedContract: GarageServicemanContract,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.REMOVED, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionSelectedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly notifyChanges?: (car: RegCarData) => unknown,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.SELECTED, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgGarageRaceMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GARAGE, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageRaceMsg } from './garage-race-msg.def';\n\nexport class DBusMsgRaceRequestMsg extends DBusMsgGarageRaceMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { RaceStatusesList } from '../../../race-statuses.def';\nimport { DBusMsgGarageRaceMsg } from './garage-race-msg.def';\n\nexport class DBusMsgGarageRaceStatusMsg extends DBusMsgGarageRaceMsg {\n  constructor(\n    readonly status: RaceStatusesList,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgGarageResetMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GARAGE, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageResetMsg } from './garage-reset-msg.def';\n\nexport class DBusMsgGarageResetReqMsg extends DBusMsgGarageResetMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { UnregCarData } from '../../definitions/car-data.def';\nimport { DBUS_COMMON_RESPONSES } from '../../lib/services/dbus/defs/dbus-common-responses.def';\nimport {\n  DBusHubNamesList,\n  DBUS_HUB_NAMES,\n} from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../lib/services/dbus/defs/dbus-port.def';\nimport { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBusTX } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionRemovedMsg } from './dbus-msgs/by-topic/car-action/garage-car-remove-msg.def';\nimport { GarageManagersTeam } from './garage-servant';\nimport { CarComp } from './subcomps/car/car';\nimport { TrackComp } from './subcomps/track/track';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\nimport { DBusMsgCarActionCreatedMsg } from './dbus-msgs/by-topic/car-action/garage-car-created-msg.def';\nimport { DBusMsgRaceRequestMsg } from './dbus-msgs/by-topic/garage/garage-race-request-msg.def';\nimport { DBusMsgGarageResetReqMsg } from './dbus-msgs/by-topic/garage/garage-reset-req-msg.def';\n\nimport styles from './garage.scss';\nimport sharedStyles from '../../styles.scss';\nimport { Pager } from '../../lib/services/pager/pager';\nimport { Notifiable } from '../../lib/interfaces/notifiable';\nimport { DBusMsgGenerateCarsMsg } from './subcomps/main-controls/dbus-msgs/generate-cars-msg.def';\n\ntype TracksGeometry = {\n  trackHeights: number[];\n  displacements: number[];\n  paddingBase: number;\n  paddingAddShift: number;\n};\n\nexport class GarageComponentControllerAkaDirector implements DBusHub {\n  static readonly DISPLACEMENT_FIX = -20;\n\n  readonly hubName = DBUS_HUB_NAMES.GARAGE_CONTROLLER;\n\n  protected txs = new Set<DBusTX>();\n\n  private garageManagersTeam: GarageManagersTeam;\n\n  private pager: Pager;\n\n  private entriesPerPage = 7;\n\n  private pagerContainer = document.createElement('div');\n\n  private readonly carImgRatio = 3.78;\n\n  private readonly scaleFactor = 0.95;\n\n  constructor(\n    private tracksContainer: HTMLElement,\n    private carCtlsBlock: HTMLElement,\n  ) {\n    this.garageManagersTeam = new GarageManagersTeam(\n      tracksContainer,\n      carCtlsBlock,\n    );\n\n    this.pagerContainer.classList.add(styles['garage-bg__pager']);\n    this.pager = new Pager(this.entriesPerPage, this.pagerCallback);\n\n    const btnNextPage = this.pager.getBtnNextPage();\n    const btnPrevPage = this.pager.getBtnPrevPage();\n    btnNextPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['garage-bg__pager-btn'],\n    );\n    btnPrevPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['garage-bg__pager-btn'],\n    );\n\n    const pagerInfo = this.pager.getPagerSpan();\n    pagerInfo.classList.add(styles['garage-bg__pager-span']);\n\n    this.pagerContainer.append(btnPrevPage, btnNextPage, pagerInfo);\n  }\n\n  private pagerCallback = async (dir: 'prev' | 'next'): Promise<boolean> => {\n    try {\n      await this.reloadData(dir);\n      return true;\n    } catch {\n      return false;\n    }\n  };\n\n  async startWorking(): Promise<boolean> {\n    try {\n      await this.reloadData('no');\n      window.addEventListener('resize', () => this.redraw());\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  async connect(int: DBusInterface) {\n    this.txs.add(int.getNewTX('send requests to REST Garage client'));\n    this.garageManagersTeam.autoConnect(int);\n\n    const carActionsMsgsRX = int.getNewRX(\n      this.carActionsRXFunc,\n      'monitor cars removes',\n    );\n    int.plugRX(DBusTopics.CAR_ACTION, carActionsMsgsRX);\n\n    const raceMsgsRX = int.getNewRX(this.racingRXFunc, 'handle race requsets');\n    int.plugRX(DBusTopics.GARAGE, raceMsgsRX);\n\n    const generatorMsgsRX = int.getNewRX(this.generatorRXFunc);\n    int.plugRX(DBusTopics.GENERATE, generatorMsgsRX);\n  }\n\n  private generatorRXFunc = async (data: DBusTXData) => {\n    if (\n      data.msg instanceof DBusMsgGenerateCarsMsg &&\n      data.msg.status === 'end'\n    ) {\n      const contracts = this.garageManagersTeam.getContracts();\n\n      if (contracts.size < 7) this.reloadData('no');\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private racingRXFunc = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgRaceRequestMsg) {\n      this.pager.toogleLock(true);\n      await this.performRace();\n      this.pager.toogleLock(false);\n      return true;\n    }\n    if (data.msg instanceof DBusMsgGarageResetReqMsg) {\n      return this.resetState();\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private async resetState() {\n    const reseted = await this.garageManagersTeam.resetState();\n    return reseted;\n  }\n\n  private async performRace() {\n    await this.garageManagersTeam.performRace();\n  }\n\n  private carActionsRXFunc = async (data: DBusTXData) => {\n    if (\n      data.msg instanceof DBusMsgCarActionRemovedMsg ||\n      data.msg instanceof DBusMsgCarActionCreatedMsg\n    ) {\n      try {\n        this.reloadData('no');\n      } catch {\n        this.pager.tryChangePage('prev');\n      }\n    }\n\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private reloadData(dir: 'prev' | 'next' | 'no') {\n    return new Promise<boolean>((res, rej) => {\n      const page = dir\n        ? dir === 'next'\n          ? this.pager.getCurrPageNumber() + 1\n          : dir === 'prev'\n          ? this.pager.getCurrPageNumber() - 1\n          : dir === 'no'\n          ? this.pager.getCurrPageNumber()\n          : 1\n        : 1;\n      REST_CLIENT_GARAGE.getCars(page, this.pager.getEntriesPerPage()).then(\n        async response => {\n          const { limit, cars } = response;\n          this.pager.setEntriesCount(Number.parseInt(limit, 10));\n          if (cars.length === 0 && dir !== 'no') {\n            rej();\n            return;\n          }\n          await this.garageManagersTeam.nullifyContracts();\n          const newContracts: GarageServicemanContract[] = [];\n\n          cars.forEach((car, index) => {\n            const track = new TrackComp();\n            const carComp = new CarComp(car, index + 1);\n            track.placeCar(carComp);\n            newContracts.push({ track, car: carComp });\n          });\n\n          this.garageManagersTeam.addContracts(...newContracts);\n          this.garageManagersTeam.resetState();\n          this.redraw();\n          res(true);\n        },\n      );\n    });\n  }\n\n  private redraw() {\n    this.clearDOM();\n    const tracks = [...this.garageManagersTeam.getContracts()].map(\n      contract => contract.track,\n    );\n\n    const geometry = this.calcGeometry();\n    this.setStylesForTracks(geometry);\n\n    this.drawTracks();\n    this.drawCarsCtls();\n  }\n\n  private clearDOM() {\n    while (this.tracksContainer.firstChild)\n      this.tracksContainer.firstChild.remove();\n    while (this.carCtlsBlock.firstChild) this.carCtlsBlock.firstChild.remove();\n  }\n\n  private calcGeometry(): TracksGeometry {\n    const style = window.getComputedStyle(this.tracksContainer);\n    const containerHeight =\n      Number.parseFloat(style.height) -\n      Number.parseFloat(style.paddingBottom) -\n      Number.parseFloat(style.paddingTop);\n    const firstAutoWidth = window.innerWidth * 0.2;\n    const firstAutoHeight = firstAutoWidth / this.carImgRatio;\n    const heights: number[] = [];\n    let heightSum = 0;\n    const contracts = [...this.garageManagersTeam.getContracts()];\n\n    contracts.forEach((contract, index) => {\n      const factor = this.scaleFactor ** index;\n      const carTrackHeight = firstAutoHeight * factor;\n      heightSum += carTrackHeight;\n      heights.push(carTrackHeight);\n    });\n\n    const excessHeight = heightSum - containerHeight;\n    const heightsReversed = heights.sort((a, b) => a - b);\n    const displacementBase =\n      excessHeight > 0\n        ? excessHeight / this.garageManagersTeam.getContracts().size - 2\n        : 0;\n\n    const displacements: number[] = [];\n    const midIndex = (contracts.length - 1) / 2;\n\n    contracts.forEach((contract, index) => {\n      const diff = index - midIndex;\n      const displacement =\n        displacementBase * -diff +\n        GarageComponentControllerAkaDirector.DISPLACEMENT_FIX;\n      displacements.push(displacement);\n    });\n\n    const paddingBase = (heightsReversed[0] as number) * this.carImgRatio;\n    const paddingAddShift = (20 * window.innerWidth) / 1920; // 20 - is good looking on 1920\n\n    return {\n      trackHeights: heightsReversed,\n      displacements,\n      paddingBase,\n      paddingAddShift,\n    };\n  }\n\n  private setStylesForTracks(geometry: TracksGeometry) {\n    const contracts = [...this.garageManagersTeam.getContracts()];\n\n    contracts.forEach((contract, index) => {\n      contract.track.rootElement.style.setProperty(\n        'height',\n        `${geometry.trackHeights[index]}px`,\n      );\n\n      // if (index !== 0) {\n      contract.track.rootElement.style.setProperty(\n        'top',\n        `${geometry.displacements[index]}px`,\n      );\n      // }\n\n      contract.track.rootElement.style.setProperty('z-index', `${index + 1}`);\n\n      contract.track.rootElement.style.setProperty(\n        '--padding-w',\n        `${\n          (geometry.trackHeights[\n            geometry.trackHeights.length - 1 - index\n          ] as number) *\n            this.carImgRatio -\n          geometry.paddingBase +\n          geometry.paddingAddShift * (contracts.length - 1 - index)\n        }px`,\n      );\n    });\n  }\n\n  private drawTracks() {\n    this.tracksContainer.append(\n      this.pagerContainer,\n      ...[...this.garageManagersTeam.getContracts()].map(\n        contract => contract.track.rootElement,\n      ),\n    );\n  }\n\n  private drawCarsCtls() {\n    const contracts = [...this.garageManagersTeam.getContracts()];\n    const ctlBlocks = contracts.map((contract, index) => {\n      const block = this.createCarCtlBlock(contract.car, index + 1);\n      this.connectCtlAndTrack(block, contract.track);\n      return block;\n    });\n    this.carCtlsBlock.append(...ctlBlocks);\n  }\n\n  private createCarCtlBlock = (car: CarComp, index: number): HTMLElement => {\n    const btns = [car.btnSelect, car.btnStart, car.btnReset, car.btnRm];\n\n    car.btnStart.classList.add(sharedStyles['btn-15']);\n    car.btnSelect.classList.add(sharedStyles['btn-13']);\n    car.btnReset.classList.add(sharedStyles['btn-9']);\n    car.btnRm.classList.add(sharedStyles['btn-4']);\n\n    btns.forEach(btn => {\n      btn.classList.add(sharedStyles.btn, styles['garage-bg__car-ctl-btn']);\n    });\n\n    const numberSpan = document.createElement('span');\n    numberSpan.classList.add(styles['garage-bg__car-ctl-block-number']);\n    numberSpan.textContent = index.toString();\n    const container = document.createElement('div');\n    container.classList.add(styles['garage-bg__car-ctl-block']);\n    container.append(numberSpan, ...btns);\n    return container;\n  };\n\n  private connectCtlAndTrack = (ctlElem: HTMLElement, track: TrackComp) => {\n    ctlElem.addEventListener(\n      'mouseover',\n      () => track.illuminateSelf(true),\n      true,\n    );\n    ctlElem.addEventListener(\n      'mouseout',\n      () => track.illuminateSelf(false),\n      true,\n    );\n  };\n}\n","import { RegCarData } from '../../definitions/car-data.def';\nimport { PopupStandaloneModal404Comp } from '../../lib/components/popups/standalone/modal/404/popup-404';\nimport { PopupStandaloneModalComp } from '../../lib/components/popups/standalone/modal/popup-standalone-modal';\nimport { PopupStandaloneModalProgressComp } from '../../lib/components/popups/standalone/modal/progress/popup-progress';\nimport { genUniqId } from '../../lib/generators/generators';\nimport {\n  EngineResponse,\n  REST_CLIENT_ENGINE,\n} from '../../services/rest-clients/client-engine/rest-client-engine';\nimport { REST_CLIENT_ERROR } from '../../services/rest-clients/rest-clients-errors.def';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\nimport { CarComp } from './subcomps/car/car';\n\nexport enum GarageDriverCommands {\n  START_DRIVING,\n  STOP_DRIVING,\n}\n\nexport class GarageDriver {\n  private contract: GarageServicemanContract | undefined;\n\n  private currDriveId: string | undefined;\n\n  private drivePromise: Promise<unknown> | undefined;\n\n  private ignitionPromise: Promise<unknown> | undefined;\n\n  private lastStart: number | undefined;\n\n  private lastTimeInMs: number | undefined;\n\n  public isFree(): boolean {\n    if (!this.contract) return true;\n    return false;\n  }\n\n  putBehindTheWheel(contract: GarageServicemanContract): void {\n    if (this.contract) throw new Error('ALREADY IN CAR');\n    this.contract = contract;\n  }\n\n  async getOutOfTheCar() {\n    this.contract = undefined;\n  }\n\n  async performDrivingProtocol(flags?: Record<string, unknown>) {\n    const newPromise = new Promise<{\n      driveParams: EngineResponse;\n      drivePromise: Promise<number | false>;\n    }>((res, rej) => {\n      if (flags) this.contract?.car.disableCtls(); // race\n      const thisDriveId = genUniqId();\n      this.currDriveId = thisDriveId;\n      this.ignitionPromise = this.TurnOnTheIgnition()\n        .then(driveParams => {\n          if (thisDriveId !== this.currDriveId) rej(new Error('interrupted'));\n          // console.log(driveParams);\n          const drivePromise = this.drive(driveParams, thisDriveId, flags);\n          res({\n            driveParams,\n            drivePromise,\n          });\n        })\n        .catch((error: Error) => {\n          if (thisDriveId !== this.currDriveId) rej(new Error('interrupted'));\n          else rej(error);\n        });\n    });\n    return newPromise;\n  }\n\n  private async TurnOnTheIgnition() {\n    if (!this.contract) throw new Error('NOT_BEHIND_THE_WHEEL');\n    if (this.drivePromise) await this.drivePromise;\n    const params = await REST_CLIENT_ENGINE.toggleEngine(\n      this.contract.car.currCar.id,\n      'started',\n    );\n    // console.log('ENGINE STARTED');\n    return params;\n  }\n\n  // !!! If animation fails, this promise never resolves!\n  async returnToStart() {\n    this.currDriveId = undefined;\n    if (this.contract) {\n      if (this.ignitionPromise) await this.ignitionPromise;\n      if (this.drivePromise) {\n        await this.stopCar(true, false);\n        await this.contract.car.rollBack(this.drivePromise);\n        const msgBlock = document.createElement('div');\n        msgBlock.style.setProperty('height', '100%');\n        msgBlock.style.setProperty('width', '40%');\n        msgBlock.style.setProperty('position', 'absolute');\n        msgBlock.style.setProperty('right', '0px');\n        msgBlock.style.setProperty('top', '100%');\n        msgBlock.style.setProperty('transform', 'translate(-40%, -120%)');\n        this.contract.track.rootElement.append(msgBlock);\n        const popup = new PopupStandaloneModalProgressComp();\n\n        popup\n          .setText(\n            `I can't let the engine start again until\n          the server finishes its business, read the notes, please.`,\n          )\n          .show(msgBlock);\n        const interval = this.updateProgress(popup);\n        await this.contract.car.playAwaitingAnim(this.drivePromise);\n        if (interval) clearTimeout(interval);\n        popup.hide();\n        msgBlock.remove();\n      } else {\n        await this.stopCar(false, false);\n        await this.contract.car.rollBack();\n      }\n    }\n    return true;\n  }\n\n  private updateProgress(\n    popup: PopupStandaloneModalProgressComp,\n  ): NodeJS.Timeout {\n    const interval = setInterval(() => {\n      if (this.lastTimeInMs && this.lastStart) {\n        const progress =\n          ((Date.now() - this.lastStart) / this.lastTimeInMs) * 100;\n        console.log(progress);\n        popup.setProgress(progress);\n      } else clearInterval(interval);\n    }, 500);\n    return interval;\n  }\n\n  private async drive(\n    driveParams: EngineResponse,\n    driveId: string,\n    flags?: Record<string, unknown>,\n  ): Promise<false | number> {\n    return new Promise<false | number>((res, rej) => {\n      if (this.contract) {\n        const { contract } = this;\n        const time = GarageDriver.calculateDriveTime(driveParams);\n        this.lastStart = Date.now();\n        this.lastTimeInMs = time * 1000;\n        const start = Date.now();\n        this.drivePromise = REST_CLIENT_ENGINE.enterDriveMode(\n          contract.car.currCar.id,\n        ).then(success => {\n          if (\n            !(contract === this.contract) ||\n            !(driveId === this.currDriveId)\n          ) {\n            rej(new Error('interrupted'));\n          } else if (success) {\n            res(time);\n            console.log('stop car finish');\n            this.stopCar(true, true, false, flags);\n          } else {\n            console.log('stop car broken');\n            this.stopCar(true, false, true, flags);\n            res(false);\n          }\n          console.log(`time from start: ${Date.now() - start}`);\n        });\n        contract.car.rollForward(time, !flags).catch(() => {\n          res(false);\n        });\n      } else rej(new Error('No car'));\n    });\n  }\n\n  private async stopCar(\n    onlyAnim = false,\n    rollover = true,\n    broken = false,\n    flags?: Record<string, unknown>,\n  ) {\n    if (this.contract) {\n      if (!broken && !onlyAnim) {\n        const response = await REST_CLIENT_ENGINE.toggleEngine(\n          this.contract.car.currCar.id,\n          'stopped',\n        );\n        console.log('stopped by server', response);\n      }\n      await this.contract.car.stop(rollover, broken, flags);\n      return true;\n    }\n    throw new Error('No car');\n  }\n\n  private static calculateDriveTime(params: EngineResponse) {\n    const time = params.distance / 1000 / params.velocity; /// !!! distance units???\n    return time;\n  }\n}\n","import { RegCarData, WinnerCarData } from '../../definitions/car-data.def';\nimport { DBusInterface } from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../lib/services/dbus/defs/dbus-port.def';\nimport { DBusRX } from '../../lib/services/dbus/defs/dbus-rx/dbus-rx.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgCarActionSelectedMsg } from './dbus-msgs/by-topic/car-action/garage-car-select-msg.def';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionRemovedMsg } from './dbus-msgs/by-topic/car-action/garage-car-remove-msg.def';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\nimport { GarageDriver, GarageDriverCommands } from './garage-driver';\nimport { genUniqId } from '../../lib/generators/generators';\n\nimport styles from './garage.scss';\nimport { REST_CLIENT_WINNERS } from '../../services/rest-clients/client-winners/rest-client-winners';\nimport { REST_CLIENT_ERROR } from '../../services/rest-clients/rest-clients-errors.def';\nimport { DBusMsgGarageRaceStatusMsg } from './dbus-msgs/by-topic/garage/garage-race-status-msg.def';\nimport { RaceStatusesList } from './race-statuses.def';\nimport {\n  getTransitionDuration,\n  transitionPromise,\n} from '../../lib/gui/animation';\nimport { GaragePopupWinner } from './subcomps/popup-winner/popup-winner';\n\ntype RaceData = {\n  raceId: string;\n  arrivedByOrder: GarageServicemanContract[];\n  notArrived: GarageServicemanContract[];\n  participantsCount: number;\n  flags: Record<string, unknown>;\n  stratedCount: number;\n};\n\ntype RaceResults = {\n  arrivedByOrder: GarageServicemanContract[];\n  notArrived: GarageServicemanContract[];\n};\nexport class GarageManagersTeam implements DBusPort {\n  protected txs = new Set<DBusTX>();\n\n  protected contracts = new Set<GarageServicemanContract>();\n\n  protected freeDrivers = new Set<GarageDriver>();\n\n  protected busyDrivers = new Map<GarageServicemanContract, GarageDriver>();\n\n  protected currRaceId: string | undefined;\n\n  protected winnerPopup = new GaragePopupWinner();\n\n  constructor(\n    private readonly tracksContainer: HTMLElement,\n    private readonly carCtlsBlock: HTMLElement,\n  ) {\n    this.carCtlsBlock.addEventListener('click', this.carCtlsClickListener);\n    this.winnerPopup.rootElement.classList.add(styles['garage__winner-popup']);\n  }\n\n  autoConnect(int: DBusInterface) {\n    const tx = int.getNewTX('garage serviceman');\n    this.txs.add(tx);\n  }\n\n  public getContracts() {\n    return this.contracts;\n  }\n\n  async nullifyContracts(contracts?: GarageServicemanContract[]) {\n    if (contracts) {\n      this.tryFreeDrivers(...contracts);\n      contracts.forEach(contract => {\n        this.contracts.delete(contract);\n      });\n    } else {\n      this.tryFreeDrivers(...this.contracts);\n      this.contracts.clear();\n    }\n  }\n\n  addContracts(...сontracts: GarageServicemanContract[]) {\n    сontracts.forEach(newContract => this.contracts.add(newContract));\n  }\n\n  private carCtlsClickListener = (e: Event) => {\n    if (e.target instanceof HTMLElement) {\n      const elem = e.target;\n      let btn: HTMLButtonElement | undefined;\n\n      if (elem instanceof HTMLButtonElement) btn = elem;\n      else if (elem.parentElement instanceof HTMLButtonElement)\n        btn = elem.parentElement;\n\n      if (btn && btn.disabled !== true) {\n        this.contracts.forEach(contract => {\n          if (this.currRaceId) return;\n          if (btn === contract.car.btnSelect) {\n            this.handleSelection(contract);\n            return;\n          }\n          if (btn === contract.car.btnRm) {\n            contract.car.btnRm.disabled = true;\n            this.handleRemoving(contract);\n            return;\n          }\n          if (btn === contract.car.btnStart) {\n            contract.car.btnStart.disabled = true;\n            this.startDriving(contract);\n            return;\n          }\n          if (btn === contract.car.btnReset) {\n            contract.car.btnReset.disabled = true;\n            this.handleRestoreState(contract);\n          }\n        });\n      }\n    }\n  };\n\n  async resetState(prepareForRace?: boolean) {\n    if (!prepareForRace) this.currRaceId = undefined;\n    this.winnerPopup.rootElement.remove();\n    this.tracksContainer.classList.remove(\n      styles['synthwave-background_race-mode'],\n    );\n    await this.rollbackCars();\n\n    if (!prepareForRace) {\n      this.broadcastRaceStatus('READY_TO_GO');\n    }\n  }\n\n  private async handleRestoreState(contract: GarageServicemanContract) {\n    const driver = this.busyDrivers.get(contract);\n    if (driver) {\n      await driver.returnToStart();\n    }\n  }\n\n  private async startDriving(\n    contract: GarageServicemanContract,\n    flags?: Record<string, unknown>,\n  ) {\n    let choosedDriver = this.busyDrivers.get(contract);\n\n    if (!choosedDriver) {\n      // !!! excess check?\n      choosedDriver = [...this.freeDrivers].find(driver => driver.isFree());\n\n      if (choosedDriver) {\n        this.freeDrivers.delete(choosedDriver);\n      } else {\n        choosedDriver = new GarageDriver();\n      }\n\n      this.busyDrivers.set(contract, choosedDriver);\n\n      choosedDriver.putBehindTheWheel(contract);\n    }\n\n    return choosedDriver.performDrivingProtocol(flags);\n  }\n\n  private handleRemoving(contract: GarageServicemanContract) {\n    REST_CLIENT_GARAGE.deleteCar(contract.car.currCar.id).then(async () => {\n      await REST_CLIENT_WINNERS.deleteWinner(contract.car.currCar.id).catch(\n        () => {},\n      );\n      this.tryFreeDrivers(contract);\n      this.contracts.delete(contract);\n      const msg = new DBusMsgCarActionRemovedMsg(\n        contract.car.currCar,\n        contract,\n      );\n      this.txs.forEach(tx => {\n        tx.transmit({\n          msg,\n          prepMode: DBusTXPrepModes.freeze,\n          waitMode: DBusTXWaitModes.nowait,\n        });\n      });\n    });\n  }\n\n  private handleSelection(contract: GarageServicemanContract) {\n    const msg = new DBusMsgCarActionSelectedMsg(\n      contract.car.currCar,\n      this.genSelectCallback(contract),\n    );\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  private async rollbackCars() {\n    this.tracksContainer.classList.remove(\n      styles['garage__track-container_finish'],\n    );\n    this.tracksContainer.style.setProperty('--translate-x', '0px');\n    // rollback cars\n    const rollbacks: Promise<unknown>[] = [];\n    this.busyDrivers.forEach(driver => {\n      rollbacks.push(driver.returnToStart());\n    });\n    await Promise.all(rollbacks);\n  }\n\n  async performRace() {\n    // prepare\n    const thisRaceId = genUniqId();\n    this.currRaceId = thisRaceId;\n    await this.resetState(true);\n    // check if user cancell a race\n    if (thisRaceId !== this.currRaceId) return;\n\n    // process race\n    const raceData: RaceData = {\n      raceId: thisRaceId,\n      arrivedByOrder: [],\n      notArrived: [],\n      participantsCount: this.contracts.size,\n      flags: {\n        roadElem: this.tracksContainer,\n        isFinishVisible: false, // TODO: rm\n      },\n      stratedCount: 0,\n    };\n    this.broadcastRaceStatus('IN_PROCESS');\n    await this.processRace(raceData)\n      .catch((error: Error) => {\n        if (!(thisRaceId !== this.currRaceId)) throw error;\n      })\n      .finally(() => {\n        this.tracksContainer.classList.remove(\n          styles['synthwave-background_race-mode'],\n        );\n      });\n\n    // check if user cancell a race\n    if (thisRaceId !== this.currRaceId) return;\n\n    // console.log(raceData);\n\n    this.broadcastRaceStatus('NEED_RESET');\n    // TODO: Do something else?\n  }\n\n  private broadcastRaceStatus(status: RaceStatusesList) {\n    const msg = new DBusMsgGarageRaceStatusMsg(status);\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  // false if race was interrupted\n  private processRace(raceData: RaceData) {\n    return new Promise<RaceData | false>(res => {\n      this.contracts.forEach(contract => {\n        this.startDriving(contract, raceData.flags).then(response => {\n          if (raceData.raceId !== this.currRaceId) {\n            res(false);\n            return;\n          }\n\n          if (raceData.stratedCount === raceData.participantsCount - 1) {\n            this.tracksContainer.classList.add(\n              styles['synthwave-background_race-mode'],\n            );\n            raceData.flags.isRoadMoves = true;\n          } else raceData.stratedCount++;\n\n          if (!(response instanceof Error)) {\n            response.drivePromise\n              .then(result =>\n                this.handleDriveResult(raceData, contract, result),\n              )\n              .catch((error: Error) => {\n                if (error.message === 'interrupted') res(false);\n              })\n              .finally(() => {\n                console.log(raceData);\n                if (\n                  raceData.arrivedByOrder.length +\n                    raceData.notArrived.length ===\n                  raceData.participantsCount\n                ) {\n                  console.log(raceData);\n                  res(raceData);\n                }\n              });\n          } else {\n            throw response;\n          }\n        });\n      });\n    });\n  }\n\n  private handleDriveResult(\n    raceData: RaceData,\n    contract: GarageServicemanContract,\n    result: number | false,\n  ) {\n    if (raceData.raceId !== this.currRaceId) return;\n    if (result !== false) {\n      if (raceData.arrivedByOrder.length === 0) {\n        this.handleWinner(contract, result, raceData.flags);\n      }\n      raceData.arrivedByOrder.push(contract);\n    } else {\n      raceData.notArrived.push(contract);\n    }\n  }\n\n  private handleWinner = async (\n    contract: GarageServicemanContract,\n    time: number,\n    flags: Record<string, unknown>,\n  ) => {\n    flags.isFinishVisible = true;\n    this.tracksContainer.classList.add(\n      styles['garage__track-container_finish'],\n    );\n    const style = window.getComputedStyle(this.tracksContainer, '::after');\n    const duration = getTransitionDuration(style, 'right');\n    if (duration) {\n      const awaitTime = Number.parseFloat(duration);\n      if (awaitTime > 0)\n        await new Promise(res => setTimeout(res, awaitTime * 1000));\n    }\n    this.tracksContainer.classList.remove(\n      styles['synthwave-background_race-mode'],\n    );\n    flags.isRoadMoves = false;\n    const winnerCar = contract.car.currCar;\n    this.winnerPopup.setData(\n      winnerCar,\n      time.toFixed(2),\n      contract.car.index?.toString(),\n    );\n    this.tracksContainer.append(this.winnerPopup.rootElement);\n    REST_CLIENT_WINNERS.getWinner(winnerCar.id)\n      .then(winnerRecord => {\n        const updatedWinnerData: WinnerCarData = {\n          id: winnerRecord.id,\n          wins: winnerRecord.wins + 1,\n          time:\n            time < winnerRecord.time\n              ? Number.parseFloat(time.toFixed(2))\n              : winnerRecord.time,\n        };\n        REST_CLIENT_WINNERS.updateWinner(updatedWinnerData);\n      })\n      .catch((error: Error) => {\n        if (error.message === REST_CLIENT_ERROR.NOT_FOUND) {\n          const newWinnerData: WinnerCarData = {\n            id: winnerCar.id,\n            wins: 1,\n            time: Number.parseFloat(time.toFixed(2)),\n          };\n          REST_CLIENT_WINNERS.createWinner(newWinnerData);\n        }\n      });\n  };\n\n  private tryFreeDrivers(...contracts: GarageServicemanContract[]) {\n    contracts.forEach(contract => {\n      const driver = this.busyDrivers.get(contract);\n      if (driver) {\n        driver.getOutOfTheCar().then(() => {\n          this.busyDrivers.delete(contract);\n          this.freeDrivers.add(driver);\n        });\n      }\n    });\n  }\n\n  private genSelectCallback(contract: GarageServicemanContract) {\n    return (car: RegCarData) => {\n      if (!this.contracts.has(contract)) return;\n      contract.car.updateData(car);\n    };\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { DBUS_HUB_NAMES } from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { GarageComponentControllerAkaDirector } from './garage-controller';\nimport { MainControlsComp } from './subcomps/main-controls/main-controls';\n\nimport styles from './garage.scss';\nimport sharedStyles from '../../styles.scss';\nimport { Notifiable } from '../../lib/interfaces/notifiable';\nimport { PopupStandaloneModalProgressComp } from '../../lib/components/popups/standalone/modal/progress/popup-progress';\n\nexport class GarageComp extends BaseComp implements DBusHub, Notifiable {\n  readonly hubName = DBUS_HUB_NAMES.GARAGE;\n\n  private controller: GarageComponentControllerAkaDirector;\n\n  private isControllerWorking = false;\n\n  private mainControlsComp = new MainControlsComp();\n\n  private carsCtlsBlock = document.createElement('div');\n\n  private bgVideo = document.createElement('video');\n\n  private popup = new PopupStandaloneModalProgressComp();\n\n  constructor() {\n    super('section');\n    this.popup.setText('Loading...').setProgress(1).show();\n    this._rootElement.classList.add(styles.garage);\n\n    const tracksContainer = document.createElement('div');\n    tracksContainer.classList.add(\n      styles['garage__track-container'],\n      styles['synthwave-background'],\n    );\n\n    const selfCtlsBlock = document.createElement('div');\n    selfCtlsBlock.classList.add(styles['garage-bg__self-ctls-block']);\n    selfCtlsBlock.append(this.mainControlsComp.rootElement);\n\n    const bg = document.createElement('div');\n    bg.classList.add(styles.garage__bg, styles['garage-bg']);\n\n    this.bgVideo.classList.add(styles['garage-bg__video']);\n\n    this.bgVideo.controls = false;\n    this.bgVideo.loop = true;\n    this.bgVideo.defaultMuted = true;\n    this.bgVideo.muted = true;\n    this.bgVideo.autoplay = true;\n    this.bgVideo.addEventListener('progress', this.bgVideoProgressListener);\n    this.bgVideo.addEventListener(\n      'canplaythrough',\n      this.bgVideoCanPlayListener,\n    );\n    this.bgVideo.src = './assets/videos/bg/cyberpunk2077-garage.mp4';\n\n    bg.append(this.bgVideo, selfCtlsBlock);\n    this.controller = new GarageComponentControllerAkaDirector(\n      tracksContainer,\n      this.carsCtlsBlock,\n    );\n    this.carsCtlsBlock.classList.add(styles['garage-bg__cars-ctls-block']);\n    this._rootElement.append(bg, tracksContainer, this.carsCtlsBlock);\n  }\n\n  private bgVideoProgressListener = () => {\n    if (this.bgVideo.buffered.length > 0) {\n      const progress =\n        (this.bgVideo.buffered.end(0) / this.bgVideo.duration) * 100;\n      this.popup.setProgress(progress);\n    }\n  };\n\n  private bgVideoCanPlayListener = async () => {\n    this.bgVideo.removeEventListener(\n      'canplaythrough',\n      this.bgVideoCanPlayListener,\n    );\n    this.bgVideo.removeEventListener('progress', this.bgVideoProgressListener);\n    this.isControllerWorking = await this.controller.startWorking();\n    this.popup.setProgress(100).reset().hide();\n  };\n\n  connect(int: DBusInterface) {\n    int.attachSubHub(this.controller);\n    int.attachSubHub(this.mainControlsComp);\n  }\n\n  notify = async () => {\n    try {\n      this.bgVideo.play();\n    } catch {\n      // do nothing...\n    }\n    if (!this.isControllerWorking) {\n      this.popup.setProgress(1).setText('Loading...').show();\n      this.isControllerWorking = await this.controller.startWorking();\n      this.popup.reset().hide();\n    }\n  };\n}\n","import { RegCarData, UnregCarData } from '../../../../definitions/car-data.def';\nimport { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { hexToRgb } from '../../../../lib/convertors/colors';\nimport { transitionPromise } from '../../../../lib/gui/animation';\nimport { OBJ_PROCESSOR } from '../../../../lib/processors/obj-processor';\nimport styles from './car.scss';\nimport garageStyles from '../../garage.scss';\n\nexport class CarComp extends BaseComp {\n  static readonly TIMING_FUNCTION = 'cubic-bezier(.72,.2,.54,.77)';\n\n  static readonly CAR_BODY_IMG_SRC = './assets/imgs/cars/body.gif';\n\n  static readonly CAR_WHEEL_IMG_SRC = './assets/imgs/cars/tire back.gif';\n\n  static readonly CAR_EXPLOSION_IMG_DATA = {\n    BASE_URL: './assets/imgs/cars/explosion/',\n    EXTENSION: '.png',\n    FRAMES_COUNT: 9,\n    FRAME_TIME_MS: 200,\n  };\n\n  protected canvas = document.createElement('canvas');\n\n  protected tireBack = document.createElement('img');\n\n  private btnSelect$ = document.createElement('button');\n\n  private btnRm$ = document.createElement('button');\n\n  private _spanCarName = document.createElement('span');\n\n  private btnStart$ = document.createElement('button');\n\n  private btnReset$ = document.createElement('button');\n\n  private startDrivingTime: number | undefined;\n\n  private destinationCoordinate: number | undefined;\n\n  private currAnimation: Animation | undefined;\n\n  private currOutOfSceneAnim: Animation | undefined;\n\n  private isReseted = true;\n\n  private observer: MutationObserver;\n\n  private movingClassName = garageStyles['synthwave-background_race-mode'];\n\n  constructor(private _currCar: RegCarData, public index?: number) {\n    super('div');\n\n    this._rootElement.classList.add(styles['car-div']);\n    this.canvas.classList.add(styles['car-div__canvas']);\n    this._rootElement.append(this.canvas);\n\n    const selectSpan = document.createElement('span');\n    const rmSpan = document.createElement('span');\n    const startSpan = document.createElement('span');\n    const resetSpan = document.createElement('span');\n\n    selectSpan.textContent = 'select';\n    rmSpan.textContent = 'remove';\n    startSpan.textContent = 'start!';\n    resetSpan.textContent = 'reset';\n\n    this.btnSelect$.append(selectSpan);\n    this.btnRm$.append(rmSpan);\n    this.btnReset$.append(resetSpan);\n    this.btnStart$.append(startSpan);\n\n    this.btnReset$.disabled = true;\n\n    CarComp.drawCar(this.canvas, this._currCar.color);\n    this._spanCarName.textContent = `${index}: ${_currCar.name}`;\n    CarComp.drawWheels(this._rootElement);\n\n    this.observer = new MutationObserver(mutations => {\n      mutations.forEach(mutation => {\n        if (mutation.oldValue?.includes(this.movingClassName)) {\n          this.currOutOfSceneAnim?.pause();\n          this.observer.disconnect();\n        } else {\n          const elem = mutation.target as HTMLElement;\n          if (elem.classList.contains(this.movingClassName)) {\n            this.outOfScene();\n          }\n        }\n      });\n    });\n  }\n\n  static drawWheels(rootElem: HTMLElement) {\n    const wheelImg = new Image();\n    wheelImg.src = CarComp.CAR_WHEEL_IMG_SRC;\n    wheelImg.onload = () => {\n      wheelImg.classList.add(styles['car-div__wheel']);\n      const backwardWheelImg = OBJ_PROCESSOR.deepClone(wheelImg);\n      wheelImg.classList.add(styles['car-div__wheel_forward']);\n      backwardWheelImg.classList.add(styles['car-div__wheel_backward']);\n\n      rootElem.append(wheelImg);\n      rootElem.append(backwardWheelImg);\n    };\n  }\n\n  updateData(carData: RegCarData) {\n    this._currCar = carData;\n    CarComp.drawCar(this.canvas, this._currCar.color);\n    this._spanCarName.textContent = `${this.index}: ${carData.name}`;\n    // this._rootElement.style.setProperty('background-color', carData.color);\n  }\n\n  public async rollBack(finishPromise: Promise<unknown> = Promise.resolve()) {\n    return new Promise(res => {\n      const asyncFunc = async () => {\n        if (!this.isReseted) {\n          this.observer.disconnect();\n          await this.playOutAnim();\n          if (this.currOutOfSceneAnim) {\n            this.currOutOfSceneAnim.cancel();\n            // await this.currOutOfSceneAnim.finished;\n            this.clearAnimFromElem(this.currOutOfSceneAnim);\n            this.currOutOfSceneAnim = undefined;\n          }\n          if (this.currAnimation) {\n            await this.stop();\n            this.currAnimation.playbackRate = -10;\n            this.currAnimation.play();\n            console.log(`wait curr anim ${this.index}`);\n            await this.currAnimation.finished;\n            this.clearAnimFromElem(this.currAnimation);\n            this.currAnimation = undefined;\n            this._rootElement.classList.remove(styles['car-div_rollForward']);\n          }\n          this._rootElement.style.removeProperty('transition');\n          this._rootElement.style.removeProperty('transform');\n          await this.playInAnim();\n          this._rootElement.style.removeProperty('opacity');\n          finishPromise.finally(() => {\n            this.btnStart$.disabled = false;\n            this.btnReset$.disabled = true;\n            this.btnRm$.disabled = false;\n            this.btnSelect$.disabled = false;\n          });\n        }\n        console.log(`reseted ${this.index}`);\n        this.isReseted = true;\n        res(true);\n      };\n      asyncFunc();\n    });\n  }\n\n  async playOutAnim() {\n    const animOut = this._rootElement.animate(\n      [\n        { opacity: `0.5` },\n        { opacity: `0.9` },\n        { opacity: `0.3` },\n        { opacity: `0.7` },\n        { opacity: `0.1` },\n        { opacity: `0.4` },\n        { opacity: `0` },\n      ],\n      {\n        duration: 300,\n        easing: 'linear',\n        fill: 'forwards',\n      },\n    );\n    await animOut.finished;\n    this.clearAnimFromElem(animOut);\n  }\n\n  async playAwaitingAnim(promiseToAwait: Promise<unknown>) {\n    const animIn = this._rootElement.animate(\n      [\n        { opacity: `0` },\n        { opacity: `0.6` },\n        { opacity: `0.3` },\n        { opacity: `0.8` },\n        { opacity: `0.3` },\n        { opacity: `0.6` },\n        { opacity: `0` },\n      ],\n      {\n        duration: 400,\n        easing: 'linear',\n        fill: 'forwards',\n        iterations: Number.POSITIVE_INFINITY,\n      },\n    );\n    await promiseToAwait.finally(() => {\n      animIn.cancel();\n      this.clearAnimFromElem(animIn);\n    });\n  }\n\n  async playInAnim() {\n    const animIn = this._rootElement.animate(\n      [\n        { opacity: `0` },\n        { opacity: `0.6` },\n        { opacity: `0.3` },\n        { opacity: `0.8` },\n        { opacity: `0.5` },\n        { opacity: `1` },\n      ],\n      {\n        duration: 300,\n        easing: 'linear',\n        fill: 'forwards',\n      },\n    );\n    await animIn.finished;\n    this.clearAnimFromElem(animIn);\n  }\n\n  private clearAnimFromElem = (a: Animation) => {\n    const anim = a as unknown as Record<string, unknown>;\n    if ('commitStyles' in anim && typeof anim.commitStyles === 'function')\n      anim.commitStyles();\n  };\n\n  private outOfScene() {\n    // console.log(`OUT OF SCENE ${this.index}`);\n    this.isReseted = false;\n    this.currOutOfSceneAnim = this._rootElement.animate(\n      [{ transform: `translateX(${-1000}%)` }],\n      {\n        duration: 3600,\n        easing: 'ease-in',\n        fill: 'forwards',\n      },\n    );\n  }\n\n  public disableCtls() {\n    this.btnStart$.disabled = true;\n    this.btnRm$.disabled = true;\n    this.btnSelect$.disabled = true;\n    this.btnReset$.disabled = true;\n  }\n\n  public async rollForward(time: number, handleBtns = true) {\n    this.isReseted = false;\n    // console.log(`anim time: ${time} ${this.index}`);\n    return new Promise((res, rej) => {\n      // const start = Date.now();\n      if (handleBtns) {\n        this.btnStart$.disabled = true;\n        this.btnRm$.disabled = true;\n        this.btnSelect$.disabled = true;\n        this.btnReset$.disabled = false;\n      }\n      const rootStyle = window.getComputedStyle(\n        this._rootElement.parentElement as HTMLElement,\n      );\n      const selfStyle = window.getComputedStyle(this.rootElement);\n\n      const rootWidth =\n        Number.parseFloat(rootStyle.width) -\n        Number.parseFloat(rootStyle.paddingLeft) -\n        Number.parseFloat(rootStyle.paddingRight);\n      const selfWidth = Number.parseFloat(selfStyle.width);\n\n      const coordinateInPercents = ((rootWidth - selfWidth) / selfWidth) * 100;\n\n      this._rootElement.classList.add(styles['car-div_rollForward']);\n\n      this.currAnimation = this._rootElement.animate(\n        [{ transform: `translateX(${coordinateInPercents}%)` }],\n        {\n          duration: time * 1000 * 1.5,\n          easing: 'ease-in-out',\n          fill: 'forwards',\n        },\n      );\n\n      this.currAnimation.onfinish = () => {\n        // console.log(`time from anim start: ${Date.now() - start}`);\n        // console.log('stop animation by roll forward finish');\n        // this._rootElement.classList.remove(styles['car-div_rollForward']);\n        // this.stop();\n        res(true);\n      };\n\n      this.currAnimation.oncancel = () => {\n        // console.log(`curr Anim cancel ${this.index}`);\n        this._rootElement.classList.remove(styles['car-div_rollForward']);\n        rej();\n      };\n    });\n  }\n\n  public async stop(\n    rollover = true,\n    broken = false,\n    flags?: Record<string, unknown>,\n  ) {\n    // console.log(`STOP, broken: ${broken}, ${this.index}`);\n    // this.rootElement.style.setProperty('transition', '');\n    if (rollover) {\n      await new Promise(res => {\n        if (this.currAnimation?.playState === 'running') {\n          // console.log(\n          //   this.currAnimation,\n          //   `awaiting for animation ${this.index}`,\n          // );\n          this.currAnimation.addEventListener('finish', () => res(true));\n          this.currAnimation.addEventListener('cancel', () => res(true));\n        } else res(true);\n      });\n    }\n    this._rootElement.classList.remove(styles['car-div_rollForward']);\n    this.currAnimation?.pause();\n    if (broken) {\n      if (flags) {\n        const roadElem = flags.roadElem as HTMLElement;\n        const roadIsMoving = roadElem.classList.contains(this.movingClassName);\n        console.log(`CHECK IF ROAD IS MOVING ${this.index}`);\n        if (roadIsMoving) this.outOfScene();\n        this.observer.observe(roadElem, {\n          attributes: true,\n          attributeOldValue: true,\n        });\n      }\n      console.log(`exp anim ${this.index}`);\n      const img = new Image();\n      let frameNumber = 0;\n      img.classList.add(styles['car-div__explosion']);\n      img.src = `${CarComp.CAR_EXPLOSION_IMG_DATA.BASE_URL}${frameNumber}${CarComp.CAR_EXPLOSION_IMG_DATA.EXTENSION}`;\n      img.onload = async () => {\n        this._rootElement.append(img);\n        await new Promise(res =>\n          setTimeout(res, CarComp.CAR_EXPLOSION_IMG_DATA.FRAME_TIME_MS),\n        );\n        frameNumber++;\n        if (frameNumber < CarComp.CAR_EXPLOSION_IMG_DATA.FRAMES_COUNT) {\n          img.src = `${CarComp.CAR_EXPLOSION_IMG_DATA.BASE_URL}${frameNumber}${CarComp.CAR_EXPLOSION_IMG_DATA.EXTENSION}`;\n        } else {\n          img.remove();\n        }\n      };\n    }\n  }\n\n  public get currCar(): RegCarData {\n    return this._currCar;\n  }\n\n  public get btnSelect() {\n    return this.btnSelect$;\n  }\n\n  public get btnRm() {\n    return this.btnRm$;\n  }\n\n  public get btnStart() {\n    return this.btnStart$;\n  }\n\n  public get btnReset() {\n    return this.btnReset$;\n  }\n\n  public get spanCarName() {\n    return this._spanCarName;\n  }\n\n  static drawCar(canvas: HTMLCanvasElement, hexColor: string) {\n    const img = new Image();\n    img.src = CarComp.CAR_BODY_IMG_SRC;\n    img.onload = () => {\n      canvas.height = img.height / 3;\n      canvas.width = img.width / 3;\n      const ctx = canvas.getContext('2d');\n\n      if (ctx) {\n        ctx.shadowColor = hexColor;\n        ctx.shadowBlur = 25;\n        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n      }\n\n      CarComp.paintCarBody(canvas, hexColor);\n    };\n  }\n\n  static paintCarBody(canvas: HTMLCanvasElement, hexColor: string) {\n    const imageData = canvas\n      .getContext('2d')\n      ?.getImageData(0, 0, canvas.width, canvas.height);\n    if (imageData) {\n      const rgb = hexToRgb(hexColor);\n      for (let j = 0; j < imageData.width; j++) {\n        for (let i = 0; i < imageData.height; i++) {\n          // index: red, green, blue, alpha, red, green, blue, alpha..etc.\n          const index = i * 4 * imageData.width + j * 4;\n          const red = imageData.data[index] as number;\n          const green = imageData.data[index + 1] as number;\n          const blue = imageData.data[index + 2] as number;\n          // const alpha = imageData.data[index + 3] as number;\n\n          const blueDiff = 2 * blue - red - green;\n          const blueDiffThreshold = 10;\n          const threshold = 70;\n          if (\n            red > threshold &&\n            green > threshold &&\n            blue > threshold &&\n            blueDiff < blueDiffThreshold\n          ) {\n            imageData.data[index] = (red / 255) * rgb.r;\n            imageData.data[index + 1] = (green / 255) * rgb.g;\n            imageData.data[index + 2] = (blue / 255) * rgb.b;\n            // imageData.data[index + 3] = 225; /// !!! TEST !!!\n          }\n        }\n      }\n      canvas\n        .getContext('2d')\n        ?.putImageData(imageData, 0, 0, 0, 0, canvas.width, canvas.height);\n    }\n  }\n\n  static genPreview(car: UnregCarData): HTMLElement {\n    const container = document.createElement('div');\n    const canvas = document.createElement('canvas');\n    canvas.classList.add(styles['car-div__canvas']);\n    container.append(canvas);\n    CarComp.drawWheels(container);\n    CarComp.drawCar(canvas, car.color);\n    return container;\n  }\n}\n","import { UnregCarData } from '../../../../../definitions/car-data.def';\nimport { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { REST_CLIENT_GARAGE } from '../../../../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionCreatedMsg } from '../../../dbus-msgs/by-topic/car-action/garage-car-created-msg.def';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\n\nexport class CreateCompController extends CreateUpdateCompControllerProto {\n  private txs = new Set<DBusTX>();\n\n  constructor(elements: CreateUpdateCompControllerReqElems) {\n    super(elements.inputText, elements.inputColor, elements.btn);\n\n    this.setupBtnCreate();\n  }\n\n  private setupBtnCreate() {\n    this.btn.addEventListener('click', () => {\n      this.btn.disabled = true;\n      // TODO: !!! add validity check!\n      const unregCar: UnregCarData = {\n        name: this.inputText.value,\n        color: this.inputColor.value,\n      };\n      REST_CLIENT_GARAGE.createCar(unregCar)\n        .then(car => {\n          // TODO: Notify with DBus\n          const msg = new DBusMsgCarActionCreatedMsg(car);\n          this.txs.forEach(tx => {\n            tx.transmit({\n              msg,\n              prepMode: DBusTXPrepModes.clone,\n              waitMode: DBusTXWaitModes.nowait,\n            });\n          });\n        })\n        .finally(() => {\n          this.btn.disabled = false;\n        });\n    });\n  }\n\n  autoConnect(int: DBusInterface) {\n    const tx = int.getNewTX('send created car msgs');\n    this.txs.add(tx);\n  }\n}\n","import { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../../../../lib/services/dbus/defs/dbus-port.def';\n\nexport interface CreateUpdateCompControllerReqElems {\n  inputText: HTMLInputElement;\n  inputColor: HTMLInputElement;\n  btn: HTMLButtonElement;\n}\n\nexport abstract class CreateUpdateCompControllerProto implements DBusPort {\n  constructor(\n    protected inputText: HTMLInputElement,\n    protected inputColor: HTMLInputElement,\n    protected btn: HTMLButtonElement,\n  ) {}\n\n  abstract autoConnect(int: DBusInterface): void | Promise<void>;\n\n  protected toogleCtlsDisabled(state: boolean) {\n    this.inputText.disabled = state;\n    this.inputColor.disabled = state;\n    this.btn.disabled = state;\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../../../lib/processors/obj-processor';\nimport { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../../../../lib/services/dbus/defs/dbus-port.def';\nimport { DBusRX } from '../../../../../lib/services/dbus/defs/dbus-rx/dbus-rx.def';\nimport { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { REST_CLIENT_GARAGE } from '../../../../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionSelectedMsg } from '../../../dbus-msgs/by-topic/car-action/garage-car-select-msg.def';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\n\nexport class UpdateCompController\n  extends CreateUpdateCompControllerProto\n  implements DBusPort\n{\n  private rxs: Set<DBusRX> = new Set();\n\n  private choosedCar: RegCarData | undefined;\n\n  private notifyCb: ((car: RegCarData) => unknown) | undefined;\n\n  constructor(elements: CreateUpdateCompControllerReqElems) {\n    super(elements.inputText, elements.inputColor, elements.btn);\n\n    this.setupBtnUpdate();\n  }\n\n  autoConnect(int: DBusInterface) {\n    const rx = int.getNewRX(this.chooseCarListener, 'listen car choosing');\n    int.plugRX(DBusTopics.CAR_ACTION, rx);\n  }\n\n  private chooseCarListener = async (data: DBusTXData) => {\n    console.log(data);\n    if (data.msg instanceof DBusMsgCarActionSelectedMsg) {\n      this.choosedCar = OBJ_PROCESSOR.deepClone(data.msg.car);\n      this.notifyCb = data.msg.notifyChanges;\n      this.inputColor.value = data.msg.car.color;\n      this.inputText.value = data.msg.car.name;\n      this.toogleCtlsDisabled(false);\n    }\n  };\n\n  private setupBtnUpdate() {\n    this.toogleCtlsDisabled(true);\n    this.btn.addEventListener('click', () => {\n      this.toogleCtlsDisabled(true);\n      if (!this.choosedCar) return;\n      // TODO: !!! add validity check!\n      this.choosedCar.color = this.inputColor.value;\n      this.choosedCar.name = this.inputText.value;\n      REST_CLIENT_GARAGE.updateCar(this.choosedCar)\n        .then(car => {\n          if (this.notifyCb) this.notifyCb(car);\n        })\n        .finally(() => {\n          this.toogleCtlsDisabled(false);\n        });\n    });\n  }\n}\n","import { BaseComp } from '../../../../../lib/components/base-comp/base-comp';\nimport { DBUS_HUB_NAMES } from '../../../../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { CreateCompController } from './controller-create';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\nimport { UpdateCompController } from './controller-update';\n\nimport styles from './create-update.scss';\nimport sharedStyles from '../../../../../styles.scss';\n\nexport class CreateUpdateComponent extends BaseComp implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.CREATE_UPDATE;\n\n  protected textInput = document.createElement('input');\n\n  protected colorInput = document.createElement('input');\n\n  protected btn = document.createElement('button');\n\n  protected controller: CreateUpdateCompControllerProto;\n\n  constructor(type: 'CREATE' | 'UPDATE', btnText: string) {\n    super('div');\n    this._rootElement.classList.add(styles.root);\n    this.textInput.type = 'text';\n    this.textInput.classList.add(styles['text-input']);\n    this.colorInput.type = 'color';\n    this.colorInput.classList.add(styles['color-input']);\n    this.btn.textContent = btnText;\n    this.btn.classList.add(sharedStyles.btn);\n    this._rootElement.append(this.textInput, this.colorInput, this.btn);\n\n    const elements: CreateUpdateCompControllerReqElems = {\n      inputText: this.textInput,\n      inputColor: this.colorInput,\n      btn: this.btn,\n    };\n\n    switch (type) {\n      case 'UPDATE':\n        this.controller = new UpdateCompController(elements);\n        this.btn.classList.add(sharedStyles['btn-13']);\n        break;\n      case 'CREATE':\n      default:\n        this.controller = new CreateCompController(elements);\n        this.btn.classList.add(sharedStyles['btn-13']); // TODO: maybe change?\n        break;\n    }\n  }\n\n  connect(int: DBusInterface) {\n    this.controller.autoConnect(int);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport class DBusMsgGenerateCarsMsg extends DBusMsg {\n  constructor(\n    readonly status: 'start' | 'end',\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GENERATE, rxIds, prefResponseRxIds);\n  }\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { CreateUpdateComponent } from './create-update/create-update';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from '../../../../lib/services/dbus/defs/dbus-hub-names.def';\nimport { DBusMsgRaceRequestMsg } from '../../dbus-msgs/by-topic/garage/garage-race-request-msg.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusMsgGarageResetReqMsg } from '../../dbus-msgs/by-topic/garage/garage-reset-req-msg.def';\n\nimport styles from './main-controls.scss';\nimport sharedStyles from '../../../../styles.scss';\nimport { REST_CLIENT_GARAGE } from '../../../../services/rest-clients/client-garage/rest-client-garage';\nimport {\n  CAR_MODEL_LIST,\n  CAR_MODEL_LIST_KEYS,\n} from '../../../../definitions/car-random-data.def';\nimport {\n  genRandomHexColor,\n  getRandomArbitraryInt,\n  getRandomInt,\n} from '../../../../lib/generators/generators';\nimport {\n  UnregCarData,\n  WinnerCarData,\n} from '../../../../definitions/car-data.def';\nimport { REST_CLIENT_WINNERS } from '../../../../services/rest-clients/client-winners/rest-client-winners';\nimport { DBusTXData } from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBusMsgGarageRaceMsg } from '../../dbus-msgs/by-topic/garage/garage-race-msg.def';\nimport { DBUS_COMMON_RESPONSES } from '../../../../lib/services/dbus/defs/dbus-common-responses.def';\nimport { DBusMsgGarageRaceStatusMsg } from '../../dbus-msgs/by-topic/garage/garage-race-status-msg.def';\nimport { DBusTopics } from '../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTX } from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgGenerateCarsMsg } from './dbus-msgs/generate-cars-msg.def';\nimport { PopupStandaloneModalProgressComp } from '../../../../lib/components/popups/standalone/modal/progress/popup-progress';\n\nexport class MainControlsComp extends BaseComp implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.MAIN_CONTROLS;\n\n  private txs = new Set<DBusTX>();\n\n  private createComponent = new CreateUpdateComponent('CREATE', 'create');\n\n  private updateComponent = new CreateUpdateComponent('UPDATE', 'update');\n\n  private btnRace = document.createElement('button');\n\n  private btnReset = document.createElement('button');\n\n  private btnGenerate = document.createElement('button');\n\n  private popup = new PopupStandaloneModalProgressComp();\n\n  constructor() {\n    super('div');\n    this._rootElement.classList.add(styles['main-controls']);\n\n    const btnsBlock = this.renderBtns();\n    this.btnRace.addEventListener('click', this.raceClickListener);\n    this.btnReset.addEventListener('click', this.resetClickListener);\n    this.btnGenerate.addEventListener('click', this.generateClickListener);\n\n    this.btnReset.disabled = true;\n    this.btnRace.disabled = true;\n\n    this._rootElement.append(\n      this.createComponent.rootElement,\n      this.updateComponent.rootElement,\n      btnsBlock,\n    );\n  }\n\n  private generateClickListener = async () => {\n    this.btnGenerate.disabled = true;\n    const msg = new DBusMsgGenerateCarsMsg('start');\n    const transmissions: Promise<unknown>[] = [];\n    this.txs.forEach(tx => {\n      const transmission = tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n      transmissions.push(transmission);\n    });\n    await Promise.allSettled(transmissions);\n    this.popup\n      .reset()\n      .setText('please wait while the entries are generated')\n      .show();\n    await this.generate(100, undefined, this.genCb);\n    this.popup.reset().hide();\n    const resolveMsg = new DBusMsgGenerateCarsMsg('end');\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg: resolveMsg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n    this.btnGenerate.disabled = false;\n  };\n\n  private genCb = (progress: number) => {\n    this.popup.setProgress(progress);\n  };\n\n  private raceClickListener = async () => {\n    if (this.txs.size === 0) return;\n    this.btnRace.disabled = true;\n    this.btnGenerate.disabled = true;\n    const msg = new DBusMsgRaceRequestMsg();\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n    });\n  };\n\n  private resetClickListener = async () => {\n    if (this.txs.size === 0) return;\n    const msg = new DBusMsgGarageResetReqMsg();\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n    });\n  };\n\n  private renderBtns(): HTMLElement {\n    // setip btns\n    const span = document.createElement('span');\n    span.textContent = 'race';\n    this.btnRace.append(span);\n    this.btnRace.classList.add(sharedStyles.btn, sharedStyles['btn-15']);\n    this.btnReset.textContent = 'reset';\n    this.btnReset.classList.add(sharedStyles.btn, sharedStyles['btn-9']);\n    this.btnGenerate.textContent = 'generate cards';\n    this.btnGenerate.classList.add(sharedStyles.btn, sharedStyles['btn-1']);\n\n    const btnBlock = document.createElement('div');\n    btnBlock.classList.add(styles['btn-block']);\n    btnBlock.append(this.btnRace, this.btnReset, this.btnGenerate);\n    return btnBlock;\n  }\n\n  private async generate(\n    total: number,\n    left?: number,\n    cb?: (progress: number) => unknown,\n  ): Promise<boolean> {\n    let genLeft = left || total;\n    const randomName = this.genRandomCarName();\n    const color = genRandomHexColor();\n    const unregCarData: UnregCarData = {\n      name: randomName,\n      color,\n    };\n    const car = await REST_CLIENT_GARAGE.createCar(unregCarData);\n    const winner: WinnerCarData = {\n      id: car.id,\n      wins: getRandomArbitraryInt(1, 3),\n      time: Number.parseFloat((getRandomArbitraryInt(40, 50) / 3).toFixed(2)),\n    };\n    await REST_CLIENT_WINNERS.createWinner(winner);\n    genLeft--;\n\n    if (cb) {\n      const progress = (1 - genLeft / total) * 100;\n      cb(progress);\n    }\n\n    if (genLeft > 0) return this.generate(total, genLeft, cb);\n\n    return true;\n  }\n\n  private genRandomCarName = (): string => {\n    const manufacturerNumber = getRandomInt(CAR_MODEL_LIST_KEYS.length - 1);\n    const manufacturerName = CAR_MODEL_LIST_KEYS[\n      manufacturerNumber\n    ] as keyof typeof CAR_MODEL_LIST;\n    const models = CAR_MODEL_LIST[manufacturerName];\n    const modelNumber = getRandomInt(models.length - 1);\n    const modelName = models[modelNumber] as string;\n    return `${manufacturerName} ${modelName}`;\n  };\n\n  private rxFuncForRaceMsgs = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgGarageRaceStatusMsg) {\n      const { status } = data.msg;\n      switch (status) {\n        case 'READY_TO_GO':\n          this.btnRace.disabled = false;\n          this.btnReset.disabled = true;\n          this.btnGenerate.disabled = false;\n          // this.btnGenerate.disabled = true;\n          break;\n        case 'IN_PROCESS':\n          this.btnRace.disabled = true;\n          this.btnReset.disabled = false;\n          this.btnGenerate.disabled = true;\n          break;\n        case 'NEED_RESET':\n          this.btnRace.disabled = true;\n          this.btnReset.disabled = false;\n          this.btnGenerate.disabled = false;\n          break;\n        default:\n          break;\n      }\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  connect(int: DBusInterface) {\n    int.attachSubHub(this.createComponent, 'cu_create');\n    int.attachSubHub(this.updateComponent, 'cu_delete');\n\n    const rx = int.getNewRX(\n      this.rxFuncForRaceMsgs,\n      'toggle btns in main-ctls-block',\n    );\n    int.plugRX(DBusTopics.GARAGE, rx);\n\n    const tx = int.getNewTX('start race | broadcast generate');\n    this.txs.add(tx);\n  }\n}\n","import { RegCarData } from '../../../../definitions/car-data.def';\nimport { BaseComp } from '../../../../lib/components/base-comp/base-comp';\n\nexport class GaragePopupWinner extends BaseComp {\n  private header = document.createElement('h3');\n\n  private textTime = document.createElement('span');\n\n  private textName = document.createElement('span');\n\n  private textId = document.createElement('span');\n\n  private textNumber = document.createElement('span');\n\n  constructor() {\n    super('div');\n    this.header.textContent = 'WE HAVE A WINNER!';\n    this._rootElement.append(\n      this.header,\n      this.textTime,\n      this.textName,\n      this.textId,\n      this.textNumber,\n    );\n  }\n\n  setData(car: RegCarData, timeStr: string, indexStr?: string) {\n    this.textTime.textContent = `Time: ${timeStr}s`;\n    this.textName.textContent = `Name of the car: \\n ${car.name}`;\n    this.textId.textContent = `ID of the car: ${car.id}`;\n    this.textNumber.textContent = indexStr\n      ? `Position on the track: ${indexStr}`\n      : ``;\n  }\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { CarComp } from '../car/car';\n\nimport styles from './track.scss';\n\nexport class TrackComp extends BaseComp {\n  private topBlock = document.createElement('div');\n\n  constructor() {\n    super('div');\n    this._rootElement.classList.add(styles.track);\n    this._rootElement.append();\n    this.topBlock.classList.add(styles['track__controls-block']);\n  }\n\n  illuminateSelf = (illuminate: boolean) => {\n    if (illuminate) this._rootElement.classList.add(styles.track_illuminated);\n    else this._rootElement.classList.remove(styles.track_illuminated);\n  };\n\n  placeCar(carComp: CarComp) {\n    if (this._rootElement.hasChildNodes()) {\n      this._rootElement.childNodes.forEach(child => child.remove());\n    }\n    this.topBlock.append(carComp.spanCarName);\n    this._rootElement.append(this.topBlock, carComp.rootElement);\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { DBus } from '../../lib/services/dbus/dbus';\nimport { DBUS_COMMON_RESPONSES } from '../../lib/services/dbus/defs/dbus-common-responses.def';\nimport {\n  DBusHubNamesList,\n  DBUS_HUB_NAMES,\n} from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBusMsgRouteIsChangedMsg } from '../../lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport styles from './header.scss';\nimport { NavItem } from './subcomps/nav-item/nav-item';\n\nexport class HeaderComponent extends BaseComp implements DBusHub {\n  private navContainer: HTMLElement;\n\n  private logo: HTMLElement;\n\n  protected anchors: HTMLAnchorElement[];\n\n  protected buses: DBus[] = [];\n\n  constructor(readonly hubName: DBusHubNamesList = DBUS_HUB_NAMES.HEADER) {\n    super('header');\n    this.rootElement.classList.add(styles.header);\n\n    // logo\n    this.logo = document.createElement('h1');\n    this.logo.classList.add(styles.header__logo);\n    const firstSpan = document.createElement('span');\n    firstSpan.textContent = 'async';\n    const secondSpan = document.createElement('span');\n    secondSpan.textContent = 'race';\n    this.logo.append(firstSpan, secondSpan);\n    this.rootElement.append(this.logo);\n\n    // nav\n    this.navContainer = document.createElement('nav');\n    this.navContainer.classList.add(styles['header-nav']);\n    this.rootElement.append(this.navContainer);\n\n    // ul\n    const ul = document.createElement('ul');\n    ul.classList.add(styles['header-nav__list']);\n    this.navContainer.append(ul);\n\n    // ul items\n    const classList = {\n      li: styles['header-nav__item'],\n      a: styles['header-nav__anchor'],\n      svg: styles['header-nav__svg'],\n      span: styles['header-nav__span'],\n    };\n\n    const garageNavItem = new NavItem('garage', '#garage', classList);\n    const winnersNavItem = new NavItem('winners', '#winners', classList);\n\n    const navItems = [garageNavItem, winnersNavItem];\n    this.anchors = navItems.map(item => item.anchor);\n\n    ul.append(...navItems.map(item => item.rootElement));\n  }\n\n  connect(int: DBusInterface) {\n    const illuminateRX = int.getNewRX(\n      this.illuminateNavItem,\n      'illuminate nav items',\n    );\n    int.plugRX(DBusTopics.ROUTING, illuminateRX);\n  }\n\n  private illuminateNavItem = async (data: DBusTXData) => {\n    const { msg } = data;\n    if (msg instanceof DBusMsgRouteIsChangedMsg) {\n      this.anchors.forEach(anchor => {\n        if (anchor.getAttribute('href') === msg.newRoute) {\n          anchor.classList.add(styles['header-nav__anchor_active']);\n        } else {\n          anchor.classList.remove(styles['header-nav__anchor_active']);\n        }\n      });\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\n\nexport interface NavItemStyles {\n  li?: string;\n  a?: string;\n  svg?: string;\n  span?: string;\n}\n\nexport class NavItem extends BaseComp {\n  private _anchor: HTMLAnchorElement;\n\n  protected iconImage: HTMLImageElement | undefined;\n\n  protected span: HTMLSpanElement;\n\n  constructor(\n    text: string,\n    href: string,\n    styles?: NavItemStyles,\n    iconSrc?: string,\n  ) {\n    super('li');\n\n    if (styles?.li) this._rootElement.classList.add(styles.li);\n    this._anchor = document.createElement('a');\n    this._anchor.setAttribute('href', href);\n\n    if (styles?.a) this._anchor.classList.add(styles.a);\n\n    if (iconSrc) {\n      this.iconImage = document.createElement('img');\n      this.iconImage.src = iconSrc;\n\n      if (styles?.svg) this.iconImage.classList.add(styles.svg);\n      this._anchor.append(this.iconImage);\n    }\n    this.span = document.createElement('span');\n    this.span.textContent = text;\n\n    if (styles?.span) this.span.classList.add(styles.span);\n    this._anchor.append(this.span);\n\n    this.rootElement.append(this._anchor);\n  }\n\n  get anchor(): HTMLAnchorElement {\n    return this._anchor;\n  }\n}\n","import { UnregCarData, WinnerCarData } from '../../../definitions/car-data.def';\nimport { BaseComp } from '../../../lib/components/base-comp/base-comp';\nimport { CarComp } from '../../garage/subcomps/car/car';\n\nexport class WinnerRowComp extends BaseComp {\n  private indexElem = document.createElement('td');\n\n  private idElem = document.createElement('td');\n\n  private carPreviewBox = document.createElement('td');\n\n  private nameElem = document.createElement('td');\n\n  private winsElem = document.createElement('td');\n\n  private bestTimeElem = document.createElement('td');\n\n  private carPreview: HTMLElement;\n\n  constructor(index: number, winnerData: WinnerCarData, carData: UnregCarData) {\n    super('tr');\n\n    this.indexElem.textContent = index.toString();\n    this.idElem.textContent = winnerData.id.toString();\n    this.carPreview = CarComp.genPreview(carData);\n    this.carPreviewBox.append(this.carPreview);\n    this.nameElem.textContent = carData.name;\n    this.winsElem.textContent = winnerData.wins.toString();\n    this.bestTimeElem.textContent = winnerData.time.toString();\n\n    this._rootElement.append(\n      this.indexElem,\n      this.idElem,\n      this.carPreviewBox,\n      this.nameElem,\n      this.winsElem,\n      this.bestTimeElem,\n    );\n  }\n\n  public getCarPreview() {\n    return this.carPreview;\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { REST_CLIENT_WINNERS } from '../../services/rest-clients/client-winners/rest-client-winners';\nimport {\n  RestClientWinnersSortOptionsList,\n  REST_CLIENT_WINNERS_SORT_OPTIONS,\n} from '../../services/rest-clients/client-winners/rest-client-winners.def';\nimport { WinnerRowComp } from './subcomps/winner-entry';\nimport { Pager } from '../../lib/services/pager/pager';\n\nimport styles from './winners.scss';\nimport sharedStyles from '../../styles.scss';\nimport { Notifiable } from '../../lib/interfaces/notifiable';\n\nexport class WinnersComp extends BaseComp implements Notifiable {\n  static readonly TEXT_CONTENT_ENG = {};\n\n  private table = document.createElement('table');\n\n  private tableBody = document.createElement('tbody');\n\n  private tableHead = document.createElement('thead');\n\n  private thId = document.createElement('th');\n\n  private thCar = document.createElement('th');\n\n  private thName = document.createElement('th');\n\n  private thWins = document.createElement('th');\n\n  private thBestTime = document.createElement('th');\n\n  private currSortedElem: HTMLElement | undefined;\n\n  private pager: Pager;\n\n  private currOrder: 'ASC' | 'DESC' = 'DESC';\n\n  private currSort: RestClientWinnersSortOptionsList = 'wins';\n\n  private entriesPerPage = 10;\n\n  constructor() {\n    super('section');\n    this._rootElement.classList.add(styles.winners);\n    this._rootElement.style.setProperty(\n      'background-image',\n      `url('./assets/imgs/backgrounds/winners/anime-girl-cyberpunk-ride-4k-lx-2880x1800.jpg')`,\n    );\n\n    const pagerBtnsContainer = document.createElement('div');\n    pagerBtnsContainer.classList.add(styles.pager);\n\n    this.pager = new Pager(this.entriesPerPage, this.pagerCallback);\n\n    const btnPrevPage = this.pager.getBtnPrevPage();\n    const btnNextPage = this.pager.getBtnNextPage();\n    btnPrevPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['pager-btn'],\n    );\n    btnNextPage.classList.add(sharedStyles.btn);\n    btnNextPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['pager-btn'],\n    );\n\n    pagerBtnsContainer.append(btnPrevPage, btnNextPage);\n\n    const pagerSpan = this.pager.getPagerSpan();\n\n    pagerSpan.classList.add(styles['pager-span']);\n\n    this.table.append(\n      this.tableHead,\n      this.tableBody,\n      pagerBtnsContainer,\n      pagerSpan,\n    );\n    this.table.classList.add(styles.table);\n\n    this._rootElement.append(this.table);\n\n    this.renderHeader();\n    this.refillTable().then(() => this.refreshTableHeader(this.thBestTime));\n  }\n\n  notify(): void {\n    this.refillTable(this.currSort, this.currOrder).then(() =>\n      this.refreshTableHeader(this.currSortedElem || this.thBestTime),\n    );\n  }\n\n  private pagerCallback = async (dir: 'prev' | 'next'): Promise<boolean> => {\n    try {\n      await this.refillTable(undefined, undefined, dir);\n      return true;\n    } catch {\n      return false;\n    }\n  };\n\n  private renderHeader() {\n    const tr = document.createElement('tr');\n\n    const thIndex = document.createElement('th');\n    thIndex.textContent = '№';\n    this.thId.textContent = 'ID';\n    this.thId.classList.add(styles['table__can-be-sorted']);\n    this.thCar.textContent = 'CAR';\n    this.thName.textContent = 'NAME';\n    this.thWins.textContent = 'WINS';\n    this.thWins.classList.add(styles['table__can-be-sorted']);\n    this.thBestTime.textContent = 'BEST TIME';\n    this.thBestTime.classList.add(styles['table__can-be-sorted']);\n\n    tr.append(\n      thIndex,\n      this.thId,\n      this.thCar,\n      this.thName,\n      this.thWins,\n      this.thBestTime,\n    );\n    this.tableHead.append(tr);\n    this.tableHead.addEventListener('click', this.tableHeadClickListener);\n  }\n\n  private async refillTable(\n    specialSort?: RestClientWinnersSortOptionsList,\n    specialOrder?: 'ASC' | 'DESC',\n    dir?: 'prev' | 'next',\n  ) {\n    return new Promise((res, rej) => {\n      const page = dir\n        ? dir === 'next'\n          ? this.pager.getCurrPageNumber() + 1\n          : this.pager.getCurrPageNumber() - 1\n        : this.pager.getCurrPageNumber();\n      const order = specialOrder || this.currOrder;\n      const sort = specialSort || this.currSort;\n\n      REST_CLIENT_WINNERS.getWinners(page, 10, sort, order).then(\n        async response => {\n          this.pager.setEntriesCount(Number.parseInt(response.limit, 10));\n          if (response.cars.length === 0) {\n            rej();\n            return;\n          }\n          const rows = new Array<WinnerRowComp>(response.cars.length);\n          const promises: Promise<unknown>[] = [];\n          const indexInc = (page - 1) * 10;\n          response.cars.forEach((winner, index) => {\n            const promise = REST_CLIENT_GARAGE.getCar(winner.id).then(car => {\n              const totalIndex = index + indexInc + 1;\n              const row = new WinnerRowComp(totalIndex, winner, car);\n              rows[index] = row;\n            });\n            promises.push(promise);\n          });\n          await Promise.allSettled(promises);\n          while (this.tableBody.firstChild) this.tableBody.firstChild.remove();\n          this.tableBody.append(\n            ...rows.map(row => {\n              row\n                .getCarPreview()\n                .classList.add(styles['table__car-preview-box']);\n              return row.rootElement;\n            }),\n          );\n          res(true);\n        },\n      );\n    });\n  }\n\n  private tableHeadClickListener = async (e: Event) => {\n    let sort: RestClientWinnersSortOptionsList | undefined;\n    switch (e.target) {\n      case this.thId:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.id;\n        break;\n      case this.thWins:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.wins;\n        break;\n      case this.thBestTime:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.time;\n        break;\n      default:\n        break;\n    }\n    if (sort) {\n      // TODO: block pager\n      const elem = e.target as HTMLElement;\n      this.currOrder = elem.classList.contains(\n        styles['table__sorted-elem_desc'],\n      )\n        ? 'ASC'\n        : 'DESC';\n      this.currSort = sort;\n      await this.refillTable();\n      this.refreshTableHeader(elem);\n    }\n  };\n\n  private refreshTableHeader = (elem: HTMLElement) => {\n    if (this.currSortedElem)\n      this.currSortedElem.classList.remove(styles['table__sorted-elem']);\n\n    elem.classList.add(styles['table__sorted-elem']);\n    this.currSortedElem = elem;\n\n    if (this.currOrder === 'ASC') {\n      elem.classList.remove(styles['table__sorted-elem_desc']);\n      elem.classList.add(styles['table__sorted-elem_asc']);\n    } else {\n      elem.classList.remove(styles['table__sorted-elem_asc']);\n      elem.classList.add(styles['table__sorted-elem_desc']);\n    }\n  };\n}\n","import { OBJ_PROCESSOR } from '../lib/processors/obj-processor';\n\nconst models = {\n  Lamborghini: [\n    'Murciélago',\n    '350 GT',\n    '400 GT',\n    'Sián FKP 37',\n    'Essenza SCV12',\n    'Urus',\n    'Centenario',\n    'Huracán',\n    'Veneno',\n    'Sesto Elementо',\n    'Aventador',\n    'Reventón',\n    'Gallardo',\n    'Diablo',\n    'LM002',\n    'Jalpa',\n    'Silhouette',\n    'Countach',\n    'Urraco',\n    'Jarama',\n    'Islero',\n    'Espada',\n    'Miura',\n  ],\n  'Aston Martin': [\n    'Project 003',\n    'Valkyrie',\n    'DBS',\n    'Vanquish Zagato',\n    'Vanquish',\n    'Virage/Virage Volante',\n    'V12 Zagato',\n    'One-77',\n    'V8 Coupe/V8 Volante',\n    'V8 Zagato',\n  ],\n  Ferrari: [\n    'Roma',\n    'Portfolio',\n    '488 GTB',\n    'California T',\n    '360 Spider',\n    '355 F1 Berlinetta',\n    'F355 GTS',\n    '456 GT',\n    'Testarossa',\n    'SF1000',\n  ],\n  Koenigsegg: [\n    'Jesko Absolut',\n    'Jesko',\n    'Agera Final',\n    'Agera XS',\n    'Agera X',\n    'Agera S',\n    'Regera',\n    'Agera RS',\n    'One:1',\n    'CCGT',\n  ],\n};\n\nconst CAR_MODEL_LIST = OBJ_PROCESSOR.deepFreeze(models);\n\nexport { CAR_MODEL_LIST };\n\nconst CAR_MODEL_LIST_KEYS = OBJ_PROCESSOR.deepFreeze(\n  Object.keys(CAR_MODEL_LIST),\n);\n\nexport { CAR_MODEL_LIST_KEYS };\n","export class BaseComp {\n  protected _rootElement: HTMLElement;\n\n  constructor(tag: keyof HTMLElementTagNameMap = 'div') {\n    this._rootElement = document.createElement(tag);\n  }\n\n  public get rootElement(): HTMLElement {\n    return this._rootElement;\n  }\n}\n","import { PopupStandaloneModalComp } from '../popup-standalone-modal';\n\nimport sharedStyles from '../../../../../../styles.scss';\n\nexport class PopupStandaloneModal404Comp extends PopupStandaloneModalComp {\n  constructor() {\n    super();\n    this.header.textContent = 'ERROR: 404';\n    this.header.dataset.textContent = this.header.textContent;\n    this.header.classList.add(sharedStyles['glitched-text']);\n    this.text.classList.add(sharedStyles['glitched-text']);\n  }\n}\n","import { PopupStandaloneComp } from '../popup-standalone';\n\nimport styles from './popup-standalone-modal.scss';\n\nexport abstract class PopupStandaloneModalComp extends PopupStandaloneComp {\n  constructor() {\n    super();\n    this._rootElement.classList.add(styles['popup-modal']);\n    const closeArea = document.createElement('div');\n    closeArea.classList.add(styles['popup-bg']);\n    this._rootElement.append(closeArea);\n    this.body.classList.add(styles['popup-body']);\n    closeArea.append(this.body);\n    this.header.classList.add(styles['popup-body-header']);\n    this.text.classList.add(styles['popup-body-text']);\n  }\n\n  setText(text: string): PopupStandaloneModalComp {\n    this.text.textContent = text;\n    this.text.dataset.textContent = text;\n    return this;\n  }\n\n  show(rootElem?: HTMLElement): PopupStandaloneModalComp {\n    const root = rootElem || document.body;\n    root.append(this._rootElement);\n    return this;\n  }\n\n  hide(): PopupStandaloneModalComp {\n    this._rootElement.remove();\n    return this;\n  }\n}\n","import { PopupStandaloneModalComp } from '../popup-standalone-modal';\n\nimport styles from './popup-progress.scss';\nimport sharedStyles from '../../../../../../styles.scss';\n\nexport class PopupStandaloneModalProgressComp extends PopupStandaloneModalComp {\n  private barContainer = document.createElement('div');\n\n  private bar = document.createElement('div');\n\n  constructor() {\n    super();\n    this.barContainer.classList.add(styles.container);\n    this.bar.classList.add(styles.bar);\n    this.barContainer.append(this.bar);\n    this.text.classList.add(styles.text, sharedStyles['glitched-text']);\n    this.body.classList.add(styles.body);\n    this.body.append(this.barContainer);\n  }\n\n  setText(text: string): PopupStandaloneModalProgressComp {\n    super.setText(text);\n    return this;\n  }\n\n  reset(): PopupStandaloneModalProgressComp {\n    this.bar.style.removeProperty('--progress');\n    this.text.textContent = '';\n    this.text.dataset.textContent = '';\n    return this;\n  }\n\n  setProgress(progress: number): PopupStandaloneModalProgressComp {\n    this.bar.style.setProperty('--progress', `${progress}%`);\n    return this;\n  }\n}\n","import { BaseComp } from '../../base-comp/base-comp';\n\nexport interface BasePopupAttrs {\n  configurable: boolean;\n}\n\nexport abstract class PopupStandaloneComp extends BaseComp {\n  protected body: HTMLElement;\n\n  protected header: HTMLHeadingElement;\n\n  protected text: HTMLParagraphElement;\n\n  constructor() {\n    super('div');\n\n    this.body = document.createElement('div');\n    this.header = document.createElement('h3');\n    this.text = document.createElement('p');\n\n    this.body.append(this.header, this.text);\n    this._rootElement.append(this.body);\n  }\n}\n","export function hexToRgb(hex: string): { r: number; g: number; b: number } {\n  let c: string[];\n\n  if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\n    // c = hex.substring(1).split('');\n    c = hex.split('');\n    if (c.length === 4) {\n      c = [c[1], c[1], c[2], c[2], c[3], c[3]] as string[];\n    }\n    const r = Number.parseInt(hex.slice(1, 3), 16);\n    const g = Number.parseInt(hex.slice(3, 5), 16);\n    const b = Number.parseInt(hex.slice(5, 7), 16);\n    // return `rgb(${r}, ${g}, ${b})`;\n    return { r, g, b };\n  }\n  throw new Error('Bad Hex');\n}\n","export function genUniqId(): string {\n  const arr = new Uint8Array(4);\n  return window.crypto.getRandomValues(arr).join('');\n}\n\nexport function getRandomInt(max: number): number {\n  return Math.floor(Math.random() * max);\n}\n\nexport function getRandomArbitraryInt(min: number, max: number): number {\n  return Math.floor(Math.random() * (max - min) + min);\n}\n\nexport function genRandomHexColor(): string {\n  const color = `#${Math.floor(Math.random() * 16_777_215).toString(16)}`;\n  if (color.length === 7) return color;\n  return genRandomHexColor();\n}\n","export interface TransitionPromiseInterface {\n  elem: HTMLElement;\n  prop: string;\n  val?: string;\n  valToWait?: string;\n  forceAutoresolveIn?: number;\n}\n\nexport function getTransitionDuration(\n  style: CSSStyleDeclaration,\n  prop: string,\n) {\n  const transPropArr = style\n    .getPropertyValue('transition-property')\n    .replace(',', '')\n    .split(' ');\n  let propIndex = transPropArr.lastIndexOf(prop);\n\n  if (propIndex === -1) propIndex = transPropArr.lastIndexOf('all');\n\n  if (propIndex !== -1) {\n    const transDurationsArr = style\n      .getPropertyValue('transition-duration')\n      .replace(',', '')\n      .split(' ');\n    return transDurationsArr[propIndex];\n  }\n\n  return undefined;\n}\n\nexport function transitionPromise(\n  params: TransitionPromiseInterface,\n): Promise<boolean> {\n  return new Promise(resolve => {\n    const transformAndAutoresolve = (delay?: number): void => {\n      if (params.val) params.elem.style.setProperty(params.prop, params.val);\n      const time = delay || 20;\n      setTimeout(() => {\n        resolve(true);\n        // doesn't work - for cause look forward\n        // window.getComputedStyle(elem)[prop] == val ? resolve(true) : resolve(false);\n      }, time);\n    };\n\n    const transformAndWaitEvent = () => {\n      const eventHandler = (e: TransitionEvent): void => {\n        if (e.target !== params.elem) return;\n\n        if (e.propertyName !== params.prop) return;\n\n        if (\n          params.valToWait &&\n          window.getComputedStyle(params.elem).getPropertyValue(params.prop) !==\n            params.valToWait\n        ) {\n          return;\n        }\n\n        params.elem.removeEventListener('transitionend', eventHandler);\n        params.elem.removeEventListener('transitionend', eventHandler);\n\n        // val should be equal to style ! For example translate != matrix...\n        // if(val) window.getComputedStyle(elem)[prop] == val ? resolve(true) : reject(false);\n        // else\n        resolve(true);\n      };\n\n      params.elem.addEventListener('transitionend', eventHandler);\n      params.elem.addEventListener('transitioncancel', eventHandler);\n\n      if (params.val) params.elem.style.setProperty(params.prop, params.val);\n    };\n\n    if (params.forceAutoresolveIn)\n      transformAndAutoresolve(params.forceAutoresolveIn);\n    else if (\n      params.valToWait &&\n      window.getComputedStyle(params.elem).getPropertyValue(params.prop) ===\n        params.valToWait\n    )\n      transformAndAutoresolve();\n    else {\n      const style = window.getComputedStyle(params.elem);\n      const duration = getTransitionDuration(style, params.prop);\n\n      if (!duration || duration === '0s') {\n        transformAndAutoresolve();\n      } else {\n        transformAndWaitEvent();\n      }\n    }\n  });\n}\n","export interface Notifiable {\n  notify: <T>(params: T) => void | Promise<void>;\n}\n\nexport function isNotifiable(object: unknown): object is Notifiable {\n  const objAsRecord = object as Record<string, unknown>;\n  return 'notify' in objAsRecord && typeof objAsRecord.notify === 'function';\n}\n","class ObjProcessor {\n  readonly deepFreeze = <T>(obj: T): T => {\n    if (typeof obj === 'object' && obj !== null) {\n      const record = obj as Record<string, unknown>;\n      Object.keys(record).forEach(prop => {\n        if (\n          typeof record[prop] === 'object' &&\n          !Object.isFrozen(record[prop])\n        ) {\n          this.deepFreeze(record[prop]);\n        }\n      });\n      return Object.freeze(obj);\n    }\n    throw new Error('not object');\n  };\n\n  readonly deepClone = <T>(target: T): T => {\n    if (Array.isArray(target)) {\n      const clone = [] as unknown[];\n      (target as unknown[]).forEach(v => {\n        clone.push(v);\n      });\n      return clone.map((n: unknown) => this.deepClone(n)) as unknown as T;\n    }\n\n    if (typeof target === 'object' && target !== null) {\n      if (target instanceof HTMLElement)\n        return target.cloneNode(true) as unknown as T;\n      if (target instanceof Blob) return target.slice() as unknown as T;\n      const clone = {\n        ...(target as unknown as { [key: string]: unknown }),\n      } as {\n        [key: string]: unknown;\n      };\n      Object.keys(clone).forEach(k => {\n        clone[k] = this.deepClone(clone[k]);\n      });\n      Object.setPrototypeOf(clone, Object.getPrototypeOf(target));\n      return clone as unknown as T;\n    }\n    return target;\n  };\n}\n\nconst OBJ_PROCESSOR = new ObjProcessor();\nOBJ_PROCESSOR.deepFreeze(OBJ_PROCESSOR);\nexport { OBJ_PROCESSOR };\n","import { DBusTopics } from './defs/dbus-topics.def';\nimport { genUniqId } from '../../generators/generators';\nimport { OBJ_PROCESSOR } from '../../processors/obj-processor';\nimport { DBUS_ERRORS } from './defs/dbus-errors.def';\nimport { DBusRX, DBusRXFunc } from './defs/dbus-rx/dbus-rx.def';\nimport { DBusTX } from './defs/dbus-tx/dbus-tx.def';\nimport { DBusTXOptions } from './defs/dbus-tx/dbus-tx-options.def';\nimport { DBusTXData } from './defs/dbus-tx/dbus-tx-data.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from './defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTXDataHeaders } from './defs/dbus-tx/dbus-tx-data-headers.def';\nimport { DBusHub, DBusInterface } from './defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from './defs/dbus-hub-names.def';\n\nexport class DBus {\n  private network: Map<DBusTopics, Set<DBusRX>> = new Map();\n\n  private idCounter = {\n    txs: 0,\n    rxs: 0,\n  };\n\n  private createdRXs = new Set<DBusRX>();\n\n  private createdTXs = new Set<DBusTX>();\n\n  private attachedHubs = new Map<DBusHub, DBusInterface>();\n\n  private occupiedNames = new Set<string>();\n\n  readonly busId: string;\n\n  constructor() {\n    this.busId = genUniqId();\n    return Object.freeze(this) as unknown as DBus;\n  }\n\n  public attachHub(hub: DBusHub, suffix?: string): void | Promise<void> {\n    return this.createInterfaceForHub(hub, undefined, suffix);\n  }\n\n  private createInterfaceForHub(\n    hub: DBusHub,\n    prefix?: string,\n    suffix?: string,\n  ): void | Promise<void> {\n    if (this.attachedHubs.has(hub))\n      throw new Error(DBUS_ERRORS.HUB_IS_ALREADY_ATTACHED);\n\n    if (!(hub.hubName in DBUS_HUB_NAMES))\n      throw new Error(DBUS_ERRORS.HUB_NAME_NOT_AUTHORIZED);\n\n    let hubName = prefix ? `${prefix}_${hub.hubName}` : hub.hubName;\n    if (suffix) hubName += `_${suffix}`;\n\n    if (this.occupiedNames.has(hubName))\n      throw new Error(DBUS_ERRORS.HUB_NAME_IS_OCCUPIED);\n\n    const arrowedGetNewTX = (desc?: string) => this.getNewTX(hubName, desc);\n    const arrowedGetNewRX = (func: DBusRXFunc, desc?: string) =>\n      this.genNewRX(func, desc);\n    const arrowedPlugRX = (topic: DBusTopics, rx: DBusRX) =>\n      this.plugRX(topic, rx);\n    const arrowedUnplugRX = (topic: DBusTopics, rx: DBusRX) =>\n      this.unplugRX(topic, rx);\n    const decoratedAttachHub = (subHub: DBusHub, subSuffix?: string) =>\n      this.createInterfaceForHub(subHub, hubName, subSuffix);\n\n    const dbusInterface = new DBusInterface(\n      arrowedGetNewTX,\n      arrowedGetNewRX,\n      arrowedPlugRX,\n      arrowedUnplugRX,\n      decoratedAttachHub,\n    );\n\n    this.occupiedNames.add(hubName);\n    this.attachedHubs.set(hub, dbusInterface);\n\n    OBJ_PROCESSOR.deepFreeze(dbusInterface);\n\n    return hub.connect(dbusInterface);\n  }\n\n  private getNewTX(hubName: string, desc?: string): DBusTX {\n    const id = genUniqId();\n    const regNumber = this.idCounter.txs++;\n\n    const arrowedTransmit = async (opts: DBusTXOptions) => {\n      const head = new DBusTXDataHeaders(\n        hubName,\n        id,\n        regNumber,\n        opts.waitMode,\n        opts.prepMode,\n        desc,\n      );\n      const data = new DBusTXData(head, opts.msg);\n      const result = await this.transmit(data);\n      return result;\n    };\n\n    const tx = new DBusTX(regNumber, id, this.busId, arrowedTransmit);\n\n    const freezedTX = OBJ_PROCESSOR.deepFreeze(tx);\n\n    this.createdTXs.add(freezedTX);\n\n    return freezedTX;\n  }\n\n  private genNewRX(func: DBusRXFunc, desc?: string): DBusRX {\n    const id = genUniqId();\n    const regNumber = this.idCounter.rxs++;\n    const rx = new DBusRX(regNumber, id, this.busId, func, desc);\n    const freezedRX = OBJ_PROCESSOR.deepFreeze(rx);\n    this.createdRXs.add(freezedRX);\n    return freezedRX;\n  }\n\n  private plugRX(topic: DBusTopics, rx: DBusRX): void {\n    if (!this.createdRXs.has(rx)) throw new Error(DBUS_ERRORS.XENO_RX);\n    if (!this.network.has(topic)) this.network.set(topic, new Set());\n    this.network.get(topic)?.add(rx);\n  }\n\n  private unplugRX(topic: DBusTopics, rx: DBusRX): void {\n    this.network.get(topic)?.delete(rx);\n  }\n\n  private async transmit(data: DBusTXData): Promise<unknown> {\n    if (!this.network.has(data.msg.topic)) {\n      throw new Error(DBUS_ERRORS.TOPIC_IS_NOT_EXIST);\n    }\n\n    const rxs = this.network.get(data.msg.topic);\n\n    if (rxs === undefined || rxs.size === 0)\n      throw new Error(DBUS_ERRORS.TOPIC_HAS_NO_RXS);\n\n    let choosedRXs: DBusRX[] = [];\n\n    if (data.msg.prefResponseRxIds) {\n      rxs.forEach(rx => {\n        if (data.msg.prefResponseRxIds?.includes(rx.id)) choosedRXs.push(rx);\n      });\n      if (choosedRXs.length === 0)\n        throw new Error(DBUS_ERRORS.PREF_RXS_ARE_NOT_EXIST);\n    } else choosedRXs = [...rxs];\n\n    let result;\n    switch (data.headers.waitMode) {\n      case DBusTXWaitModes.all:\n        result = await Promise.all(\n          choosedRXs.map(rx => this.callRXFunc(data, rx)),\n        );\n        break;\n      case DBusTXWaitModes.allSetled:\n        result = await Promise.allSettled(\n          choosedRXs.map(rx => this.callRXFunc(data, rx)),\n        );\n        break;\n      case DBusTXWaitModes.manual:\n        result = choosedRXs;\n        break;\n      case DBusTXWaitModes.nowait:\n      default:\n        choosedRXs.map(rx => this.callRXFunc(data, rx));\n        result = true;\n        break;\n    }\n    return result;\n  }\n\n  private callRXFunc = (data: DBusTXData, rx: DBusRX) => {\n    const handleClone = () => {\n      const clonedData = OBJ_PROCESSOR.deepClone(data);\n      return rx.func(clonedData);\n    };\n\n    const handleFreeze = () => {\n      const freezedData = OBJ_PROCESSOR.deepFreeze(data);\n      return rx.func(freezedData);\n    };\n\n    switch (data.headers.prepMode) {\n      case DBusTXPrepModes.clone:\n        return handleClone();\n      case DBusTXPrepModes.freeze:\n        return handleFreeze();\n      default:\n        throw new Error(DBUS_ERRORS.UNEXPECTED_PREP_MODE);\n    }\n  };\n}\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nconst dbusCommonResponses = {\n  VOID: 'VOID',\n  BAD_REQUEST: 'BAD_REQUEST',\n};\n\nconst DBUS_COMMON_RESPONSES = OBJ_PROCESSOR.deepFreeze(dbusCommonResponses);\n\nexport { DBUS_COMMON_RESPONSES };\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nconst dbusErrors = {\n  HUB_NAME_IS_OCCUPIED: 'HUB_NAME_IS_OCCUPIED',\n  HUB_IS_ALREADY_ATTACHED: 'HUB_IS_ALREADY_ATTACHED',\n  HUB_NAME_NOT_AUTHORIZED: 'HUB_NAME_NOT_AUTHORIZED',\n  XENO_RX: 'XENO_RX',\n  TOPIC_IS_NOT_EXIST: 'TOPIC_IS_NOT_EXIST',\n  TOPIC_HAS_NO_RXS: 'TOPIC_HAS_NO_RXS',\n  PREF_RXS_ARE_NOT_EXIST: 'PREF_RXS_ARE_NOT_EXIST',\n  UNEXPECTED_PREP_MODE: 'UNEXPECTED_PREP_MODE',\n};\n\nconst DBUS_ERRORS = OBJ_PROCESSOR.deepFreeze(dbusErrors);\n\nexport { DBUS_ERRORS };\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nclass DBusHubNames {\n  readonly APP = 'APP';\n\n  readonly ROUTER = 'ROUTER';\n\n  readonly GARAGE = 'GARAGE';\n\n  readonly HEADER = 'HEADER';\n\n  readonly MAIN_CONTROLS = 'MAIN_CONTROLS';\n\n  readonly CREATE_UPDATE = 'CREATE_UPDATE';\n\n  readonly GARAGE_CONTROLLER = 'GARAGE_CONTROLLER';\n}\n\nconst obj = new DBusHubNames();\n\nconst DBUS_HUB_NAMES = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { DBUS_HUB_NAMES };\n\nexport type DBusHubNamesList = keyof DBusHubNames;\n","import { DBusHubNamesList, DBUS_HUB_NAMES } from './dbus-hub-names.def';\nimport { DBusRX, DBusRXFunc } from './dbus-rx/dbus-rx.def';\nimport { DBusTopics } from './dbus-topics.def';\nimport { DBusTX } from './dbus-tx/dbus-tx.def';\n\nexport interface DBusHub {\n  readonly hubName: DBusHubNamesList;\n  connect: (dbusInterface: DBusInterface) => void | Promise<void>;\n}\n\nexport function isDBusHub(object: unknown): object is DBusHub {\n  const objAsRecord = object as Record<string, unknown>;\n  return (\n    'connect' in objAsRecord &&\n    'hubName' in objAsRecord &&\n    typeof objAsRecord.hubName === 'string' &&\n    objAsRecord.hubName in DBUS_HUB_NAMES\n  );\n}\n\nexport class DBusInterface {\n  private RXs = new Set<DBusRX>();\n\n  private TXs = new Set<DBusTX>();\n\n  private RXsPlugMap = new Map<DBusTopics, Set<DBusRX>>();\n\n  constructor(\n    private readonly arrowedGetNewTX: (desc?: string) => DBusTX,\n    private readonly arrowedGetNewRX: (\n      func: DBusRXFunc,\n      desc?: string,\n    ) => DBusRX,\n    private readonly arrowedPlugRX: (topic: DBusTopics, rx: DBusRX) => void,\n    private readonly arrowedUnplugRX: (topic: DBusTopics, rx: DBusRX) => void,\n    public readonly attachSubHub: (\n      subHub: DBusHub,\n      subSuffix?: string,\n    ) => void | Promise<void>,\n  ) {}\n\n  getNewRX(func: DBusRXFunc, desc?: string) {\n    const rx = this.arrowedGetNewRX(func, desc);\n    this.RXs.add(rx);\n    return rx;\n  }\n\n  getNewTX(desc?: string) {\n    const tx = this.arrowedGetNewTX(desc);\n    this.TXs.add(tx);\n    return tx;\n  }\n\n  plugRX(topic: DBusTopics, rx: DBusRX): void {\n    if (!this.RXsPlugMap.has(topic)) this.RXsPlugMap.set(topic, new Set());\n    this.RXsPlugMap.get(topic)?.add(rx);\n    this.arrowedPlugRX(topic, rx);\n  }\n\n  unplugRX(topic: DBusTopics, rx: DBusRX): void {\n    this.RXsPlugMap.get(topic)?.delete(rx);\n    this.arrowedUnplugRX(topic, rx);\n  }\n}\n","import { DBusTXData } from '../dbus-tx/dbus-tx-data.def';\n\nexport type DBusRXFunc = (data: DBusTXData) => Promise<unknown>;\n\nexport class DBusRX {\n  constructor(\n    readonly regNumber: number,\n    readonly id: string,\n    readonly busId: string,\n    readonly func: DBusRXFunc,\n    readonly desc?: string,\n  ) {}\n}\n","export enum DBusTopics {\n  ROUTING,\n  CAR_ACTION,\n  GARAGE,\n  REST_CLIENT_REQUESTS,\n  GENERATE,\n}\n","import { DBusTXPrepModes, DBusTXWaitModes } from './dbus-tx-modes.def';\n\nexport class DBusTXDataHeaders {\n  constructor(\n    readonly hubName: string,\n    readonly txId: string,\n    readonly txRegNumber: number,\n    readonly waitMode: DBusTXWaitModes,\n    readonly prepMode: DBusTXPrepModes,\n    readonly txDesc?: string,\n  ) {}\n}\n","import { DBusMsg } from '../msgs/dbus-msg.def';\nimport { DBusTXDataHeaders } from './dbus-tx-data-headers.def';\n\nexport class DBusTXData {\n  constructor(readonly headers: DBusTXDataHeaders, readonly msg: DBusMsg) {}\n}\n","export enum DBusTXWaitModes {\n  nowait,\n  all,\n  allSetled,\n  manual,\n}\n\nexport enum DBusTXPrepModes {\n  clone,\n  freeze,\n}\n","import { DBusTXOptions } from './dbus-tx-options.def';\n\nexport class DBusTX {\n  constructor(\n    readonly regNumber: number,\n    readonly id: string,\n    readonly busId: string,\n    readonly transmit: (options: DBusTXOptions) => Promise<unknown>,\n  ) {}\n}\n","import { DBusTopics } from '../dbus-topics.def';\n\nexport abstract class DBusMsg {\n  constructor(\n    readonly topic: DBusTopics,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {}\n}\n","export class Pager {\n  private firstPageNumber = 1;\n\n  private currPageNumber = this.firstPageNumber;\n\n  private lastPageNumber = 0;\n\n  private pagerSpan = document.createElement('span');\n\n  private entriesCount = 0;\n\n  private callbackIsCalled = false;\n\n  constructor(\n    private entriesPerPage: number,\n    protected readonly listCallback: (dir: 'prev' | 'next') => Promise<boolean>,\n    private btnPrevPage = document.createElement('button'),\n    private btnNextPage = document.createElement('button'),\n  ) {\n    const btnNextSpan = document.createElement('span');\n    btnNextSpan.textContent = 'Next page';\n    this.btnNextPage.append(btnNextSpan);\n\n    const btnPrevSpan = document.createElement('span');\n    btnPrevSpan.textContent = 'Prev page';\n    this.btnPrevPage.append(btnPrevSpan);\n\n    this.btnNextPage.addEventListener('click', () => this.callCallback('next'));\n    this.btnPrevPage.addEventListener('click', () => this.callCallback('prev'));\n  }\n\n  public toogleLock(lock: boolean) {\n    this.toggleBtnsDisabled(lock);\n  }\n\n  public getEntriesPerPage(): number {\n    return this.entriesPerPage;\n  }\n\n  public setLastPageNumber(n: number) {\n    this.lastPageNumber = n;\n    if (!this.callbackIsCalled) this.toggleBtnsDisabled(false);\n  }\n\n  public setEntriesCount(n: number) {\n    this.entriesCount = n;\n    this.lastPageNumber = Math.ceil(this.entriesCount / this.entriesPerPage);\n    this.pagerSpan.textContent = `Entries: ${n}, Pages: ${this.lastPageNumber}`;\n    if (!this.callbackIsCalled) this.toggleBtnsDisabled(false);\n  }\n\n  public getCurrPageNumber() {\n    return this.currPageNumber;\n  }\n\n  public getBtnPrevPage(): HTMLSpanElement {\n    return this.btnPrevPage;\n  }\n\n  public getBtnNextPage(): HTMLSpanElement {\n    return this.btnNextPage;\n  }\n\n  public getPagerSpan(): HTMLSpanElement {\n    return this.pagerSpan;\n  }\n\n  tryChangePage(dir: 'prev' | 'next') {\n    return this.callCallback(dir);\n  }\n\n  private async callCallback(dir: 'prev' | 'next') {\n    this.callbackIsCalled = true;\n    this.toggleBtnsDisabled(true);\n    const pageIsChanged = await this.listCallback(dir);\n    if (pageIsChanged) {\n      switch (dir) {\n        case 'next':\n          this.currPageNumber++;\n          break;\n        case 'prev':\n          this.currPageNumber--;\n          break;\n        default:\n          break;\n      }\n    }\n    this.toggleBtnsDisabled(false);\n    this.callbackIsCalled = false;\n  }\n\n  private toggleBtnsDisabled(state: boolean) {\n    if (state === true) {\n      this.btnPrevPage.disabled = true;\n      this.btnNextPage.disabled = true;\n      return;\n    }\n\n    if (this.currPageNumber > this.firstPageNumber)\n      this.btnPrevPage.disabled = false;\n    else this.btnPrevPage.disabled = true;\n\n    if (this.currPageNumber < this.lastPageNumber)\n      this.btnNextPage.disabled = false;\n    else this.btnNextPage.disabled = true;\n  }\n}\n","import { DBusTopics } from '../../dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgRoutingMsg extends DBusMsg {\n  constructor(rxIds?: string[], prefResponseRxIds?: string[]) {\n    super(DBusTopics.ROUTING, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgRoutingMsg } from '../dbus-msg-routing-msg.def';\nimport { ROUTES } from '../../routes.def';\n\nexport class DBusMsgRouteIsChangedMsg extends DBusMsgRoutingMsg {\n  constructor(\n    readonly newRoute: keyof typeof ROUTES | string,\n    rxIds?: string[],\n    prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","export class SimpleRouterAgent {\n  constructor(\n    readonly type: string,\n    readonly path: string,\n    readonly callback: CallableFunction,\n    readonly getStateCallback?: CallableFunction,\n    readonly setStateCallback?: CallableFunction,\n  ) {}\n}\n","import { OBJ_PROCESSOR } from '../../processors/obj-processor';\nimport { DBUS_HUB_NAMES } from '../dbus/defs/dbus-hub-names.def';\nimport { DBusHub, DBusInterface } from '../dbus/defs/dbus-interface.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgRouteIsChangedMsg } from './dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport { SimpleRouterAgent } from './simple-router-agent';\n\nexport interface RouterOptions {\n  mode: string;\n  onlyDBus?: true;\n  defaultRoot?: string;\n  defaultAgent?: SimpleRouterAgent;\n}\n\nexport class SimpleRouter implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.ROUTER;\n\n  private agents: Set<SimpleRouterAgent> = new Set();\n\n  private options: RouterOptions;\n\n  private currRoute: string | undefined;\n\n  private txs: Set<DBusTX> = new Set();\n\n  private defaultAgent: SimpleRouterAgent | undefined;\n\n  private restrictions: Set<() => Promise<boolean>> = new Set();\n\n  constructor(options: RouterOptions) {\n    switch (options.mode) {\n      case '#':\n        // just filter that # mode\n        break;\n      case '?':\n        throw new Error(`${options.mode} is not supported yet!`);\n      default:\n        throw new Error(`${options.mode} is not supported!`);\n    }\n    this.options = OBJ_PROCESSOR.deepFreeze(options);\n\n    window.addEventListener('popstate', async () => {\n      if (window.location.href === this.currRoute) return;\n\n      if (this.restrictions.size > 0) {\n        const wantedRoute = window.location.href;\n\n        if (this.currRoute) {\n          window.location.href = this.currRoute;\n        } else if (this.options.defaultRoot) {\n          window.location.href = `${window.location.host}/${this.options.defaultRoot}`;\n        }\n        const arr = [...this.restrictions.values()];\n        const promises = arr.map(arrow => arrow());\n        const result = await Promise.all(promises);\n        let cancelRouteChange = false;\n\n        if (Array.isArray(result)) {\n          for (let i = 0; i < result.length; i++) {\n            if (typeof result[i] !== 'boolean')\n              throw new Error('restrict func returned not boolean value!');\n\n            if (!result[i]) cancelRouteChange = true;\n            else {\n              const func = arr[i];\n\n              if (func) this.restrictions.delete(func);\n            }\n          }\n        }\n\n        if (!cancelRouteChange) window.location.href = wantedRoute;\n      } else {\n        this.activateWantedAgents();\n      }\n    });\n  }\n\n  activateWantedAgents(): boolean | Error[] {\n    this.currRoute = window.location.href;\n    let activatedCount = 0;\n    const errors = [];\n\n    if (!this.options.onlyDBus && this.options.mode === '#') {\n      const agentsArr = [...this.agents];\n      for (let i = 0; i < this.agents.size; i++) {\n        if (agentsArr[i]?.path === window.location.hash) {\n          try {\n            agentsArr[i]?.callback();\n          } catch (error) {\n            error.push(error);\n          }\n          activatedCount++;\n          break;\n        }\n      }\n\n      if (activatedCount === 0) {\n        if (\n          this.defaultAgent &&\n          this.options.defaultRoot === window.location.hash\n        ) {\n          this.defaultAgent.callback();\n        } else {\n          errors.push(new Error('Agent is not finded'));\n        }\n      }\n    }\n\n    if (this.txs.size > 0) {\n      this.txs.forEach(tx => {\n        const msg = new DBusMsgRouteIsChangedMsg(window.location.hash);\n        tx.transmit({\n          msg,\n          waitMode: DBusTXWaitModes.nowait,\n          prepMode: DBusTXPrepModes.freeze,\n        });\n      });\n    }\n\n    if (errors.length > 0) return errors;\n    return activatedCount > 0;\n  }\n\n  addRouterAgent(agent: SimpleRouterAgent): void {\n    this.agents.add(agent);\n  }\n\n  removeRouterAgent(agent: SimpleRouterAgent): void {\n    this.agents.delete(agent);\n  }\n\n  flushRouterAgents(): void {\n    this.agents.clear();\n  }\n\n  /* not refactored yet\n  private watchRestrictions = async (msg: DataBusRoutingMsg) => {\n    if (msg instanceof DataBusMsgRoutingRoutingRestrictMode) {\n      const func = msg.data.callbackPromiseGenerator as () => Promise<boolean>;\n\n      if (msg.data.mode) {\n        this.restrictions.add(func);\n      } else {\n        this.restrictions.delete(func);\n      }\n    }\n  };\n  */\n\n  connect(int: DBusInterface): void {\n    const tx = int.getNewTX('broadcasting route changes');\n    this.txs.add(tx);\n    // watch restriction\n    // not refactored yet\n    // const rx = bus.getNewRX();\n    // bus.registerReceiver(DataBusMsgTopics.ROUTING, msgReceiver);\n  }\n}\n","import { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\n\nexport type EngineResponse = {\n  velocity: number;\n  distance: number;\n};\n\nclass RestClientEngine {\n  private resUrl = '/engine';\n\n  private fullUrl: string;\n\n  constructor(private baseUrl: string) {\n    this.fullUrl = baseUrl + this.resUrl;\n  }\n\n  toggleEngine(\n    id: number,\n    status: 'started' | 'stopped',\n  ): Promise<EngineResponse> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}?id=${id}&status=${status}`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as EngineResponse))\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  enterDriveMode(id: number): Promise<true | false | 404> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}?id=${id}&status=drive`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          else if (response.status === 500) res(false);\n          else rej(new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT));\n        })\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n}\n\nconst obj = new RestClientEngine('http://127.0.0.1:3000');\n\nconst REST_CLIENT_ENGINE = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_ENGINE };\n","import { RegCarData, UnregCarData } from '../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\nimport { REST_CLIENT_NAMES } from '../rest-clients-names.def';\n\nclass RestClientGarage {\n  protected clientName = REST_CLIENT_NAMES.GARAGE;\n\n  private resUrl = '/garage';\n\n  private fullUrl: string;\n\n  constructor(private baseUrl: string) {\n    this.fullUrl = baseUrl + this.resUrl;\n  }\n\n  getCars(\n    page?: number,\n    limit?: number,\n  ): Promise<{ limit: string; cars: RegCarData[] }> {\n    return new Promise((res, rej) => {\n      const limitStr = limit || '';\n      const url = `${this.fullUrl}?_page=${page}&_limit=${limitStr}`;\n      let limitResponse = '';\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) {\n            limitResponse = response.headers.get('X-Total-Count') as string;\n            return response.json();\n          }\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res({ limit: limitResponse, cars: json as RegCarData[] }))\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  getCar(id: number): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as RegCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  createCar(unregCar: UnregCarData): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      fetch(this.fullUrl, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(unregCar),\n      })\n        .then(response => {\n          if (response.status === 201) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as RegCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  deleteCar(id: number): Promise<true> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'DELETE',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  updateCar(regCar: RegCarData): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${regCar.id}`;\n      const data: UnregCarData = regCar;\n      fetch(url, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data),\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n}\n\nconst obj = new RestClientGarage('http://127.0.0.1:3000');\n\nconst REST_CLIENT_GARAGE = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_GARAGE };\n","import { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\n\nclass RestClientWinnersSortOptions {\n  readonly id = 'id';\n\n  readonly wins = 'wins';\n\n  readonly time = 'time';\n}\n\nconst obj = new RestClientWinnersSortOptions();\n\nconst REST_CLIENT_WINNERS_SORT_OPTIONS = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_WINNERS_SORT_OPTIONS };\n\nexport type RestClientWinnersSortOptionsList =\n  keyof RestClientWinnersSortOptions;\n","import { WinnerCarData } from '../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\nimport { RestClientWinnersSortOptionsList } from './rest-client-winners.def';\n\nclass RestClientWinners {\n  private resUrl = '/winners';\n\n  private fullUrl: string;\n\n  constructor(private baseUrl: string) {\n    this.fullUrl = baseUrl + this.resUrl;\n  }\n\n  getWinners(\n    page = 0,\n    limit?: number,\n    sort?: RestClientWinnersSortOptionsList,\n    order?: 'ASC' | 'DESC',\n  ): Promise<{ limit: string; cars: WinnerCarData[] }> {\n    return new Promise((res, rej) => {\n      const limitStr = limit || '';\n      let url = `${this.fullUrl}?_page=${page}&_limit=${limitStr}`;\n      if (sort) url += `&_sort=${sort}`;\n      if (order) url += `&_order=${order}`;\n      let limitResponse = '';\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) {\n            limitResponse = response.headers.get('X-Total-Count') as string;\n            return response.json();\n          }\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json =>\n          res({ limit: limitResponse, cars: json as WinnerCarData[] }),\n        )\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  getWinner(id: number): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  createWinner(winnerCarData: WinnerCarData): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      fetch(this.fullUrl, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(winnerCarData),\n      })\n        .then(response => {\n          if (response.status === 201) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  deleteWinner(id: number): Promise<true> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'DELETE',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  updateWinner(winnerData: WinnerCarData): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${winnerData.id}`;\n      const data: WinnerCarData = winnerData;\n      fetch(url, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data),\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n}\n\nconst obj = new RestClientWinners('http://127.0.0.1:3000');\n\nconst REST_CLIENT_WINNERS = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_WINNERS };\n","import { OBJ_PROCESSOR } from '../../lib/processors/obj-processor';\n\nconst restClientError = {\n  UNEXPECTED_RESULT: 'UNEXPECTED_RESULT',\n  UNKNOWN_ERROR: 'UNKNOWN_ERROR',\n  NOT_FOUND: 'NOT_FOUND',\n  CONNECTION_REFUSED: 'CONNECTION_REFUSED',\n};\n\nconst REST_CLIENT_ERROR = OBJ_PROCESSOR.deepFreeze(\n  restClientError,\n) as typeof restClientError;\n\nexport { REST_CLIENT_ERROR };\n","import { OBJ_PROCESSOR } from '../../lib/processors/obj-processor';\n\nclass RestClientNames {\n  readonly GARAGE = 'GARAGE';\n\n  readonly WINNERS = 'WINNERS';\n}\n\nconst REST_CLIENT_NAMES = new RestClientNames();\n\nOBJ_PROCESSOR.deepFreeze(REST_CLIENT_NAMES);\n\nexport { REST_CLIENT_NAMES };\n\nexport type RestClientNamesList = keyof RestClientNames;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { App } from './app';\n\nwindow.addEventListener('load', () => {\n  const appDiv = document.createElement('div');\n  document.body.append(appDiv);\n  const app = new App(appDiv);\n});\n"],"sourceRoot":""}