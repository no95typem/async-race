{"version":3,"sources":["webpack://async-race/./src/components/garage/garage.scss?dc9e","webpack://async-race/./src/components/garage/subcomps/car/car.scss?1a27","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/create-update.scss?4682","webpack://async-race/./src/components/garage/subcomps/main-controls/main-controls.scss?1eb1","webpack://async-race/./src/components/garage/subcomps/track/track.scss?9419","webpack://async-race/./src/components/header/header.scss?92c0","webpack://async-race/./src/components/winners/winners.scss?feec","webpack://async-race/./src/lib/components/popups/standalone/modal/popup-standalone-modal.scss?0629","webpack://async-race/./src/lib/components/popups/standalone/modal/progress/popup-progress.scss?22c3","webpack://async-race/./src/styles.scss?cfb3","webpack://async-race/./src/app/app.ts","webpack://async-race/./src/app/dbus-msgs/reboot-msg.def.ts","webpack://async-race/./src/components/garage/car-actions.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-action-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-created-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-remove-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/car-action/garage-car-select-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-page-is-changed.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-request-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-race-status-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-reset-msg.def.ts","webpack://async-race/./src/components/garage/dbus-msgs/by-topic/garage/garage-reset-req-msg.def.ts","webpack://async-race/./src/components/garage/garage-controller.ts","webpack://async-race/./src/components/garage/garage-driver.ts","webpack://async-race/./src/components/garage/garage-managers-team.ts","webpack://async-race/./src/components/garage/garage.ts","webpack://async-race/./src/components/garage/subcomps/car/car.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-create.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-proto.def.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/controller-update.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/create-update/create-update.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/dbus-msgs/generate-cars-msg.def.ts","webpack://async-race/./src/components/garage/subcomps/main-controls/main-controls.ts","webpack://async-race/./src/components/garage/subcomps/popup-winner/popup-winner.ts","webpack://async-race/./src/components/garage/subcomps/track/track.ts","webpack://async-race/./src/components/header/header.ts","webpack://async-race/./src/components/header/subcomps/nav-item/nav-item.ts","webpack://async-race/./src/components/winners/subcomps/winner-entry.ts","webpack://async-race/./src/components/winners/winners.ts","webpack://async-race/./src/definitions/car-random-data.def.ts","webpack://async-race/./src/lib/components/base-comp/base-comp.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/404/popup-404.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/popup-standalone-modal.ts","webpack://async-race/./src/lib/components/popups/standalone/modal/progress/popup-progress.ts","webpack://async-race/./src/lib/components/popups/standalone/popup-standalone.ts","webpack://async-race/./src/lib/convertors/colors.ts","webpack://async-race/./src/lib/generators/generators.ts","webpack://async-race/./src/lib/gui/animation.ts","webpack://async-race/./src/lib/interfaces/notifiable.ts","webpack://async-race/./src/lib/processors/obj-processor.ts","webpack://async-race/./src/lib/services/dbus/dbus.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-common-responses.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-errors.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-hub-names.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-interface.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-rx/dbus-rx.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-topics.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-data-headers.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-data.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def.ts","webpack://async-race/./src/lib/services/dbus/defs/dbus-tx/dbus-tx.def.ts","webpack://async-race/./src/lib/services/dbus/defs/msgs/dbus-msg.def.ts","webpack://async-race/./src/lib/services/pager/pager.ts","webpack://async-race/./src/lib/services/simple-router/dbus-msgs-defs/dbus-msg-routing-msg.def.ts","webpack://async-race/./src/lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg.ts","webpack://async-race/./src/lib/services/simple-router/simple-router-agent.ts","webpack://async-race/./src/lib/services/simple-router/simple-router.ts","webpack://async-race/./src/services/rest-clients/client-engine/rest-client-engine.ts","webpack://async-race/./src/services/rest-clients/client-garage/rest-client-garage.ts","webpack://async-race/./src/services/rest-clients/client-winners/rest-client-winners.def.ts","webpack://async-race/./src/services/rest-clients/client-winners/rest-client-winners.ts","webpack://async-race/./src/services/rest-clients/rest-clients-errors.def.ts","webpack://async-race/./src/services/rest-clients/rest-clients-names.def.ts","webpack://async-race/webpack/bootstrap","webpack://async-race/webpack/runtime/define property getters","webpack://async-race/webpack/runtime/hasOwnProperty shorthand","webpack://async-race/webpack/runtime/make namespace object","webpack://async-race/./src/entry.ts"],"names":["rootElement","hubName","DBUS_HUB_NAMES","APP","loadedMainComponents","defaultRouterAgent","SimpleRouterAgent","this","loadMainComponent","router","SimpleRouter","mode","defaultRoot","defaultAgent","mainlineDBus","DBus","rebootMsg","DBusMsgRebootMsg","emergencyHandlerIsWorking","sendRebootMsg","tx","transmit","msg","prepMode","DBusTXPrepModes","freeze","waitMode","DBusTXWaitModes","allSetled","watchRouterMsgs","async","data","DBusMsgRouteIsChangedMsg","newRoute","DBUS_COMMON_RESPONSES","VOID","setupEmergencyHandler","classList","add","app","header","HeaderComponent","HEADER","append","attachHub","activateWantedAgents","window","addEventListener","e","preventDefault","promise","catch","error","message","REST_CLIENT_ERROR","CONNECTION_REFUSED","popup","PopupStandaloneModal404Comp","setText","show","retry","REST_CLIENT_GARAGE","getCars","console","log","hide","Promise","res","setTimeout","intrfce","routeRX","getNewRX","plugRX","DBusTopics","ROUTING","getNewTX","name","GarageComp","WinnersComp","location","hash","newComponent","currMainComponent","remove","isDBusHub","isNotifiable","notify","DBusMsg","signal","rxIds","prefResponseRxIds","super","APP_CTL","CarActions","DBusMsgCarActionMsg","action","CAR_ACTION","DBusMsgCarActionCreatedMsg","car","CREATED","DBusMsgCarActionRemovedMsg","nullifiedContract","REMOVED","DBusMsgCarActionSelectedMsg","notifyChanges","SELECTED","DBusMsgGarageMsg","GARAGE","DBusMsgGaragePageIsChangedMsg","DBusMsgGarageRaceMsg","DBusMsgRaceRequestMsg","DBusMsgGarageRaceStatusMsg","status","DBusMsgGarageResetMsg","DBusMsgGarageResetReqMsg","GarageCompCtlAkaDirector","tracksContainer","carCtlsBlock","GARAGE_CONTROLLER","txs","Set","entriesPerPage","pagerContainer","document","createElement","ctlBlocks","pagerCallback","dir","resetState","reloadData","appCtlRXFunc","generatorRXFunc","DBusMsgGenerateCarsMsg","garageManagersTeam","getContracts","size","racingRXFunc","pager","toogleLock","performRace","carCtlsBlockBlockListener","stopPropagation","carActionsRXFunc","racePromise","handleCarRm","finally","tryChangePage","createCarCtlBlock","index","btns","btnSelect","btnStart","btnReset","btnRm","forEach","btn","numberSpan","textContent","toString","container","connectCtlAndTrack","ctlElem","track","illuminateSelf","GarageManagersTeam","lockCallback","Pager","setupPager","btnNextPage","getBtnNextPage","btnPrevPage","getBtnPrevPage","pagerInfo","getPagerSpan","redraw","int","autoConnect","carActionsMsgsRX","raceMsgsRX","generatorMsgsRX","GENERATE","appCtlMsgsRX","rej","toggleCtlsBlockDisabled","then","state","capture","block","style","setProperty","length","removeEventListener","removeProperty","undefined","page","getCurrPageNumber","getEntriesPerPage","response","limit","cars","setEntriesCount","Number","parseInt","broadcastPaging","nullifyContracts","newContracts","TrackComp","carComp","CarComp","placeCar","push","addContracts","nowait","clearDOM","geometry","calcGeometry","setStylesForTracks","drawTracks","drawCarsCtls","firstChild","getComputedStyle","containerHeight","parseFloat","height","paddingBottom","paddingTop","firstAutoHeight","Math","min","innerWidth","CAR_WIDTH_RATIO","CAR_MAX_WIDTH","CAR_IMG_RATIO","heights","heightSum","contracts","contract","factor","SCALE_FACTOR","carTrackHeight","excessHeight","heightsReversed","sort","a","b","displacementBase","SKIPPED_PROGRESSION_MEMBERS_COUNT","displacements","midIndex","displacement","DISPLACEMENT_FIX","paddingBase","paddingShift","PADDING_SHIFT_BASE","PADDING_SHIFT_BASE_VW","trackHeights","map","GarageDriverCommands","GarageDriver","emergencyAwaitServer","timeInMS","delayInMS","resPromise","PopupStandaloneModalProgressComp","setProgress","startTime","Date","now","interval","IamResolved","resFunc","clearInterval","setInterval","elapsedTime","progress","Error","flags","disableCtls","thisDriveId","genUniqId","currDriveId","ignitionPromise","TurnOnTheIgnition","driveParams","drivePromise","drive","REST_CLIENT_ENGINE","toggleEngine","currCar","id","stopCar","rollBack","msgBlock","updateProgress","playAwaitingAnim","clearTimeout","lastTimeInMs","lastStart","driveId","time","calculateDriveTime","start","enterDriveMode","success","rollForward","playbackRate","onlyAnim","rollover","broken","stop","params","distance","velocity","directorLockCb","freeDrivers","busyDrivers","Map","winnerPopup","GaragePopupWinner","carCtlsClickListener","target","HTMLElement","elem","HTMLButtonElement","parentElement","disabled","currRaceId","handleRemoving","startDriving","handleRestoreState","handleSelection","handleWinner","isFinishVisible","duration","getTransitionDuration","awaitTime","isRoadMoves","winnerCar","setData","toFixed","REST_CLIENT_WINNERS","getWinner","winnerRecord","updatedWinnerData","wins","updateWinner","NOT_FOUND","newWinnerData","createWinner","get","getOutOfTheCar","tryFreeDrivers","delete","clear","сontracts","newContract","prepareForRace","rollbackCars","broadcastRaceStatus","driver","returnToStart","choosedDriver","find","isFree","set","putBehindTheWheel","performDrivingProtocol","deleteCar","deleteWinner","genSelectCallback","rollbacks","all","thisRaceId","raceData","raceId","arrivedByOrder","notArrived","participantsCount","roadElem","stratedCount","processRace","result","handleDriveResult","has","updateData","BaseComp","isControllerWorking","mainControlsComp","MainControlsComp","carsCtlsBlock","bgVideo","bgVideoProgressListener","buffered","end","bgVideoCanPlayListener","reset","controller","startWorking","play","_rootElement","garage","selfCtlsBlock","bg","garage__bg","setupBgVideo","renderBgVideo","controls","loop","defaultMuted","muted","autoplay","src","attachSubHub","_currCar","canvas","tireBack","btnSelect$","btnRm$","_spanCarName","btnStart$","btnReset$","isReseted","movingClassName","clearAnimFromElem","anim","commitStyles","selectSpan","rmSpan","startSpan","resetSpan","drawCar","color","drawWheels","observer","MutationObserver","mutations","mutation","oldValue","includes","currOutOfSceneAnim","pause","disconnect","contains","outOfScene","rootElem","wheelImg","Image","CAR_WHEEL_IMG_SRC","onload","backwardWheelImg","OBJ_PROCESSOR","deepClone","carData","finishPromise","resolve","playOutAnim","cancel","currAnimation","finished","playInAnim","asyncFunc","animOut","animate","opacity","easing","fill","promiseToAwait","animIn","iterations","POSITIVE_INFINITY","transform","handleBtns","rootStyle","selfStyle","rootWidth","width","paddingLeft","paddingRight","selfWidth","coordinateInPercents","onfinish","oncancel","playState","roadIsMoving","observe","attributes","attributeOldValue","img","frameNumber","CAR_EXPLOSION_IMG_DATA","BASE_URL","EXTENSION","FRAME_TIME_MS","FRAMES_COUNT","hexColor","CAR_BODY_IMG_SRC","ctx","getContext","shadowColor","shadowBlur","drawImage","paintCarBody","imageData","getImageData","rgb","hexToRgb","j","i","red","green","blue","blueDiff","blueDiffThreshold","threshold","r","g","putImageData","TIMING_FUNCTION","CreateCompController","CreateUpdateCompControllerProto","elements","inputText","inputColor","setupBtnCreate","reportValidity","unregCar","value","createCar","clone","ctlsStateMap","ctls","setCustomValidity","pattern","removeAttribute","ctl","pushCtlsState","toogleCtlsDisabled","popCtlsState","UpdateCompController","garageMsgsListener","carActionsListener","choosedCar","notifyCb","setupBtnUpdate","rxCarActions","rxGarage","updateCar","CreateUpdateComponent","type","btnText","CREATE_UPDATE","textInput","colorInput","root","MAIN_CONTROLS","createComponent","updateComponent","btnRace","btnGenerate","generateClickListener","transmissions","transmission","allSettled","generate","genCb","resolveMsg","raceClickListener","resetClickListener","genRandomCarName","manufacturerNumber","getRandomInt","CAR_MODEL_LIST_KEYS","manufacturerName","models","CAR_MODEL_LIST","rxFuncForRaceMsgs","getController","enable","disable","btnsBlock","renderBtns","span","btnBlock","total","left","cb","genLeft","unregCarData","genRandomHexColor","rx","textTime","textName","textId","textNumber","timeStr","indexStr","topBlock","illuminate","track_illuminated","hasChildNodes","childNodes","child","spanCarName","buses","illuminateNavItem","anchors","anchor","getAttribute","logo","header__logo","firstSpan","secondSpan","navContainer","ul","li","svg","navItems","NavItem","item","illuminateRX","text","href","styles","iconSrc","_anchor","setAttribute","iconImage","WinnerRowComp","winnerData","indexElem","idElem","carPreviewBox","nameElem","winsElem","bestTimeElem","carPreview","genPreview","table","tableBody","tableHead","thId","thCar","thName","thWins","thBestTime","pagerBtnsContainer","currOrder","currSort","refillTable","tableHeadClickListener","REST_CLIENT_WINNERS_SORT_OPTIONS","refreshTableHeader","currSortedElem","winners","pagerSpan","renderPager","renderTable","renderTableHeader","tr","thIndex","getWinners","rows","Array","promises","indexInc","winner","getCar","totalIndex","row","getCarPreview","TEXT_CONTENT_ENG","deepFreeze","Lamborghini","Ferrari","Koenigsegg","Object","keys","tag","PopupStandaloneModalComp","dataset","PopupStandaloneComp","closeArea","body","barContainer","bar","setHeader","hex","c","test","split","slice","arr","Uint8Array","crypto","getRandomValues","join","max","floor","random","prop","transPropArr","getPropertyValue","replace","propIndex","lastIndexOf","transformAndAutoresolve","delay","val","forceAutoresolveIn","valToWait","eventHandler","propertyName","transformAndWaitEvent","object","obj","record","isFrozen","isArray","v","n","cloneNode","Blob","k","setPrototypeOf","getPrototypeOf","network","idCounter","rxs","createdRXs","createdTXs","attachedHubs","occupiedNames","callRXFunc","headers","clonedData","func","handleClone","freezedData","handleFreeze","DBUS_ERRORS","UNEXPECTED_PREP_MODE","busId","hub","suffix","createInterfaceForHub","prefix","HUB_IS_ALREADY_ATTACHED","HUB_NAME_NOT_AUTHORIZED","HUB_NAME_IS_OCCUPIED","dbusInterface","DBusInterface","desc","genNewRX","topic","unplugRX","subHub","subSuffix","connect","regNumber","DBusTX","opts","head","DBusTXDataHeaders","DBusTXData","freezedTX","DBusRX","freezedRX","XENO_RX","TOPIC_IS_NOT_EXIST","TOPIC_HAS_NO_RXS","choosedRXs","PREF_RXS_ARE_NOT_EXIST","manual","BAD_REQUEST","ROUTER","objAsRecord","arrowedGetNewTX","arrowedGetNewRX","arrowedPlugRX","arrowedUnplugRX","RXs","TXs","RXsPlugMap","txId","txRegNumber","txDesc","listCallback","firstPageNumber","currPageNumber","lastPageNumber","entriesCount","callbackIsCalled","btnNextSpan","btnPrevSpan","callCallback","lock","toggleBtnsDisabled","ceil","updateSpanText","pageNumber","DBusMsgRoutingMsg","addInfo","path","callback","getStateCallback","setStateCallback","options","agents","restrictions","currRoute","wantedRoute","host","values","arrow","cancelRouteChange","activatedCount","errors","onlyDBus","agentsArr","agent","baseUrl","resUrl","fullUrl","url","fetch","method","json","UNEXPECTED_RESULT","UNKNOWN_ERROR","clientName","REST_CLIENT_NAMES","limitStr","limitResponse","JSON","stringify","regCar","order","winnerCarData","WINNERS","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","d","definition","key","o","defineProperty","enumerable","prototype","hasOwnProperty","Symbol","toStringTag","appDiv","App"],"mappings":"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","file":"main.4420bcfbb756d5203110.js","sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"garage\":\"_21SC4SGf5mTamWfNdNRR\",\"garage__bg\":\"_2VnbeeG4HKnZfSWUedizHh\",\"garage__track-container\":\"_1rsPT6UvHnbHI-FUFvPaSe\",\"hue-rotate\":\"_3MSD3skhU7RLqKdx6pBax7\",\"garage__track-container_finish\":\"_1khEfVJzcbQlBMhoHPdhzY\",\"garage__winner-popup\":\"_17InT8lGlAlk8k1JRcrTCM\",\"garage-bg\":\"-BA3r_cxZwAYkgGQVVZeo\",\"garage-bg__video\":\"_3byu86MCf3s6B7JQuetNAw\",\"garage-bg__car-ctl-btn\":\"_3upDU-ngLjybmFg4wiVvfl\",\"garage-bg__car-ctl-block-number\":\"_3dT19pzigDW1UKuPVLEguq\",\"garage-bg__car-ctl-block\":\"_2e0Ox8Joh0jw60ztR_rVt5\",\"garage-bg__cars-ctls-block\":\"wMVLCRcoluFnZleBHWXlm\",\"garage-bg__self-ctls-block\":\"_2VQVmkB2amN4PG9XCyFye9\",\"garage-bg__pager\":\"_2avafWgl8XDS2KLJswKq0H\",\"garage-bg__pager-span\":\"_3ktlpozBQghco3VMHLJBo1\",\"garage-bg__pager-btn\":\"_2QdjLaEnj3Balh89eZAya4\",\"synthwave-background\":\"_2pUKJme_w_0KTS_JoVNV5b\",\"synthwave-background_race-mode\":\"n1z9UH35nfilmkK2lmQvV\",\"race\":\"_375ItX4gjZY-ZT7KrEfBgG\",\"move-grid\":\"_1MqERRNbzZtvdd9iE43L04\"};","// extracted by mini-css-extract-plugin\nexport default {\"car-div\":\"_3pRKwGaRv59JcJqlApAnkk\",\"car-div__canvas\":\"rH6_OMXna8-zeemMHF11D\",\"car-div__wheel\":\"_3WNDl-LGGtViqzAfLLX4CB\",\"car-div__wheel_forward\":\"_3Rdh32fs7fi-95LcabV_Ed\",\"car-div__wheel_backward\":\"_3xptMXOOFn6YcMVYMigRMa\",\"car-div__explosion\":\"_3w8-mlW0m2zLABohqiDQ3e\",\"car-div_rollForward\":\"_3xWmq3Q2UpNiq2nICrGAIN\",\"car-div-anim\":\"_381V-1xCMVwSdGT0FxnQiO\",\"tire-anim\":\"_2Qs9DAZPIqZivw_0ON2Vot\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"_2uo9WXSTJyDD3jBlT_quev\",\"text-input\":\"_2YNdYEaErpy02Ske_bZONx\",\"color-input\":\"_3Ye7rbfoBnq4HZn4H-yDB8\"};","// extracted by mini-css-extract-plugin\nexport default {\"main-controls\":\"_2b_svto1O0DGSO3_579_Xj\",\"btn-block\":\"_262VSHreYXfZUHLGeCJEvZ\"};","// extracted by mini-css-extract-plugin\nexport default {\"track\":\"_2hDrLwwwZMiv2NrI-XZZqJ\",\"track_illuminated\":\"_3zXlLAoKpXJ_jlpauHLjHR\",\"track__controls-block\":\"_3pqcODoHFqX9rxmLKBnhD4\"};","// extracted by mini-css-extract-plugin\nexport default {\"header\":\"_3TTTWNe5aoHesw4iV0YUGU\",\"header__logo\":\"_2idUQTZia_1M_0xkhMkXf8\",\"header-nav\":\"_7vejZGT8OzUejTiWyGs1P\",\"header-nav__item\":\"_1NYwlHRXmh2YGu63soBsjx\",\"header-nav__anchor\":\"_2n39qEg5Iz5Tym2Z0Jrjz9\",\"header-nav__anchor_active\":\"_2bRvd3RlExbbSpyXLuxSdS\",\"header-nav__svg\":\"_2FCXcgNK7Jgl9f3ZK-O56I\",\"header-nav__span\":\"_1NVrpdaSQLvqho4VNqQqit\",\"header-nav__list\":\"_1vy8OijKt-Cy7SGXyM4ek9\",\"header-nav__list_disabled\":\"_25SilQm6mkAlbl-WpajKBY\"};","// extracted by mini-css-extract-plugin\nexport default {\"winners\":\"HVDfoBgyIQ4teF5EKFzcD\",\"table\":\"_3mJKnd573Tt4WspNl7gf1J\",\"table__car-preview-box\":\"_86kcZK8UgXIsvYD-wpDED\",\"table__can-be-sorted\":\"_3Xa74hpyx3g6XUuZ9fB9Cm\",\"table__sorted-elem\":\"rfPuVNCW0Sd4nzQGO8-R8\",\"table__sorted-elem_asc\":\"N6296gY2c5AFEX4KjE4I4\",\"table__sorted-elem_desc\":\"_37bMOUs2OF28ZqMubJCPnM\",\"pager\":\"_2q-noyJbwIpKOMhl7AWlq5\",\"pager-span\":\"_1O8erRuDz9RWa3C9tqnUm-\",\"pager-btn\":\"_3OktYstRgXgDE6zlpOM6LA\"};","// extracted by mini-css-extract-plugin\nexport default {\"popup-modal\":\"_3KlZOyoPt2P4FT1Ofdi1oz\",\"popup-bg\":\"_1QGzfQYEHvrYonFptRzkG6\",\"popup-body\":\"_3zDyJwNy615xogiYvCl4vt\",\"popup-body-header\":\"_2DglTs5KJlA1QJriRI6bVZ\",\"popup-body-text\":\"_2oMxBL_Jv1KW3bHu3sVdaA\",\"popup-body__btn-close\":\"HV1Imp7Np5N8O5nUXwQsS\"};","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"_1KBIW4BNGKHwQtRcKc6JIF\",\"hue-rotate\":\"_1t6lrd-wEBCB6ei-o9kDmk\",\"bar\":\"_2DWg3PnmWwM25SBd7sLJQK\",\"body\":\"_24wm1l_qZHsMTx2Oy-enF4\",\"text\":\"_1UFV3thankQQ1R2Ly1Zle2\"};","// extracted by mini-css-extract-plugin\nexport default {\"app\":\"_2ljk-3_Qk7EjDct5a15qZP\",\"main-component\":\"_394erWdWCWrQmkYlaBZ1L5\",\"btn\":\"_3cliA46UjEIGfEKGRnJzCZ\",\"btn-1\":\"_7q7sGuJSjnM-fV8DfMtl5\",\"btn-4\":\"KE9Fso9VtLV8xX_x8IAiF\",\"btn-6\":\"_35BryCkuNmCUsRxmBw_Y1\",\"btn-9\":\"_9jiLaDmXVuzxrmO3P-9mb\",\"btn-13\":\"_1872fOtVBrHuR0iXYtVhRT\",\"btn-15\":\"TNTO3dtfSfS40M6g8U274\",\"glitched-text\":\"xB_2phBrodgB6jPUYYf8V\",\"glitch-animation-1\":\"_2N8U2GaQpCAdpuVv32CY9B\",\"glitch-animation-2\":\"_1g8DjVAkpXimf-Ld9-LLk8\",\"glitched-item\":\"_1d3HUb7Ipak7Hmv8rOld49\",\"glitch-animation-3-xy\":\"_1-Bstbuj6gmQLGeJ4IzWwX\",\"glitch-animation-4-xy\":\"_35f5UNHMiojkZNKF8axfVl\"};","import { BaseComp } from '../lib/components/base-comp/base-comp';\nimport { SimpleRouterAgent } from '../lib/services/simple-router/simple-router-agent';\nimport { SimpleRouter } from '../lib/services/simple-router/simple-router';\nimport { DBus } from '../lib/services/dbus/dbus';\nimport { DBusMsgRouteIsChangedMsg } from '../lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport { DBusTopics } from '../lib/services/dbus/defs/dbus-topics.def';\nimport { DBUS_COMMON_RESPONSES } from '../lib/services/dbus/defs/dbus-common-responses.def';\nimport { HeaderComponent } from '../components/header/header';\n\nimport sharedStyles from '../styles.scss';\nimport { DBusTXData } from '../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { GarageComp } from '../components/garage/garage';\nimport {\n  DBusHub,\n  isDBusHub,\n  DBusInterface,\n} from '../lib/services/dbus/defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from '../lib/services/dbus/defs/dbus-hub-names.def';\nimport { WinnersComp } from '../components/winners/winners';\nimport { REST_CLIENT_ERROR } from '../services/rest-clients/rest-clients-errors.def';\nimport { isNotifiable } from '../lib/interfaces/notifiable';\nimport { PopupStandaloneModal404Comp } from '../lib/components/popups/standalone/modal/404/popup-404';\nimport { REST_CLIENT_GARAGE } from '../services/rest-clients/client-garage/rest-client-garage';\nimport { AppFlags } from './app-flags';\nimport { DBusMsgRebootMsg } from './dbus-msgs/reboot-msg.def';\nimport { DBusTX } from '../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\n\nexport class App implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.APP;\n\n  protected loadedMainComponents: Record<string, BaseComp> = {};\n\n  protected currMainComponent: BaseComp | undefined;\n\n  protected defaultRouterAgent = new SimpleRouterAgent('hash', '', () =>\n    this.loadMainComponent('default'),\n  );\n\n  protected router = new SimpleRouter({\n    mode: '#',\n    defaultRoot: '',\n    defaultAgent: this.defaultRouterAgent,\n  });\n\n  protected mainlineDBus = new DBus();\n\n  protected tx: DBusTX | undefined;\n\n  protected rebootMsg = new DBusMsgRebootMsg('reboot');\n\n  protected emergencyHandlerIsWorking = false;\n\n  constructor(private readonly rootElement: HTMLElement) {\n    // window.addEventListener('error', e => console.log(e));\n    this.setupEmergencyHandler();\n\n    this.rootElement.classList.add(sharedStyles.app);\n\n    const header = new HeaderComponent(DBUS_HUB_NAMES.HEADER);\n    this.rootElement.append(header.rootElement);\n\n    this.mainlineDBus.attachHub(this);\n    this.mainlineDBus.attachHub(header);\n    this.mainlineDBus.attachHub(this.router);\n\n    this.router.activateWantedAgents();\n  }\n\n  private setupEmergencyHandler() {\n    window.addEventListener('unhandledrejection', e => {\n      e.preventDefault();\n      e.promise.catch((error: Error) => {\n        if (\n          !this.emergencyHandlerIsWorking &&\n          error.message in REST_CLIENT_ERROR &&\n          error.message === REST_CLIENT_ERROR.CONNECTION_REFUSED\n        ) {\n          this.emergencyHandlerIsWorking = true;\n          const popup = new PopupStandaloneModal404Comp();\n          popup\n            .setText(\n              `No connection! Check that the server is online\n          and nothing is blocking the connection!`,\n            )\n            .show();\n          const retry = async () => {\n            try {\n              await REST_CLIENT_GARAGE.getCars();\n              console.log('SEND MSG!');\n              await this.sendRebootMsg();\n              console.log('HIDDING');\n              popup.hide();\n              this.emergencyHandlerIsWorking = false;\n            } catch {\n              console.log('catched');\n              await new Promise(res => setTimeout(res, 1000));\n              retry();\n            }\n          };\n          retry();\n        }\n      });\n    });\n  }\n\n  private sendRebootMsg = () => {\n    return this.tx?.transmit({\n      msg: this.rebootMsg,\n      prepMode: DBusTXPrepModes.freeze,\n      waitMode: DBusTXWaitModes.allSetled,\n    });\n  };\n\n  connect(intrfce: DBusInterface) {\n    const routeRX = intrfce.getNewRX(this.watchRouterMsgs);\n    intrfce.plugRX(DBusTopics.ROUTING, routeRX);\n    this.tx = intrfce.getNewTX('APP SYSTEM MSGS TX');\n  }\n\n  private watchRouterMsgs = async (data: DBusTXData) => {\n    const { msg } = data;\n    if (msg instanceof DBusMsgRouteIsChangedMsg) {\n      // TODO: Rework with enum!?\n      this.loadMainComponent(msg.newRoute);\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private loadMainComponent(name: string): void {\n    if (!(name in this.loadedMainComponents)) {\n      switch (name) {\n        case '#garage':\n          this.loadedMainComponents[`${name}`] = new GarageComp();\n          break;\n        case '#winners':\n          this.loadedMainComponents[`${name}`] = new WinnersComp();\n          break;\n        default:\n          window.location.hash = '#garage';\n          break;\n      }\n    }\n    const newComponent = this.loadedMainComponents[`${name}`];\n\n    if (newComponent) {\n      if (this.currMainComponent) {\n        this.currMainComponent.rootElement.remove();\n      }\n\n      this.currMainComponent = newComponent;\n      newComponent.rootElement.classList.add(sharedStyles['main-component']);\n      this.rootElement.append(newComponent.rootElement);\n\n      if (isDBusHub(this.currMainComponent)) {\n        try {\n          this.mainlineDBus.attachHub(this.currMainComponent);\n        } catch {\n          // no need to catch\n        }\n      }\n      if (isNotifiable(this.currMainComponent)) {\n        console.log('notify');\n        this.currMainComponent.notify(null);\n      }\n    }\n  }\n}\n","import { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport class DBusMsgRebootMsg extends DBusMsg {\n  constructor(\n    readonly signal: 'reboot',\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.APP_CTL, rxIds, prefResponseRxIds);\n  }\n}\n","export enum CarActions {\n  CREATED,\n  SELECTED,\n  REMOVED,\n  UPDATED,\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\nimport { CarActions } from '../../../car-actions.def';\n\nexport class DBusMsgCarActionMsg extends DBusMsg {\n  constructor(\n    readonly action: CarActions,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.CAR_ACTION, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionCreatedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.CREATED, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { GarageServicemanContract } from '../../../garage-serviceman-contract.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionRemovedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly nullifiedContract: GarageServicemanContract,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.REMOVED, rxIds, prefResponseRxIds);\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { CarActions } from '../../../car-actions.def';\nimport { DBusMsgCarActionMsg } from './garage-car-action-msg.def';\n\nexport class DBusMsgCarActionSelectedMsg extends DBusMsgCarActionMsg {\n  constructor(\n    readonly car: RegCarData,\n    readonly notifyChanges?: (car: RegCarData) => unknown,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(CarActions.SELECTED, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgGarageMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GARAGE, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageMsg } from './garage-msg.def';\n\nexport class DBusMsgGaragePageIsChangedMsg extends DBusMsgGarageMsg {}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgGarageRaceMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GARAGE, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageRaceMsg } from './garage-race-msg.def';\n\nexport class DBusMsgRaceRequestMsg extends DBusMsgGarageRaceMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { RaceStatusesList } from '../../../race-statuses.def';\nimport { DBusMsgGarageRaceMsg } from './garage-race-msg.def';\n\nexport class DBusMsgGarageRaceStatusMsg extends DBusMsgGarageRaceMsg {\n  constructor(\n    readonly status: RaceStatusesList,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgGarageResetMsg extends DBusMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GARAGE, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgGarageResetMsg } from './garage-reset-msg.def';\n\nexport class DBusMsgGarageResetReqMsg extends DBusMsgGarageResetMsg {\n  constructor(\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","import { DBUS_COMMON_RESPONSES } from '../../lib/services/dbus/defs/dbus-common-responses.def';\nimport { DBUS_HUB_NAMES } from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBusTX } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionRemovedMsg } from './dbus-msgs/by-topic/car-action/garage-car-remove-msg.def';\nimport { GarageManagersTeam } from './garage-managers-team';\nimport { CarComp } from './subcomps/car/car';\nimport { TrackComp } from './subcomps/track/track';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\nimport { DBusMsgCarActionCreatedMsg } from './dbus-msgs/by-topic/car-action/garage-car-created-msg.def';\nimport { DBusMsgRaceRequestMsg } from './dbus-msgs/by-topic/garage/garage-race-request-msg.def';\nimport { DBusMsgGarageResetReqMsg } from './dbus-msgs/by-topic/garage/garage-reset-req-msg.def';\n\nimport styles from './garage.scss';\nimport sharedStyles from '../../styles.scss';\nimport { Pager } from '../../lib/services/pager/pager';\nimport { DBusMsgGenerateCarsMsg } from './subcomps/main-controls/dbus-msgs/generate-cars-msg.def';\nimport { DBusMsgRebootMsg } from '../../app/dbus-msgs/reboot-msg.def';\nimport { DBusMsgGaragePageIsChangedMsg } from './dbus-msgs/by-topic/garage/garage-page-is-changed.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\n\ntype TracksGeometry = {\n  trackHeights: number[];\n  displacements: number[];\n  paddingBase: number;\n  paddingShift: number;\n};\n\nexport class GarageCompCtlAkaDirector implements DBusHub {\n  static readonly DISPLACEMENT_FIX = -30;\n\n  static readonly CAR_WIDTH_RATIO = 0.2;\n\n  static readonly CAR_MAX_WIDTH =\n    1920 * GarageCompCtlAkaDirector.CAR_WIDTH_RATIO;\n\n  static readonly SKIPPED_PROGRESSION_MEMBERS_COUNT = 2;\n\n  static readonly PADDING_SHIFT_BASE = 20;\n\n  static readonly PADDING_SHIFT_BASE_VW = 1920;\n\n  static readonly CAR_IMG_RATIO = 3.78;\n\n  static readonly SCALE_FACTOR = 0.95;\n\n  readonly hubName = DBUS_HUB_NAMES.GARAGE_CONTROLLER;\n\n  protected txs = new Set<DBusTX>();\n\n  private garageManagersTeam: GarageManagersTeam;\n\n  private pager: Pager;\n\n  private entriesPerPage = 7;\n\n  private pagerContainer = document.createElement('div');\n\n  private racePromise: Promise<unknown> | undefined;\n\n  private ctlBlocks: HTMLElement[] = [];\n\n  // * FINISHED < 40 LINES *\n  constructor(\n    private tracksContainer: HTMLElement,\n    private carCtlsBlock: HTMLElement,\n  ) {\n    this.garageManagersTeam = new GarageManagersTeam(\n      tracksContainer,\n      carCtlsBlock,\n      this.lockCallback,\n    );\n\n    this.pager = new Pager(this.entriesPerPage, this.pagerCallback);\n    this.setupPager();\n  }\n\n  // * FINISHED < 40 LINES *\n  private setupPager() {\n    const btnNextPage = this.pager.getBtnNextPage();\n    btnNextPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['garage-bg__pager-btn'],\n    );\n\n    const btnPrevPage = this.pager.getBtnPrevPage();\n    btnPrevPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['garage-bg__pager-btn'],\n    );\n\n    const pagerInfo = this.pager.getPagerSpan();\n    pagerInfo.classList.add(styles['garage-bg__pager-span']);\n\n    this.pagerContainer.classList.add(styles['garage-bg__pager']);\n    this.pagerContainer.append(btnPrevPage, btnNextPage, pagerInfo);\n  }\n\n  // * FINISHED < 40 LINES *\n  private pagerCallback = async (dir: 'prev' | 'next'): Promise<boolean> => {\n    try {\n      await this.resetState();\n      await this.reloadData(dir);\n      return true;\n    } catch {\n      return false;\n    }\n  };\n\n  // * FINISHED < 40 LINES *\n  async startWorking(): Promise<boolean> {\n    try {\n      await this.reloadData('no');\n      window.addEventListener('resize', () => this.redraw());\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  // * FINISHED < 40 LINES *\n  async connect(int: DBusInterface): Promise<void> {\n    this.txs.add(int.getNewTX('send requests to REST Garage client'));\n    this.garageManagersTeam.autoConnect(int);\n\n    const carActionsMsgsRX = int.getNewRX(\n      this.carActionsRXFunc,\n      'monitor cars removes',\n    );\n    int.plugRX(DBusTopics.CAR_ACTION, carActionsMsgsRX);\n\n    const raceMsgsRX = int.getNewRX(this.racingRXFunc, 'handle race requsets');\n    int.plugRX(DBusTopics.GARAGE, raceMsgsRX);\n\n    const generatorMsgsRX = int.getNewRX(this.generatorRXFunc);\n    int.plugRX(DBusTopics.GENERATE, generatorMsgsRX);\n\n    const appCtlMsgsRX = int.getNewRX(\n      this.appCtlRXFunc,\n      'handle app reboot msgs',\n    );\n    int.plugRX(DBusTopics.APP_CTL, appCtlMsgsRX);\n  }\n\n  private appCtlRXFunc = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgRebootMsg && data.msg.signal === 'reboot') {\n      await this.resetState();\n      await this.reloadData('no');\n      return true;\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private generatorRXFunc = async (data: DBusTXData) => {\n    if (\n      data.msg instanceof DBusMsgGenerateCarsMsg &&\n      data.msg.status === 'end'\n    ) {\n      const contracts = this.garageManagersTeam.getContracts();\n\n      if (contracts.size < this.entriesPerPage) await this.reloadData('no');\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private racingRXFunc = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgRaceRequestMsg) {\n      this.pager.toogleLock(true);\n      await this.performRace();\n      this.pager.toogleLock(false);\n      return true;\n    }\n    if (data.msg instanceof DBusMsgGarageResetReqMsg) {\n      return this.resetState();\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private async resetState() {\n    return new Promise((res, rej) => {\n      this.toggleCtlsBlockDisabled(true);\n      this.pager.toogleLock(true);\n      this.garageManagersTeam\n        .resetState()\n        .then(() => res(true))\n        .catch((error: Error) => {\n          rej(error);\n        })\n        .finally(() => {\n          this.pager.toogleLock(false);\n          this.toggleCtlsBlockDisabled(false);\n        });\n    });\n  }\n\n  private async lockCallback(state: boolean) {\n    console.log(state);\n    this.pager.toogleLock(state);\n    return true;\n  }\n\n  private toggleCtlsBlockDisabled(state: boolean) {\n    if (state === true) {\n      console.log('add event listener');\n      this.carCtlsBlock.addEventListener(\n        'click',\n        this.carCtlsBlockBlockListener,\n        {\n          capture: true,\n        },\n      );\n      this.ctlBlocks.forEach((block, index) => {\n        block.style.setProperty(\n          '--glitch-delay',\n          `${index / this.ctlBlocks.length}s`,\n        );\n        block.classList.add(sharedStyles['glitched-item']);\n      });\n    } else {\n      console.log('remove event listener');\n      this.carCtlsBlock.removeEventListener(\n        'click',\n        this.carCtlsBlockBlockListener,\n        {\n          capture: true,\n        },\n      );\n      this.ctlBlocks.forEach(block => {\n        block.classList.remove(sharedStyles['glitched-item']);\n        block.style.removeProperty('--glitch-delay');\n      });\n    }\n  }\n\n  private carCtlsBlockBlockListener = (e: Event) => {\n    console.log('PRVENTED');\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  // * FINISHED < 40 LINES *\n  // ! NOT TESTED PROMISE !\n  private async performRace() {\n    this.racePromise = this.garageManagersTeam.performRace().finally(() => {\n      this.racePromise = undefined;\n    });\n    return this.racePromise;\n  }\n\n  // * FINISHED < 40 LINES *\n  private carActionsRXFunc = async (data: DBusTXData) => {\n    if (\n      data.msg instanceof DBusMsgCarActionRemovedMsg ||\n      data.msg instanceof DBusMsgCarActionCreatedMsg\n    ) {\n      if (this.racePromise) await this.racePromise;\n      try {\n        if (data.msg instanceof DBusMsgCarActionRemovedMsg) {\n          this.garageManagersTeam.handleCarRm(data.msg.car);\n        }\n        this.resetState().finally(() => this.reloadData('no'));\n      } catch {\n        this.pager.tryChangePage('prev');\n      }\n    }\n\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  // * FINISHED < 40 LINES *\n  private reloadData(dir: 'prev' | 'next' | 'no') {\n    return new Promise<boolean>((res, rej) => {\n      const page = dir\n        ? dir === 'next'\n          ? this.pager.getCurrPageNumber() + 1\n          : dir === 'prev'\n          ? this.pager.getCurrPageNumber() - 1\n          : dir === 'no'\n          ? this.pager.getCurrPageNumber()\n          : 1\n        : 1;\n      REST_CLIENT_GARAGE.getCars(page, this.pager.getEntriesPerPage()).then(\n        async response => {\n          const { limit, cars } = response;\n          this.pager.setEntriesCount(Number.parseInt(limit, 10));\n          if (cars.length === 0 && dir !== 'no') {\n            rej();\n            return;\n          }\n          if (dir !== 'no') this.broadcastPaging();\n\n          await this.garageManagersTeam.nullifyContracts();\n          const newContracts: GarageServicemanContract[] = [];\n\n          cars.forEach((car, index) => {\n            const track = new TrackComp();\n            const carComp = new CarComp(car, index + 1);\n            track.placeCar(carComp);\n            newContracts.push({ track, car: carComp });\n          });\n\n          this.garageManagersTeam.addContracts(...newContracts);\n          this.garageManagersTeam.resetState();\n          this.redraw();\n          res(true);\n        },\n      );\n    });\n  }\n\n  private broadcastPaging() {\n    const msg = new DBusMsgGaragePageIsChangedMsg();\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  // * FINISHED < 40 LINES *\n  private redraw() {\n    this.clearDOM();\n\n    const geometry = this.calcGeometry();\n    this.setStylesForTracks(geometry);\n\n    this.drawTracks();\n    this.drawCarsCtls();\n  }\n\n  // * FINISHED < 40 LINES *\n  private clearDOM() {\n    while (this.tracksContainer.firstChild)\n      this.tracksContainer.firstChild.remove();\n    while (this.carCtlsBlock.firstChild) this.carCtlsBlock.firstChild.remove();\n  }\n\n  // ! MORE THAN 40 LINES ! BUT IT IS AN ONE-PIECE FUNCTION !\n  // ! BETTER TO SAVE IT AS IS\n  private calcGeometry(): TracksGeometry {\n    const style = window.getComputedStyle(this.tracksContainer);\n    const containerHeight =\n      Number.parseFloat(style.height) -\n      Number.parseFloat(style.paddingBottom) -\n      Number.parseFloat(style.paddingTop);\n    const firstAutoWidth = Math.min(\n      window.innerWidth * GarageCompCtlAkaDirector.CAR_WIDTH_RATIO,\n      GarageCompCtlAkaDirector.CAR_MAX_WIDTH,\n    );\n    const firstAutoHeight =\n      firstAutoWidth / GarageCompCtlAkaDirector.CAR_IMG_RATIO;\n    const heights: number[] = [];\n    let heightSum = 0;\n    const contracts = [...this.garageManagersTeam.getContracts()];\n\n    contracts.forEach((contract, index) => {\n      const factor = GarageCompCtlAkaDirector.SCALE_FACTOR ** index;\n      const carTrackHeight = firstAutoHeight * factor;\n      heightSum += carTrackHeight;\n      heights.push(carTrackHeight);\n    });\n\n    const excessHeight = heightSum - containerHeight;\n    const heightsReversed = heights.sort((a, b) => a - b);\n    const displacementBase =\n      excessHeight > 0\n        ? excessHeight / this.garageManagersTeam.getContracts().size -\n          GarageCompCtlAkaDirector.SKIPPED_PROGRESSION_MEMBERS_COUNT\n        : 0;\n\n    const displacements: number[] = [];\n    const midIndex = (contracts.length - 1) / 2;\n\n    contracts.forEach((contract, index) => {\n      const diff = index - midIndex;\n      const displacement =\n        displacementBase * -diff + GarageCompCtlAkaDirector.DISPLACEMENT_FIX;\n      displacements.push(displacement);\n    });\n\n    const paddingBase =\n      (heightsReversed[0] as number) * GarageCompCtlAkaDirector.CAR_IMG_RATIO;\n    const paddingShift =\n      (GarageCompCtlAkaDirector.PADDING_SHIFT_BASE * window.innerWidth) /\n      GarageCompCtlAkaDirector.PADDING_SHIFT_BASE_VW;\n\n    return {\n      trackHeights: heightsReversed,\n      displacements,\n      paddingBase,\n      paddingShift,\n    };\n  }\n\n  // * FINISHED < 40 LINES *\n  private setStylesForTracks(geometry: TracksGeometry) {\n    const contracts = [...this.garageManagersTeam.getContracts()];\n\n    contracts.forEach((contract, index) => {\n      contract.track.rootElement.style.setProperty(\n        'height',\n        `${geometry.trackHeights[index]}px`,\n      );\n\n      contract.track.rootElement.style.setProperty(\n        'top',\n        `${geometry.displacements[index]}px`,\n      );\n\n      contract.track.rootElement.style.setProperty('z-index', `${index + 1}`);\n\n      contract.track.rootElement.style.setProperty(\n        '--padding-w',\n        `${\n          (geometry.trackHeights[\n            geometry.trackHeights.length - 1 - index\n          ] as number) *\n            GarageCompCtlAkaDirector.CAR_IMG_RATIO -\n          geometry.paddingBase +\n          geometry.paddingShift * (contracts.length - 1 - index)\n        }px`,\n      );\n    });\n  }\n\n  // * FINISHED < 40 LINES *\n  private drawTracks() {\n    this.tracksContainer.append(\n      this.pagerContainer,\n      ...[...this.garageManagersTeam.getContracts()].map(\n        contract => contract.track.rootElement,\n      ),\n    );\n  }\n\n  // * FINISHED < 40 LINES *\n  private drawCarsCtls() {\n    const contracts = [...this.garageManagersTeam.getContracts()];\n    this.ctlBlocks = contracts.map((contract, index) => {\n      const block = this.createCarCtlBlock(contract.car, index + 1);\n      this.connectCtlAndTrack(block, contract.track);\n      return block;\n    });\n    this.carCtlsBlock.append(...this.ctlBlocks);\n  }\n\n  // * FINISHED < 40 LINES *\n  private createCarCtlBlock = (car: CarComp, index: number): HTMLElement => {\n    const btns = [car.btnSelect, car.btnStart, car.btnReset, car.btnRm];\n\n    btns.forEach(btn => {\n      btn.classList.add(sharedStyles.btn, styles['garage-bg__car-ctl-btn']);\n    });\n\n    car.btnStart.classList.add(sharedStyles['btn-15']);\n    car.btnSelect.classList.add(sharedStyles['btn-13']);\n    car.btnReset.classList.add(sharedStyles['btn-9']);\n    car.btnRm.classList.add(sharedStyles['btn-4']);\n\n    const numberSpan = document.createElement('span');\n    numberSpan.classList.add(styles['garage-bg__car-ctl-block-number']);\n    numberSpan.textContent = index.toString();\n\n    const container = document.createElement('div');\n    container.classList.add(styles['garage-bg__car-ctl-block']);\n    container.append(numberSpan, ...btns);\n\n    return container;\n  };\n\n  // * FINISHED < 40 LINES *\n  // ? REFACTOR TO BE ABLE TO RM EVENT LISTENERS ?\n  private connectCtlAndTrack = (ctlElem: HTMLElement, track: TrackComp) => {\n    ctlElem.addEventListener(\n      'mouseover',\n      () => track.illuminateSelf(true),\n      true,\n    );\n    ctlElem.addEventListener(\n      'mouseout',\n      () => track.illuminateSelf(false),\n      true,\n    );\n  };\n}\n","import { PopupStandaloneModalProgressComp } from '../../lib/components/popups/standalone/modal/progress/popup-progress';\nimport { genUniqId } from '../../lib/generators/generators';\nimport {\n  EngineResponse,\n  REST_CLIENT_ENGINE,\n} from '../../services/rest-clients/client-engine/rest-client-engine';\nimport { REST_CLIENT_ERROR } from '../../services/rest-clients/rest-clients-errors.def';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\n\nexport enum GarageDriverCommands {\n  START_DRIVING,\n  STOP_DRIVING,\n}\n\nexport class GarageDriver {\n  private contract: GarageServicemanContract | undefined;\n\n  private currDriveId: string | undefined;\n\n  private drivePromise: Promise<unknown> | undefined;\n\n  private ignitionPromise: Promise<unknown> | undefined;\n\n  private lastStart: number | undefined;\n\n  private lastTimeInMs: number | undefined;\n\n  public isFree(): boolean {\n    if (!this.contract) return true;\n    return false;\n  }\n\n  putBehindTheWheel(contract: GarageServicemanContract): void {\n    if (this.contract) throw new Error('ALREADY IN CAR');\n    this.contract = contract;\n  }\n\n  async getOutOfTheCar() {\n    this.contract = undefined;\n  }\n\n  async performDrivingProtocol(flags?: Record<string, unknown>) {\n    const newPromise = new Promise<{\n      driveParams: EngineResponse;\n      drivePromise: Promise<number | false>;\n    }>((res, rej) => {\n      if (flags) this.contract?.car.disableCtls(); // race\n      const thisDriveId = genUniqId();\n      this.currDriveId = thisDriveId;\n      console.log('ignite');\n      this.ignitionPromise = this.TurnOnTheIgnition()\n        .then(driveParams => {\n          console.log('ignited');\n          if (thisDriveId !== this.currDriveId) rej(new Error('interrupted'));\n          // console.log(driveParams);\n          const drivePromise = this.drive(driveParams, thisDriveId, flags);\n          res({\n            driveParams,\n            drivePromise,\n          });\n        })\n        .catch((error: Error) => {\n          if (thisDriveId !== this.currDriveId) rej(new Error('interrupted'));\n          else rej(error);\n        });\n    });\n    return newPromise;\n  }\n\n  private async TurnOnTheIgnition() {\n    if (!this.contract) throw new Error('NOT_BEHIND_THE_WHEEL');\n    if (this.drivePromise) await this.drivePromise;\n    const params = await REST_CLIENT_ENGINE.toggleEngine(\n      this.contract.car.currCar.id,\n      'started',\n    );\n    // console.log('ENGINE STARTED');\n    return params;\n  }\n\n  // !!! If animation fails, this promise never resolves!\n  async returnToStart() {\n    this.currDriveId = undefined;\n    if (this.contract) {\n      if (this.ignitionPromise) await this.ignitionPromise;\n      if (this.drivePromise) {\n        console.log('return', this.contract);\n        await this.stopCar(true, false);\n        console.log('return', this.contract);\n        await this.contract.car.rollBack(this.drivePromise);\n        console.log('return', this.contract);\n        const msgBlock = document.createElement('div');\n        msgBlock.style.setProperty('height', '100%');\n        msgBlock.style.setProperty('width', '40%');\n        msgBlock.style.setProperty('position', 'absolute');\n        msgBlock.style.setProperty('right', '0px');\n        msgBlock.style.setProperty('top', '100%');\n        msgBlock.style.setProperty('transform', 'translate(-40%, -120%)');\n        this.contract.track.rootElement.append(msgBlock);\n        const popup = new PopupStandaloneModalProgressComp();\n\n        popup\n          .setText(\n            `I can't let the engine start again until\n          the server finishes its business, read the notes, please.`,\n          )\n          .show(msgBlock);\n        const interval = this.updateProgress(popup);\n        await this.contract.car.playAwaitingAnim(this.drivePromise);\n        if (interval) clearTimeout(interval);\n        popup.hide();\n        msgBlock.remove();\n      } else {\n        await this.stopCar(false, false);\n        await this.contract.car.rollBack();\n      }\n    }\n    return true;\n  }\n\n  private updateProgress(\n    popup: PopupStandaloneModalProgressComp,\n  ): NodeJS.Timeout {\n    const interval = setInterval(() => {\n      if (this.lastTimeInMs && this.lastStart) {\n        const progress =\n          ((Date.now() - this.lastStart) / this.lastTimeInMs) * 100;\n        popup.setProgress(progress);\n      } else clearInterval(interval);\n    }, 500);\n    return interval;\n  }\n\n  private async drive(\n    driveParams: EngineResponse,\n    driveId: string,\n    flags?: Record<string, unknown>,\n  ): Promise<false | number> {\n    return new Promise<false | number>((res, rej) => {\n      if (this.contract) {\n        const { contract } = this;\n        const time = GarageDriver.calculateDriveTime(driveParams);\n        this.lastStart = Date.now();\n        this.lastTimeInMs = time * 1000;\n        const start = Date.now();\n        console.log('enter drive mode');\n        this.drivePromise = REST_CLIENT_ENGINE.enterDriveMode(\n          contract.car.currCar.id,\n        ).then(success => {\n          if (\n            !(contract === this.contract) ||\n            !(driveId === this.currDriveId)\n          ) {\n            rej(new Error('interrupted'));\n          } else if (success) {\n            res(time);\n            console.log('stop car finish');\n            this.stopCar(true, true, false, flags);\n          } else {\n            console.log('stop car broken');\n            this.stopCar(true, false, true, flags);\n            res(false);\n          }\n          console.log(`time from start: ${Date.now() - start}`);\n        });\n        contract.car\n          .rollForward(time, !flags)\n          .catch(() => {\n            res(false);\n          })\n          .then(async playbackRate => {\n            if (playbackRate && playbackRate > 0) {\n              this.stopCar(true, true, false, flags);\n              const connectionRestored = await this.emergencyAwaitServer(\n                time * 1000,\n                1000,\n                this.drivePromise,\n              );\n              if (!connectionRestored) {\n                rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n              }\n            }\n          });\n      } else rej(new Error('No car'));\n    });\n  }\n\n  private emergencyAwaitServer = (\n    timeInMS: number,\n    delayInMS: number,\n    resPromise?: Promise<unknown>,\n  ) => {\n    const popup = new PopupStandaloneModalProgressComp();\n    popup\n      .setText(`Connection is lost... awaiting server`)\n      .setProgress(1)\n      .show();\n    return new Promise<boolean>(res => {\n      const startTime = Date.now();\n      let IamResolved = false;\n      let interval: NodeJS.Timeout;\n      const resFunc = () => {\n        IamResolved = true;\n        if (interval) clearInterval(interval);\n        popup.hide();\n        res(false);\n      };\n      const chargeInterval = () => {\n        interval = setInterval(() => {\n          console.log(resPromise, IamResolved);\n          if (IamResolved) {\n            clearInterval(interval);\n            return;\n          }\n          const currTime = Date.now();\n          const elapsedTime = currTime - startTime;\n          if (elapsedTime < timeInMS) {\n            const progress = (elapsedTime / timeInMS) * 100;\n            popup.setProgress(progress);\n          } else resFunc();\n        }, timeInMS / 20); // 5%\n      };\n\n      resPromise?.finally(() => {\n        resFunc();\n      });\n      setTimeout(() => chargeInterval(), delayInMS);\n    });\n  };\n\n  private async stopCar(\n    onlyAnim = false,\n    rollover = true,\n    broken = false,\n    flags?: Record<string, unknown>,\n  ) {\n    if (this.contract) {\n      if (!broken && !onlyAnim) {\n        const response = await REST_CLIENT_ENGINE.toggleEngine(\n          this.contract.car.currCar.id,\n          'stopped',\n        );\n        console.log('stopped by server', response);\n      }\n      await this.contract.car.stop(rollover, broken, flags);\n      return true;\n    }\n    throw new Error('No car');\n  }\n\n  private static calculateDriveTime(params: EngineResponse) {\n    const time = params.distance / 1000 / params.velocity; /// !!! distance units???\n    return time;\n  }\n}\n","import { RegCarData, WinnerCarData } from '../../definitions/car-data.def';\nimport { DBusInterface } from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../lib/services/dbus/defs/dbus-port.def';\nimport { DBusRX } from '../../lib/services/dbus/defs/dbus-rx/dbus-rx.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgCarActionSelectedMsg } from './dbus-msgs/by-topic/car-action/garage-car-select-msg.def';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionRemovedMsg } from './dbus-msgs/by-topic/car-action/garage-car-remove-msg.def';\nimport { GarageServicemanContract } from './garage-serviceman-contract.def';\nimport { GarageDriver, GarageDriverCommands } from './garage-driver';\nimport { genUniqId } from '../../lib/generators/generators';\n\nimport styles from './garage.scss';\nimport { REST_CLIENT_WINNERS } from '../../services/rest-clients/client-winners/rest-client-winners';\nimport { REST_CLIENT_ERROR } from '../../services/rest-clients/rest-clients-errors.def';\nimport { DBusMsgGarageRaceStatusMsg } from './dbus-msgs/by-topic/garage/garage-race-status-msg.def';\nimport { RaceStatusesList } from './race-statuses.def';\nimport {\n  getTransitionDuration,\n  transitionPromise,\n} from '../../lib/gui/animation';\nimport { GaragePopupWinner } from './subcomps/popup-winner/popup-winner';\n\ntype RaceData = {\n  raceId: string;\n  arrivedByOrder: GarageServicemanContract[];\n  notArrived: GarageServicemanContract[];\n  participantsCount: number;\n  flags: Record<string, unknown>;\n  stratedCount: number;\n};\n\ntype RaceResults = {\n  arrivedByOrder: GarageServicemanContract[];\n  notArrived: GarageServicemanContract[];\n};\nexport class GarageManagersTeam implements DBusPort {\n  protected txs = new Set<DBusTX>();\n\n  protected contracts = new Set<GarageServicemanContract>();\n\n  protected freeDrivers = new Set<GarageDriver>();\n\n  protected busyDrivers = new Map<GarageServicemanContract, GarageDriver>();\n\n  protected currRaceId: string | undefined;\n\n  protected winnerPopup = new GaragePopupWinner();\n\n  constructor(\n    private readonly tracksContainer: HTMLElement,\n    private readonly carCtlsBlock: HTMLElement,\n    private readonly directorLockCb: (state: boolean) => Promise<boolean>,\n  ) {\n    this.carCtlsBlock.addEventListener('click', this.carCtlsClickListener);\n    this.winnerPopup.rootElement.classList.add(styles['garage__winner-popup']);\n  }\n\n  autoConnect(int: DBusInterface) {\n    const tx = int.getNewTX('garage serviceman');\n    this.txs.add(tx);\n  }\n\n  public getContracts() {\n    return this.contracts;\n  }\n\n  public handleCarRm(car: RegCarData) {\n    this.contracts.forEach(contract => {\n      if (contract.car.currCar.id === car.id)\n        this.busyDrivers.get(contract)?.getOutOfTheCar();\n    });\n  }\n\n  async nullifyContracts(contracts?: GarageServicemanContract[]) {\n    if (contracts) {\n      this.tryFreeDrivers(...contracts);\n      contracts.forEach(contract => {\n        this.contracts.delete(contract);\n      });\n    } else {\n      this.tryFreeDrivers(...this.contracts);\n      this.contracts.clear();\n    }\n  }\n\n  addContracts(...сontracts: GarageServicemanContract[]) {\n    сontracts.forEach(newContract => this.contracts.add(newContract));\n  }\n\n  private carCtlsClickListener = (e: Event) => {\n    if (e.target instanceof HTMLElement) {\n      const elem = e.target;\n      let btn: HTMLButtonElement | undefined;\n\n      if (elem instanceof HTMLButtonElement) btn = elem;\n      else if (elem.parentElement instanceof HTMLButtonElement)\n        btn = elem.parentElement;\n\n      if (btn && btn.disabled !== true) {\n        this.contracts.forEach(contract => {\n          if (this.currRaceId) return;\n          if (btn === contract.car.btnSelect) {\n            this.handleSelection(contract);\n            return;\n          }\n          if (btn === contract.car.btnRm) {\n            contract.car.btnRm.disabled = true;\n            this.handleRemoving(contract);\n            return;\n          }\n          if (btn === contract.car.btnStart) {\n            contract.car.btnStart.disabled = true;\n            this.startDriving(contract);\n            return;\n          }\n          if (btn === contract.car.btnReset) {\n            contract.car.btnReset.disabled = true;\n            this.handleRestoreState(contract);\n          }\n        });\n      }\n    }\n  };\n\n  async resetState(prepareForRace?: boolean) {\n    if (!prepareForRace) this.currRaceId = undefined;\n    this.winnerPopup.rootElement.remove();\n    this.tracksContainer.classList.remove(\n      styles['synthwave-background_race-mode'],\n    );\n    await this.rollbackCars();\n\n    if (!prepareForRace) {\n      this.broadcastRaceStatus('READY_TO_GO');\n    }\n  }\n\n  private async handleRestoreState(contract: GarageServicemanContract) {\n    const driver = this.busyDrivers.get(contract);\n    if (driver) {\n      await driver.returnToStart();\n    }\n  }\n\n  private async startDriving(\n    contract: GarageServicemanContract,\n    flags?: Record<string, unknown>,\n  ) {\n    let choosedDriver = this.busyDrivers.get(contract);\n\n    if (!choosedDriver) {\n      // !!! excess check?\n      choosedDriver = [...this.freeDrivers].find(driver => driver.isFree());\n\n      if (choosedDriver) {\n        this.freeDrivers.delete(choosedDriver);\n      } else {\n        choosedDriver = new GarageDriver();\n      }\n\n      this.busyDrivers.set(contract, choosedDriver);\n\n      choosedDriver.putBehindTheWheel(contract);\n    }\n\n    return choosedDriver.performDrivingProtocol(flags);\n  }\n\n  private handleRemoving(contract: GarageServicemanContract) {\n    REST_CLIENT_GARAGE.deleteCar(contract.car.currCar.id).then(async () => {\n      await REST_CLIENT_WINNERS.deleteWinner(contract.car.currCar.id).catch(\n        () => {},\n      );\n      this.tryFreeDrivers(contract);\n      this.contracts.delete(contract);\n      const msg = new DBusMsgCarActionRemovedMsg(\n        contract.car.currCar,\n        contract,\n      );\n      this.txs.forEach(tx => {\n        tx.transmit({\n          msg,\n          prepMode: DBusTXPrepModes.freeze,\n          waitMode: DBusTXWaitModes.nowait,\n        });\n      });\n    });\n  }\n\n  private handleSelection(contract: GarageServicemanContract) {\n    const msg = new DBusMsgCarActionSelectedMsg(\n      contract.car.currCar,\n      this.genSelectCallback(contract),\n    );\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  private async rollbackCars() {\n    this.tracksContainer.classList.remove(\n      styles['garage__track-container_finish'],\n    );\n    this.tracksContainer.style.setProperty('--translate-x', '0px');\n    // rollback cars\n    const rollbacks: Promise<unknown>[] = [];\n    this.busyDrivers.forEach(driver => {\n      rollbacks.push(driver.returnToStart());\n    });\n    console.log('awaiting', rollbacks);\n    await Promise.all(rollbacks);\n    console.log('rollbacks done');\n  }\n\n  async performRace() {\n    // prepare\n    const thisRaceId = genUniqId();\n    this.currRaceId = thisRaceId;\n    await this.resetState(true);\n    // check if user cancell a race\n    if (thisRaceId !== this.currRaceId) return;\n\n    // process race\n    const raceData: RaceData = {\n      raceId: thisRaceId,\n      arrivedByOrder: [],\n      notArrived: [],\n      participantsCount: this.contracts.size,\n      flags: {\n        roadElem: this.tracksContainer,\n        isFinishVisible: false, // TODO: rm\n      },\n      stratedCount: 0,\n    };\n    this.broadcastRaceStatus('IN_PROCESS');\n    await this.processRace(raceData)\n      .catch((error: Error) => {\n        if (!(thisRaceId !== this.currRaceId)) throw error;\n      })\n      .finally(() => {\n        this.tracksContainer.classList.remove(\n          styles['synthwave-background_race-mode'],\n        );\n      });\n\n    // check if user cancell a race\n    if (thisRaceId !== this.currRaceId) return;\n\n    // console.log(raceData);\n\n    this.broadcastRaceStatus('NEED_RESET');\n    // TODO: Do something else?\n  }\n\n  private broadcastRaceStatus(status: RaceStatusesList) {\n    const msg = new DBusMsgGarageRaceStatusMsg(status);\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n  }\n\n  // false if race was interrupted\n  private processRace(raceData: RaceData) {\n    return new Promise<RaceData | false>(res => {\n      this.contracts.forEach(contract => {\n        this.startDriving(contract, raceData.flags).then(response => {\n          if (raceData.raceId !== this.currRaceId) {\n            res(false);\n            return;\n          }\n\n          if (raceData.stratedCount === raceData.participantsCount - 1) {\n            this.tracksContainer.classList.add(\n              styles['synthwave-background_race-mode'],\n            );\n            raceData.flags.isRoadMoves = true;\n          } else raceData.stratedCount++;\n\n          if (!(response instanceof Error)) {\n            response.drivePromise\n              .then(result =>\n                this.handleDriveResult(raceData, contract, result),\n              )\n              .catch((error: Error) => {\n                if (error.message === 'interrupted') res(false);\n              })\n              .finally(() => {\n                console.log(raceData);\n                if (\n                  raceData.arrivedByOrder.length +\n                    raceData.notArrived.length ===\n                  raceData.participantsCount\n                ) {\n                  console.log(raceData);\n                  res(raceData);\n                }\n              });\n          } else {\n            throw response;\n          }\n        });\n      });\n    });\n  }\n\n  private handleDriveResult(\n    raceData: RaceData,\n    contract: GarageServicemanContract,\n    result: number | false,\n  ) {\n    if (raceData.raceId !== this.currRaceId) return;\n    if (result !== false) {\n      if (raceData.arrivedByOrder.length === 0) {\n        this.handleWinner(contract, result, raceData.flags);\n      }\n      raceData.arrivedByOrder.push(contract);\n    } else {\n      raceData.notArrived.push(contract);\n    }\n  }\n\n  private handleWinner = async (\n    contract: GarageServicemanContract,\n    time: number,\n    flags: Record<string, unknown>,\n  ) => {\n    flags.isFinishVisible = true;\n    this.tracksContainer.classList.add(\n      styles['garage__track-container_finish'],\n    );\n    const style = window.getComputedStyle(this.tracksContainer, '::after');\n    const duration = getTransitionDuration(style, 'right');\n    if (duration) {\n      const awaitTime = Number.parseFloat(duration);\n      if (awaitTime > 0)\n        await new Promise(res => setTimeout(res, awaitTime * 1000));\n    }\n    this.tracksContainer.classList.remove(\n      styles['synthwave-background_race-mode'],\n    );\n    flags.isRoadMoves = false;\n    const winnerCar = contract.car.currCar;\n    this.winnerPopup.setData(\n      winnerCar,\n      time.toFixed(2),\n      contract.car.index?.toString(),\n    );\n    this.tracksContainer.append(this.winnerPopup.rootElement);\n    REST_CLIENT_WINNERS.getWinner(winnerCar.id)\n      .then(winnerRecord => {\n        const updatedWinnerData: WinnerCarData = {\n          id: winnerRecord.id,\n          wins: winnerRecord.wins + 1,\n          time:\n            time < winnerRecord.time\n              ? Number.parseFloat(time.toFixed(2))\n              : winnerRecord.time,\n        };\n        REST_CLIENT_WINNERS.updateWinner(updatedWinnerData);\n      })\n      .catch((error: Error) => {\n        if (error.message === REST_CLIENT_ERROR.NOT_FOUND) {\n          const newWinnerData: WinnerCarData = {\n            id: winnerCar.id,\n            wins: 1,\n            time: Number.parseFloat(time.toFixed(2)),\n          };\n          REST_CLIENT_WINNERS.createWinner(newWinnerData);\n        }\n      });\n  };\n\n  private tryFreeDrivers(...contracts: GarageServicemanContract[]) {\n    contracts.forEach(contract => {\n      const driver = this.busyDrivers.get(contract);\n      if (driver) {\n        driver.getOutOfTheCar().then(() => {\n          this.busyDrivers.delete(contract);\n          this.freeDrivers.add(driver);\n        });\n      }\n    });\n  }\n\n  private genSelectCallback(contract: GarageServicemanContract) {\n    return (car: RegCarData) => {\n      if (!this.contracts.has(contract)) return;\n      contract.car.updateData(car);\n    };\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { DBUS_HUB_NAMES } from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { GarageCompCtlAkaDirector } from './garage-controller';\nimport { MainControlsComp } from './subcomps/main-controls/main-controls';\n\nimport styles from './garage.scss';\nimport { Notifiable } from '../../lib/interfaces/notifiable';\nimport { PopupStandaloneModalProgressComp } from '../../lib/components/popups/standalone/modal/progress/popup-progress';\n\nexport class GarageComp extends BaseComp implements DBusHub, Notifiable {\n  readonly hubName = DBUS_HUB_NAMES.GARAGE;\n\n  private controller: GarageCompCtlAkaDirector;\n\n  private isControllerWorking = false;\n\n  private mainControlsComp = new MainControlsComp();\n\n  private carsCtlsBlock = document.createElement('div');\n\n  private bgVideo = document.createElement('video');\n\n  private popup = new PopupStandaloneModalProgressComp();\n\n  constructor() {\n    super('section');\n    console.log('show');\n    this.popup.setText('Loading...').setProgress(1).show();\n    this._rootElement.classList.add(styles.garage);\n\n    const selfCtlsBlock = document.createElement('div');\n    selfCtlsBlock.classList.add(styles['garage-bg__self-ctls-block']);\n    selfCtlsBlock.append(this.mainControlsComp.rootElement);\n\n    const bg = document.createElement('div');\n    bg.classList.add(styles.garage__bg, styles['garage-bg']);\n    bg.append(this.bgVideo, selfCtlsBlock);\n\n    const tracksContainer = document.createElement('div');\n    tracksContainer.classList.add(\n      styles['garage__track-container'],\n      styles['synthwave-background'],\n    );\n\n    this.carsCtlsBlock.classList.add(styles['garage-bg__cars-ctls-block']);\n\n    this.controller = new GarageCompCtlAkaDirector(\n      tracksContainer,\n      this.carsCtlsBlock,\n    );\n\n    this.setupBgVideo();\n\n    this._rootElement.append(bg, tracksContainer, this.carsCtlsBlock);\n  }\n\n  private setupBgVideo() {\n    this.bgVideo.addEventListener('progress', this.bgVideoProgressListener);\n    this.bgVideo.addEventListener(\n      'canplaythrough',\n      this.bgVideoCanPlayListener,\n    );\n    this.renderBgVideo();\n  }\n\n  private renderBgVideo() {\n    this.bgVideo.classList.add(styles['garage-bg__video']);\n    this.bgVideo.controls = false;\n    this.bgVideo.loop = true;\n    this.bgVideo.defaultMuted = true;\n    this.bgVideo.muted = true;\n    this.bgVideo.autoplay = true;\n    this.bgVideo.src = './assets/videos/bg/cyberpunk2077-garage.mp4';\n  }\n\n  private bgVideoProgressListener = () => {\n    if (this.bgVideo.buffered.length > 0) {\n      const progress =\n        (this.bgVideo.buffered.end(0) / this.bgVideo.duration) * 100;\n      this.popup.setProgress(progress);\n    }\n  };\n\n  private bgVideoCanPlayListener = async () => {\n    this.bgVideo.removeEventListener(\n      'canplaythrough',\n      this.bgVideoCanPlayListener,\n    );\n    this.bgVideo.removeEventListener('progress', this.bgVideoProgressListener);\n    this.popup.setProgress(100).reset().hide();\n    this.isControllerWorking = await this.controller.startWorking();\n  };\n\n  connect(int: DBusInterface): void {\n    int.attachSubHub(this.controller);\n    int.attachSubHub(this.mainControlsComp);\n  }\n\n  notify = async (): Promise<void> => {\n    try {\n      this.bgVideo.play();\n    } catch {\n      // do nothing...\n    }\n    if (!this.isControllerWorking) {\n      this.isControllerWorking = await this.controller.startWorking();\n    }\n  };\n}\n","import { RegCarData, UnregCarData } from '../../../../definitions/car-data.def';\nimport { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { hexToRgb } from '../../../../lib/convertors/colors';\nimport { transitionPromise } from '../../../../lib/gui/animation';\nimport { OBJ_PROCESSOR } from '../../../../lib/processors/obj-processor';\nimport styles from './car.scss';\nimport garageStyles from '../../garage.scss';\n\nexport class CarComp extends BaseComp {\n  static readonly TIMING_FUNCTION = 'cubic-bezier(.72,.2,.54,.77)';\n\n  static readonly CAR_BODY_IMG_SRC = './assets/imgs/cars/body.gif';\n\n  static readonly CAR_WHEEL_IMG_SRC = './assets/imgs/cars/tire back.gif';\n\n  static readonly CAR_EXPLOSION_IMG_DATA = {\n    BASE_URL: './assets/imgs/cars/explosion/',\n    EXTENSION: '.png',\n    FRAMES_COUNT: 9,\n    FRAME_TIME_MS: 200,\n  };\n\n  protected canvas = document.createElement('canvas');\n\n  protected tireBack = document.createElement('img');\n\n  private btnSelect$ = document.createElement('button');\n\n  private btnRm$ = document.createElement('button');\n\n  private _spanCarName = document.createElement('span');\n\n  private btnStart$ = document.createElement('button');\n\n  private btnReset$ = document.createElement('button');\n\n  private currAnimation: Animation | undefined;\n\n  private currOutOfSceneAnim: Animation | undefined;\n\n  private isReseted = true;\n\n  private observer: MutationObserver;\n\n  private movingClassName = garageStyles['synthwave-background_race-mode'];\n\n  constructor(private _currCar: RegCarData, public index?: number) {\n    super('div');\n\n    this._rootElement.classList.add(styles['car-div']);\n    this.canvas.classList.add(styles['car-div__canvas']);\n    this._rootElement.append(this.canvas);\n\n    const selectSpan = document.createElement('span');\n    const rmSpan = document.createElement('span');\n    const startSpan = document.createElement('span');\n    const resetSpan = document.createElement('span');\n\n    selectSpan.textContent = 'select';\n    rmSpan.textContent = 'remove';\n    startSpan.textContent = 'start!';\n    resetSpan.textContent = 'reset';\n\n    this.btnSelect$.append(selectSpan);\n    this.btnRm$.append(rmSpan);\n    this.btnReset$.append(resetSpan);\n    this.btnStart$.append(startSpan);\n\n    this.btnReset$.disabled = true;\n\n    CarComp.drawCar(this.canvas, this._currCar.color);\n    this._spanCarName.textContent = `${index}: ${_currCar.name}`;\n    CarComp.drawWheels(this._rootElement);\n\n    this.observer = new MutationObserver(mutations => {\n      mutations.forEach(mutation => {\n        if (mutation.oldValue?.includes(this.movingClassName)) {\n          this.currOutOfSceneAnim?.pause();\n          this.observer.disconnect();\n        } else {\n          const elem = mutation.target as HTMLElement;\n          if (elem.classList.contains(this.movingClassName)) {\n            this.outOfScene();\n          }\n        }\n      });\n    });\n  }\n\n  static drawWheels(rootElem: HTMLElement) {\n    const wheelImg = new Image();\n    wheelImg.src = CarComp.CAR_WHEEL_IMG_SRC;\n    wheelImg.onload = () => {\n      wheelImg.classList.add(styles['car-div__wheel']);\n      const backwardWheelImg = OBJ_PROCESSOR.deepClone(wheelImg);\n      wheelImg.classList.add(styles['car-div__wheel_forward']);\n      backwardWheelImg.classList.add(styles['car-div__wheel_backward']);\n\n      rootElem.append(wheelImg);\n      rootElem.append(backwardWheelImg);\n    };\n  }\n\n  updateData(carData: RegCarData) {\n    this._currCar = carData;\n    CarComp.drawCar(this.canvas, this._currCar.color);\n    this._spanCarName.textContent = `${this.index}: ${carData.name}`;\n    // this._rootElement.style.setProperty('background-color', carData.color);\n  }\n\n  public async rollBack(finishPromise: Promise<unknown> = Promise.resolve()) {\n    return new Promise(res => {\n      const asyncFunc = async () => {\n        if (!this.isReseted) {\n          this.observer.disconnect();\n          await this.playOutAnim();\n          if (this.currOutOfSceneAnim) {\n            this.currOutOfSceneAnim.cancel();\n            // await this.currOutOfSceneAnim.finished;\n            this.clearAnimFromElem(this.currOutOfSceneAnim);\n            this.currOutOfSceneAnim = undefined;\n          }\n          if (this.currAnimation) {\n            await this.stop();\n            this.currAnimation.playbackRate = -10;\n            this.currAnimation.play();\n            console.log(`wait curr anim ${this.index}`);\n            await this.currAnimation.finished;\n            this.clearAnimFromElem(this.currAnimation);\n            this.currAnimation = undefined;\n            this._rootElement.classList.remove(styles['car-div_rollForward']);\n          }\n          this._rootElement.style.removeProperty('transition');\n          this._rootElement.style.removeProperty('transform');\n          await this.playInAnim();\n          this._rootElement.style.removeProperty('opacity');\n          finishPromise.finally(() => {\n            this.btnStart$.disabled = false;\n            this.btnReset$.disabled = true;\n            this.btnRm$.disabled = false;\n            this.btnSelect$.disabled = false;\n          });\n        }\n        console.log(`reseted ${this.index}`);\n        this.isReseted = true;\n        res(true);\n      };\n      asyncFunc();\n    });\n  }\n\n  async playOutAnim() {\n    const animOut = this._rootElement.animate(\n      [\n        { opacity: `0.5` },\n        { opacity: `0.9` },\n        { opacity: `0.3` },\n        { opacity: `0.7` },\n        { opacity: `0.1` },\n        { opacity: `0.4` },\n        { opacity: `0` },\n      ],\n      {\n        duration: 300,\n        easing: 'linear',\n        fill: 'forwards',\n      },\n    );\n    await animOut.finished;\n    this.clearAnimFromElem(animOut);\n  }\n\n  async playAwaitingAnim(promiseToAwait: Promise<unknown>) {\n    return new Promise<void>(res => {\n      const animIn = this._rootElement.animate(\n        [\n          { opacity: `0` },\n          { opacity: `0.6` },\n          { opacity: `0.3` },\n          { opacity: `0.8` },\n          { opacity: `0.3` },\n          { opacity: `0.6` },\n          { opacity: `0` },\n        ],\n        {\n          duration: 400,\n          easing: 'linear',\n          fill: 'forwards',\n          iterations: Number.POSITIVE_INFINITY,\n        },\n      );\n      promiseToAwait.finally(() => {\n        animIn.cancel();\n        this.clearAnimFromElem(animIn);\n        res();\n      });\n    });\n  }\n\n  async playInAnim() {\n    const animIn = this._rootElement.animate(\n      [\n        { opacity: `0` },\n        { opacity: `0.6` },\n        { opacity: `0.3` },\n        { opacity: `0.8` },\n        { opacity: `0.5` },\n        { opacity: `1` },\n      ],\n      {\n        duration: 300,\n        easing: 'linear',\n        fill: 'forwards',\n      },\n    );\n    await animIn.finished;\n    this.clearAnimFromElem(animIn);\n  }\n\n  private clearAnimFromElem = (a: Animation) => {\n    const anim = a as unknown as Record<string, unknown>;\n    if ('commitStyles' in anim && typeof anim.commitStyles === 'function')\n      anim.commitStyles();\n  };\n\n  private outOfScene() {\n    // console.log(`OUT OF SCENE ${this.index}`);\n    this.isReseted = false;\n    this.currOutOfSceneAnim = this._rootElement.animate(\n      [{ transform: `translateX(${-1000}%)` }],\n      {\n        duration: 3600,\n        easing: 'ease-in',\n        fill: 'forwards',\n      },\n    );\n  }\n\n  public disableCtls() {\n    this.btnStart$.disabled = true;\n    this.btnRm$.disabled = true;\n    this.btnSelect$.disabled = true;\n    this.btnReset$.disabled = true;\n  }\n\n  public async rollForward(time: number, handleBtns = true) {\n    this.isReseted = false;\n    // console.log(`anim time: ${time} ${this.index}`);\n    return new Promise<number | undefined>((res, rej) => {\n      const start = Date.now();\n      if (handleBtns) {\n        this.btnStart$.disabled = true;\n        this.btnRm$.disabled = true;\n        this.btnSelect$.disabled = true;\n        this.btnReset$.disabled = false;\n      }\n      const rootStyle = window.getComputedStyle(\n        this._rootElement.parentElement as HTMLElement,\n      );\n      const selfStyle = window.getComputedStyle(this.rootElement);\n\n      const rootWidth =\n        Number.parseFloat(rootStyle.width) -\n        Number.parseFloat(rootStyle.paddingLeft) -\n        Number.parseFloat(rootStyle.paddingRight);\n      const selfWidth = Number.parseFloat(selfStyle.width);\n\n      const coordinateInPercents = ((rootWidth - selfWidth) / selfWidth) * 100;\n\n      this._rootElement.classList.add(styles['car-div_rollForward']);\n\n      this.currAnimation = this._rootElement.animate(\n        [{ transform: `translateX(${coordinateInPercents}%)` }],\n        {\n          duration: time * 1000 + 1000,\n          easing: 'ease-in-out',\n          fill: 'forwards',\n        },\n      );\n\n      this.currAnimation.onfinish = (e: Event) => {\n        // console.log(`time from anim start: ${Date.now() - start}`);\n        // console.log('stop animation by roll forward finish');\n        // this._rootElement.classList.remove(styles['car-div_rollForward']);\n        // this.stop();\n        // console.log('TRUE', e);\n        res(this.currAnimation?.playbackRate);\n      };\n\n      this.currAnimation.oncancel = () => {\n        // console.log(`curr Anim cancel ${this.index}`);\n        this._rootElement.classList.remove(styles['car-div_rollForward']);\n        rej();\n      };\n    });\n  }\n\n  public async stop(\n    rollover = true,\n    broken = false,\n    flags?: Record<string, unknown>,\n  ) {\n    // console.log(`STOP, broken: ${broken}, ${this.index}`);\n    // this.rootElement.style.setProperty('transition', '');\n    if (rollover) {\n      await new Promise(res => {\n        if (this.currAnimation?.playState === 'running') {\n          // console.log(\n          //   this.currAnimation,\n          //   `awaiting for animation ${this.index}`,\n          // );\n          this.currAnimation.addEventListener('finish', () => res(true));\n          this.currAnimation.addEventListener('cancel', () => res(true));\n        } else res(true);\n      });\n    }\n    this._rootElement.classList.remove(styles['car-div_rollForward']);\n    this.currAnimation?.pause();\n    if (broken) {\n      if (flags) {\n        const roadElem = flags.roadElem as HTMLElement;\n        const roadIsMoving = roadElem.classList.contains(this.movingClassName);\n        console.log(`CHECK IF ROAD IS MOVING ${this.index}`);\n        if (roadIsMoving) this.outOfScene();\n        this.observer.observe(roadElem, {\n          attributes: true,\n          attributeOldValue: true,\n        });\n      }\n      console.log(`exp anim ${this.index}`);\n      const img = new Image();\n      let frameNumber = 0;\n      img.classList.add(styles['car-div__explosion']);\n      img.src = `${CarComp.CAR_EXPLOSION_IMG_DATA.BASE_URL}${frameNumber}${CarComp.CAR_EXPLOSION_IMG_DATA.EXTENSION}`;\n      img.onload = async () => {\n        this._rootElement.append(img);\n        await new Promise(res =>\n          setTimeout(res, CarComp.CAR_EXPLOSION_IMG_DATA.FRAME_TIME_MS),\n        );\n        frameNumber++;\n        if (frameNumber < CarComp.CAR_EXPLOSION_IMG_DATA.FRAMES_COUNT) {\n          img.src = `${CarComp.CAR_EXPLOSION_IMG_DATA.BASE_URL}${frameNumber}${CarComp.CAR_EXPLOSION_IMG_DATA.EXTENSION}`;\n        } else {\n          img.remove();\n        }\n      };\n    }\n  }\n\n  public get currCar(): RegCarData {\n    return this._currCar;\n  }\n\n  public get btnSelect() {\n    return this.btnSelect$;\n  }\n\n  public get btnRm() {\n    return this.btnRm$;\n  }\n\n  public get btnStart() {\n    return this.btnStart$;\n  }\n\n  public get btnReset() {\n    return this.btnReset$;\n  }\n\n  public get spanCarName() {\n    return this._spanCarName;\n  }\n\n  static drawCar(canvas: HTMLCanvasElement, hexColor: string) {\n    const img = new Image();\n    img.src = CarComp.CAR_BODY_IMG_SRC;\n    img.onload = () => {\n      canvas.height = img.height / 3;\n      canvas.width = img.width / 3;\n      const ctx = canvas.getContext('2d');\n\n      if (ctx) {\n        ctx.shadowColor = hexColor;\n        ctx.shadowBlur = 25;\n        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n      }\n\n      CarComp.paintCarBody(canvas, hexColor);\n    };\n  }\n\n  static paintCarBody(canvas: HTMLCanvasElement, hexColor: string) {\n    const imageData = canvas\n      .getContext('2d')\n      ?.getImageData(0, 0, canvas.width, canvas.height);\n    if (imageData) {\n      const rgb = hexToRgb(hexColor);\n      for (let j = 0; j < imageData.width; j++) {\n        for (let i = 0; i < imageData.height; i++) {\n          // index: red, green, blue, alpha, red, green, blue, alpha..etc.\n          const index = i * 4 * imageData.width + j * 4;\n          const red = imageData.data[index] as number;\n          const green = imageData.data[index + 1] as number;\n          const blue = imageData.data[index + 2] as number;\n          // const alpha = imageData.data[index + 3] as number;\n\n          const blueDiff = 2 * blue - red - green;\n          const blueDiffThreshold = 10;\n          const threshold = 70;\n          if (\n            red > threshold &&\n            green > threshold &&\n            blue > threshold &&\n            blueDiff < blueDiffThreshold\n          ) {\n            imageData.data[index] = (red / 255) * rgb.r;\n            imageData.data[index + 1] = (green / 255) * rgb.g;\n            imageData.data[index + 2] = (blue / 255) * rgb.b;\n            // imageData.data[index + 3] = 225; /// !!! TEST !!!\n          }\n        }\n      }\n      canvas\n        .getContext('2d')\n        ?.putImageData(imageData, 0, 0, 0, 0, canvas.width, canvas.height);\n    }\n  }\n\n  static genPreview(car: UnregCarData): HTMLElement {\n    const container = document.createElement('div');\n    const canvas = document.createElement('canvas');\n    canvas.classList.add(styles['car-div__canvas']);\n    container.append(canvas);\n    CarComp.drawWheels(container);\n    CarComp.drawCar(canvas, car.color);\n    return container;\n  }\n}\n","import { UnregCarData } from '../../../../../definitions/car-data.def';\nimport { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { REST_CLIENT_GARAGE } from '../../../../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionCreatedMsg } from '../../../dbus-msgs/by-topic/car-action/garage-car-created-msg.def';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\n\nexport class CreateCompController extends CreateUpdateCompControllerProto {\n  private txs = new Set<DBusTX>();\n\n  constructor(elements: CreateUpdateCompControllerReqElems) {\n    super(elements.inputText, elements.inputColor, elements.btn);\n\n    this.setupBtnCreate();\n  }\n\n  private setupBtnCreate() {\n    this.btn.addEventListener('click', () => {\n      if (!this.reportValidity()) return;\n      this.btn.disabled = true;\n      const unregCar: UnregCarData = {\n        name: this.inputText.value,\n        color: this.inputColor.value,\n      };\n      REST_CLIENT_GARAGE.createCar(unregCar)\n        .then(car => {\n          // TODO: Notify with DBus\n          const msg = new DBusMsgCarActionCreatedMsg(car);\n          this.txs.forEach(tx => {\n            tx.transmit({\n              msg,\n              prepMode: DBusTXPrepModes.clone,\n              waitMode: DBusTXWaitModes.nowait,\n            });\n          });\n        })\n        .finally(() => {\n          this.btn.disabled = false;\n        });\n    });\n  }\n\n  autoConnect(int: DBusInterface) {\n    const tx = int.getNewTX('send created car msgs');\n    this.txs.add(tx);\n  }\n}\n","import { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../../../../lib/services/dbus/defs/dbus-port.def';\n\nexport interface CreateUpdateCompControllerReqElems {\n  inputText: HTMLInputElement;\n  inputColor: HTMLInputElement;\n  btn: HTMLButtonElement;\n}\n\nexport abstract class CreateUpdateCompControllerProto implements DBusPort {\n  protected ctlsStateMap = new Map<HTMLElement, boolean>();\n\n  protected ctls = [this.inputText, this.inputColor, this.btn];\n\n  constructor(\n    protected inputText: HTMLInputElement,\n    protected inputColor: HTMLInputElement,\n    protected btn: HTMLButtonElement,\n  ) {}\n\n  abstract autoConnect(int: DBusInterface): void | Promise<void>;\n\n  protected reportValidity() {\n    if (this.inputText.value.length === 0) {\n      this.inputText.setCustomValidity('Please, enter a name');\n      this.inputText.pattern = '';\n      this.inputText.reportValidity();\n      this.inputText.removeAttribute('pattern');\n      return false;\n    }\n    return true;\n  }\n\n  protected toogleCtlsDisabled(state: boolean) {\n    this.inputText.disabled = state;\n    this.inputColor.disabled = state;\n    this.btn.disabled = state;\n  }\n\n  protected pushCtlsState() {\n    this.ctls.forEach(ctl => {\n      this.ctlsStateMap.set(ctl, ctl.disabled);\n    });\n  }\n\n  protected popCtlsState() {\n    this.ctls.forEach(ctl => {\n      const state = this.ctlsStateMap.get(ctl);\n      if (state !== undefined) ctl.disabled = state;\n    });\n    this.ctlsStateMap.clear();\n  }\n\n  disable() {\n    this.pushCtlsState();\n    this.toogleCtlsDisabled(true);\n  }\n\n  enable() {\n    this.popCtlsState();\n  }\n}\n","import { RegCarData } from '../../../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../../../lib/processors/obj-processor';\nimport { DBUS_COMMON_RESPONSES } from '../../../../../lib/services/dbus/defs/dbus-common-responses.def';\nimport { DBusInterface } from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusPort } from '../../../../../lib/services/dbus/defs/dbus-port.def';\nimport { DBusRX } from '../../../../../lib/services/dbus/defs/dbus-rx/dbus-rx.def';\nimport { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { REST_CLIENT_GARAGE } from '../../../../../services/rest-clients/client-garage/rest-client-garage';\nimport { DBusMsgCarActionRemovedMsg } from '../../../dbus-msgs/by-topic/car-action/garage-car-remove-msg.def';\nimport { DBusMsgCarActionSelectedMsg } from '../../../dbus-msgs/by-topic/car-action/garage-car-select-msg.def';\nimport { DBusMsgGaragePageIsChangedMsg } from '../../../dbus-msgs/by-topic/garage/garage-page-is-changed.def';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\n\nexport class UpdateCompController\n  extends CreateUpdateCompControllerProto\n  implements DBusPort\n{\n  private choosedCar: RegCarData | undefined;\n\n  private notifyCb: ((car: RegCarData) => unknown) | undefined;\n\n  constructor(elements: CreateUpdateCompControllerReqElems) {\n    super(elements.inputText, elements.inputColor, elements.btn);\n\n    this.setupBtnUpdate();\n  }\n\n  autoConnect(int: DBusInterface) {\n    const rxCarActions = int.getNewRX(\n      this.carActionsListener,\n      'listen car choosing',\n    );\n    int.plugRX(DBusTopics.CAR_ACTION, rxCarActions);\n\n    const rxGarage = int.getNewRX(\n      this.garageMsgsListener,\n      'listen garage paging',\n    );\n    int.plugRX(DBusTopics.GARAGE, rxGarage);\n  }\n\n  private garageMsgsListener = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgGaragePageIsChangedMsg) {\n      this.reset();\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private reset() {\n    this.notifyCb = undefined;\n    this.choosedCar = undefined;\n    this.inputText.value = '';\n    this.inputColor.value = '#000000';\n    this.toogleCtlsDisabled(true);\n  }\n\n  private carActionsListener = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgCarActionSelectedMsg) {\n      this.choosedCar = OBJ_PROCESSOR.deepClone(data.msg.car);\n      this.notifyCb = data.msg.notifyChanges;\n      this.inputColor.value = data.msg.car.color;\n      this.inputText.value = data.msg.car.name;\n      this.toogleCtlsDisabled(false);\n    }\n    if (\n      data.msg instanceof DBusMsgCarActionRemovedMsg &&\n      data.msg.car.id === this.choosedCar?.id\n    ) {\n      this.reset();\n    }\n\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  private setupBtnUpdate() {\n    this.toogleCtlsDisabled(true);\n    this.btn.addEventListener('click', () => {\n      if (!this.reportValidity()) return;\n      this.toogleCtlsDisabled(true);\n      if (!this.choosedCar) return;\n      this.choosedCar.color = this.inputColor.value;\n      this.choosedCar.name = this.inputText.value;\n      REST_CLIENT_GARAGE.updateCar(this.choosedCar)\n        .then(car => {\n          if (this.notifyCb) this.notifyCb(car);\n        })\n        .finally(() => {\n          this.toogleCtlsDisabled(false);\n        });\n    });\n  }\n}\n","import { BaseComp } from '../../../../../lib/components/base-comp/base-comp';\nimport { DBUS_HUB_NAMES } from '../../../../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { CreateCompController } from './controller-create';\nimport {\n  CreateUpdateCompControllerProto,\n  CreateUpdateCompControllerReqElems,\n} from './controller-proto.def';\nimport { UpdateCompController } from './controller-update';\n\nimport styles from './create-update.scss';\nimport sharedStyles from '../../../../../styles.scss';\n\nexport class CreateUpdateComponent extends BaseComp implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.CREATE_UPDATE;\n\n  protected textInput = document.createElement('input');\n\n  protected colorInput = document.createElement('input');\n\n  protected btn = document.createElement('button');\n\n  protected controller: CreateUpdateCompControllerProto;\n\n  constructor(type: 'CREATE' | 'UPDATE', btnText: string) {\n    super('div');\n    this._rootElement.classList.add(styles.root);\n    this.textInput.type = 'text';\n    this.textInput.classList.add(styles['text-input']);\n    this.colorInput.type = 'color';\n    this.colorInput.classList.add(styles['color-input']);\n    this.btn.textContent = btnText;\n    this.btn.classList.add(sharedStyles.btn);\n    this._rootElement.append(this.textInput, this.colorInput, this.btn);\n\n    const elements: CreateUpdateCompControllerReqElems = {\n      inputText: this.textInput,\n      inputColor: this.colorInput,\n      btn: this.btn,\n    };\n\n    switch (type) {\n      case 'UPDATE':\n        this.controller = new UpdateCompController(elements);\n        this.btn.classList.add(sharedStyles['btn-13']);\n        break;\n      case 'CREATE':\n      default:\n        this.controller = new CreateCompController(elements);\n        this.btn.classList.add(sharedStyles['btn-13']); // TODO: maybe change?\n        break;\n    }\n  }\n\n  getController() {\n    return this.controller;\n  }\n\n  connect(int: DBusInterface) {\n    this.controller.autoConnect(int);\n  }\n}\n","import { DBusTopics } from '../../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../../../../lib/services/dbus/defs/msgs/dbus-msg.def';\n\nexport class DBusMsgGenerateCarsMsg extends DBusMsg {\n  constructor(\n    readonly status: 'start' | 'end',\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {\n    super(DBusTopics.GENERATE, rxIds, prefResponseRxIds);\n  }\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { CreateUpdateComponent } from './create-update/create-update';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from '../../../../lib/services/dbus/defs/dbus-hub-names.def';\nimport { DBusMsgRaceRequestMsg } from '../../dbus-msgs/by-topic/garage/garage-race-request-msg.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusMsgGarageResetReqMsg } from '../../dbus-msgs/by-topic/garage/garage-reset-req-msg.def';\n\nimport styles from './main-controls.scss';\nimport sharedStyles from '../../../../styles.scss';\nimport { REST_CLIENT_GARAGE } from '../../../../services/rest-clients/client-garage/rest-client-garage';\nimport {\n  CAR_MODEL_LIST,\n  CAR_MODEL_LIST_KEYS,\n} from '../../../../definitions/car-random-data.def';\nimport {\n  genRandomHexColor,\n  getRandomArbitraryInt,\n  getRandomInt,\n} from '../../../../lib/generators/generators';\nimport {\n  UnregCarData,\n  WinnerCarData,\n} from '../../../../definitions/car-data.def';\nimport { REST_CLIENT_WINNERS } from '../../../../services/rest-clients/client-winners/rest-client-winners';\nimport { DBusTXData } from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBusMsgGarageRaceMsg } from '../../dbus-msgs/by-topic/garage/garage-race-msg.def';\nimport { DBUS_COMMON_RESPONSES } from '../../../../lib/services/dbus/defs/dbus-common-responses.def';\nimport { DBusMsgGarageRaceStatusMsg } from '../../dbus-msgs/by-topic/garage/garage-race-status-msg.def';\nimport { DBusTopics } from '../../../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTX } from '../../../../lib/services/dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgGenerateCarsMsg } from './dbus-msgs/generate-cars-msg.def';\nimport { PopupStandaloneModalProgressComp } from '../../../../lib/components/popups/standalone/modal/progress/popup-progress';\n\nexport class MainControlsComp extends BaseComp implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.MAIN_CONTROLS;\n\n  private txs = new Set<DBusTX>();\n\n  private createComponent = new CreateUpdateComponent('CREATE', 'create');\n\n  private updateComponent = new CreateUpdateComponent('UPDATE', 'update');\n\n  private btnRace = document.createElement('button');\n\n  private btnReset = document.createElement('button');\n\n  private btnGenerate = document.createElement('button');\n\n  private popup = new PopupStandaloneModalProgressComp();\n\n  constructor() {\n    super('div');\n    this._rootElement.classList.add(styles['main-controls']);\n\n    const btnsBlock = this.renderBtns();\n    this.btnRace.addEventListener('click', this.raceClickListener);\n    this.btnReset.addEventListener('click', this.resetClickListener);\n    this.btnGenerate.addEventListener('click', this.generateClickListener);\n\n    this.btnReset.disabled = true;\n    this.btnRace.disabled = true;\n\n    this._rootElement.append(\n      this.createComponent.rootElement,\n      this.updateComponent.rootElement,\n      btnsBlock,\n    );\n  }\n\n  private generateClickListener = async () => {\n    this.btnGenerate.disabled = true;\n    const msg = new DBusMsgGenerateCarsMsg('start');\n    const transmissions: Promise<unknown>[] = [];\n    this.txs.forEach(tx => {\n      const transmission = tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n      transmissions.push(transmission);\n    });\n    await Promise.allSettled(transmissions);\n    this.popup\n      .reset()\n      .setText('please wait while the entries are generated')\n      .show();\n    await this.generate(100, undefined, this.genCb);\n    this.popup.reset().hide();\n    const resolveMsg = new DBusMsgGenerateCarsMsg('end');\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg: resolveMsg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.nowait,\n      });\n    });\n    this.btnGenerate.disabled = false;\n  };\n\n  private genCb = (progress: number) => {\n    this.popup.setProgress(progress);\n  };\n\n  private raceClickListener = async () => {\n    if (this.txs.size === 0) return;\n    this.btnRace.disabled = true;\n    this.btnGenerate.disabled = true;\n    const msg = new DBusMsgRaceRequestMsg();\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n    });\n  };\n\n  private resetClickListener = async () => {\n    if (this.txs.size === 0) return;\n    const msg = new DBusMsgGarageResetReqMsg();\n    this.txs.forEach(tx => {\n      tx.transmit({\n        msg,\n        prepMode: DBusTXPrepModes.freeze,\n        waitMode: DBusTXWaitModes.allSetled,\n      });\n    });\n  };\n\n  private renderBtns(): HTMLElement {\n    // setip btns\n    const span = document.createElement('span');\n    span.textContent = 'race';\n    this.btnRace.append(span);\n    this.btnRace.classList.add(sharedStyles.btn, sharedStyles['btn-15']);\n    this.btnReset.textContent = 'reset';\n    this.btnReset.classList.add(sharedStyles.btn, sharedStyles['btn-9']);\n    this.btnGenerate.textContent = 'generate cars';\n    this.btnGenerate.classList.add(sharedStyles.btn, sharedStyles['btn-1']);\n\n    const btnBlock = document.createElement('div');\n    btnBlock.classList.add(styles['btn-block']);\n    btnBlock.append(this.btnRace, this.btnReset, this.btnGenerate);\n    return btnBlock;\n  }\n\n  private async generate(\n    total: number,\n    left?: number,\n    cb?: (progress: number) => unknown,\n  ): Promise<boolean> {\n    let genLeft = left || total;\n    const randomName = this.genRandomCarName();\n    const color = genRandomHexColor();\n    const unregCarData: UnregCarData = {\n      name: randomName,\n      color,\n    };\n    const car = await REST_CLIENT_GARAGE.createCar(unregCarData);\n    // const winner: WinnerCarData = {\n    //   id: car.id,\n    //   wins: getRandomArbitraryInt(1, 3),\n    //   time: Number.parseFloat((getRandomArbitraryInt(40, 50) / 3).toFixed(2)),\n    // };\n    // await REST_CLIENT_WINNERS.createWinner(winner);\n    genLeft--;\n\n    if (cb) {\n      const progress = (1 - genLeft / total) * 100;\n      cb(progress);\n    }\n\n    if (genLeft > 0) return this.generate(total, genLeft, cb);\n\n    return true;\n  }\n\n  private genRandomCarName = (): string => {\n    const manufacturerNumber = getRandomInt(CAR_MODEL_LIST_KEYS.length - 1);\n    const manufacturerName = CAR_MODEL_LIST_KEYS[\n      manufacturerNumber\n    ] as keyof typeof CAR_MODEL_LIST;\n    const models = CAR_MODEL_LIST[manufacturerName];\n    const modelNumber = getRandomInt(models.length - 1);\n    const modelName = models[modelNumber] as string;\n    return `${manufacturerName} ${modelName}`;\n  };\n\n  private rxFuncForRaceMsgs = async (data: DBusTXData) => {\n    if (data.msg instanceof DBusMsgGarageRaceStatusMsg) {\n      const { status } = data.msg;\n      switch (status) {\n        case 'READY_TO_GO':\n          this.btnRace.disabled = false;\n          this.btnReset.disabled = true;\n          this.btnGenerate.disabled = false;\n          this.createComponent.getController().enable();\n          this.updateComponent.getController().enable();\n          break;\n        case 'IN_PROCESS':\n          this.btnRace.disabled = true;\n          this.btnReset.disabled = false;\n          this.btnGenerate.disabled = true;\n          this.createComponent.getController().disable();\n          this.updateComponent.getController().disable();\n          break;\n        case 'NEED_RESET':\n          this.btnRace.disabled = true;\n          this.btnReset.disabled = false;\n          this.btnGenerate.disabled = false;\n          this.createComponent.getController().enable();\n          this.updateComponent.getController().enable();\n          break;\n        default:\n          break;\n      }\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n\n  connect(int: DBusInterface) {\n    int.attachSubHub(this.createComponent, 'cu_create');\n    int.attachSubHub(this.updateComponent, 'cu_delete');\n\n    const rx = int.getNewRX(\n      this.rxFuncForRaceMsgs,\n      'toggle btns in main-ctls-block',\n    );\n    int.plugRX(DBusTopics.GARAGE, rx);\n\n    const tx = int.getNewTX('start race | broadcast generate');\n    this.txs.add(tx);\n  }\n}\n","import { RegCarData } from '../../../../definitions/car-data.def';\nimport { BaseComp } from '../../../../lib/components/base-comp/base-comp';\n\nexport class GaragePopupWinner extends BaseComp {\n  private header = document.createElement('h3');\n\n  private textTime = document.createElement('span');\n\n  private textName = document.createElement('span');\n\n  private textId = document.createElement('span');\n\n  private textNumber = document.createElement('span');\n\n  constructor() {\n    super('div');\n    this.header.textContent = 'WE HAVE A WINNER!';\n    this._rootElement.append(\n      this.header,\n      this.textTime,\n      this.textName,\n      this.textId,\n      this.textNumber,\n    );\n  }\n\n  setData(car: RegCarData, timeStr: string, indexStr?: string) {\n    this.textTime.textContent = `Time: ${timeStr}s`;\n    this.textName.textContent = `Name of the car: \\n ${car.name}`;\n    this.textId.textContent = `ID of the car: ${car.id}`;\n    this.textNumber.textContent = indexStr\n      ? `Position on the track: ${indexStr}`\n      : ``;\n  }\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\nimport { CarComp } from '../car/car';\n\nimport styles from './track.scss';\n\nexport class TrackComp extends BaseComp {\n  private topBlock = document.createElement('div');\n\n  constructor() {\n    super('div');\n    this._rootElement.classList.add(styles.track);\n    this._rootElement.append();\n    this.topBlock.classList.add(styles['track__controls-block']);\n  }\n\n  illuminateSelf = (illuminate: boolean) => {\n    if (illuminate) this._rootElement.classList.add(styles.track_illuminated);\n    else this._rootElement.classList.remove(styles.track_illuminated);\n  };\n\n  placeCar(carComp: CarComp) {\n    if (this._rootElement.hasChildNodes()) {\n      this._rootElement.childNodes.forEach(child => child.remove());\n    }\n    this.topBlock.append(carComp.spanCarName);\n    this._rootElement.append(this.topBlock, carComp.rootElement);\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { DBus } from '../../lib/services/dbus/dbus';\nimport { DBUS_COMMON_RESPONSES } from '../../lib/services/dbus/defs/dbus-common-responses.def';\nimport {\n  DBusHubNamesList,\n  DBUS_HUB_NAMES,\n} from '../../lib/services/dbus/defs/dbus-hub-names.def';\nimport {\n  DBusHub,\n  DBusInterface,\n} from '../../lib/services/dbus/defs/dbus-interface.def';\nimport { DBusTopics } from '../../lib/services/dbus/defs/dbus-topics.def';\nimport { DBusTXData } from '../../lib/services/dbus/defs/dbus-tx/dbus-tx-data.def';\nimport { DBusMsgRouteIsChangedMsg } from '../../lib/services/simple-router/dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport styles from './header.scss';\nimport { NavItem } from './subcomps/nav-item/nav-item';\n\nexport class HeaderComponent extends BaseComp implements DBusHub {\n  private navContainer: HTMLElement;\n\n  private logo: HTMLElement;\n\n  protected anchors: HTMLAnchorElement[];\n\n  protected buses: DBus[] = [];\n\n  constructor(readonly hubName: DBusHubNamesList = DBUS_HUB_NAMES.HEADER) {\n    super('header');\n    this.rootElement.classList.add(styles.header);\n\n    // logo\n    this.logo = document.createElement('h1');\n    this.logo.classList.add(styles.header__logo);\n    const firstSpan = document.createElement('span');\n    firstSpan.textContent = 'async';\n    const secondSpan = document.createElement('span');\n    secondSpan.textContent = 'race';\n    this.logo.append(firstSpan, secondSpan);\n    this.rootElement.append(this.logo);\n\n    // nav\n    this.navContainer = document.createElement('nav');\n    this.navContainer.classList.add(styles['header-nav']);\n    this.rootElement.append(this.navContainer);\n\n    // ul\n    const ul = document.createElement('ul');\n    ul.classList.add(styles['header-nav__list']);\n    this.navContainer.append(ul);\n\n    // ul items\n    const classList = {\n      li: styles['header-nav__item'],\n      a: styles['header-nav__anchor'],\n      svg: styles['header-nav__svg'],\n      span: styles['header-nav__span'],\n    };\n\n    const garageNavItem = new NavItem('garage', '#garage', classList);\n    const winnersNavItem = new NavItem('winners', '#winners', classList);\n\n    const navItems = [garageNavItem, winnersNavItem];\n    this.anchors = navItems.map(item => item.anchor);\n\n    ul.append(...navItems.map(item => item.rootElement));\n  }\n\n  connect(int: DBusInterface) {\n    const illuminateRX = int.getNewRX(\n      this.illuminateNavItem,\n      'illuminate nav items',\n    );\n    int.plugRX(DBusTopics.ROUTING, illuminateRX);\n  }\n\n  private illuminateNavItem = async (data: DBusTXData) => {\n    const { msg } = data;\n    if (msg instanceof DBusMsgRouteIsChangedMsg) {\n      this.anchors.forEach(anchor => {\n        if (anchor.getAttribute('href') === msg.newRoute) {\n          anchor.classList.add(styles['header-nav__anchor_active']);\n        } else {\n          anchor.classList.remove(styles['header-nav__anchor_active']);\n        }\n      });\n    }\n    return DBUS_COMMON_RESPONSES.VOID;\n  };\n}\n","import { BaseComp } from '../../../../lib/components/base-comp/base-comp';\n\nexport interface NavItemStyles {\n  li?: string;\n  a?: string;\n  svg?: string;\n  span?: string;\n}\n\nexport class NavItem extends BaseComp {\n  private _anchor: HTMLAnchorElement;\n\n  protected iconImage: HTMLImageElement | undefined;\n\n  protected span: HTMLSpanElement;\n\n  constructor(\n    text: string,\n    href: string,\n    styles?: NavItemStyles,\n    iconSrc?: string,\n  ) {\n    super('li');\n\n    if (styles?.li) this._rootElement.classList.add(styles.li);\n    this._anchor = document.createElement('a');\n    this._anchor.setAttribute('href', href);\n\n    if (styles?.a) this._anchor.classList.add(styles.a);\n\n    if (iconSrc) {\n      this.iconImage = document.createElement('img');\n      this.iconImage.src = iconSrc;\n\n      if (styles?.svg) this.iconImage.classList.add(styles.svg);\n      this._anchor.append(this.iconImage);\n    }\n    this.span = document.createElement('span');\n    this.span.textContent = text;\n\n    if (styles?.span) this.span.classList.add(styles.span);\n    this._anchor.append(this.span);\n\n    this.rootElement.append(this._anchor);\n  }\n\n  get anchor(): HTMLAnchorElement {\n    return this._anchor;\n  }\n}\n","import { UnregCarData, WinnerCarData } from '../../../definitions/car-data.def';\nimport { BaseComp } from '../../../lib/components/base-comp/base-comp';\nimport { CarComp } from '../../garage/subcomps/car/car';\n\nexport class WinnerRowComp extends BaseComp {\n  private indexElem = document.createElement('td');\n\n  private idElem = document.createElement('td');\n\n  private carPreviewBox = document.createElement('td');\n\n  private nameElem = document.createElement('td');\n\n  private winsElem = document.createElement('td');\n\n  private bestTimeElem = document.createElement('td');\n\n  private carPreview: HTMLElement;\n\n  constructor(index: number, winnerData: WinnerCarData, carData: UnregCarData) {\n    super('tr');\n\n    this.indexElem.textContent = index.toString();\n    this.idElem.textContent = winnerData.id.toString();\n    this.carPreview = CarComp.genPreview(carData);\n    this.carPreviewBox.append(this.carPreview);\n    this.nameElem.textContent = carData.name;\n    this.winsElem.textContent = winnerData.wins.toString();\n    this.bestTimeElem.textContent = winnerData.time.toString();\n\n    this._rootElement.append(\n      this.indexElem,\n      this.idElem,\n      this.carPreviewBox,\n      this.nameElem,\n      this.winsElem,\n      this.bestTimeElem,\n    );\n  }\n\n  public getCarPreview() {\n    return this.carPreview;\n  }\n}\n","import { BaseComp } from '../../lib/components/base-comp/base-comp';\nimport { REST_CLIENT_GARAGE } from '../../services/rest-clients/client-garage/rest-client-garage';\nimport { REST_CLIENT_WINNERS } from '../../services/rest-clients/client-winners/rest-client-winners';\nimport {\n  RestClientWinnersSortOptionsList,\n  REST_CLIENT_WINNERS_SORT_OPTIONS,\n} from '../../services/rest-clients/client-winners/rest-client-winners.def';\nimport { WinnerRowComp } from './subcomps/winner-entry';\nimport { Pager } from '../../lib/services/pager/pager';\n\nimport styles from './winners.scss';\nimport sharedStyles from '../../styles.scss';\nimport { Notifiable } from '../../lib/interfaces/notifiable';\n\nexport class WinnersComp extends BaseComp implements Notifiable {\n  static readonly TEXT_CONTENT_ENG = {};\n\n  private table = document.createElement('table');\n\n  private tableBody = document.createElement('tbody');\n\n  private tableHead = document.createElement('thead');\n\n  private thId = document.createElement('th');\n\n  private thCar = document.createElement('th');\n\n  private thName = document.createElement('th');\n\n  private thWins = document.createElement('th');\n\n  private thBestTime = document.createElement('th');\n\n  private pager: Pager;\n\n  private pagerBtnsContainer = document.createElement('div');\n\n  private pagerSpan: HTMLSpanElement;\n\n  private currSortedElem: HTMLElement | undefined;\n\n  private currOrder: 'ASC' | 'DESC' = 'ASC';\n\n  private currSort: RestClientWinnersSortOptionsList = 'time';\n\n  private entriesPerPage = 10;\n\n  constructor() {\n    super('section');\n    this._rootElement.classList.add(styles.winners);\n    this._rootElement.style.setProperty(\n      'background-image',\n      `url('./assets/imgs/backgrounds/winners/anime-girl-cyberpunk-ride-4k-lx-2880x1800.jpg')`,\n    );\n\n    this.pager = new Pager(this.entriesPerPage, this.pagerCallback);\n    this.pagerSpan = this.pager.getPagerSpan();\n\n    this.renderPager();\n\n    this.renderTable();\n\n    this._rootElement.append(this.table);\n  }\n\n  private renderTable() {\n    this.renderTableHeader();\n    this.table.classList.add(styles.table);\n    this.table.append(\n      this.tableHead,\n      this.tableBody,\n      this.pagerBtnsContainer,\n      this.pagerSpan,\n    );\n  }\n\n  private renderTableHeader() {\n    const tr = document.createElement('tr');\n\n    const thIndex = document.createElement('th');\n    thIndex.textContent = '№';\n    this.thId.textContent = 'ID';\n    this.thId.classList.add(styles['table__can-be-sorted']);\n    this.thCar.textContent = 'CAR';\n    this.thName.textContent = 'NAME';\n    this.thWins.textContent = 'WINS';\n    this.thWins.classList.add(styles['table__can-be-sorted']);\n    this.thBestTime.textContent = 'BEST TIME';\n    this.thBestTime.classList.add(styles['table__can-be-sorted']);\n\n    tr.append(\n      thIndex,\n      this.thId,\n      this.thCar,\n      this.thName,\n      this.thWins,\n      this.thBestTime,\n    );\n    this.tableHead.append(tr);\n    this.tableHead.addEventListener('click', this.tableHeadClickListener);\n  }\n\n  private renderPager() {\n    const btnPrevPage = this.pager.getBtnPrevPage();\n\n    btnPrevPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['pager-btn'],\n    );\n\n    const btnNextPage = this.pager.getBtnNextPage();\n\n    btnNextPage.classList.add(\n      sharedStyles.btn,\n      sharedStyles['btn-6'],\n      styles['pager-btn'],\n    );\n\n    this.pagerBtnsContainer.classList.add(styles.pager);\n    this.pagerBtnsContainer.append(btnPrevPage, btnNextPage);\n\n    this.pagerSpan.classList.add(styles['pager-span']);\n  }\n\n  notify(): void {\n    this.refillTable().then(() =>\n      this.refreshTableHeader(this.currSortedElem || this.thBestTime),\n    );\n  }\n\n  private pagerCallback = async (dir: 'prev' | 'next'): Promise<boolean> => {\n    try {\n      await this.refillTable(dir);\n      return true;\n    } catch {\n      return false;\n    }\n  };\n\n  private async refillTable(dir?: 'prev' | 'next'): Promise<void> {\n    return new Promise((res, rej) => {\n      const page = dir\n        ? dir === 'next'\n          ? this.pager.getCurrPageNumber() + 1\n          : this.pager.getCurrPageNumber() - 1\n        : this.pager.getCurrPageNumber();\n\n      console.log(page, this.currSort, this.currOrder);\n      REST_CLIENT_WINNERS.getWinners(\n        page,\n        10,\n        this.currSort,\n        this.currOrder,\n      ).then(async response => {\n        this.pager.setEntriesCount(Number.parseInt(response.limit, 10));\n        if (response.cars.length === 0) {\n          if (dir) {\n            rej();\n            return;\n          }\n\n          if (page > 1) {\n            await this.pager.tryChangePage('prev');\n            res();\n            return;\n          }\n        }\n        const rows = new Array<WinnerRowComp>(response.cars.length);\n        const promises: Promise<unknown>[] = [];\n        const indexInc = (page - 1) * 10;\n        response.cars.forEach((winner, index) => {\n          const promise = REST_CLIENT_GARAGE.getCar(winner.id).then(car => {\n            const totalIndex = index + indexInc + 1;\n            const row = new WinnerRowComp(totalIndex, winner, car);\n            console.log(totalIndex, winner.time);\n            rows[index] = row;\n          });\n          promises.push(promise);\n        });\n        await Promise.allSettled(promises);\n        while (this.tableBody.firstChild) this.tableBody.firstChild.remove();\n        this.tableBody.append(\n          ...rows.map(row => {\n            row.getCarPreview().classList.add(styles['table__car-preview-box']);\n            return row.rootElement;\n          }),\n        );\n        res();\n      });\n    });\n  }\n\n  private tableHeadClickListener = async (e: Event) => {\n    let sort: RestClientWinnersSortOptionsList | undefined;\n    switch (e.target) {\n      case this.thId:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.id;\n        break;\n      case this.thWins:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.wins;\n        break;\n      case this.thBestTime:\n        sort = REST_CLIENT_WINNERS_SORT_OPTIONS.time;\n        break;\n      default:\n        break;\n    }\n    if (sort) {\n      this.pager.toogleLock(true);\n      const elem = e.target as HTMLElement;\n      this.currOrder = elem.classList.contains(\n        styles['table__sorted-elem_desc'],\n      )\n        ? 'ASC'\n        : 'DESC';\n      this.currSort = sort;\n      await this.refillTable();\n      this.refreshTableHeader(elem);\n      this.pager.toogleLock(false);\n    }\n  };\n\n  private refreshTableHeader = (elem: HTMLElement) => {\n    if (this.currSortedElem)\n      this.currSortedElem.classList.remove(styles['table__sorted-elem']);\n\n    elem.classList.add(styles['table__sorted-elem']);\n    this.currSortedElem = elem;\n\n    if (this.currOrder === 'ASC') {\n      elem.classList.remove(styles['table__sorted-elem_desc']);\n      elem.classList.add(styles['table__sorted-elem_asc']);\n    } else {\n      elem.classList.remove(styles['table__sorted-elem_asc']);\n      elem.classList.add(styles['table__sorted-elem_desc']);\n    }\n  };\n}\n","import { OBJ_PROCESSOR } from '../lib/processors/obj-processor';\n\nconst models = {\n  Lamborghini: [\n    'Murciélago',\n    '350 GT',\n    '400 GT',\n    'Sián FKP 37',\n    'Essenza SCV12',\n    'Urus',\n    'Centenario',\n    'Huracán',\n    'Veneno',\n    'Sesto Elementо',\n    'Aventador',\n    'Reventón',\n    'Gallardo',\n    'Diablo',\n    'LM002',\n    'Jalpa',\n    'Silhouette',\n    'Countach',\n    'Urraco',\n    'Jarama',\n    'Islero',\n    'Espada',\n    'Miura',\n  ],\n  'Aston Martin': [\n    'Project 003',\n    'Valkyrie',\n    'DBS',\n    'Vanquish Zagato',\n    'Vanquish',\n    'Virage/Virage Volante',\n    'V12 Zagato',\n    'One-77',\n    'V8 Coupe/V8 Volante',\n    'V8 Zagato',\n  ],\n  Ferrari: [\n    'Roma',\n    'Portfolio',\n    '488 GTB',\n    'California T',\n    '360 Spider',\n    '355 F1 Berlinetta',\n    'F355 GTS',\n    '456 GT',\n    'Testarossa',\n    'SF1000',\n  ],\n  Koenigsegg: [\n    'Jesko Absolut',\n    'Jesko',\n    'Agera Final',\n    'Agera XS',\n    'Agera X',\n    'Agera S',\n    'Regera',\n    'Agera RS',\n    'One:1',\n    'CCGT',\n  ],\n};\n\nconst CAR_MODEL_LIST = OBJ_PROCESSOR.deepFreeze(models);\n\nexport { CAR_MODEL_LIST };\n\nconst CAR_MODEL_LIST_KEYS = OBJ_PROCESSOR.deepFreeze(\n  Object.keys(CAR_MODEL_LIST),\n);\n\nexport { CAR_MODEL_LIST_KEYS };\n","export class BaseComp {\n  protected _rootElement: HTMLElement;\n\n  constructor(tag: keyof HTMLElementTagNameMap = 'div') {\n    this._rootElement = document.createElement(tag);\n  }\n\n  public get rootElement(): HTMLElement {\n    return this._rootElement;\n  }\n}\n","import { PopupStandaloneModalComp } from '../popup-standalone-modal';\n\nimport sharedStyles from '../../../../../../styles.scss';\n\nexport class PopupStandaloneModal404Comp extends PopupStandaloneModalComp {\n  constructor() {\n    super();\n    this.header.textContent = 'ERROR: 404';\n    this.header.dataset.textContent = this.header.textContent;\n    this.header.classList.add(sharedStyles['glitched-text']);\n    this.text.classList.add(sharedStyles['glitched-text']);\n  }\n}\n","import { PopupStandaloneComp } from '../popup-standalone';\n\nimport styles from './popup-standalone-modal.scss';\n\nexport abstract class PopupStandaloneModalComp extends PopupStandaloneComp {\n  constructor() {\n    super();\n    this._rootElement.classList.add(styles['popup-modal']);\n    const closeArea = document.createElement('div');\n    closeArea.classList.add(styles['popup-bg']);\n    this._rootElement.append(closeArea);\n    this.body.classList.add(styles['popup-body']);\n    closeArea.append(this.body);\n    this.header.classList.add(styles['popup-body-header']);\n    this.text.classList.add(styles['popup-body-text']);\n  }\n\n  setHeader(text: string): PopupStandaloneModalComp {\n    this.header.textContent = text;\n    this.header.dataset.textContent = text;\n    return this;\n  }\n\n  setText(text: string): PopupStandaloneModalComp {\n    this.text.textContent = text;\n    this.text.dataset.textContent = text;\n    return this;\n  }\n\n  show(rootElem?: HTMLElement): PopupStandaloneModalComp {\n    const root = rootElem || document.body;\n    root.append(this._rootElement);\n    return this;\n  }\n\n  hide(): PopupStandaloneModalComp {\n    this._rootElement.remove();\n    return this;\n  }\n}\n","import { PopupStandaloneModalComp } from '../popup-standalone-modal';\n\nimport styles from './popup-progress.scss';\nimport sharedStyles from '../../../../../../styles.scss';\n\nexport class PopupStandaloneModalProgressComp extends PopupStandaloneModalComp {\n  private barContainer = document.createElement('div');\n\n  private bar = document.createElement('div');\n\n  constructor() {\n    super();\n    this.barContainer.classList.add(styles.container);\n    this.bar.classList.add(styles.bar);\n    this.barContainer.append(this.bar);\n    this.text.classList.add(styles.text, sharedStyles['glitched-text']);\n    this.body.classList.add(styles.body);\n    this.body.append(this.barContainer);\n  }\n\n  setHeader(text: string): PopupStandaloneModalProgressComp {\n    super.setHeader(text);\n    return this;\n  }\n\n  setText(text: string): PopupStandaloneModalProgressComp {\n    super.setText(text);\n    return this;\n  }\n\n  reset(): PopupStandaloneModalProgressComp {\n    this.bar.style.removeProperty('--progress');\n    this.text.textContent = '';\n    this.text.dataset.textContent = '';\n    return this;\n  }\n\n  setProgress(progress: number): PopupStandaloneModalProgressComp {\n    this.bar.style.setProperty('--progress', `${progress}%`);\n    return this;\n  }\n}\n","import { BaseComp } from '../../base-comp/base-comp';\n\nexport interface BasePopupAttrs {\n  configurable: boolean;\n}\n\nexport abstract class PopupStandaloneComp extends BaseComp {\n  protected body: HTMLElement;\n\n  protected header: HTMLHeadingElement;\n\n  protected text: HTMLParagraphElement;\n\n  constructor() {\n    super('div');\n\n    this.body = document.createElement('div');\n    this.header = document.createElement('h3');\n    this.text = document.createElement('p');\n\n    this.body.append(this.header, this.text);\n    this._rootElement.append(this.body);\n  }\n}\n","export function hexToRgb(hex: string): { r: number; g: number; b: number } {\n  let c: string[];\n  if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\n    // c = hex.substring(1).split('');\n    c = hex.split('');\n    if (c.length === 4) {\n      c = [c[1], c[1], c[2], c[2], c[3], c[3]] as string[];\n    }\n    const r = Number.parseInt(hex.slice(1, 3), 16);\n    const g = Number.parseInt(hex.slice(3, 5), 16);\n    const b = Number.parseInt(hex.slice(5, 7), 16);\n    // return `rgb(${r}, ${g}, ${b})`;\n    return { r, g, b };\n  }\n  throw new Error('Bad Hex');\n}\n","export function genUniqId(): string {\n  const arr = new Uint8Array(4);\n  return window.crypto.getRandomValues(arr).join('');\n}\n\nexport function getRandomInt(max: number): number {\n  return Math.floor(Math.random() * max);\n}\n\nexport function getRandomArbitraryInt(min: number, max: number): number {\n  return Math.floor(Math.random() * (max - min) + min);\n}\n\nexport function genRandomHexColor(): string {\n  const color = `#${Math.floor(Math.random() * 16_777_215).toString(16)}`;\n  if (color.length === 7) return color;\n  return genRandomHexColor();\n}\n","export interface TransitionPromiseInterface {\n  elem: HTMLElement;\n  prop: string;\n  val?: string;\n  valToWait?: string;\n  forceAutoresolveIn?: number;\n}\n\nexport function getTransitionDuration(\n  style: CSSStyleDeclaration,\n  prop: string,\n) {\n  const transPropArr = style\n    .getPropertyValue('transition-property')\n    .replace(',', '')\n    .split(' ');\n  let propIndex = transPropArr.lastIndexOf(prop);\n\n  if (propIndex === -1) propIndex = transPropArr.lastIndexOf('all');\n\n  if (propIndex !== -1) {\n    const transDurationsArr = style\n      .getPropertyValue('transition-duration')\n      .replace(',', '')\n      .split(' ');\n    return transDurationsArr[propIndex];\n  }\n\n  return undefined;\n}\n\nexport function transitionPromise(\n  params: TransitionPromiseInterface,\n): Promise<boolean> {\n  return new Promise(resolve => {\n    const transformAndAutoresolve = (delay?: number): void => {\n      if (params.val) params.elem.style.setProperty(params.prop, params.val);\n      const time = delay || 20;\n      setTimeout(() => {\n        resolve(true);\n        // doesn't work - for cause look forward\n        // window.getComputedStyle(elem)[prop] == val ? resolve(true) : resolve(false);\n      }, time);\n    };\n\n    const transformAndWaitEvent = () => {\n      const eventHandler = (e: TransitionEvent): void => {\n        if (e.target !== params.elem) return;\n\n        if (e.propertyName !== params.prop) return;\n\n        if (\n          params.valToWait &&\n          window.getComputedStyle(params.elem).getPropertyValue(params.prop) !==\n            params.valToWait\n        ) {\n          return;\n        }\n\n        params.elem.removeEventListener('transitionend', eventHandler);\n        params.elem.removeEventListener('transitionend', eventHandler);\n\n        // val should be equal to style ! For example translate != matrix...\n        // if(val) window.getComputedStyle(elem)[prop] == val ? resolve(true) : reject(false);\n        // else\n        resolve(true);\n      };\n\n      params.elem.addEventListener('transitionend', eventHandler);\n      params.elem.addEventListener('transitioncancel', eventHandler);\n\n      if (params.val) params.elem.style.setProperty(params.prop, params.val);\n    };\n\n    if (params.forceAutoresolveIn)\n      transformAndAutoresolve(params.forceAutoresolveIn);\n    else if (\n      params.valToWait &&\n      window.getComputedStyle(params.elem).getPropertyValue(params.prop) ===\n        params.valToWait\n    )\n      transformAndAutoresolve();\n    else {\n      const style = window.getComputedStyle(params.elem);\n      const duration = getTransitionDuration(style, params.prop);\n\n      if (!duration || duration === '0s') {\n        transformAndAutoresolve();\n      } else {\n        transformAndWaitEvent();\n      }\n    }\n  });\n}\n","export interface Notifiable {\n  notify: <T>(params: T) => void | Promise<void>;\n}\n\nexport function isNotifiable(object: unknown): object is Notifiable {\n  const objAsRecord = object as Record<string, unknown>;\n  return 'notify' in objAsRecord && typeof objAsRecord.notify === 'function';\n}\n","class ObjProcessor {\n  readonly deepFreeze = <T>(obj: T): T => {\n    if (typeof obj === 'object' && obj !== null) {\n      const record = obj as Record<string, unknown>;\n      Object.keys(record).forEach(prop => {\n        if (\n          typeof record[prop] === 'object' &&\n          !Object.isFrozen(record[prop])\n        ) {\n          this.deepFreeze(record[prop]);\n        }\n      });\n      return Object.freeze(obj);\n    }\n    throw new Error('not object');\n  };\n\n  readonly deepClone = <T>(target: T): T => {\n    if (Array.isArray(target)) {\n      const clone = [] as unknown[];\n      (target as unknown[]).forEach(v => {\n        clone.push(v);\n      });\n      return clone.map((n: unknown) => this.deepClone(n)) as unknown as T;\n    }\n\n    if (typeof target === 'object' && target !== null) {\n      if (target instanceof HTMLElement)\n        return target.cloneNode(true) as unknown as T;\n      if (target instanceof Blob) return target.slice() as unknown as T;\n      const clone = {\n        ...(target as unknown as { [key: string]: unknown }),\n      } as {\n        [key: string]: unknown;\n      };\n      Object.keys(clone).forEach(k => {\n        clone[k] = this.deepClone(clone[k]);\n      });\n      Object.setPrototypeOf(clone, Object.getPrototypeOf(target));\n      return clone as unknown as T;\n    }\n    return target;\n  };\n}\n\nconst OBJ_PROCESSOR = new ObjProcessor();\nOBJ_PROCESSOR.deepFreeze(OBJ_PROCESSOR);\nexport { OBJ_PROCESSOR };\n","import { DBusTopics } from './defs/dbus-topics.def';\nimport { genUniqId } from '../../generators/generators';\nimport { OBJ_PROCESSOR } from '../../processors/obj-processor';\nimport { DBUS_ERRORS } from './defs/dbus-errors.def';\nimport { DBusRX, DBusRXFunc } from './defs/dbus-rx/dbus-rx.def';\nimport { DBusTX } from './defs/dbus-tx/dbus-tx.def';\nimport { DBusTXOptions } from './defs/dbus-tx/dbus-tx-options.def';\nimport { DBusTXData } from './defs/dbus-tx/dbus-tx-data.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from './defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTXDataHeaders } from './defs/dbus-tx/dbus-tx-data-headers.def';\nimport { DBusHub, DBusInterface } from './defs/dbus-interface.def';\nimport { DBUS_HUB_NAMES } from './defs/dbus-hub-names.def';\n\nexport class DBus {\n  private network: Map<DBusTopics, Set<DBusRX>> = new Map();\n\n  private idCounter = {\n    txs: 0,\n    rxs: 0,\n  };\n\n  private createdRXs = new Set<DBusRX>();\n\n  private createdTXs = new Set<DBusTX>();\n\n  private attachedHubs = new Map<DBusHub, DBusInterface>();\n\n  private occupiedNames = new Set<string>();\n\n  readonly busId: string;\n\n  constructor() {\n    this.busId = genUniqId();\n    return Object.freeze(this) as unknown as DBus;\n  }\n\n  public attachHub(hub: DBusHub, suffix?: string): void | Promise<void> {\n    return this.createInterfaceForHub(hub, undefined, suffix);\n  }\n\n  private createInterfaceForHub(\n    hub: DBusHub,\n    prefix?: string,\n    suffix?: string,\n  ): void | Promise<void> {\n    if (this.attachedHubs.has(hub))\n      throw new Error(DBUS_ERRORS.HUB_IS_ALREADY_ATTACHED);\n\n    if (!(hub.hubName in DBUS_HUB_NAMES))\n      throw new Error(DBUS_ERRORS.HUB_NAME_NOT_AUTHORIZED);\n\n    let hubName = prefix ? `${prefix}_${hub.hubName}` : hub.hubName;\n    if (suffix) hubName += `_${suffix}`;\n\n    if (this.occupiedNames.has(hubName))\n      throw new Error(DBUS_ERRORS.HUB_NAME_IS_OCCUPIED);\n\n    const arrowedGetNewTX = (desc?: string) => this.getNewTX(hubName, desc);\n    const arrowedGetNewRX = (func: DBusRXFunc, desc?: string) =>\n      this.genNewRX(func, desc);\n    const arrowedPlugRX = (topic: DBusTopics, rx: DBusRX) =>\n      this.plugRX(topic, rx);\n    const arrowedUnplugRX = (topic: DBusTopics, rx: DBusRX) =>\n      this.unplugRX(topic, rx);\n    const decoratedAttachHub = (subHub: DBusHub, subSuffix?: string) =>\n      this.createInterfaceForHub(subHub, hubName, subSuffix);\n\n    const dbusInterface = new DBusInterface(\n      arrowedGetNewTX,\n      arrowedGetNewRX,\n      arrowedPlugRX,\n      arrowedUnplugRX,\n      decoratedAttachHub,\n    );\n\n    this.occupiedNames.add(hubName);\n    this.attachedHubs.set(hub, dbusInterface);\n\n    OBJ_PROCESSOR.deepFreeze(dbusInterface);\n\n    return hub.connect(dbusInterface);\n  }\n\n  private getNewTX(hubName: string, desc?: string): DBusTX {\n    const id = genUniqId();\n    const regNumber = this.idCounter.txs++;\n\n    const arrowedTransmit = async (opts: DBusTXOptions) => {\n      const head = new DBusTXDataHeaders(\n        hubName,\n        id,\n        regNumber,\n        opts.waitMode,\n        opts.prepMode,\n        desc,\n      );\n      const data = new DBusTXData(head, opts.msg);\n      const result = await this.transmit(data);\n      return result;\n    };\n\n    const tx = new DBusTX(regNumber, id, this.busId, arrowedTransmit);\n\n    const freezedTX = OBJ_PROCESSOR.deepFreeze(tx);\n\n    this.createdTXs.add(freezedTX);\n\n    return freezedTX;\n  }\n\n  private genNewRX(func: DBusRXFunc, desc?: string): DBusRX {\n    const id = genUniqId();\n    const regNumber = this.idCounter.rxs++;\n    const rx = new DBusRX(regNumber, id, this.busId, func, desc);\n    const freezedRX = OBJ_PROCESSOR.deepFreeze(rx);\n    this.createdRXs.add(freezedRX);\n    return freezedRX;\n  }\n\n  private plugRX(topic: DBusTopics, rx: DBusRX): void {\n    if (!this.createdRXs.has(rx)) throw new Error(DBUS_ERRORS.XENO_RX);\n    if (!this.network.has(topic)) this.network.set(topic, new Set());\n    this.network.get(topic)?.add(rx);\n  }\n\n  private unplugRX(topic: DBusTopics, rx: DBusRX): void {\n    this.network.get(topic)?.delete(rx);\n  }\n\n  private async transmit(data: DBusTXData): Promise<unknown> {\n    if (!this.network.has(data.msg.topic)) {\n      throw new Error(DBUS_ERRORS.TOPIC_IS_NOT_EXIST);\n    }\n\n    const rxs = this.network.get(data.msg.topic);\n\n    if (rxs === undefined || rxs.size === 0)\n      throw new Error(DBUS_ERRORS.TOPIC_HAS_NO_RXS);\n\n    let choosedRXs: DBusRX[] = [];\n\n    if (data.msg.prefResponseRxIds) {\n      rxs.forEach(rx => {\n        if (data.msg.prefResponseRxIds?.includes(rx.id)) choosedRXs.push(rx);\n      });\n      if (choosedRXs.length === 0)\n        throw new Error(DBUS_ERRORS.PREF_RXS_ARE_NOT_EXIST);\n    } else choosedRXs = [...rxs];\n\n    let result;\n    switch (data.headers.waitMode) {\n      case DBusTXWaitModes.all:\n        result = await Promise.all(\n          choosedRXs.map(rx => this.callRXFunc(data, rx)),\n        );\n        break;\n      case DBusTXWaitModes.allSetled:\n        result = await Promise.allSettled(\n          choosedRXs.map(rx => this.callRXFunc(data, rx)),\n        );\n        break;\n      case DBusTXWaitModes.manual:\n        result = choosedRXs;\n        break;\n      case DBusTXWaitModes.nowait:\n      default:\n        choosedRXs.map(rx => this.callRXFunc(data, rx));\n        result = true;\n        break;\n    }\n    return result;\n  }\n\n  private callRXFunc = (data: DBusTXData, rx: DBusRX) => {\n    const handleClone = () => {\n      const clonedData = OBJ_PROCESSOR.deepClone(data);\n      return rx.func(clonedData);\n    };\n\n    const handleFreeze = () => {\n      const freezedData = OBJ_PROCESSOR.deepFreeze(data);\n      return rx.func(freezedData);\n    };\n\n    switch (data.headers.prepMode) {\n      case DBusTXPrepModes.clone:\n        return handleClone();\n      case DBusTXPrepModes.freeze:\n        return handleFreeze();\n      default:\n        throw new Error(DBUS_ERRORS.UNEXPECTED_PREP_MODE);\n    }\n  };\n}\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nconst dbusCommonResponses = {\n  VOID: 'VOID',\n  BAD_REQUEST: 'BAD_REQUEST',\n};\n\nconst DBUS_COMMON_RESPONSES = OBJ_PROCESSOR.deepFreeze(dbusCommonResponses);\n\nexport { DBUS_COMMON_RESPONSES };\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nconst dbusErrors = {\n  HUB_NAME_IS_OCCUPIED: 'HUB_NAME_IS_OCCUPIED',\n  HUB_IS_ALREADY_ATTACHED: 'HUB_IS_ALREADY_ATTACHED',\n  HUB_NAME_NOT_AUTHORIZED: 'HUB_NAME_NOT_AUTHORIZED',\n  XENO_RX: 'XENO_RX',\n  TOPIC_IS_NOT_EXIST: 'TOPIC_IS_NOT_EXIST',\n  TOPIC_HAS_NO_RXS: 'TOPIC_HAS_NO_RXS',\n  PREF_RXS_ARE_NOT_EXIST: 'PREF_RXS_ARE_NOT_EXIST',\n  UNEXPECTED_PREP_MODE: 'UNEXPECTED_PREP_MODE',\n};\n\nconst DBUS_ERRORS = OBJ_PROCESSOR.deepFreeze(dbusErrors);\n\nexport { DBUS_ERRORS };\n","import { OBJ_PROCESSOR } from '../../../processors/obj-processor';\n\nclass DBusHubNames {\n  readonly APP = 'APP';\n\n  readonly ROUTER = 'ROUTER';\n\n  readonly GARAGE = 'GARAGE';\n\n  readonly HEADER = 'HEADER';\n\n  readonly MAIN_CONTROLS = 'MAIN_CONTROLS';\n\n  readonly CREATE_UPDATE = 'CREATE_UPDATE';\n\n  readonly GARAGE_CONTROLLER = 'GARAGE_CONTROLLER';\n}\n\nconst obj = new DBusHubNames();\n\nconst DBUS_HUB_NAMES = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { DBUS_HUB_NAMES };\n\nexport type DBusHubNamesList = keyof DBusHubNames;\n","import { DBusHubNamesList, DBUS_HUB_NAMES } from './dbus-hub-names.def';\nimport { DBusRX, DBusRXFunc } from './dbus-rx/dbus-rx.def';\nimport { DBusTopics } from './dbus-topics.def';\nimport { DBusTX } from './dbus-tx/dbus-tx.def';\n\nexport interface DBusHub {\n  readonly hubName: DBusHubNamesList;\n  connect: (dbusInterface: DBusInterface) => void | Promise<void>;\n  // TODO: handleSystemRequset: (request: unknown) => unknown | Promise<unknown>;\n}\n\nexport function isDBusHub(object: unknown): object is DBusHub {\n  const objAsRecord = object as Record<string, unknown>;\n  return (\n    'connect' in objAsRecord &&\n    'hubName' in objAsRecord &&\n    typeof objAsRecord.hubName === 'string' &&\n    objAsRecord.hubName in DBUS_HUB_NAMES\n  );\n}\n\nexport class DBusInterface {\n  private RXs = new Set<DBusRX>();\n\n  private TXs = new Set<DBusTX>();\n\n  private RXsPlugMap = new Map<DBusTopics, Set<DBusRX>>();\n\n  constructor(\n    private readonly arrowedGetNewTX: (desc?: string) => DBusTX,\n    private readonly arrowedGetNewRX: (\n      func: DBusRXFunc,\n      desc?: string,\n    ) => DBusRX,\n    private readonly arrowedPlugRX: (topic: DBusTopics, rx: DBusRX) => void,\n    private readonly arrowedUnplugRX: (topic: DBusTopics, rx: DBusRX) => void,\n    public readonly attachSubHub: (\n      subHub: DBusHub,\n      subSuffix?: string,\n    ) => void | Promise<void>,\n  ) {}\n\n  getNewRX(func: DBusRXFunc, desc?: string) {\n    const rx = this.arrowedGetNewRX(func, desc);\n    this.RXs.add(rx);\n    return rx;\n  }\n\n  getNewTX(desc?: string) {\n    const tx = this.arrowedGetNewTX(desc);\n    this.TXs.add(tx);\n    return tx;\n  }\n\n  plugRX(topic: DBusTopics, rx: DBusRX): void {\n    if (!this.RXsPlugMap.has(topic)) this.RXsPlugMap.set(topic, new Set());\n    this.RXsPlugMap.get(topic)?.add(rx);\n    this.arrowedPlugRX(topic, rx);\n  }\n\n  unplugRX(topic: DBusTopics, rx: DBusRX): void {\n    this.RXsPlugMap.get(topic)?.delete(rx);\n    this.arrowedUnplugRX(topic, rx);\n  }\n}\n","import { DBusTXData } from '../dbus-tx/dbus-tx-data.def';\n\nexport type DBusRXFunc = (data: DBusTXData) => Promise<unknown>;\n\nexport class DBusRX {\n  constructor(\n    readonly regNumber: number,\n    readonly id: string,\n    readonly busId: string,\n    readonly func: DBusRXFunc,\n    readonly desc?: string,\n  ) {}\n}\n","export enum DBusTopics {\n  APP_CTL,\n  ROUTING,\n  CAR_ACTION,\n  GARAGE,\n  REST_CLIENT_REQUESTS,\n  GENERATE,\n}\n","import { DBusTXPrepModes, DBusTXWaitModes } from './dbus-tx-modes.def';\n\nexport class DBusTXDataHeaders {\n  constructor(\n    readonly hubName: string,\n    readonly txId: string,\n    readonly txRegNumber: number,\n    readonly waitMode: DBusTXWaitModes,\n    readonly prepMode: DBusTXPrepModes,\n    readonly txDesc?: string,\n  ) {}\n}\n","import { DBusMsg } from '../msgs/dbus-msg.def';\nimport { DBusTXDataHeaders } from './dbus-tx-data-headers.def';\n\nexport class DBusTXData {\n  constructor(readonly headers: DBusTXDataHeaders, readonly msg: DBusMsg) {}\n}\n","export enum DBusTXWaitModes {\n  nowait,\n  all,\n  allSetled,\n  manual,\n}\n\nexport enum DBusTXPrepModes {\n  clone,\n  freeze,\n}\n","import { DBusTXOptions } from './dbus-tx-options.def';\n\nexport class DBusTX {\n  constructor(\n    readonly regNumber: number,\n    readonly id: string,\n    readonly busId: string,\n    readonly transmit: (options: DBusTXOptions) => Promise<unknown>,\n  ) {}\n}\n","import { DBusTopics } from '../dbus-topics.def';\n\nexport abstract class DBusMsg {\n  constructor(\n    readonly topic: DBusTopics,\n    readonly rxIds?: string[],\n    readonly prefResponseRxIds?: string[],\n  ) {}\n}\n","export class Pager {\n  private firstPageNumber = 1;\n\n  private currPageNumber = this.firstPageNumber;\n\n  private lastPageNumber = 0;\n\n  private pagerSpan = document.createElement('span');\n\n  private entriesCount = 0;\n\n  private callbackIsCalled = false;\n\n  constructor(\n    private entriesPerPage: number,\n    protected readonly listCallback: (dir: 'prev' | 'next') => Promise<boolean>,\n    private btnPrevPage = document.createElement('button'),\n    private btnNextPage = document.createElement('button'),\n  ) {\n    const btnNextSpan = document.createElement('span');\n    btnNextSpan.textContent = 'Next page';\n    this.btnNextPage.append(btnNextSpan);\n\n    const btnPrevSpan = document.createElement('span');\n    btnPrevSpan.textContent = 'Prev page';\n    this.btnPrevPage.append(btnPrevSpan);\n\n    this.btnNextPage.addEventListener('click', () => this.callCallback('next'));\n    this.btnPrevPage.addEventListener('click', () => this.callCallback('prev'));\n  }\n\n  public toogleLock(lock: boolean) {\n    console.log('lock');\n    this.toggleBtnsDisabled(lock);\n  }\n\n  public getEntriesPerPage(): number {\n    return this.entriesPerPage;\n  }\n\n  public setLastPageNumber(n: number) {\n    this.lastPageNumber = n;\n    if (!this.callbackIsCalled) this.toggleBtnsDisabled(false);\n  }\n\n  public setEntriesCount(n: number) {\n    this.entriesCount = n;\n    this.lastPageNumber = Math.ceil(this.entriesCount / this.entriesPerPage);\n    this.updateSpanText();\n    if (!this.callbackIsCalled) this.toggleBtnsDisabled(false);\n  }\n\n  public getCurrPageNumber() {\n    return this.currPageNumber;\n  }\n\n  public getBtnPrevPage(): HTMLSpanElement {\n    return this.btnPrevPage;\n  }\n\n  public getBtnNextPage(): HTMLSpanElement {\n    return this.btnNextPage;\n  }\n\n  public getPagerSpan(): HTMLSpanElement {\n    return this.pagerSpan;\n  }\n\n  tryChangePage(dir: 'prev' | 'next') {\n    return this.callCallback(dir);\n  }\n\n  private updateSpanText() {\n    const pageNumber = this.entriesCount > 0 ? this.currPageNumber : 0;\n    this.pagerSpan.textContent = `Entries: ${this.entriesCount}, Page: ${pageNumber}/${this.lastPageNumber}`;\n  }\n\n  private async callCallback(dir: 'prev' | 'next') {\n    this.callbackIsCalled = true;\n    this.toggleBtnsDisabled(true);\n    const pageIsChanged = await this.listCallback(dir);\n    if (pageIsChanged) {\n      switch (dir) {\n        case 'next':\n          this.currPageNumber++;\n          break;\n        case 'prev':\n          this.currPageNumber--;\n          break;\n        default:\n          break;\n      }\n      this.updateSpanText();\n    }\n    this.toggleBtnsDisabled(false);\n    this.callbackIsCalled = false;\n  }\n\n  private toggleBtnsDisabled(state: boolean) {\n    if (state === true) {\n      this.btnPrevPage.disabled = true;\n      this.btnNextPage.disabled = true;\n      return;\n    }\n\n    if (this.currPageNumber > this.firstPageNumber)\n      this.btnPrevPage.disabled = false;\n    else this.btnPrevPage.disabled = true;\n\n    if (this.currPageNumber < this.lastPageNumber)\n      this.btnNextPage.disabled = false;\n    else this.btnNextPage.disabled = true;\n  }\n}\n","import { DBusTopics } from '../../dbus/defs/dbus-topics.def';\nimport { DBusMsg } from '../../dbus/defs/msgs/dbus-msg.def';\n\nexport abstract class DBusMsgRoutingMsg extends DBusMsg {\n  constructor(rxIds?: string[], prefResponseRxIds?: string[]) {\n    super(DBusTopics.ROUTING, rxIds, prefResponseRxIds);\n  }\n}\n","import { DBusMsgRoutingMsg } from '../dbus-msg-routing-msg.def';\nimport { ROUTES } from '../../routes.def';\n\nexport class DBusMsgRouteIsChangedMsg extends DBusMsgRoutingMsg {\n  constructor(\n    readonly newRoute: keyof typeof ROUTES | string,\n    readonly addInfo?: unknown,\n    rxIds?: string[],\n    prefResponseRxIds?: string[],\n  ) {\n    super(rxIds, prefResponseRxIds);\n  }\n}\n","export class SimpleRouterAgent {\n  constructor(\n    readonly type: string,\n    readonly path: string,\n    readonly callback: CallableFunction,\n    readonly getStateCallback?: CallableFunction,\n    readonly setStateCallback?: CallableFunction,\n  ) {}\n}\n","import { OBJ_PROCESSOR } from '../../processors/obj-processor';\nimport { DBUS_HUB_NAMES } from '../dbus/defs/dbus-hub-names.def';\nimport { DBusHub, DBusInterface } from '../dbus/defs/dbus-interface.def';\nimport {\n  DBusTXPrepModes,\n  DBusTXWaitModes,\n} from '../dbus/defs/dbus-tx/dbus-tx-modes.def';\nimport { DBusTX } from '../dbus/defs/dbus-tx/dbus-tx.def';\nimport { DBusMsgRouteIsChangedMsg } from './dbus-msgs-defs/types/dbus-msg-route-is-chaned-msg';\nimport { SimpleRouterAgent } from './simple-router-agent';\n\nexport interface RouterOptions {\n  mode: string;\n  onlyDBus?: true;\n  defaultRoot?: string;\n  defaultAgent?: SimpleRouterAgent;\n}\n\nexport class SimpleRouter implements DBusHub {\n  readonly hubName = DBUS_HUB_NAMES.ROUTER;\n\n  private agents: Set<SimpleRouterAgent> = new Set();\n\n  private options: RouterOptions;\n\n  private currRoute: string | undefined;\n\n  private txs: Set<DBusTX> = new Set();\n\n  private defaultAgent: SimpleRouterAgent | undefined;\n\n  private restrictions: Set<() => Promise<boolean>> = new Set();\n\n  constructor(options: RouterOptions) {\n    switch (options.mode) {\n      case '#':\n        // just filter that # mode\n        break;\n      case '?':\n        throw new Error(`${options.mode} is not supported yet!`);\n      default:\n        throw new Error(`${options.mode} is not supported!`);\n    }\n    this.options = OBJ_PROCESSOR.deepFreeze(options);\n\n    window.addEventListener('popstate', async () => {\n      if (window.location.href === this.currRoute) return;\n\n      if (this.restrictions.size > 0) {\n        const wantedRoute = window.location.href;\n\n        if (this.currRoute) {\n          window.location.href = this.currRoute;\n        } else if (this.options.defaultRoot) {\n          window.location.href = `${window.location.host}/${this.options.defaultRoot}`;\n        }\n        const arr = [...this.restrictions.values()];\n        const promises = arr.map(arrow => arrow());\n        const result = await Promise.all(promises);\n        let cancelRouteChange = false;\n\n        if (Array.isArray(result)) {\n          for (let i = 0; i < result.length; i++) {\n            if (typeof result[i] !== 'boolean')\n              throw new Error('restrict func returned not boolean value!');\n\n            if (!result[i]) cancelRouteChange = true;\n            else {\n              const func = arr[i];\n\n              if (func) this.restrictions.delete(func);\n            }\n          }\n        }\n\n        if (!cancelRouteChange) window.location.href = wantedRoute;\n      } else {\n        this.activateWantedAgents();\n      }\n    });\n  }\n\n  activateWantedAgents(addInfo?: unknown): boolean | Error[] {\n    this.currRoute = window.location.href;\n    let activatedCount = 0;\n    const errors = [];\n\n    if (!this.options.onlyDBus && this.options.mode === '#') {\n      const agentsArr = [...this.agents];\n      for (let i = 0; i < this.agents.size; i++) {\n        if (agentsArr[i]?.path === window.location.hash) {\n          try {\n            agentsArr[i]?.callback(addInfo);\n          } catch (error) {\n            error.push(error);\n          }\n          activatedCount++;\n          break;\n        }\n      }\n\n      if (activatedCount === 0) {\n        if (\n          this.defaultAgent &&\n          this.options.defaultRoot === window.location.hash\n        ) {\n          this.defaultAgent.callback(addInfo);\n        } else {\n          errors.push(new Error('Agent is not finded'));\n        }\n      }\n    }\n\n    if (this.txs.size > 0) {\n      this.txs.forEach(tx => {\n        const msg = new DBusMsgRouteIsChangedMsg(window.location.hash, addInfo);\n        tx.transmit({\n          msg,\n          waitMode: DBusTXWaitModes.nowait,\n          prepMode: DBusTXPrepModes.freeze,\n        });\n      });\n    }\n\n    if (errors.length > 0) return errors;\n    return activatedCount > 0;\n  }\n\n  addRouterAgent(agent: SimpleRouterAgent): void {\n    this.agents.add(agent);\n  }\n\n  removeRouterAgent(agent: SimpleRouterAgent): void {\n    this.agents.delete(agent);\n  }\n\n  flushRouterAgents(): void {\n    this.agents.clear();\n  }\n\n  /* not refactored yet\n  private watchRestrictions = async (msg: DataBusRoutingMsg) => {\n    if (msg instanceof DataBusMsgRoutingRoutingRestrictMode) {\n      const func = msg.data.callbackPromiseGenerator as () => Promise<boolean>;\n\n      if (msg.data.mode) {\n        this.restrictions.add(func);\n      } else {\n        this.restrictions.delete(func);\n      }\n    }\n  };\n  */\n\n  connect(int: DBusInterface): void {\n    const tx = int.getNewTX('broadcasting route changes');\n    this.txs.add(tx);\n    // watch restriction\n    // not refactored yet\n    // const rx = bus.getNewRX();\n    // bus.registerReceiver(DataBusMsgTopics.ROUTING, msgReceiver);\n  }\n}\n","import { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\n\nexport type EngineResponse = {\n  velocity: number;\n  distance: number;\n};\n\nclass RestClientEngine {\n  private resUrl = '/engine';\n\n  private fullUrl: string;\n\n  constructor(private baseUrl: string) {\n    this.fullUrl = baseUrl + this.resUrl;\n  }\n\n  toggleEngine(\n    id: number,\n    status: 'started' | 'stopped',\n  ): Promise<EngineResponse> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}?id=${id}&status=${status}`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as EngineResponse))\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  enterDriveMode(id: number): Promise<true | false | 404> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}?id=${id}&status=drive`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          else if (response.status === 500) res(false);\n          else rej(new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT));\n        })\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n}\n\nconst obj = new RestClientEngine('http://127.0.0.1:3000');\n\nconst REST_CLIENT_ENGINE = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_ENGINE };\n","import { RegCarData, UnregCarData } from '../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\nimport { REST_CLIENT_NAMES } from '../rest-clients-names.def';\n\nclass RestClientGarage {\n  protected clientName = REST_CLIENT_NAMES.GARAGE;\n\n  private resUrl = '/garage';\n\n  private fullUrl: string;\n\n  constructor(private baseUrl: string) {\n    this.fullUrl = baseUrl + this.resUrl;\n  }\n\n  getCars(\n    page?: number,\n    limit?: number,\n  ): Promise<{ limit: string; cars: RegCarData[] }> {\n    return new Promise((res, rej) => {\n      const limitStr = limit || '';\n      const url = `${this.fullUrl}?_page=${page}&_limit=${limitStr}`;\n      let limitResponse = '';\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) {\n            limitResponse = response.headers.get('X-Total-Count') as string;\n            return response.json();\n          }\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res({ limit: limitResponse, cars: json as RegCarData[] }))\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  getCar(id: number): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as RegCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  createCar(unregCar: UnregCarData): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      fetch(this.fullUrl, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(unregCar),\n      })\n        .then(response => {\n          if (response.status === 201) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as RegCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  deleteCar(id: number): Promise<true> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'DELETE',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  updateCar(regCar: RegCarData): Promise<RegCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${regCar.id}`;\n      const data: UnregCarData = regCar;\n      fetch(url, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data),\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n}\n\nconst obj = new RestClientGarage('http://127.0.0.1:3000');\n\nconst REST_CLIENT_GARAGE = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_GARAGE };\n","import { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\n\nclass RestClientWinnersSortOptions {\n  readonly id = 'id';\n\n  readonly wins = 'wins';\n\n  readonly time = 'time';\n}\n\nconst obj = new RestClientWinnersSortOptions();\n\nconst REST_CLIENT_WINNERS_SORT_OPTIONS = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_WINNERS_SORT_OPTIONS };\n\nexport type RestClientWinnersSortOptionsList =\n  keyof RestClientWinnersSortOptions;\n","import { WinnerCarData } from '../../../definitions/car-data.def';\nimport { OBJ_PROCESSOR } from '../../../lib/processors/obj-processor';\nimport { REST_CLIENT_ERROR } from '../rest-clients-errors.def';\nimport { RestClientWinnersSortOptionsList } from './rest-client-winners.def';\n\nclass RestClientWinners {\n  private resUrl = '/winners';\n\n  private fullUrl: string;\n\n  constructor(private baseUrl: string) {\n    this.fullUrl = baseUrl + this.resUrl;\n  }\n\n  getWinners(\n    page = 0,\n    limit?: number,\n    sort?: RestClientWinnersSortOptionsList,\n    order?: 'ASC' | 'DESC',\n  ): Promise<{ limit: string; cars: WinnerCarData[] }> {\n    return new Promise((res, rej) => {\n      const limitStr = limit || '';\n      let url = `${this.fullUrl}?_page=${page}&_limit=${limitStr}`;\n      if (sort) url += `&_sort=${sort}`;\n      if (order) url += `&_order=${order}`;\n      let limitResponse = '';\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) {\n            limitResponse = response.headers.get('X-Total-Count') as string;\n            return response.json();\n          }\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json =>\n          res({ limit: limitResponse, cars: json as WinnerCarData[] }),\n        )\n        .catch((error: Error) => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  getWinner(id: number): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'GET',\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  createWinner(winnerCarData: WinnerCarData): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      fetch(this.fullUrl, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(winnerCarData),\n      })\n        .then(response => {\n          if (response.status === 201) return response.json();\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  deleteWinner(id: number): Promise<true> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${id}`;\n      fetch(url, {\n        method: 'DELETE',\n      })\n        .then(response => {\n          if (response.status === 200) res(true);\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n\n  updateWinner(winnerData: WinnerCarData): Promise<WinnerCarData> {\n    return new Promise((res, rej) => {\n      const url = `${this.fullUrl}/${winnerData.id}`;\n      const data: WinnerCarData = winnerData;\n      fetch(url, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data),\n      })\n        .then(response => {\n          if (response.status === 200) return response.json();\n          if (response.status === 404)\n            throw new Error(REST_CLIENT_ERROR.NOT_FOUND);\n          throw new Error(REST_CLIENT_ERROR.UNEXPECTED_RESULT);\n        })\n        .then(json => res(json as WinnerCarData))\n        .catch(error => {\n          if (error.message in REST_CLIENT_ERROR) rej(error);\n          if (error.message === 'Failed to fetch')\n            rej(new Error(REST_CLIENT_ERROR.CONNECTION_REFUSED));\n          else rej(REST_CLIENT_ERROR.UNKNOWN_ERROR);\n        });\n    });\n  }\n}\n\nconst obj = new RestClientWinners('http://127.0.0.1:3000');\n\nconst REST_CLIENT_WINNERS = OBJ_PROCESSOR.deepFreeze(obj);\n\nexport { REST_CLIENT_WINNERS };\n","import { OBJ_PROCESSOR } from '../../lib/processors/obj-processor';\n\nconst restClientError = {\n  UNEXPECTED_RESULT: 'UNEXPECTED_RESULT',\n  UNKNOWN_ERROR: 'UNKNOWN_ERROR',\n  NOT_FOUND: 'NOT_FOUND',\n  CONNECTION_REFUSED: 'CONNECTION_REFUSED',\n};\n\nconst REST_CLIENT_ERROR = OBJ_PROCESSOR.deepFreeze(\n  restClientError,\n) as typeof restClientError;\n\nexport { REST_CLIENT_ERROR };\n","import { OBJ_PROCESSOR } from '../../lib/processors/obj-processor';\n\nclass RestClientNames {\n  readonly GARAGE = 'GARAGE';\n\n  readonly WINNERS = 'WINNERS';\n}\n\nconst REST_CLIENT_NAMES = new RestClientNames();\n\nOBJ_PROCESSOR.deepFreeze(REST_CLIENT_NAMES);\n\nexport { REST_CLIENT_NAMES };\n\nexport type RestClientNamesList = keyof RestClientNames;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { App } from './app/app';\n\nwindow.addEventListener('load', () => {\n  const appDiv = document.createElement('div');\n  document.body.append(appDiv);\n  const app = new App(appDiv);\n});\n"],"sourceRoot":""}